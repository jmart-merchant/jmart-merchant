(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{kj2d:function(t,e,i){"use strict";i.r(e);var n=i("ofXK"),s=i("PCNd"),r=i("tyNb"),a=i("lJxs"),o=i("fXoL"),c=i("2A1n");let l=(()=>{class t{constructor(t,e){this.authoritiesService=t,this.router=e}canActivate(){return this.authoritiesService.getOtpDevices().pipe(Object(a.a)(t=>{var e;const i=(null===(e=t)||void 0===e?void 0:e.length)>0;return i||this.router.navigate(["/authorities/main"]),i}))}}return t.\u0275fac=function(e){return new(e||t)(o.ec(c.a),o.ec(r.c))},t.\u0275prov=o.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var b=i("mrSG"),u=i("quSY"),d=i("itXk"),p=i("LRne"),m=i("pLZG"),h=i("JIr8"),g=i("VnnJ"),f=i("S1F0"),y=i("oKsb"),T=i("fvpk"),A=i("xJkR"),v=i("TwVa"),I=i("3Pt+"),S=i("+/Tu"),O=i("3rLF"),R=i("1kSV"),_=i("mR7B"),P=i("NpBu"),E=i("M6pS"),L=i("sYmb");let M=(()=>{class t{constructor(t,e,i){this.modal=t,this.authorityLimitsService=e,this.maskedService=i,this.isLoading=!1,this.form=new I.k({amount:new I.h("",[I.H.required,t=>t.value&&this.maskedService.getNumberedAmount(t.value)>O.a?{maxAmount:!0}:null])})}ngOnInit(){this.title=this.mapTranslate(`CREATE.${this.paymentType}`)}dismissModal(t){this.modal.dismiss(t)}closeModal(t){this.modal.close(t)}createLimit(){return Object(b.a)(this,void 0,void 0,(function*(){this.isLoading=!0;const{amount:t}=this.form.getRawValue(),e={paymentType:this.paymentType,limit:{amount:this.maskedService.getNumberedAmount(t),currency:S.a.KZT}};try{const t=yield this.authorityLimitsService.createLimit(this.authorityId,e);this.closeModal(t)}catch(i){this.dismissModal(i)}finally{this.isLoading=!1}}))}mapTranslate(t){return`AUTHORITIES.MODALS.${t}`}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(R.a),o.Qb(c.b),o.Qb(_.a))},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-create-limit-modal"]],inputs:{authorityId:"authorityId",paymentType:"paymentType"},decls:13,vars:14,consts:[[1,"pt-5","pb-4","px-4",3,"formGroup"],[1,"authorities-modal__article"],[1,"p3","text-muted"],[3,"label","formControl"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-primary",3,"jLoading","disabled","click"]],template:function(t,e){1&t&&(o.Wb(0,"form",0),o.Wb(1,"article",1),o.Wb(2,"h5"),o.Rc(3),o.mc(4,"translate"),o.Vb(),o.Wb(5,"p",2),o.Rc(6),o.mc(7,"translate"),o.Vb(),o.Vb(),o.Rb(8,"j-amount-input",3),o.Wb(9,"div",4),o.Wb(10,"button",5),o.ic("click",(function(t){return e.createLimit()})),o.Rc(11),o.mc(12,"translate"),o.Vb(),o.Vb(),o.Vb()),2&t&&(o.sc("formGroup",e.form),o.Ab(3),o.Tc(" ",o.nc(4,8,e.title)," "),o.Ab(3),o.Tc(" ",o.nc(7,10,e.mapTranslate("DESCRIPTION"))," "),o.Ab(2),o.sc("label",e.mapTranslate("LABEL"))("formControl",e.form.controls.amount),o.Ab(2),o.sc("jLoading",e.isLoading)("disabled",e.isLoading||e.form.invalid),o.Ab(1),o.Tc(" ",o.nc(12,12,e.mapTranslate("SUBMIT"))," "))},directives:[I.J,I.u,I.l,P.a,I.t,I.i,E.a],pipes:[L.d],styles:[".authorities-modal__article[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{line-height:30px;max-width:340px}"]}),t})(),C=(()=>{class t{constructor(t,e,i){this.modal=t,this.authorityLimitsService=e,this.maskedService=i,this.isLoading=!1}dismissModal(t){this.modal.dismiss(t)}closeModal(t,e=null){this.modal.close({message:t,limit:e})}ngOnInit(){this.title=this.mapTranslate(`CREATE.${this.paymentType}`),this.form=new I.k({amount:new I.h(this.maskedService.getMaskedAmount(this.limit.limit.amount),[I.H.required,t=>t.value&&this.maskedService.getNumberedAmount(t.value)>O.a?{maxAmount:!0}:null])})}deleteLimit(){return Object(b.a)(this,void 0,void 0,(function*(){this.isLoading=!0;try{yield this.authorityLimitsService.deleteLimit(this.authorityId,this.limit),this.closeModal("delete")}catch(t){this.dismissModal("delete")}finally{this.isLoading=!1}}))}updateLimit(){return Object(b.a)(this,void 0,void 0,(function*(){const{amount:t}=this.form.getRawValue(),e=Object.assign(Object.assign({},this.limit),{limit:{amount:this.maskedService.getNumberedAmount(t),currency:S.a.KZT}});this.isLoading=!0;try{const t=yield this.authorityLimitsService.updateLimit(this.authorityId,e);this.closeModal("update",t)}catch(i){this.dismissModal("update")}finally{this.isLoading=!1}}))}mapTranslate(t){return`AUTHORITIES.MODALS.${t}`}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(R.a),o.Qb(c.b),o.Qb(_.a))},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-edit-limit-modal"]],inputs:{authorityId:"authorityId",paymentType:"paymentType",limit:"limit"},decls:16,vars:19,consts:[[1,"pt-5","pb-4","px-4",3,"formGroup"],[1,"authorities-modal__article"],[1,"p3","text-muted"],[3,"label","formControl"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-outline-primary",3,"jLoading","disabled","click"],["type","submit",1,"ml-3","btn","btn-primary",3,"jLoading","disabled","click"]],template:function(t,e){1&t&&(o.Wb(0,"form",0),o.Wb(1,"article",1),o.Wb(2,"h5"),o.Rc(3),o.mc(4,"translate"),o.Vb(),o.Wb(5,"p",2),o.Rc(6),o.mc(7,"translate"),o.Vb(),o.Vb(),o.Rb(8,"j-amount-input",3),o.Wb(9,"div",4),o.Wb(10,"button",5),o.ic("click",(function(t){return e.deleteLimit()})),o.Rc(11),o.mc(12,"translate"),o.Vb(),o.Wb(13,"button",6),o.ic("click",(function(t){return e.updateLimit()})),o.Rc(14),o.mc(15,"translate"),o.Vb(),o.Vb(),o.Vb()),2&t&&(o.sc("formGroup",e.form),o.Ab(3),o.Tc(" ",o.nc(4,11,e.title)," "),o.Ab(3),o.Tc(" ",o.nc(7,13,e.mapTranslate("DESCRIPTION"))," "),o.Ab(2),o.sc("label",e.mapTranslate("LABEL"))("formControl",e.form.controls.amount),o.Ab(2),o.sc("jLoading",e.isLoading)("disabled",e.isLoading),o.Ab(1),o.Tc(" ",o.nc(12,15,e.mapTranslate("RESET"))," "),o.Ab(2),o.sc("jLoading",e.isLoading)("disabled",e.isLoading||e.form.invalid),o.Ab(1),o.Tc(" ",o.nc(15,17,e.mapTranslate("SUBMIT"))," "))},directives:[I.J,I.u,I.l,P.a,I.t,I.i,E.a],pipes:[L.d],styles:[""]}),t})();var V=i("VO+5"),W=i("DHTX"),j=i("wV3k");function k(t,e){if(1&t&&(o.Wb(0,"small",6),o.Rc(1),o.mc(2,"translate"),o.Vb()),2&t){const t=o.lc();o.Ab(1),o.Sc(o.nc(2,1,t.mapSwitchMessage("NO_LIMITS")))}}const x=function(t){return{amount:t}};function w(t,e){if(1&t&&(o.Wb(0,"small",6),o.Rc(1),o.mc(2,"translate"),o.mc(3,"money"),o.Vb()),2&t){const t=o.lc();o.Ab(1),o.Tc(" ",o.oc(2,1,t.mapSwitchMessage("HAS_LIMIT"),o.xc(6,x,o.nc(3,4,t.payment.limitAmount)))," ")}}function D(t,e){if(1&t){const t=o.Xb();o.Wb(0,"button",10),o.ic("click",(function(e){return o.Gc(t),o.lc(2).showCreateLimitModal()})),o.Rc(1),o.mc(2,"translate"),o.Vb()}if(2&t){const t=o.lc(2);o.sc("disabled",!t.payment.isEnabled),o.Ab(1),o.Tc(" ",o.nc(2,2,t.mapButtonLabel("SET_LIMIT"))," ")}}function F(t,e){if(1&t){const t=o.Xb();o.Wb(0,"button",11),o.ic("click",(function(e){return o.Gc(t),o.lc(2).showEditLimitModal()})),o.Rc(1),o.mc(2,"translate"),o.Vb()}if(2&t){const t=o.lc(2);o.sc("disabled",!t.payment.isEnabled),o.Ab(1),o.Tc(" ",o.nc(2,2,t.mapButtonLabel("CHANGE_LIMIT"))," ")}}function U(t,e){if(1&t&&(o.Ub(0),o.Wb(1,"div",7),o.Pc(2,D,3,4,"button",8),o.Pc(3,F,3,4,"button",9),o.Vb(),o.Tb()),2&t){const t=o.lc();o.Ab(2),o.sc("ngIf",!t.payment.limitAmount),o.Ab(1),o.sc("ngIf",t.payment.limitAmount)}}let N=(()=>{class t{constructor(t,e,i,n){this.authorityPermissionsService=t,this.notifierService=e,this.translateService=i,this.modalService=n}onChange(t){var e;return Object(b.a)(this,void 0,void 0,(function*(){try{let i;i=t?yield this.enablePayment():yield this.disablePayment(),!this.payment.permissionId&&(null===(e=i)||void 0===e?void 0:e.id)&&(this.payment.permissionId=i.id)}catch(i){this.payment.isEnabled=!this.payment.isEnabled}}))}enablePayment(){return Object(b.a)(this,void 0,void 0,(function*(){try{const t=yield this.authorityPermissionsService.grantPermission(this.person,this.payment);return this.notify("ACCESS_ENABLED"),t}catch(t){throw console.log(t),this.notify("ACCESS_ENABLE_FAILED","error"),t}}))}disablePayment(){return Object(b.a)(this,void 0,void 0,(function*(){try{const t=yield this.authorityPermissionsService.refusePermission(this.person,this.payment);return this.notify("ACCESS_DISABLED"),t}catch(t){throw console.log(t),this.notify("ACCESS_DISABLE_FAILED","error"),t}}))}showCreateLimitModal(){return Object(b.a)(this,void 0,void 0,(function*(){const t=this.createModalRef(M);try{const e=yield t.result;this.payment.limitId=e.id,this.payment.limitAmount=e.limit,this.notify("LIMIT_SET")}catch(e){e&&this.notify("LIMIT_SET_FAILED","error")}}))}showEditLimitModal(){return Object(b.a)(this,void 0,void 0,(function*(){const t=this.createModalRef(C);t.componentInstance.limit={id:this.payment.limitId,paymentType:this.payment.type,limit:this.payment.limitAmount};try{const{message:e,limit:i}=yield t.result;"update"===e?(this.payment.limitId=i.id,this.payment.limitAmount=i.limit,this.notify("LIMIT_UPDATED")):(this.payment.limitId=null,this.payment.limitAmount=null,this.notify("LIMIT_DELETED"))}catch(e){"update"===e?this.notify("LIMIT_UPDATE_FAILED","error"):"delete"==e&&this.notify("LIMIT_DELETE_FAILED","error")}}))}mapPaymentType(t){return this.mapTranslate(`TYPE.${t}`)}mapButtonLabel(t){return this.mapTranslate(`BUTTON.${t}`)}mapSwitchMessage(t){return this.mapTranslate(`SWITCH.${t}`)}createModalRef(t){const e=this.modalService.open(t,{backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",centered:!0});return e.componentInstance.authorityId=this.person.id,e.componentInstance.paymentType=this.payment.type,e}mapTranslate(t){return`AUTHORITIES.PAYMENTS.${t}`}notify(t,e="default"){this.notifierService.notify(e,this.translateService.instant(this.mapTranslate(`MESSAGES.${t}`),{paymentType:this.translateService.instant(this.mapPaymentType(this.payment.type))}))}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(c.c),o.Qb(V.c),o.Qb(L.e),o.Qb(R.q))},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-payment"]],inputs:{payment:"payment",person:"person"},decls:9,vars:7,consts:[[1,"toggle"],[3,"value","valueChange"],[1,"toggle__label"],[1,"d-block"],["class","text-gray",4,"ngIf"],[4,"ngIf"],[1,"text-gray"],[1,"toggle__button"],["class","btn btn-link link-blue p-0",3,"disabled","click",4,"ngIf"],["class","btn btn-link p-0",3,"disabled","click",4,"ngIf"],[1,"btn","btn-link","link-blue","p-0",3,"disabled","click"],[1,"btn","btn-link","p-0",3,"disabled","click"]],template:function(t,e){1&t&&(o.Wb(0,"div",0),o.Wb(1,"j-toggle",1),o.ic("valueChange",(function(t){return e.payment.isEnabled=t}))("valueChange",(function(t){return e.onChange(t)})),o.Vb(),o.Wb(2,"span",2),o.Wb(3,"strong",3),o.Rc(4),o.mc(5,"translate"),o.Vb(),o.Pc(6,k,3,3,"small",4),o.Pc(7,w,4,8,"small",4),o.Vb(),o.Vb(),o.Pc(8,U,4,2,"ng-container",5)),2&t&&(o.Ab(1),o.sc("value",e.payment.isEnabled),o.Ab(3),o.Sc(o.nc(5,5,e.mapPaymentType(e.payment.type))),o.Ab(2),o.sc("ngIf",!e.payment.limitAmount),o.Ab(1),o.sc("ngIf",e.payment.limitAmount),o.Ab(1),o.sc("ngIf",!e.payment.isLimitDisabled))},directives:[W.a,n.u],pipes:[L.d,j.a],styles:["[_nghost-%COMP%]{display:block;padding:1rem 0}@media(min-width:670px){[_nghost-%COMP%]{-webkit-box-align:center;align-items:center;display:-webkit-box;display:flex}}.toggle__label[_ngcontent-%COMP%]{display:block;margin-left:1rem}.toggle[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;margin-bottom:1rem}@media(min-width:670px){.toggle[_ngcontent-%COMP%]{margin-bottom:0}}.toggle__button[_ngcontent-%COMP%]{text-align:center;-webkit-box-flex:1;flex-grow:1}@media(min-width:670px){.toggle__button[_ngcontent-%COMP%]{text-align:right}}"]}),t})();function $(t,e){if(1&t&&(o.Wb(0,"div",7),o.Rb(1,"j-authorities-payment",8),o.Vb()),2&t){const t=e.$implicit,i=o.lc(2);o.Ab(1),o.sc("payment",t)("person",i.person)}}function H(t,e){if(1&t&&(o.Wb(0,"div",5),o.Pc(1,$,2,2,"div",6),o.Vb()),2&t){const t=o.lc();o.Ab(1),o.sc("ngForOf",t.payments)}}const Q=function(){return{height:"80px","background-color":"#ECEEF1"}};function K(t,e){1&t&&(o.Wb(0,"div",9),o.Rb(1,"ngx-skeleton-loader",10),o.Vb()),2&t&&(o.Ab(1),o.sc("theme",o.wc(1,Q)))}const B=[v.j.PENSION,v.j.SOCIAL,v.j.MEDICAL,v.j.TAX,v.j.SALARY,v.j.CONVERSION,v.j.FOREIGN];let G=(()=>{class t{constructor(t,e){this.authorityPermissionsService=t,this.authorityLimitsService=e,this.isLoading=!0}ngOnInit(){this.loadData()}loadData(){return Object(b.a)(this,void 0,void 0,(function*(){try{const t=yield this.authorityPermissionsService.getPermissions(this.person.id),e=yield this.loadLimits();this.payments=B.map(i=>{const n=t.find(t=>t.paymentType===i),s=e.find(t=>t.paymentType===i);return{type:i,permissionId:n?n.id:null,isEnabled:!n||n.permissions.length>0,limitId:s?s.id:null,limitAmount:s?s.limit:null,isLimitDisabled:[v.j.CONVERSION,v.j.FOREIGN].includes(i)}})}catch(t){}finally{this.isLoading=!1}}))}loadLimits(){return Object(b.a)(this,void 0,void 0,(function*(){try{return yield this.authorityLimitsService.getLimits(this.person.id)}catch(t){return[]}}))}mapTranslate(t){return`AUTHORITIES.PAYMENTS.${t}`}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(c.c),o.Qb(c.b))},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-payments"]],inputs:{person:"person"},decls:9,vars:8,consts:[[1,"payments__header"],[1,"mb-1"],[1,"mb-0","p3","text-muted"],["class","payments__body",4,"ngIf"],["class","payments__body pt-4 pb-2",4,"ngIf"],[1,"payments__body"],["class","payments__item",4,"ngFor","ngForOf"],[1,"payments__item"],[3,"payment","person"],[1,"payments__body","pt-4","pb-2"],["count","8",3,"theme"]],template:function(t,e){1&t&&(o.Wb(0,"article",0),o.Wb(1,"h6",1),o.Rc(2),o.mc(3,"translate"),o.Vb(),o.Wb(4,"p",2),o.Rc(5),o.mc(6,"translate"),o.Vb(),o.Vb(),o.Pc(7,H,2,1,"div",3),o.Pc(8,K,2,2,"div",4)),2&t&&(o.Ab(2),o.Sc(o.nc(3,4,e.mapTranslate("TITLE"))),o.Ab(3),o.Sc(o.nc(6,6,e.mapTranslate("DESCRIPTION"))),o.Ab(2),o.sc("ngIf",!e.isLoading),o.Ab(1),o.sc("ngIf",e.isLoading))},directives:[n.u,n.t,N,A.a],pipes:[L.d],styles:["[_nghost-%COMP%]{background:#fff;border-radius:12px;display:block}.payments__body[_ngcontent-%COMP%], .payments__header[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.payments__header[_ngcontent-%COMP%]{padding-top:22px;padding-bottom:1rem;border-bottom:1px solid #dbdfe2}"]}),t})();function Y(t,e){1&t&&(o.Ub(0),o.Rc(1," \u2022 "),o.Tb())}function J(t,e){if(1&t&&(o.Ub(0),o.Wb(1,"p",4),o.Rc(2),o.Pc(3,Y,2,0,"ng-container",2),o.Rc(4),o.mc(5,"translate"),o.Vb(),o.Wb(6,"h1",5),o.Rc(7),o.Vb(),o.Tb()),2&t){const t=o.lc();o.Ab(2),o.Tc(" ",t.person.position," "),o.Ab(1),o.sc("ngIf",t.person.position&&t.person.authority),o.Ab(1),o.Tc(" ",o.nc(5,6,t.mapAuthority(t.person.authority))," "),o.Ab(3),o.Vc(" ",t.person.lastname," ",t.person.firstname?t.person.firstname[0]+".":"","",t.person.middlename?t.person.middlename[0]+".":""," ")}}const X=function(){return{width:"300px",height:"24px","margin-bottom":"6px","background-color":"#ECEEF1"}},q=function(){return{height:"48px","margin-bottom":"0","background-color":"#ECEEF1"}};function Z(t,e){1&t&&(o.Ub(0),o.Rb(1,"ngx-skeleton-loader",6),o.Rb(2,"ngx-skeleton-loader",6),o.Tb()),2&t&&(o.Ab(1),o.sc("theme",o.wc(2,X)),o.Ab(1),o.sc("theme",o.wc(3,q)))}function z(t,e){if(1&t&&o.Rb(0,"j-authorities-payments",7),2&t){const t=o.lc();o.sc("person",t.person)}}let tt=(()=>{class t{constructor(t,e,i){this.router=t,this.route=e,this.companyService=i,this.subscription=new u.a,this.isReady=!1,this.initAuthoritiesSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapAuthority(t){return this.mapTranslate(`AUTHORITY.${t}`)}mapTranslate(t){return`AUTHORITIES.USERS.${t}`}initAuthoritiesSubscription(){this.subscription.add(Object(d.a)([this.route.params,this.companyService.getAuthorizedPersons().pipe(Object(m.a)(t=>{var e;return(null===(e=t)||void 0===e?void 0:e.length)>0})).pipe(Object(h.a)((t,e)=>(console.log(t),this.onClose(),Object(p.a)([]))))]).subscribe(([t,e])=>{this.initPerson(e.find(e=>e.id===t.id))}))}initPerson(t){return Object(b.a)(this,void 0,void 0,(function*(){t||this.onClose(),this.person=t,this.isReady=!0}))}onClose(){this.router.navigate(["/authorities/main"])}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(r.c),o.Qb(r.a),o.Qb(g.a))},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-limits"]],decls:7,vars:3,consts:[["closePosition","outside","colsClassList","offset-lg-1 col-lg-8","bodyClassList","py-5",3,"closed"],[1,"limits__header",2,"position","relative"],[4,"ngIf"],[3,"person",4,"ngIf"],[1,"text-muted","limits__position"],[1,"limits__name"],[3,"theme"],[3,"person"]],template:function(t,e){1&t&&(o.Wb(0,"f-page",0),o.ic("closed",(function(t){return e.onClose()})),o.Wb(1,"f-page-header"),o.Wb(2,"div",1),o.Pc(3,J,8,8,"ng-container",2),o.Pc(4,Z,3,4,"ng-container",2),o.Vb(),o.Vb(),o.Wb(5,"f-page-body"),o.Pc(6,z,1,1,"j-authorities-payments",3),o.Vb(),o.Vb()),2&t&&(o.Ab(3),o.sc("ngIf",e.person&&e.isReady),o.Ab(1),o.sc("ngIf",!e.person||!e.isReady),o.Ab(2),o.sc("ngIf",e.person&&e.isReady))},directives:[f.a,y.a,n.u,T.a,A.a,G],pipes:[L.d],styles:[".limits__position[_ngcontent-%COMP%]{margin-bottom:6px}.limits__name[_ngcontent-%COMP%]{line-height:60px;margin-bottom:0}.limits__header[_ngcontent-%COMP%]{margin-bottom:60px}"]}),t})();function et(t,e){if(1&t&&(o.Wb(0,"a",3),o.Rc(1),o.mc(2,"translate"),o.Vb()),2&t){const t=e.$implicit,i=o.lc();o.sc("routerLink",t),o.Ab(1),o.Tc(" ",o.nc(2,2,i.mapTranslate(t))," ")}}let it=(()=>{class t{constructor(t){this.authoritiesService=t,this.links=["users","otp"],this.subscription=new u.a,this.initSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapTranslate(t){return`AUTHORITIES.MAIN.NAV.${t.toUpperCase()}`}initSubscription(){this.subscription.add(this.authoritiesService.getOtpDevices().subscribe(t=>{var e;(null===(e=t)||void 0===e?void 0:e.length)>0?this.links.includes("otp")||this.links.push("otp"):this.links.includes("otp")&&this.links.splice(this.links.indexOf("otp"),1)}))}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(c.a))},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-nav"]],decls:3,vars:1,consts:[[1,"f-page-tabs-wrap"],[1,"f-page-tabs"],["routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],["routerLinkActive","active",3,"routerLink"]],template:function(t,e){1&t&&(o.Wb(0,"div",0),o.Wb(1,"nav",1),o.Pc(2,et,3,4,"a",2),o.Vb(),o.Vb()),2&t&&(o.Ab(2),o.sc("ngForOf",e.links))},directives:[n.t,r.f,r.e],pipes:[L.d],styles:[""]}),t})(),nt=(()=>{class t{constructor(t){this.router=t}onClose(){this.router.navigate(["/settings"])}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(r.c))},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-main"]],decls:8,vars:3,consts:[["closePosition","outside","colsClassList","offset-lg-1 col-lg-11 offset-xl-2 col-xl-10","bodyClassList","py-5",3,"closed"],[1,"f-page-title"]],template:function(t,e){1&t&&(o.Wb(0,"f-page",0),o.ic("closed",(function(t){return e.onClose()})),o.Wb(1,"f-page-header"),o.Wb(2,"h1",1),o.Rc(3),o.mc(4,"translate"),o.Vb(),o.Rb(5,"j-authorities-nav"),o.Vb(),o.Wb(6,"f-page-body"),o.Rb(7,"router-outlet"),o.Vb(),o.Vb()),2&t&&(o.Ab(3),o.Sc(o.nc(4,1,"AUTHORITIES.MAIN.TITLE")))},directives:[f.a,y.a,it,T.a,r.h],pipes:[L.d],styles:[""]}),t})(),st=(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-order"]],decls:2,vars:0,template:function(t,e){1&t&&(o.Wb(0,"p"),o.Rc(1," authorities-order works!\n"),o.Vb())},styles:[""]}),t})();function rt(t,e){if(1&t&&(o.Wb(0,"th",3),o.Rc(1),o.mc(2,"translate"),o.Vb()),2&t){const t=e.$implicit,i=o.lc();o.Ab(1),o.Sc(o.nc(2,1,i.mapTableHeading(t)))}}function at(t,e){if(1&t&&(o.Wb(0,"tr"),o.Wb(1,"td"),o.Wb(2,"div",4),o.Rc(3),o.Vb(),o.Vb(),o.Wb(4,"td"),o.Wb(5,"div",5),o.Rc(6),o.Vb(),o.Vb(),o.Vb()),2&t){const t=e.$implicit;o.Ab(3),o.Tc(" ",t.serial," "),o.Ab(3),o.Vc(" ",null==t.user?null:t.user.lastname," ",null!=t.user&&t.user.firstname?(null==t.user?null:t.user.firstname[0])+".":""," ",null!=t.user&&t.user.middlename?(null==t.user?null:t.user.middlename[0])+".":""," ")}}let ot=(()=>{class t{constructor(t){this.authoritiesService=t,this.otpDevices=[],this.headings=["SERIAL","USER"],this.subscription=new u.a,this.initSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapTableHeading(t){return t?this.mapTranslate(`TABLE.${t}`):""}mapTranslate(t){return`AUTHORITIES.OTP.${t}`}initSubscription(){this.subscription.add(this.authoritiesService.getOtpDevices().subscribe(t=>{this.otpDevices=t}))}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(c.a))},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-otp"]],decls:6,vars:2,consts:[[1,"j-authorities-table"],["class","p4 text-muted",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p4","text-muted"],[1,"p4","text-dark"],[1,"p2","text-dark"]],template:function(t,e){1&t&&(o.Wb(0,"table",0),o.Wb(1,"thead"),o.Wb(2,"tr"),o.Pc(3,rt,3,3,"th",1),o.Vb(),o.Vb(),o.Wb(4,"tbody"),o.Pc(5,at,7,4,"tr",2),o.Vb(),o.Vb()),2&t&&(o.Ab(3),o.sc("ngForOf",e.headings),o.Ab(2),o.sc("ngForOf",e.otpDevices))},directives:[n.t],pipes:[L.d],styles:[".j-authorities-table[_ngcontent-%COMP%]{background:#fff;width:100%;border-radius:12px}.j-authorities-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e9ebec}.j-authorities-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.j-authorities-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 16px;font-weight:400}.j-authorities-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 16px}"]}),t})();var ct=i("Kd2e");function lt(t,e){if(1&t&&(o.Wb(0,"th",6),o.Rc(1),o.mc(2,"translate"),o.Vb()),2&t){const t=e.$implicit,i=o.lc();o.Ab(1),o.Sc(o.nc(2,1,i.mapTableHeading(t)))}}function bt(t,e){if(1&t&&(o.Wb(0,"th",6),o.Rc(1),o.mc(2,"translate"),o.Vb()),2&t){const t=e.$implicit,i=o.lc(2);o.Ab(1),o.Sc(o.nc(2,1,i.mapTableHeading(t)))}}function ut(t,e){if(1&t&&(o.Ub(0),o.Pc(1,bt,3,3,"th",3),o.Tb()),2&t){const t=o.lc();o.Ab(1),o.sc("ngForOf",t.primaryHeadings)}}function dt(t,e){1&t&&(o.Ub(0),o.Rc(1),o.mc(2,"translate"),o.Tb()),2&t&&(o.Ab(1),o.Tc(" ",o.nc(2,1,"SHARED.DATE_FROM")," "))}function pt(t,e){1&t&&(o.Ub(0),o.Rc(1," \u2014 "),o.Rb(2,"br"),o.Tb())}function mt(t,e){if(1&t&&(o.Wb(0,"span",11),o.Rc(1),o.mc(2,"translate"),o.Vb()),2&t){const t=o.lc(3);o.Ab(1),o.Sc(o.nc(2,1,t.mapTranslate("LIMITS_LINK")))}}function ht(t,e){if(1&t&&(o.Wb(0,"a",12),o.Rc(1),o.mc(2,"translate"),o.Vb()),2&t){const t=o.lc(2).$implicit,e=o.lc();o.sc("routerLink","/authorities/limits/"+t.id),o.Ab(1),o.Sc(o.nc(2,2,e.mapTranslate("LIMITS_LINK")))}}function gt(t,e){if(1&t&&(o.Ub(0),o.Wb(1,"td"),o.Pc(2,mt,3,3,"span",9),o.Pc(3,ht,3,4,"a",10),o.Vb(),o.Tb()),2&t){const t=o.lc().$implicit,e=o.lc();o.Ab(2),o.sc("ngIf",e.currentUserId===t.userId),o.Ab(1),o.sc("ngIf",e.currentUserId!==t.userId)}}function ft(t,e){if(1&t&&(o.Wb(0,"tr"),o.Wb(1,"td"),o.Wb(2,"div",7),o.Rc(3),o.Vb(),o.Wb(4,"div",6),o.Rc(5),o.Vb(),o.Vb(),o.Wb(6,"td"),o.Wb(7,"div",8),o.Rc(8),o.mc(9,"translate"),o.Vb(),o.Vb(),o.Wb(10,"td"),o.Wb(11,"div",8),o.Pc(12,dt,3,3,"ng-container",4),o.Rc(13),o.mc(14,"date"),o.Pc(15,pt,3,0,"ng-container",4),o.Rc(16),o.mc(17,"date"),o.Vb(),o.Vb(),o.Pc(18,gt,4,2,"ng-container",4),o.Vb()),2&t){const t=e.$implicit,i=o.lc();o.Ab(3),o.Vc(" ",t.lastname," ",t.firstname?t.firstname[0]+".":""," ",t.middlename?t.middlename[0]+".":""," "),o.Ab(2),o.Tc(" ",t.position," "),o.Ab(3),o.Tc(" ",o.nc(9,10,i.mapAuthority(t.authority))," "),o.Ab(4),o.sc("ngIf",!t.toDate),o.Ab(1),o.Tc(" ",o.oc(14,12,t.fromDate,"dd MMM yyyy")," "),o.Ab(2),o.sc("ngIf",t.toDate),o.Ab(1),o.Tc(" ",o.oc(17,15,t.toDate,"dd MMM yyyy")," "),o.Ab(2),o.sc("ngIf",i.isPrimaryAuthority&&!i.isFeatureDisabled)}}let yt=(()=>{class t{constructor(t,e,i){this.companyService=t,this.authoritiesService=e,this.featureFlagsService=i,this.persons=[],this.isPrimaryAuthority=!1,this.headings=["USER","TYPE","DURATION"],this.primaryHeadings=[""],this.isFeatureDisabled=!1,this.subscription=new u.a,this.restrictions=[],this.initCompanySubscription(),this.initFeatureFlagsSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapAuthority(t){return this.mapTranslate(`AUTHORITY.${t}`)}mapRestrictions(t){return this.mapTranslate(`RESTRICTIONS.${t}`)}mapTableHeading(t){return t?this.mapTranslate(`TABLE.${t}`):""}mapTranslate(t){return`AUTHORITIES.USERS.${t}`}initCompanySubscription(){this.subscription.add(this.companyService.refresh$.pipe(Object(m.a)(([,,t])=>t)).subscribe(([t,e])=>{var i;this.currentUserId=null===(i=t)||void 0===i?void 0:i.id,this.isPrimaryAuthority=this.companyService.isPrimaryAuthority(e.authority),this.isPrimaryAuthority&&this.retrieveRestrictions()}))}initFeatureFlagsSubscription(){this.subscription.add(this.featureFlagsService.featureFlags$.subscribe(()=>{this.isFeatureDisabled=this.featureFlagsService.isDisabled(ct.a.PAYMENT_PERMISSIONS)}))}retrieveRestrictions(){return Object(b.a)(this,void 0,void 0,(function*(){this.restrictions=yield this.authoritiesService.fetchRestrictions()}))}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(g.a),o.Qb(c.a),o.Qb(ct.b))},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-registered"]],inputs:{persons:"persons"},decls:14,vars:9,consts:[[1,"mb-1"],[1,"p3","text-muted"],[1,"j-authorities-table"],["class","p4 text-muted",4,"ngFor","ngForOf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"p4","text-muted"],[1,"p2","text-dark"],[1,"p4","text-dark"],["class","p3 text-disabled",4,"ngIf"],["class","p3 link-blue",3,"routerLink",4,"ngIf"],[1,"p3","text-disabled"],[1,"p3","link-blue",3,"routerLink"]],template:function(t,e){1&t&&(o.Wb(0,"article"),o.Wb(1,"h6",0),o.Rc(2),o.mc(3,"translate"),o.Vb(),o.Wb(4,"p",1),o.Rc(5),o.mc(6,"translate"),o.Vb(),o.Vb(),o.Wb(7,"table",2),o.Wb(8,"thead"),o.Wb(9,"tr"),o.Pc(10,lt,3,3,"th",3),o.Pc(11,ut,2,1,"ng-container",4),o.Vb(),o.Vb(),o.Wb(12,"tbody"),o.Pc(13,ft,19,18,"tr",5),o.Vb(),o.Vb()),2&t&&(o.Ab(2),o.Sc(o.nc(3,5,"AUTHORITIES.USERS.REGISTERED.TITLE")),o.Ab(3),o.Sc(o.nc(6,7,"AUTHORITIES.USERS.REGISTERED.DESCRIPTION")),o.Ab(5),o.sc("ngForOf",e.headings),o.Ab(1),o.sc("ngIf",e.isPrimaryAuthority),o.Ab(2),o.sc("ngForOf",e.persons))},directives:[n.t,n.u,r.f],pipes:[L.d,n.f],styles:[".j-authorities-table[_ngcontent-%COMP%]{background:#fff;width:100%;border-radius:12px}.j-authorities-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e9ebec}.j-authorities-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.j-authorities-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 16px;font-weight:400}.j-authorities-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 16px}.restriction[_ngcontent-%COMP%]{background:#f2f2f7;border-radius:12px;padding:0 8px;display:inline-block}.restriction--danger[_ngcontent-%COMP%]{background:#ffefef}"]}),t})();var Tt=i("tmjD");function At(t,e){if(1&t&&(o.Wb(0,"th",5),o.Rc(1),o.mc(2,"translate"),o.Vb()),2&t){const t=e.$implicit,i=o.lc();o.Ab(1),o.Sc(o.nc(2,1,i.mapTableHeading(t)))}}function vt(t,e){if(1&t&&(o.Wb(0,"tr"),o.Wb(1,"td"),o.Wb(2,"div",6),o.Rc(3),o.Vb(),o.Wb(4,"div",5),o.Rc(5),o.Vb(),o.Vb(),o.Wb(6,"td"),o.Wb(7,"div",5),o.Rc(8),o.mc(9,"mask"),o.Vb(),o.Vb(),o.Wb(10,"td"),o.Wb(11,"div",5),o.Rc(12),o.Vb(),o.Vb(),o.Vb()),2&t){const t=e.$implicit;o.Ab(3),o.Vc(" ",t.lastname," ",t.firstname?t.firstname[0]+".":""," ",t.middlename?t.middlename[0]+".":""," "),o.Ab(2),o.Tc(" ",t.position," "),o.Ab(3),o.Tc(" ",t.phone?o.oc(9,6,t.phone,"+0 (000) 000 00 00"):"\u2014"," "),o.Ab(4),o.Tc(" ",t.iin||"\u2014"," ")}}let It=(()=>{class t{constructor(){this.persons=[],this.headings=["USER","IIN","PHONE"]}mapTableHeading(t){return t?this.mapTranslate(`TABLE.${t}`):""}mapTranslate(t){return`AUTHORITIES.USERS.${t}`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-unregistered"]],inputs:{persons:"persons"},decls:13,vars:8,consts:[[1,"mb-1"],[1,"p3","text-muted"],[1,"j-authorities-table","j-authorities-table--unregistered"],["class","p4 text-muted",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p4","text-muted"],[1,"p2","text-dark"]],template:function(t,e){1&t&&(o.Wb(0,"article"),o.Wb(1,"h6",0),o.Rc(2),o.mc(3,"translate"),o.Vb(),o.Wb(4,"p",1),o.Rc(5),o.mc(6,"translate"),o.Vb(),o.Vb(),o.Wb(7,"table",2),o.Wb(8,"thead"),o.Wb(9,"tr"),o.Pc(10,At,3,3,"th",3),o.Vb(),o.Vb(),o.Wb(11,"tbody"),o.Pc(12,vt,13,9,"tr",4),o.Vb(),o.Vb()),2&t&&(o.Ab(2),o.Sc(o.nc(3,4,"AUTHORITIES.USERS.UNREGISTERED.TITLE")),o.Ab(3),o.Sc(o.nc(6,6,"AUTHORITIES.USERS.UNREGISTERED.DESCRIPTION")),o.Ab(5),o.sc("ngForOf",e.headings),o.Ab(2),o.sc("ngForOf",e.persons))},directives:[n.t],pipes:[L.d,Tt.b],styles:[".j-authorities-table[_ngcontent-%COMP%]{background:#fff;width:100%;border-radius:12px}.j-authorities-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e9ebec}.j-authorities-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.j-authorities-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 16px;font-weight:400}.j-authorities-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 16px}[_nghost-%COMP%]{display:block;margin-top:2.5rem}.j-authorities-table--unregistered[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{opacity:.6}"]}),t})();function St(t,e){if(1&t&&o.Rb(0,"j-authorities-registered",1),2&t){const t=o.lc();o.sc("persons",t.registered)}}function Ot(t,e){if(1&t&&o.Rb(0,"j-authorities-unregistered",1),2&t){const t=o.lc();o.sc("persons",t.unregistered)}}let Rt=(()=>{class t{constructor(t){this.companyService=t,this.registered=[],this.unregistered=[],this.subscription=new u.a,this.initAuthoritiesSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}initAuthoritiesSubscription(){this.subscription.add(this.companyService.getAuthorizedPersons().pipe(Object(h.a)((t,e)=>(console.log(t),Object(p.a)([])))).subscribe(t=>{var e;(null===(e=t)||void 0===e?void 0:e.length)>0&&(this.registered=t.filter(t=>!!t.userId),this.unregistered=t.filter(t=>!t.userId))}))}}return t.\u0275fac=function(e){return new(e||t)(o.Qb(g.a))},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities-users"]],decls:2,vars:2,consts:[[3,"persons",4,"ngIf"],[3,"persons"]],template:function(t,e){1&t&&(o.Pc(0,St,1,1,"j-authorities-registered",0),o.Pc(1,Ot,1,1,"j-authorities-unregistered",0)),2&t&&(o.sc("ngIf",(null==e.registered?null:e.registered.length)>0),o.Ab(1),o.sc("ngIf",(null==e.unregistered?null:e.unregistered.length)>0))},directives:[n.u,yt,It],styles:[""]}),t})();const _t=[{path:"",component:(()=>{class t{constructor(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Kb({type:t,selectors:[["j-authorities"]],decls:1,vars:0,template:function(t,e){1&t&&o.Rb(0,"router-outlet")},directives:[r.h],styles:[""]}),t})(),data:{title:"SETTINGS.TITLE"},children:[{path:"main",component:nt,children:[{path:"users",component:Rt},{path:"order",component:st},{path:"otp",canActivate:[l],component:ot},{path:"**",redirectTo:"users"}]},{path:"limits/:id",component:tt},{path:"**",redirectTo:"main"}]}];let Pt=(()=>{class t{}return t.\u0275mod=o.Ob({type:t}),t.\u0275inj=o.Nb({factory:function(e){return new(e||t)},imports:[[r.g.forChild(_t)],r.g]}),t})();i.d(e,"AuthoritiesModule",(function(){return Et}));let Et=(()=>{class t{}return t.\u0275mod=o.Ob({type:t}),t.\u0275inj=o.Nb({factory:function(e){return new(e||t)},imports:[[n.c,I.n,I.D,s.a,Pt]]}),t})()}}]);
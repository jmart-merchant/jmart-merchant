"use strict";(self.webpackChunkjysan=self.webpackChunkjysan||[]).push([[241],{93241:(J,I,r)=>{r.r(I),r.d(I,{ContractsModule:()=>Bn});var s=r(13500),v=r(48149),d=r(91995),a=r(59516),E=r(70655),f=r(90593),S=r(72986),b=r(40537),N=r(8929),P=r(42654),t=r(5e3),Z=r(7625);const w=t.GuJ,x=Symbol("__destroy"),c=Symbol("__decoratorApplied");function l(e){return"string"==typeof e?Symbol(`__destroy__${e}`):x}function _(e,i){e[i]||(e[i]=new N.xQ)}function C(e,i){e[i]&&(e[i].next(),e[i].complete(),e[i]=null)}function F(e){e instanceof P.w&&e.unsubscribe()}function R(e,i){return function(){var n;if(e&&e.call(this),C(this,l()),i.arrayName&&function O(e){Array.isArray(e)&&e.forEach(F)}(this[i.arrayName]),i.checkProperties)for(const o in this)(null===(n=i.blackList)||void 0===n?void 0:n.includes(o))||F(this[o])}}function H(e,i){return n=>{const o=l(i);return"string"==typeof i?function U(e,i,n){const o=e[i];_(e,n),e[i]=function(){o.apply(this,arguments),C(this,n),e[i]=o}}(e,i,o):_(e,o),n.pipe((0,Z.R)(e[o]))}}var Q=r(26164),G=r(1241),T=r(69808),$=r(66013),j=r(89854),Ct=r(79311),xt=r(94114),Tt=r(61459),V=r(23918),B=r(69544);const rt=function(){return{height:"24px","margin-bottom":"3px",width:"50%","background-color":"#ECEEF1"}},st=function(){return{height:"32px","background-color":"#ECEEF1"}};let bt=(()=>{class e{constructor(){}ngOnInit(){}mapTranslate(n){return`CONTRACTS.DETAILS.${n}`}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-info-loading"]],decls:25,vars:20,consts:[[1,"contracts-info"],[1,"contracts-info__left"],[1,"contracts-info__amounts"],[1,"contracts-info__block"],[3,"theme"],[1,"p2","m-0","text-gray"],[1,"contracts-info__heading","mb-3"],[1,"contracts-info__list","j-desc-list"],["count","7",3,"theme"],[1,"contracts-info__attachments"],["count","3",3,"theme"]],template:function(n,o){1&n&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"article",3),t._UZ(4,"ngx-skeleton-loader",4),t.TgZ(5,"p",5),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"article",3),t._UZ(9,"ngx-skeleton-loader",4),t.TgZ(10,"p",5),t._uU(11),t.ALo(12,"translate"),t.qZA()()(),t.TgZ(13,"div",3)(14,"h6",6),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"ul",7),t._UZ(18,"ngx-skeleton-loader",8),t.qZA()()(),t.TgZ(19,"div",3)(20,"h6",6),t._uU(21),t.ALo(22,"translate"),t.qZA(),t.TgZ(23,"ul",9),t._UZ(24,"ngx-skeleton-loader",10),t.qZA()()()),2&n&&(t.xp6(4),t.Q6J("theme",t.DdM(16,rt)),t.xp6(2),t.Oqu(t.lcZ(7,8,o.mapTranslate("AMOUNT"))),t.xp6(3),t.Q6J("theme",t.DdM(17,rt)),t.xp6(2),t.Oqu(t.lcZ(12,10,o.mapTranslate("REMAINDER"))),t.xp6(4),t.hij(" ",t.lcZ(16,12,o.mapTranslate("TITLE"))," "),t.xp6(3),t.Q6J("theme",t.DdM(18,st)),t.xp6(3),t.hij(" ",t.lcZ(22,14,o.mapTranslate("FILES"))," "),t.xp6(3),t.Q6J("theme",t.DdM(19,st)))},directives:[V.xr],pipes:[j.X$],styles:[".contracts__row[_ngcontent-%COMP%]{display:block}@media (min-width: 960px){.contracts__row[_ngcontent-%COMP%]{display:grid;grid-column-gap:1rem;column-gap:1rem}}.contracts__header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(183,190,197,.5);padding:20px 1rem;display:none}@media (min-width: 960px){.contracts__header[_ngcontent-%COMP%]{display:grid}}.contracts__item[_ngcontent-%COMP%]{padding:1rem 1rem .5rem;align-content:center;min-height:52px}@media (min-width: 960px){.contracts__item[_ngcontent-%COMP%]{padding:.5rem 1rem}}.contracts__item--hoverable[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease-in-out}.contracts__item--hoverable[_ngcontent-%COMP%]:hover{background:#f5f9fd}.contracts__top[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.contracts__table[_ngcontent-%COMP%]{background:#fff;overflow:hidden;box-shadow:0 0 1px #0000000a,0 0 2px #0000000f,0 4px 8px #0000000a;border-radius:0 0 .5rem .5rem}.contracts__cell[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;margin-bottom:.75rem}@media (min-width: 960px){.contracts__cell[_ngcontent-%COMP%]{margin-bottom:0}}.contracts__icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;display:block;margin-right:.5rem}.contracts__number[_ngcontent-%COMP%]{display:flex;align-items:baseline}.contracts__label[_ngcontent-%COMP%]{margin-bottom:.25rem}@media (min-width: 960px){.contracts__label[_ngcontent-%COMP%]{display:none}}.contracts-info[_ngcontent-%COMP%]{display:grid;grid-row-gap:20px;row-gap:20px}@media (min-width: 1280px){.contracts-info[_ngcontent-%COMP%]{row-gap:0;column-gap:20px;grid-template-columns:repeat(2,calc(50% - 10px))}}.contracts-info__amounts[_ngcontent-%COMP%]{display:grid;margin-bottom:16px;grid-row-gap:16px;row-gap:16px}@media (min-width: 960px){.contracts-info__amounts[_ngcontent-%COMP%]{row-gap:0;column-gap:16px;grid-template-columns:repeat(2,calc(50% - 8px))}}.contracts-info__block[_ngcontent-%COMP%]{background:#fff;padding:22px 18px;border-radius:12px}.contracts-info__heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.contracts-info__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:24px}.contracts-info__buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-top:12px}.contracts-info__attachments[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none}.contracts-info__attachment[_ngcontent-%COMP%] + .contracts-info__attachment[_ngcontent-%COMP%]{margin-top:1rem}.contracts-info__filename[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin-bottom:8px;word-break:break-all}@media (min-width: 960px){.contracts-info__filename[_ngcontent-%COMP%]{margin-bottom:0}}@media (min-width: 960px){.contracts-info__attachment[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between}}.contracts-info__icon[_ngcontent-%COMP%]{margin-right:8px}@media (min-width: 960px){.contracts-info__icon[_ngcontent-%COMP%]{margin-right:16px}}.contracts-info__date[_ngcontent-%COMP%]{flex-shrink:0;margin-left:20px}"]}),e})();var Ot=r(7102),z=r(15057),ct=r(38114),lt=r(9661),pt=r(72159),dt=r(85814);function yt(e,i){if(1&e&&(t.TgZ(0,"li",15)(1,"div",16),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div",17),t._uU(5),t.qZA()()),2&e){const n=i.$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,4,n.label)," "),t.xp6(2),t.Tol(n.extraClass?n.extraClass:"text-dark"),t.xp6(1),t.hij(" ",n.value," ")}}function Mt(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){return t.CHM(n),t.oxw().onCreatePayment()}),t.TgZ(1,"strong"),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,1,n.mapTranslate("CREATE_PAYMENT")))}}function Et(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"li",21)(1,"a",22),t.NdJ("click",function(m){const M=t.CHM(n).$implicit;return t.oxw(2).onAttachmentDownload(m,M)}),t._UZ(2,"span",23),t.TgZ(3,"span"),t._uU(4),t.qZA()(),t.TgZ(5,"div",24),t._uU(6),t.ALo(7,"date"),t.qZA()()}if(2&e){const n=i.$implicit;t.xp6(4),t.Oqu(n.file.name),t.xp6(2),t.Oqu(t.xi3(7,2,n.created,"dd LLL yyyy"))}}function Pt(e,i){if(1&e&&(t.TgZ(0,"div",3)(1,"h6",7),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"ul",19),t.YNc(5,Et,8,5,"li",20),t.qZA()()),2&e){const n=t.oxw();t.xp6(2),t.hij(" ",t.lcZ(3,2,n.mapTranslate("FILES"))," "),t.xp6(3),t.Q6J("ngForOf",n.contract.attachments)}}const q="dd MMMM yyyy";let St=(()=>{class e{constructor(n,o,m,h,M,L){this.notifierService=n,this.translateService=o,this.contractsService=m,this.featureFlagsService=h,this.filesService=M,this.router=L,this.isPaymentCreatable=!0,this.isContractErrored=!1,this.isDownloading=!1,this.subscription=new P.w,this.subscription.add(this.featureFlagsService.featureFlags$.subscribe(Y=>{this.checkFeatureFlags()}))}ngOnInit(){this.mapData()}ngOnDestroy(){this.subscription.unsubscribe()}onAttachmentDownload(n,o){n.preventDefault(),this.filesService.downloadFileById(o.file.id,o.file.name)}onCreatePayment(){this.router.navigate([`/${ct.KK.root}/${ct.KK.foreignCurrency}`],{state:{resolvedPayment:{type:Ot.V_.FOREIGN,isNewPayment:!0,details:{paymentRecipient:null,foreignPaymentDetails:{withinContract:!0,fxContract:this.contract,fxContractId:this.contract.id}}}}})}onDownload(){return(0,E.mG)(this,void 0,void 0,function*(){if(!this.isDownloading){this.isDownloading=!0;try{yield this.contractsService.downloadContractCertificate(this.contract)}catch(n){this.notifierService.notify("error",this.translateService.instant("ERRORS.DOWNLOAD_ERROR"))}finally{this.isDownloading=!1}}})}mapTranslate(n){return`CONTRACTS.DETAILS.${n}`}mapData(){var n,o,m,h,M,L;this.data=[];const Y=this.contractsService.mapRemainderMessage(this.contract);Y&&(this.isContractErrored=!0,this.data=[...this.data,{label:this.mapTranslate("INFO"),value:this.translateService.instant(this.mapTranslate(Y)),extraClass:"text-danger"}]),this.data=[...this.data,{label:this.mapTranslate("TYPE"),value:this.contract.type.description},{label:this.mapTranslate("DATE_FROM"),value:this.contract.dateFrom?(0,T.p6)(this.contract.dateFrom,q,this.translateService.currentLang):"-"},{label:this.mapTranslate("DATE_TO"),value:this.contract.dateTo?(0,T.p6)(this.contract.dateTo,q,this.translateService.currentLang):"-"}],this.contract.registrationNumberContract&&(this.data=[...this.data,{label:this.mapTranslate("UNK"),value:this.contract.registrationNumberContract}]),this.contract.documentDate&&(this.data=[...this.data,{label:this.mapTranslate("UNK_DATE"),value:(0,T.p6)(this.contract.documentDate,q,this.translateService.currentLang)}]),this.data=[...this.data,{label:this.mapTranslate("CURRENCY"),value:this.contract.amount.currency},{label:this.mapTranslate("COUNTRY"),value:`${(null===(o=null===(n=this.contract.contractor)||void 0===n?void 0:n.country)||void 0===o?void 0:o.code)||""} - ${(null===(h=null===(m=this.contract.contractor)||void 0===m?void 0:m.country)||void 0===h?void 0:h.name)||""}`},{label:this.mapTranslate("CITY"),value:(null===(M=this.contract.contractor)||void 0===M?void 0:M.cityName)||"-"},{label:this.mapTranslate("BIC"),value:(null===(L=this.contract.contractor.bank)||void 0===L?void 0:L.code)||"-"}]}checkFeatureFlags(){return(0,E.mG)(this,void 0,void 0,function*(){this.isPaymentCreatable=!this.featureFlagsService.isDisabled(z.Y.FOREIGN_PAYMENT)})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36($.lG),t.Y36(j.sK),t.Y36(G.W),t.Y36(z.a),t.Y36(lt.nS),t.Y36(a.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-info"]],inputs:{contract:"contract"},decls:29,vars:20,consts:[[1,"contracts-info"],[1,"contracts-info__left"],[1,"contracts-info__amounts"],[1,"contracts-info__block"],[1,"contracts-info__heading","mb-1"],[3,"money"],[1,"p2","m-0","text-gray"],[1,"contracts-info__heading","mb-3"],[1,"contracts-info__list","j-desc-list"],["class","j-desc-row",4,"ngFor","ngForOf"],[1,"contracts-info__buttons"],[1,"btn","btn-outline-primary",3,"disabled","jLoading","jLoadingInverted","click"],["inlineSVG","/assets/icons/contracts/pdf.svg",1,"mr-2"],["class","btn btn-primary",3,"click",4,"ngIf"],["class","contracts-info__block",4,"ngIf"],[1,"j-desc-row"],[1,"j-desc-child","text-muted"],[1,"j-desc-child"],[1,"btn","btn-primary",3,"click"],[1,"contracts-info__attachments"],["class","contracts-info__attachment",4,"ngFor","ngForOf"],[1,"contracts-info__attachment"],["href","#",1,"link-blue","contracts-info__filename",3,"click"],["inlineSVG","/assets/icons/contracts/file.svg",1,"contracts-info__icon"],[1,"contracts-info__date","text-muted"]],template:function(n,o){1&n&&(t.TgZ(0,"section",0)(1,"div",1)(2,"div",2)(3,"article",3)(4,"h6",4),t._UZ(5,"j-money",5),t.qZA(),t.TgZ(6,"p",6),t._uU(7),t.ALo(8,"translate"),t.qZA()(),t.TgZ(9,"article",3)(10,"h6",4),t._UZ(11,"j-money",5),t.qZA(),t.TgZ(12,"p",6),t._uU(13),t.ALo(14,"translate"),t.qZA()()(),t.TgZ(15,"div",3)(16,"h6",7),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"ul",8),t.YNc(20,yt,6,6,"li",9),t.qZA(),t.TgZ(21,"div",10)(22,"button",11),t.NdJ("click",function(){return o.onDownload()}),t._UZ(23,"span",12),t.TgZ(24,"strong"),t._uU(25),t.ALo(26,"translate"),t.qZA()(),t.YNc(27,Mt,4,3,"button",13),t.qZA()()(),t.YNc(28,Pt,6,4,"div",14),t.qZA()),2&n&&(t.xp6(5),t.Q6J("money",o.contract.amount),t.xp6(2),t.Oqu(t.lcZ(8,12,o.mapTranslate("AMOUNT"))),t.xp6(4),t.Q6J("money",o.contract.remainder),t.xp6(2),t.Oqu(t.lcZ(14,14,o.mapTranslate("REMAINDER"))),t.xp6(4),t.hij(" ",t.lcZ(18,16,o.mapTranslate("TITLE"))," "),t.xp6(3),t.Q6J("ngForOf",o.data),t.xp6(2),t.Q6J("disabled",o.isDownloading)("jLoading",o.isDownloading)("jLoadingInverted",!0),t.xp6(3),t.Oqu(t.lcZ(26,18,o.mapTranslate("DOWNLOAD"))),t.xp6(2),t.Q6J("ngIf",o.isPaymentCreatable&&!o.isContractErrored),t.xp6(1),t.Q6J("ngIf",(null==o.contract.attachments?null:o.contract.attachments.length)>0))},directives:[pt.y,T.sg,dt.T,B.d$,T.O5],pipes:[j.X$,T.uU],styles:[".contracts__row[_ngcontent-%COMP%]{display:block}@media (min-width: 960px){.contracts__row[_ngcontent-%COMP%]{display:grid;grid-column-gap:1rem;column-gap:1rem}}.contracts__header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(183,190,197,.5);padding:20px 1rem;display:none}@media (min-width: 960px){.contracts__header[_ngcontent-%COMP%]{display:grid}}.contracts__item[_ngcontent-%COMP%]{padding:1rem 1rem .5rem;align-content:center;min-height:52px}@media (min-width: 960px){.contracts__item[_ngcontent-%COMP%]{padding:.5rem 1rem}}.contracts__item--hoverable[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease-in-out}.contracts__item--hoverable[_ngcontent-%COMP%]:hover{background:#f5f9fd}.contracts__top[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.contracts__table[_ngcontent-%COMP%]{background:#fff;overflow:hidden;box-shadow:0 0 1px #0000000a,0 0 2px #0000000f,0 4px 8px #0000000a;border-radius:0 0 .5rem .5rem}.contracts__cell[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;margin-bottom:.75rem}@media (min-width: 960px){.contracts__cell[_ngcontent-%COMP%]{margin-bottom:0}}.contracts__icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;display:block;margin-right:.5rem}.contracts__number[_ngcontent-%COMP%]{display:flex;align-items:baseline}.contracts__label[_ngcontent-%COMP%]{margin-bottom:.25rem}@media (min-width: 960px){.contracts__label[_ngcontent-%COMP%]{display:none}}.contracts-info[_ngcontent-%COMP%]{display:grid;grid-row-gap:20px;row-gap:20px}@media (min-width: 1280px){.contracts-info[_ngcontent-%COMP%]{row-gap:0;column-gap:20px;grid-template-columns:repeat(2,calc(50% - 10px))}}.contracts-info__amounts[_ngcontent-%COMP%]{display:grid;margin-bottom:16px;grid-row-gap:16px;row-gap:16px}@media (min-width: 960px){.contracts-info__amounts[_ngcontent-%COMP%]{row-gap:0;column-gap:16px;grid-template-columns:repeat(2,calc(50% - 8px))}}.contracts-info__block[_ngcontent-%COMP%]{background:#fff;padding:22px 18px;border-radius:12px}.contracts-info__heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.contracts-info__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:24px}.contracts-info__buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-top:12px}.contracts-info__attachments[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none}.contracts-info__attachment[_ngcontent-%COMP%] + .contracts-info__attachment[_ngcontent-%COMP%]{margin-top:1rem}.contracts-info__filename[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin-bottom:8px;word-break:break-all}@media (min-width: 960px){.contracts-info__filename[_ngcontent-%COMP%]{margin-bottom:0}}@media (min-width: 960px){.contracts-info__attachment[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between}}.contracts-info__icon[_ngcontent-%COMP%]{margin-right:8px}@media (min-width: 960px){.contracts-info__icon[_ngcontent-%COMP%]{margin-right:16px}}.contracts-info__date[_ngcontent-%COMP%]{flex-shrink:0;margin-left:20px}"]}),e})();var Dt=r(43169);const Nt=function(){return{height:"24px",width:"70%","background-color":"#ECEEF1"}},Zt=function(){return{height:"56px",width:"40%","margin-bottom":"8px","background-color":"#ECEEF1"}};function Lt(e,i){1&e&&(t.ynx(0),t._UZ(1,"ngx-skeleton-loader",9)(2,"ngx-skeleton-loader",9),t.BQk()),2&e&&(t.xp6(1),t.Q6J("theme",t.DdM(2,Nt)),t.xp6(1),t.Q6J("theme",t.DdM(3,Zt)))}function It(e,i){if(1&e&&t.YNc(0,Lt,3,4,"ng-container",8),2&e){const n=t.oxw();t.Q6J("ngIf",n.isLoading)}}function wt(e,i){if(1&e&&(t.TgZ(0,"div",10)(1,"div",11),t._UZ(2,"span",12),t.TgZ(3,"span",13),t._uU(4),t.qZA()(),t.TgZ(5,"h1",14),t._uU(6),t.qZA()()),2&e){const n=t.oxw();t.xp6(2),t.Tol(n.iconClassName),t.xp6(2),t.hij(" ",n.companyName," "),t.xp6(2),t.hij("\u2116 ",null==n.contract?null:n.contract.contractNumber,"")}}function Ft(e,i){if(1&e&&(t.TgZ(0,"div",10)(1,"div",11),t._UZ(2,"span",15),t.TgZ(3,"span",13),t._uU(4),t.qZA()(),t.TgZ(5,"h1",14),t._uU(6,"-"),t.qZA()()),2&e){const n=t.oxw();t.xp6(4),t.hij(" ",n.companyName," ")}}function Rt(e,i){1&e&&t._UZ(0,"j-contracts-info-loading")}function jt(e,i){if(1&e&&t._UZ(0,"j-contracts-info",16),2&e){const n=t.oxw();t.Q6J("contract",n.contract)}}function Ut(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"j-error-placeholder",17),t.NdJ("retried",function(){return t.CHM(n),t.oxw().onRetry()}),t.ALo(1,"translate"),t.qZA()}2&e&&t.Q6J("errorText",t.lcZ(1,1,"CONTRACTS.DETAILS.ERROR"))}let k=class{constructor(i,n,o,m,h,M){this.companyService=i,this.contractsService=n,this.location=o,this.notifier=m,this.route=h,this.translate=M,this.isLoading=!1,this.route.params.pipe((0,S.q)(1)).subscribe(L=>{this.contractId=L.id}),this.companyService.refresh$.pipe(H(this)).subscribe(()=>{this.companyName=this.companyService.currentCompany.name,this.loadContract()})}onClose(){this.location.back()}get iconClassName(){switch(this.contract.status){case f.J.REGISTERED:case f.J.PROCESSING:return"text-warning";case f.J.REGED:return"text-success";case f.J.REJECTED:case f.J.CLOSED:return"text-danger"}}onRetry(){this.loadContract()}loadContract(){this.isLoading=!0,this.contractsService.getContractByIdObservable(this.contractId).pipe(H(this),(0,b.x)(()=>{this.isLoading=!1})).subscribe(i=>{this.contract=i})}};k.\u0275fac=function(i){return new(i||k)(t.Y36(Q.J),t.Y36(G.W),t.Y36(T.Ye),t.Y36($.lG),t.Y36(a.gz),t.Y36(j.sK))},k.\u0275cmp=t.Xpm({type:k,selectors:[["j-contracts-details"]],decls:17,vars:2,consts:[["closePosition","outside","colsClassList","offset-xl-1 col-xl-10","headerClassList","bg-white",3,"closed"],[3,"ngTemplateOutlet"],["headerLoading",""],["headerContent",""],["headerError",""],["bodyLoading",""],["bodyContent",""],["bodyError",""],[4,"ngIf"],[3,"theme"],[1,"contract-details__header"],[1,"contracts__top"],["inlineSVG","/assets/icons/contracts/icon.svg",1,"contracts__icon"],[1,"text-muted"],[1,"mb-3"],["inlineSVG","/assets/icons/contracts/icon.svg",1,"text-muted"],[3,"contract"],[3,"errorText","retried"]],template:function(i,n){if(1&i&&(t.TgZ(0,"f-page",0),t.NdJ("closed",function(){return n.onClose()}),t.TgZ(1,"f-page-header"),t.GkF(2,1),t.qZA(),t.TgZ(3,"f-page-body"),t.GkF(4,1),t.qZA()(),t.YNc(5,It,1,1,"ng-template",null,2,t.W1O),t.YNc(7,wt,7,4,"ng-template",null,3,t.W1O),t.YNc(9,Ft,7,1,"ng-template",null,4,t.W1O),t.YNc(11,Rt,1,0,"ng-template",null,5,t.W1O),t.YNc(13,jt,1,1,"ng-template",null,6,t.W1O),t.YNc(15,Ut,2,3,"ng-template",null,7,t.W1O)),2&i){const o=t.MAs(6),m=t.MAs(8),h=t.MAs(10),M=t.MAs(12),L=t.MAs(14),Y=t.MAs(16);t.xp6(2),t.Q6J("ngTemplateOutlet",n.isLoading?o:n.contract?m:h),t.xp6(2),t.Q6J("ngTemplateOutlet",n.isLoading?M:n.contract?L:Y)}},directives:[Ct.J,xt.M,T.tP,Tt.G,T.O5,V.xr,B.d$,bt,St,Dt.g],pipes:[j.X$],styles:[".contracts__row[_ngcontent-%COMP%]{display:block}@media (min-width: 960px){.contracts__row[_ngcontent-%COMP%]{display:grid;grid-column-gap:1rem;column-gap:1rem}}.contracts__header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(183,190,197,.5);padding:20px 1rem;display:none}@media (min-width: 960px){.contracts__header[_ngcontent-%COMP%]{display:grid}}.contracts__item[_ngcontent-%COMP%]{padding:1rem 1rem .5rem;align-content:center;min-height:52px}@media (min-width: 960px){.contracts__item[_ngcontent-%COMP%]{padding:.5rem 1rem}}.contracts__item--hoverable[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease-in-out}.contracts__item--hoverable[_ngcontent-%COMP%]:hover{background:#f5f9fd}.contracts__top[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.contracts__table[_ngcontent-%COMP%]{background:#fff;overflow:hidden;box-shadow:0 0 1px #0000000a,0 0 2px #0000000f,0 4px 8px #0000000a;border-radius:0 0 .5rem .5rem}.contracts__cell[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;margin-bottom:.75rem}@media (min-width: 960px){.contracts__cell[_ngcontent-%COMP%]{margin-bottom:0}}.contracts__icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;display:block;margin-right:.5rem}.contracts__number[_ngcontent-%COMP%]{display:flex;align-items:baseline}.contracts__label[_ngcontent-%COMP%]{margin-bottom:.25rem}@media (min-width: 960px){.contracts__label[_ngcontent-%COMP%]{display:none}}.contracts-info[_ngcontent-%COMP%]{display:grid;grid-row-gap:20px;row-gap:20px}@media (min-width: 1280px){.contracts-info[_ngcontent-%COMP%]{row-gap:0;column-gap:20px;grid-template-columns:repeat(2,calc(50% - 10px))}}.contracts-info__amounts[_ngcontent-%COMP%]{display:grid;margin-bottom:16px;grid-row-gap:16px;row-gap:16px}@media (min-width: 960px){.contracts-info__amounts[_ngcontent-%COMP%]{row-gap:0;column-gap:16px;grid-template-columns:repeat(2,calc(50% - 8px))}}.contracts-info__block[_ngcontent-%COMP%]{background:#fff;padding:22px 18px;border-radius:12px}.contracts-info__heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.contracts-info__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:24px}.contracts-info__buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-top:12px}.contracts-info__attachments[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none}.contracts-info__attachment[_ngcontent-%COMP%] + .contracts-info__attachment[_ngcontent-%COMP%]{margin-top:1rem}.contracts-info__filename[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin-bottom:8px;word-break:break-all}@media (min-width: 960px){.contracts-info__filename[_ngcontent-%COMP%]{margin-bottom:0}}@media (min-width: 960px){.contracts-info__attachment[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between}}.contracts-info__icon[_ngcontent-%COMP%]{margin-right:8px}@media (min-width: 960px){.contracts-info__icon[_ngcontent-%COMP%]{margin-right:16px}}.contracts-info__date[_ngcontent-%COMP%]{flex-shrink:0;margin-left:20px}"]}),k=(0,E.gn)([function A(e={}){return i=>{!function u(e){return!!e[w]}(i)?function y(e,i){e.prototype.ngOnDestroy=R(e.prototype.ngOnDestroy,i)}(i,e):function g(e,i){const n=e.\u0275pipe;n.onDestroy=R(n.onDestroy,i)}(i,e),function p(e){e.prototype[c]=!0}(i)}}()],k);var D=r(71811),W=r(77501);let tt=(()=>{class e{constructor(){this.label="CONTRACTS.ERRORED",this.retried=new t.vpe}onRetry(n){n.preventDefault(),this.retried.emit()}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-error"]],inputs:{label:"label"},outputs:{retried:"retried"},decls:8,vars:7,consts:[[1,"empty"],["src","/assets/img/contracts/empty.svg",1,"empty-img",3,"alt"],["translate","",1,"text-muted","empty-text","my-3"],["href","#",1,"link",3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"section",0),t._UZ(1,"img",1),t.ALo(2,"translate"),t.TgZ(3,"div",2),t._uU(4),t.qZA(),t.TgZ(5,"a",3),t.NdJ("click",function(h){return o.onRetry(h)}),t._uU(6),t.ALo(7,"translate"),t.qZA()()),2&n&&(t.xp6(1),t.Q6J("alt",t.lcZ(2,3,o.label)),t.xp6(3),t.hij(" ",o.label," "),t.xp6(2),t.hij(" ",t.lcZ(7,5,"CONTRACTS.RETRY")," "))},directives:[j.Pi],pipes:[j.X$],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;min-height:478px}.empty[_ngcontent-%COMP%]{padding:1.5rem 0;display:flex;align-items:center;flex-direction:column;justify-content:center}.empty-text[_ngcontent-%COMP%]{line-height:24px}.empty-img[_ngcontent-%COMP%]{border-radius:50%;box-shadow:0 14px 16px #0000000d;margin:1rem 0}"]}),e})();var nt=r(35803);const Jt=function(){return{width:"25%",height:"33px","background-color":"#ECEEF1"}};function Gt(e,i){1&e&&t._UZ(0,"ngx-skeleton-loader",2),2&e&&t.Q6J("theme",t.DdM(1,Jt))}const kt=function(){return{height:"52px","background-color":"#ECEEF1"}};let et=(()=>{class e{constructor(){this.hasTitle=!1}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-loading"]],inputs:{hasTitle:"hasTitle"},decls:2,vars:3,consts:[[3,"theme",4,"ngIf"],["count","6",3,"theme"],[3,"theme"]],template:function(n,o){1&n&&(t.YNc(0,Gt,1,2,"ngx-skeleton-loader",0),t._UZ(1,"ngx-skeleton-loader",1)),2&n&&(t.Q6J("ngIf",o.hasTitle),t.xp6(1),t.Q6J("theme",t.DdM(2,kt)))},directives:[T.O5,V.xr],styles:[""]}),e})();const Yt=["itemTemplate"],Qt=["headerTemplate"],Bt=function(e){return{$implicit:e}};function $t(e,i){if(1&e&&t.GkF(0,8),2&e){const n=i.$implicit,o=t.oxw(3);t.Q6J("ngTemplateOutlet",o.itemTemplate)("ngTemplateOutletContext",t.VKq(2,Bt,n))}}function Wt(e,i){if(1&e&&(t.ynx(0),t.GkF(1,6),t.YNc(2,$t,1,4,"ng-container",7),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngTemplateOutlet",n.headerTemplate),t.xp6(1),t.Q6J("ngForOf",n.contractsList)}}function Kt(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"j-contracts-error",9),t.NdJ("retried",function(){return t.CHM(n),t.oxw(2).loadContracts()}),t.qZA()}}function Ht(e,i){1&e&&t._UZ(0,"j-empty-placeholder",10),2&e&&t.Q6J("minHeight",478)("label","CONTRACTS.LIST.EMPTY.APPROVED")}function zt(e,i){if(1&e&&(t.TgZ(0,"div",2),t.YNc(1,Wt,3,2,"ng-container",3),t.YNc(2,Kt,1,0,"j-contracts-error",4),t.YNc(3,Ht,1,2,"j-empty-placeholder",5),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",(null==n.contractsList?null:n.contractsList.length)>0),t.xp6(1),t.Q6J("ngIf",n.errorText),t.xp6(1),t.Q6J("ngIf",0==(null==n.contractsList?null:n.contractsList.length))}}function Xt(e,i){1&e&&(t.TgZ(0,"div",11),t._UZ(1,"j-contracts-loading"),t.qZA())}let Vt=(()=>{class e{constructor(n,o,m){this.contractsService=n,this.companyService=o,this.navService=m,this.isLoading=!1,this.subscription=new P.w}ngOnInit(){const n=this.companyService.refresh$.subscribe(()=>{this.loadContracts()});this.subscription.add(n)}ngOnDestroy(){this.subscription.unsubscribe()}mapTranslate(n){return`${this.translatePrefix}.${n}`}loadContracts(){return(0,E.mG)(this,void 0,void 0,function*(){this.errorText=null,this.isLoading=!0;try{let n=null;this.onSignForMe&&(n={onSignForMe:!0}),this.onSignForOthers&&(n={onSignForOthers:!0}),this.contractsList=yield this.contractsService.getContracts(this.contractType,n),this.navService.retrieveContractBadges()}catch(n){this.errorText=n.description||n.code||n||!0}finally{this.isLoading=!1}})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(G.W),t.Y36(Q.J),t.Y36(W.t))},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-list"]],contentQueries:function(n,o,m){if(1&n&&(t.Suo(m,Yt,5),t.Suo(m,Qt,5)),2&n){let h;t.iGM(h=t.CRH())&&(o.itemTemplate=h.first),t.iGM(h=t.CRH())&&(o.headerTemplate=h.first)}},inputs:{translatePrefix:"translatePrefix",contractType:"contractType",onSignForMe:"onSignForMe",onSignForOthers:"onSignForOthers"},decls:2,vars:2,consts:[["class","contracts__table contracts-list",4,"ngIf"],["class","contracts__table j-list__loading",4,"ngIf"],[1,"contracts__table","contracts-list"],[4,"ngIf"],[3,"retried",4,"ngIf"],[3,"minHeight","label",4,"ngIf"],[3,"ngTemplateOutlet"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngFor","ngForOf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"retried"],[3,"minHeight","label"],[1,"contracts__table","j-list__loading"]],template:function(n,o){1&n&&(t.YNc(0,zt,4,3,"div",0),t.YNc(1,Xt,2,0,"div",1)),2&n&&(t.Q6J("ngIf",!o.isLoading),t.xp6(1),t.Q6J("ngIf",o.isLoading))},directives:[T.O5,T.tP,T.sg,tt,nt.j,et],styles:[".contracts__row[_ngcontent-%COMP%]{display:block}@media (min-width: 960px){.contracts__row[_ngcontent-%COMP%]{display:grid;grid-column-gap:1rem;column-gap:1rem}}.contracts__header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(183,190,197,.5);padding:20px 1rem;display:none}@media (min-width: 960px){.contracts__header[_ngcontent-%COMP%]{display:grid}}.contracts__item[_ngcontent-%COMP%]{padding:1rem 1rem .5rem;align-content:center;min-height:52px}@media (min-width: 960px){.contracts__item[_ngcontent-%COMP%]{padding:.5rem 1rem}}.contracts__item--hoverable[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease-in-out}.contracts__item--hoverable[_ngcontent-%COMP%]:hover{background:#f5f9fd}.contracts__top[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.contracts__table[_ngcontent-%COMP%]{background:#fff;overflow:hidden;box-shadow:0 0 1px #0000000a,0 0 2px #0000000f,0 4px 8px #0000000a;border-radius:0 0 .5rem .5rem}.contracts__cell[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;margin-bottom:.75rem}@media (min-width: 960px){.contracts__cell[_ngcontent-%COMP%]{margin-bottom:0}}.contracts__icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;display:block;margin-right:.5rem}.contracts__number[_ngcontent-%COMP%]{display:flex;align-items:baseline}.contracts__label[_ngcontent-%COMP%]{margin-bottom:.25rem}@media (min-width: 960px){.contracts__label[_ngcontent-%COMP%]{display:none}}.contracts-info[_ngcontent-%COMP%]{display:grid;grid-row-gap:20px;row-gap:20px}@media (min-width: 1280px){.contracts-info[_ngcontent-%COMP%]{row-gap:0;column-gap:20px;grid-template-columns:repeat(2,calc(50% - 10px))}}.contracts-info__amounts[_ngcontent-%COMP%]{display:grid;margin-bottom:16px;grid-row-gap:16px;row-gap:16px}@media (min-width: 960px){.contracts-info__amounts[_ngcontent-%COMP%]{row-gap:0;column-gap:16px;grid-template-columns:repeat(2,calc(50% - 8px))}}.contracts-info__block[_ngcontent-%COMP%]{background:#fff;padding:22px 18px;border-radius:12px}.contracts-info__heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.contracts-info__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:24px}.contracts-info__buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-top:12px}.contracts-info__attachments[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none}.contracts-info__attachment[_ngcontent-%COMP%] + .contracts-info__attachment[_ngcontent-%COMP%]{margin-top:1rem}.contracts-info__filename[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin-bottom:8px;word-break:break-all}@media (min-width: 960px){.contracts-info__filename[_ngcontent-%COMP%]{margin-bottom:0}}@media (min-width: 960px){.contracts-info__attachment[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between}}.contracts-info__icon[_ngcontent-%COMP%]{margin-right:8px}@media (min-width: 960px){.contracts-info__icon[_ngcontent-%COMP%]{margin-right:16px}}.contracts-info__date[_ngcontent-%COMP%]{flex-shrink:0;margin-left:20px}"]}),e})();var mt=r(40703),qt=r(67997);function tn(e,i){if(1&e&&(t.TgZ(0,"div",5),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const n=i.$implicit,o=t.oxw(2);t.xp6(1),t.Oqu(t.lcZ(2,1,o.mapTranslate(n)))}}function nn(e,i){if(1&e&&(t.TgZ(0,"div",3),t.YNc(1,tn,3,3,"div",4),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.headings)}}function en(e,i){if(1&e&&(t.TgZ(0,"div",19)(1,"span",20),t._uU(2," \u2116 "),t.qZA(),t.TgZ(3,"div",21),t._uU(4),t.qZA()()),2&e){const n=t.oxw().$implicit;t.Q6J("ngbTooltip","\u2116 "+n.contractNumber),t.xp6(4),t.hij(" ",n.contractNumber," ")}}function on(e,i){1&e&&(t.TgZ(0,"div"),t._uU(1," - "),t.qZA())}function an(e,i){if(1&e&&(t.TgZ(0,"div",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,n.mapTranslate("HAS_UNK"))," ")}}function rn(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"div",14),t.ALo(2,"money"),t._UZ(3,"j-money",15),t.qZA(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("ngbTooltip",t.lcZ(2,2,n.amount)),t.xp6(2),t.Q6J("money",n.amount)}}function sn(e,i){if(1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const n=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,o.mapRemainderMessage(n))," ")}}function cn(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"div",6),t.NdJ("click",function(){const h=t.CHM(n).$implicit;return t.oxw().onContractClick(h)}),t.TgZ(1,"div",7)(2,"div",8),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",9),t._UZ(6,"span",10),t.YNc(7,en,5,2,"div",11),t.YNc(8,on,2,0,"div",12),t.qZA(),t.YNc(9,an,3,3,"div",13),t.qZA(),t.TgZ(10,"div",7)(11,"div",8),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"div",14),t._uU(15),t.qZA()(),t.TgZ(16,"div",7)(17,"div",8),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.YNc(20,rn,4,4,"ng-container",12),t.qZA(),t.TgZ(21,"div",7)(22,"div",8),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"div",14),t.ALo(26,"money"),t._UZ(27,"j-money",15),t.qZA(),t.YNc(28,sn,3,3,"div",16),t.qZA(),t.TgZ(29,"div",7)(30,"div",17)(31,"button",18),t.NdJ("click",function(m){const M=t.CHM(n).$implicit;return t.oxw().onDownload(m,M)}),t.ALo(32,"translate"),t.qZA()()()()}if(2&e){const n=i.$implicit,o=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,17,o.mapTranslate(o.headings[0]))," "),t.xp6(4),t.Q6J("ngIf",n.contractNumber),t.xp6(1),t.Q6J("ngIf",!n.contractNumber),t.xp6(1),t.Q6J("ngIf",o.hasUnk(n)),t.xp6(3),t.hij(" ",t.lcZ(13,19,o.mapTranslate(o.headings[1]))," "),t.xp6(2),t.Q6J("ngbTooltip",null==n.contractor?null:n.contractor.name),t.xp6(1),t.hij(" ",(null==n.contractor?null:n.contractor.name)||"-"," "),t.xp6(3),t.hij(" ",t.lcZ(19,21,o.mapTranslate(o.headings[2]))," "),t.xp6(2),t.Q6J("ngIf",n.amount),t.xp6(3),t.hij(" ",t.lcZ(24,23,o.mapTranslate(o.headings[3]))," "),t.xp6(2),t.Q6J("ngbTooltip",t.lcZ(26,25,n.remainder)),t.xp6(2),t.Q6J("money",n.remainder),t.xp6(1),t.Q6J("ngIf",o.mapRemainderMessage(n)),t.xp6(3),t.ekj("j-list__action--disabled",o.loadingIds.includes(n.id)),t.Q6J("ngbTooltip",t.lcZ(32,27,o.mapTranslate(o.loadingIds.includes(n.id)?"DOWNLOADING":"DOWNLOAD")))("inlineSVG","/assets/icons/transaction/pdf.svg")}}const ln=["01","02"];let _t=(()=>{class e{constructor(n,o,m,h,M){this.contractsService=n,this.route=o,this.router=m,this.notifierService=h,this.translateService=M,this.headings=["CONTRACT_NUMBER","CONTRACT_NAME","CONTRACT_AMOUNT","CONTRACT_REMAINDER"],this.translatePrefix="CONTRACTS.APPROVED",this.contractType=D.G.APPROVED,this.loadingIds=[]}mapTranslate(n){return`${this.translatePrefix}.${n}`}hasUnk(n){return n.status==f.J.REGED&&ln.includes(n.type.colvirCode)}mapRemainderMessage(n){const o=this.contractsService.mapRemainderMessage(n);return o?this.mapTranslate(o):null}onContractClick(n){this.router.navigate([n.id],{relativeTo:this.route.parent.parent})}onDownload(n,o){return(0,E.mG)(this,void 0,void 0,function*(){if(n.stopPropagation(),!this.loadingIds.includes(o.id)){this.loadingIds.push(o.id);try{yield this.contractsService.downloadContractCertificate(o)}catch(m){this.notifierService.notify("error",this.translateService.instant("ERRORS.DOWNLOAD_ERROR"))}finally{const m=this.loadingIds.indexOf(o.id);this.loadingIds.splice(m,1)}}})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(G.W),t.Y36(a.gz),t.Y36(a.F0),t.Y36($.lG),t.Y36(j.sK))},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-approved"]],decls:5,vars:2,consts:[[3,"translatePrefix","contractType"],["headerTemplate",""],["itemTemplate",""],[1,"contracts__row","contracts__row--approved","contracts__header"],["class","text-muted p4",4,"ngFor","ngForOf"],[1,"text-muted","p4"],[1,"contracts__row","contracts__row--approved","contracts__item","contracts__item--hoverable","p3",3,"click"],[1,"contracts__cell"],[1,"text-muted","p4","contracts__label"],[1,"contracts__top"],["inlineSVG","/assets/icons/contracts/icon.svg",1,"text-success","contracts__icon"],["tooltipClass","tooltip-light","placement","top","class","contracts__number text-truncate",3,"ngbTooltip",4,"ngIf"],[4,"ngIf"],["class","text-muted",4,"ngIf"],["tooltipClass","tooltip-light","placement","top",1,"text-truncate",3,"ngbTooltip"],[3,"money"],["class","text-danger",4,"ngIf"],[1,"j-list__actions"],["tooltipClass","tooltip-light",1,"j-list__action",3,"ngbTooltip","inlineSVG","click"],["tooltipClass","tooltip-light","placement","top",1,"contracts__number","text-truncate",3,"ngbTooltip"],[1,"text-muted","mr-1"],[1,"text-truncate"],[1,"text-muted"],[1,"text-danger"]],template:function(n,o){1&n&&(t.TgZ(0,"j-contracts-list",0),t.YNc(1,nn,2,1,"ng-template",null,1,t.W1O),t.YNc(3,cn,33,29,"ng-template",null,2,t.W1O),t.qZA()),2&n&&t.Q6J("translatePrefix",o.translatePrefix)("contractType",o.contractType)},directives:[Vt,T.sg,B.d$,T.O5,mt._L,pt.y],pipes:[j.X$,qt.L],styles:[".contracts-list[_ngcontent-%COMP%]{background:#fff;border-radius:0 0 .75rem .75rem}.contracts__row[_ngcontent-%COMP%]{display:block}@media (min-width: 960px){.contracts__row[_ngcontent-%COMP%]{display:grid;grid-column-gap:1rem;column-gap:1rem}}.contracts__header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(183,190,197,.5);padding:20px 1rem;display:none}@media (min-width: 960px){.contracts__header[_ngcontent-%COMP%]{display:grid}}.contracts__item[_ngcontent-%COMP%]{padding:1rem 1rem .5rem;align-content:center;min-height:52px}@media (min-width: 960px){.contracts__item[_ngcontent-%COMP%]{padding:.5rem 1rem}}.contracts__item--hoverable[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease-in-out}.contracts__item--hoverable[_ngcontent-%COMP%]:hover{background:#f5f9fd}.contracts__top[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.contracts__table[_ngcontent-%COMP%]{background:#fff;overflow:hidden;box-shadow:0 0 1px #0000000a,0 0 2px #0000000f,0 4px 8px #0000000a;border-radius:0 0 .5rem .5rem}.contracts__cell[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;margin-bottom:.75rem}@media (min-width: 960px){.contracts__cell[_ngcontent-%COMP%]{margin-bottom:0}}.contracts__icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;display:block;margin-right:.5rem}.contracts__number[_ngcontent-%COMP%]{display:flex;align-items:baseline}.contracts__label[_ngcontent-%COMP%]{margin-bottom:.25rem}@media (min-width: 960px){.contracts__label[_ngcontent-%COMP%]{display:none}}.contracts-info[_ngcontent-%COMP%]{display:grid;grid-row-gap:20px;row-gap:20px}@media (min-width: 1280px){.contracts-info[_ngcontent-%COMP%]{row-gap:0;column-gap:20px;grid-template-columns:repeat(2,calc(50% - 10px))}}.contracts-info__amounts[_ngcontent-%COMP%]{display:grid;margin-bottom:16px;grid-row-gap:16px;row-gap:16px}@media (min-width: 960px){.contracts-info__amounts[_ngcontent-%COMP%]{row-gap:0;column-gap:16px;grid-template-columns:repeat(2,calc(50% - 8px))}}.contracts-info__block[_ngcontent-%COMP%]{background:#fff;padding:22px 18px;border-radius:12px}.contracts-info__heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.contracts-info__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:24px}.contracts-info__buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-top:12px}.contracts-info__attachments[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none}.contracts-info__attachment[_ngcontent-%COMP%] + .contracts-info__attachment[_ngcontent-%COMP%]{margin-top:1rem}.contracts-info__filename[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin-bottom:8px;word-break:break-all}@media (min-width: 960px){.contracts-info__filename[_ngcontent-%COMP%]{margin-bottom:0}}@media (min-width: 960px){.contracts-info__attachment[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between}}.contracts-info__icon[_ngcontent-%COMP%]{margin-right:8px}@media (min-width: 960px){.contracts-info__icon[_ngcontent-%COMP%]{margin-right:16px}}.contracts-info__date[_ngcontent-%COMP%]{flex-shrink:0;margin-left:20px}.contracts__row--approved[_ngcontent-%COMP%]{grid-template-columns:minmax(90px,140px) minmax(170px,2fr) minmax(160px,1fr) minmax(160px,1fr) 56px}"]}),e})();var pn=r(99430),dn=r(16831),mn=r(77337),_n=r(194);function gn(e,i){if(1&e&&(t.TgZ(0,"span",8)(1,"span",9),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"span",10),t._uU(5),t.ALo(6,"translate"),t.qZA()()),2&e){const n=t.oxw().$implicit;t.xp6(2),t.hij(" ",t.lcZ(3,2,n.label)," "),t.xp6(3),t.hij(" ",t.lcZ(6,4,"SHARED.SOON")," ")}}function un(e,i){if(1&e&&(t.TgZ(0,"a",11),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const n=t.oxw().$implicit;t.Q6J("routerLink",n.url),t.xp6(1),t.Oqu(t.lcZ(2,2,n.label))}}function hn(e,i){if(1&e&&(t.ynx(0),t.YNc(1,gn,7,6,"span",6),t.YNc(2,un,3,4,"a",7),t.BQk()),2&e){const n=i.$implicit;t.xp6(1),t.Q6J("ngIf",n.soon),t.xp6(1),t.Q6J("ngIf",!n.soon)}}let fn=(()=>{class e{constructor(n,o){this.contractsModalsService=n,this.featureFlagsService=o,this.isAddingDisabled=!1,this.contractTabs=[{label:"CONTRACTS.TABS.OUTCOMING",url:"/contracts/outcoming"},{label:"CONTRACTS.TABS.INCOMING",url:"/contracts/incoming",soon:!0}],this.subscription=new P.w}ngOnInit(){this.checkFeatureFlag(),this.subscription.add(this.featureFlagsService.featureFlags$.subscribe(n=>{this.checkFeatureFlag()}))}ngOnDestroy(){this.subscription.unsubscribe()}showAddContractModal(){this.contractsModalsService.showAddContractModal(!0)}checkFeatureFlag(){this.isAddingDisabled=this.featureFlagsService.isDisabled(z.Y.FX_CONTRACTS)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(G.T),t.Y36(z.a))},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-nav"]],decls:8,vars:4,consts:[[1,"j-tabs"],[1,"j-tabs__list"],[4,"ngFor","ngForOf"],[1,"ml-auto","btn","btn-link","j-tabs__add",3,"click"],["inlineSVG","/assets/icons/contracts/add.svg",1,"j-tabs__add-icon"],[1,"d-none","d-md-block"],["class","j-tabs__item j-tabs__item--soon",4,"ngIf"],["routerLinkActive","active","class","j-tabs__item",3,"routerLink",4,"ngIf"],[1,"j-tabs__item","j-tabs__item--soon"],[1,"j-tabs__label"],[1,"j-tabs__badge","badge","badge-warning"],["routerLinkActive","active",1,"j-tabs__item",3,"routerLink"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"nav",1),t.YNc(2,hn,3,2,"ng-container",2),t.TgZ(3,"button",3),t.NdJ("click",function(){return o.showAddContractModal()}),t._UZ(4,"span",4),t.TgZ(5,"span",5),t._uU(6),t.ALo(7,"translate"),t.qZA()()()()),2&n&&(t.xp6(2),t.Q6J("ngForOf",o.contractTabs),t.xp6(4),t.Oqu(t.lcZ(7,2,"CONTRACTS.ADD_NEW")))},directives:[T.sg,T.O5,a.yS,a.Od,B.d$],pipes:[j.X$],styles:[""]}),e})();var Cn=r(89801);const gt="/contracts/outcoming";let ut=(()=>{class e{constructor(n,o){this.router=n,this.navService=o,this.statuses=[{count:0,isSelected:!0,label:"CONTRACTS.TYPES.ON_SIGN",value:D.G.ON_SIGN},{count:0,isSelected:!1,label:"CONTRACTS.TYPES.APPROVED",value:D.G.APPROVED},{count:0,isSelected:!1,label:"CONTRACTS.TYPES.PENDING",value:D.G.PENDING},{count:0,isSelected:!1,label:"CONTRACTS.TYPES.REJECTED",value:D.G.REJECTED}],this.subscription=new P.w;const m=n.events.subscribe(M=>{M instanceof a.m2&&(this.statuses=this.statuses.map(L=>(L.isSelected=M.urlAfterRedirects===`${gt}/${L.value}`,L)))}),h=this.navService.getContractBadges().subscribe(M=>{const{onSignForMe:L,onSignForOthers:Y}=M,X=L>0;Object.assign(this.statuses[0],{count:X?L:Y,classList:X?"badge-primary":"badge-light"})});this.subscription.add(m),this.subscription.add(h)}ngOnInit(){}ngOnDestroy(){this.subscription.unsubscribe()}onStatusSelect(n){this.router.navigate([gt,n])}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(a.F0),t.Y36(W.t))},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-outcoming"]],decls:16,vars:1,consts:[[1,"row"],[1,"col-lg-10","offset-lg-1","col-xl-8","offset-xl-2"],[1,"j-page"],["translate","",1,"d-none","d-lg-block","j-page__title"],[1,"j-page__body"],[1,"j-list"],[1,"j-list__nav"],[1,"j-list__filter"],[3,"statuses","selected"]],template:function(n,o){1&n&&(t.TgZ(0,"j-layout-home")(1,"j-aside"),t._UZ(2,"j-nav-main"),t.qZA(),t.TgZ(3,"j-main")(4,"section",0)(5,"section",1)(6,"section",2)(7,"h2",3),t._uU(8,"CONTRACTS.TITLE"),t.qZA(),t.TgZ(9,"section",4)(10,"section",5)(11,"div",6),t._UZ(12,"j-contracts-nav"),t.qZA(),t.TgZ(13,"div",7)(14,"j-statuses",8),t.NdJ("selected",function(h){return o.onStatusSelect(h)}),t.qZA()(),t._UZ(15,"router-outlet"),t.qZA()()()()()()()),2&n&&(t.xp6(14),t.Q6J("statuses",o.statuses))},directives:[pn.Y,dn.l,mn.F,_n.C,j.Pi,fn,Cn.t,a.lC],styles:[""]}),e})();var xn=r(161),Tn=r(71764),K=r.n(Tn),vn=r(21086);let bn=(()=>{class e{constructor(n){this.translateService=n,this.translatePrefix="CONTRACTS.DATE"}ngOnInit(){}get tooltip(){if(this.contract)switch(this.contract.status){case f.J.ON_SIGN:case f.J.REGED:case f.J.REGISTERED:case f.J.PROCESSING:return this.mapTranslate("SENT");case f.J.REJECTED:return this.mapTranslate("REJECTED")}}mapTranslate(n){return`${this.translatePrefix}.${n}`}mapDateTime(n){const o=K()().isSame(K()(n),"day"),m=K()().subtract(1,"date").isSame(K()(n),"day");return o?this.translateService.get("STATEMENT.TRANSACTION.DATE.TODAY"):m?this.translateService.get("STATEMENT.TRANSACTION.DATE.YESTERDAY"):(0,vn.of)(this.convertToDayHourFormat(this.contract.created))}convertToDayHourFormat(n){const o=K()().isSame(this.contract.created,"year")?"d MMMM HH:mm":"d MMMM yyyy HH:mm";return(0,T.p6)(this.contract.created,o,this.translateService.currentLang)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(j.sK))},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-date"]],inputs:{contract:"contract"},decls:5,vars:6,consts:[["tooltipClass","tooltip-light",1,"contract__date",3,"ngbTooltip"],[1,"text-dark"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.ALo(1,"translate"),t.TgZ(2,"span",1),t._uU(3),t.ALo(4,"async"),t.qZA()()),2&n&&(t.Q6J("ngbTooltip",t.lcZ(1,2,o.tooltip)),t.xp6(3),t.Oqu(t.lcZ(4,4,o.mapDateTime(o.contract.created))))},directives:[mt._L],pipes:[j.X$,T.Ov],styles:[""]}),e})();function On(e,i){if(1&e&&t._UZ(0,"span",1),2&e){const n=t.oxw();t.Tol(n.statusClassname)}}let yn=(()=>{class e{constructor(){}ngOnInit(){this.mapContractType()}mapContractType(){switch(this.contract.status){case f.J.REGED:this.statusClassname="text-success";break;case f.J.PROCESSING:case f.J.REGISTERED:this.statusClassname="text-warning";break;case f.J.REJECTED:this.statusClassname="text-danger"}}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-status"]],inputs:{contract:"contract"},decls:1,vars:1,consts:[["class","contracts__icon mr-2","inlineSVG","/assets/icons/contracts/icon.svg",3,"class",4,"ngIf"],["inlineSVG","/assets/icons/contracts/icon.svg",1,"contracts__icon","mr-2"]],template:function(n,o){1&n&&t.YNc(0,On,1,2,"span",0),2&n&&t.Q6J("ngIf",o.statusClassname)},directives:[T.O5,B.d$],styles:[""]}),e})();function Mn(e,i){if(1&e&&(t.TgZ(0,"div",14),t._uU(1),t.qZA()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",n.statusMessage," ")}}function En(e,i){if(1&e&&(t.TgZ(0,"div",8),t._UZ(1,"j-contracts-status",4),t.TgZ(2,"article",9)(3,"div",10)(4,"span",11),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"button",12),t._uU(8),t.ALo(9,"async"),t.qZA()(),t.YNc(10,Mn,2,1,"div",13),t.qZA()()),2&e){const n=i.$implicit,o=t.oxw();t.xp6(1),t.Q6J("contract",n),t.xp6(4),t.hij(" ",t.lcZ(6,4,o.mapTranslate("TITLE"))," "),t.xp6(3),t.hij(" ",t.lcZ(9,6,o.mapAttachmentsTitle(n))," "),t.xp6(2),t.Q6J("ngIf",n.statusMessage)}}const ot=function(e){return{$implicit:e}};function Pn(e,i){if(1&e&&(t.TgZ(0,"ul",15),t.NdJ("click",function(o){return o.stopPropagation()}),t.GkF(1,3),t.qZA()),2&e){const n=i.$implicit,o=t.oxw(),m=t.MAs(12);t.Udp("margin-top",n.isCollapsed?"1rem":0)("margin-bottom",n.isCollapsed&&o.hasMoreAttachments?"-1rem":0)("opacity",n.isCollapsed?1:0)("max-height",o.attachmentsMaxHeight),t.ekj("contract-attachments--one-action",!o.isSignable&&o.isDeletable||o.isSignable&&!o.isDeletable)("contract-attachments--two-actions",o.isSignable&&o.isDeletable)("contract-attachments--selectable",o.isSelectable),t.xp6(1),t.Q6J("ngTemplateOutlet",m)("ngTemplateOutletContext",t.VKq(16,ot,n))}}function An(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"li",18)(1,"div",19),t._UZ(2,"span",20),t.TgZ(3,"div",21),t._uU(4),t.qZA(),t.TgZ(5,"button",22),t.NdJ("click",function(m){const M=t.CHM(n).$implicit;return t.oxw(2).onAttachmentDownload(m,M)}),t.qZA()()()}if(2&e){const n=i.$implicit;t.Q6J("jLoading",n.isLoading),t.xp6(4),t.Oqu((null==n.file?null:n.file.name)||"-")}}function Sn(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"li",23),t.NdJ("click",function(){return t.CHM(n),t.oxw(2).showMoreAttachments()}),t._uU(1),t.ALo(2,"async"),t.qZA()}if(2&e){const n=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,n.mapMoreTitle())," ")}}function Dn(e,i){if(1&e&&(t.YNc(0,An,6,2,"li",16),t.YNc(1,Sn,3,3,"li",17)),2&e){const n=t.oxw();t.Q6J("ngForOf",n.attachments),t.xp6(1),t.Q6J("ngIf",n.hasMoreAttachments)}}let Nn=(()=>{class e{constructor(n,o){this.translateService=n,this.filesService=o,this.isDeletable=!1,this.isSelectable=!1,this.isSignable=!1,this.translatePrefix="CONTRACTS.ITEM",this.maxAllowedAttachments=10}ngOnInit(){}get attachments(){return this.contract.attachments.slice(0,this.maxAllowedAttachments)}get hasMoreAttachments(){return this.maxAllowedAttachments<this.contract.attachments.length}get attachmentsMaxHeight(){if(!this.contract.isCollapsed)return 0;let n=56*this.attachments.length;return this.hasMoreAttachments&&(n+=42),`${n}px`}onAttachmentDownload(n,o){return(0,E.mG)(this,void 0,void 0,function*(){if(n.stopPropagation(),!o.isLoading){o.isLoading=!0;try{yield this.filesService.downloadFileById(o.file.id,o.file.name)}catch(m){}finally{o.isLoading=!1}}})}showMoreAttachments(){this.maxAllowedAttachments+=10}mapAttachmentsTitle(n){var o;return this.mapAttachmentsKey("ATTACHMENTS_TITLE",null===(o=n.attachments)||void 0===o?void 0:o.length)}mapTranslate(n){return`${this.translatePrefix}.${n}`}mapMoreTitle(){return this.mapAttachmentsKey("MORE",Math.min(this.contract.attachments.length-this.maxAllowedAttachments,10))}mapAttachmentsKey(n,o){const m={count:o};let h=`${n}.${this.mapPluralKey(o)}`;return this.translateService.stream(this.mapTranslate(h),m)}mapPluralKey(n){switch(n%20){case 1:return"ONE";case 2:case 3:case 4:return"FEW";default:return"OTHER"}}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(j.sK),t.Y36(lt.nS))},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-item"]],inputs:{contract:"contract",isDeletable:"isDeletable",isSelectable:"isSelectable",isSignable:"isSignable"},decls:13,vars:9,consts:[[1,"contracts-item-wrap"],[1,"p3","contracts-item"],[1,"contracts__cell"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"contract"],["mainTemplate",""],["attachmentsTemplate",""],["attachmentsCollapsedTemplate",""],[1,"contracts-item__main"],[1,"contracts-item__content"],[1,"contracts-item__title"],[1,"text-dark"],[1,"contracts-item__attachments-title"],["class","text-muted contracts-item__message",4,"ngIf"],[1,"text-muted","contracts-item__message"],[1,"contract-attachments",3,"click"],["class","contract-attachment",3,"jLoading",4,"ngFor","ngForOf"],["class","contract-attachment contract-attachment--more p3",3,"click",4,"ngIf"],[1,"contract-attachment",3,"jLoading"],[1,"contract-attachment__content"],["inlineSVG","/assets/icons/contracts/attachment-prefix.svg"],[1,"p3","text-muted","text-truncate"],["inlineSVG","/assets/icons/contracts/attachment-download.svg",1,"contract-attachment__download",3,"click"],[1,"contract-attachment","contract-attachment--more","p3",3,"click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.GkF(3,3),t.qZA(),t.TgZ(4,"div",2),t._UZ(5,"j-contracts-date",4),t.qZA()(),t.GkF(6,3),t.qZA(),t.YNc(7,En,11,8,"ng-template",null,5,t.W1O),t.YNc(9,Pn,2,18,"ng-template",null,6,t.W1O),t.YNc(11,Dn,2,2,"ng-template",null,7,t.W1O)),2&n){const m=t.MAs(8),h=t.MAs(10);t.xp6(3),t.Q6J("ngTemplateOutlet",m)("ngTemplateOutletContext",t.VKq(5,ot,o.contract)),t.xp6(2),t.Q6J("contract",o.contract),t.xp6(1),t.Q6J("ngTemplateOutlet",h)("ngTemplateOutletContext",t.VKq(7,ot,o.contract))}},directives:[T.tP,bn,yn,T.O5,T.sg,dt.T,B.d$],pipes:[j.X$,T.Ov],styles:['.contract[_ngcontent-%COMP%]{display:flex;align-items:center}.contracts-item[_ngcontent-%COMP%]{display:grid;grid-column-gap:16px;column-gap:16px;align-items:center;grid-template-columns:minmax(0px,1fr) 150px;-webkit-user-select:none;user-select:none}.contracts-item-wrap[_ngcontent-%COMP%]{position:relative}.contracts-item__attachments-title[_ngcontent-%COMP%]{font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;display:inline-block;color:#666c72;position:relative;transition:all .2s ease-in-out;margin-left:4px;padding:0}.contracts-item__attachments-title[_ngcontent-%COMP%]:after{content:"";bottom:2px;left:8px;right:8px;display:inline-block;position:absolute;border-bottom:1px dashed #666c72;transition:all .2s ease-in-out}.contracts-item__attachments-title[_ngcontent-%COMP%]:hover{color:#ef5630}.contracts-item__attachments-title[_ngcontent-%COMP%]:hover:after{border-color:#ef5630}.contracts-item__main[_ngcontent-%COMP%]{display:flex}.contract__date[_ngcontent-%COMP%]{display:flex;align-items:center}.contract-attachments[_ngcontent-%COMP%]{padding:0;overflow:hidden;max-height:0;margin:0 -16px;transition:all .2s ease-in-out}.contract-attachments--selectable[_ngcontent-%COMP%]{margin-left:-56px}.contract-attachments--one-action[_ngcontent-%COMP%]{margin-right:-66px}.contract-attachments--two-actions[_ngcontent-%COMP%]{margin-right:-116px}.contract-attachment[_ngcontent-%COMP%]{position:relative;padding:0 1rem}.contract-attachment.is-loading[_ngcontent-%COMP%]{cursor:not-allowed}.contract-attachment.is-loading[_ngcontent-%COMP%]   .contract-attachment__content[_ngcontent-%COMP%]{opacity:.5}.contract-attachment.is-loading[_ngcontent-%COMP%]   .contract-attachment__download[_ngcontent-%COMP%]:hover{color:#b7bec5}.contract-attachment--more[_ngcontent-%COMP%]{background:#f6f7f8;height:42px;display:flex;justify-content:flex-end;border-radius:0;align-items:center;color:#1586bb;transition:all .2s ease-in-out}.contract-attachment--more[_ngcontent-%COMP%]:hover{color:#ef5630}.contract-attachment__content[_ngcontent-%COMP%]{height:56px;display:grid;grid-column-gap:16px;column-gap:16px;align-items:center;grid-template-columns:24px 1fr 40px;position:relative;z-index:1}.contract-attachment__download[_ngcontent-%COMP%]{display:inline-block;font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:0;color:#b7bec5;transition:all .2s ease-in-out}.contract-attachment__download[_ngcontent-%COMP%]:hover{color:#ef5630}']}),e})();function Zn(e,i){if(1&e&&t._UZ(0,"j-contracts-item",2),2&e){const n=i.$implicit,o=t.oxw();t.Q6J("contract",n)("isDeletable",o.isDeletable)("isSelectable",o.isSelectable)("isSignable",o.isSignable)}}let ht=(()=>{class e{constructor(n,o,m){this.navService=n,this.translateService=o,this.locale=m,this.isDeletable=!1,this.isSelectable=!1,this.isSignable=!1,this.scrolled=new t.vpe,this.signed=new t.vpe,this.translatePrefix="CONTRACTS.LIST",this.urlPath="fx-contracts",this.collapsedIds=[],this.modalPartialTitleFn=this.mapModalPartialTitle.bind(this)}mapModalPartialTitle(n){const o=this.translateService.instant(this.mapTranslate("ITEM_TITLE"),{date:(0,T.p6)(n.created,"d MMMM yyyy",this.locale)});return o?`${o}:`:""}mapTranslate(n){return`${this.translatePrefix}.${n}`}onClick(n){n.isCollapsed=!n.isCollapsed}onScroll(){this.scrolled.emit()}onClear(){this.navService.retrieveContractBadges()}onSign(){this.signed.emit()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(W.t),t.Y36(j.sK),t.Y36(t.soG))},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-group"]],inputs:{title:"title",list:"list",contractType:"contractType",isDeletable:"isDeletable",isSelectable:"isSelectable",isSignable:"isSignable"},outputs:{scrolled:"scrolled",signed:"signed"},decls:3,vars:9,consts:[[3,"list","title","urlPath","translatePrefix","isHoverable","isDeletable","isSelectable","isSignable","partialTitleFn","clicked","scrolled","cleared","signed"],["defaultTemplate",""],[3,"contract","isDeletable","isSelectable","isSignable"]],template:function(n,o){1&n&&(t.TgZ(0,"j-list",0),t.NdJ("clicked",function(h){return o.onClick(h)})("scrolled",function(){return o.onScroll()})("cleared",function(){return o.onClear()})("signed",function(){return o.onSign()}),t.YNc(1,Zn,1,4,"ng-template",null,1,t.W1O),t.qZA()),2&n&&t.Q6J("list",o.list)("title",o.title)("urlPath",o.urlPath)("translatePrefix",o.translatePrefix)("isHoverable",!0)("isDeletable",o.isDeletable)("isSelectable",o.isSelectable)("isSignable",o.isSignable)("partialTitleFn",o.modalPartialTitleFn)},directives:[xn.n,Nn],styles:[""]}),e})();function Ln(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"j-contracts-error",7),t.NdJ("retried",function(){return t.CHM(n),t.oxw(2).onRetry()}),t.qZA()}}function In(e,i){if(1&e&&t._UZ(0,"j-empty-placeholder",8),2&e){const n=t.oxw(2);t.Q6J("minHeight",478)("label",n.mapTranslate("EMPTY.ON_SIGN"))}}function wn(e,i){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"j-contracts-group",3),t.NdJ("signed",function(){return t.CHM(n),t.oxw().onSign()}),t.qZA(),t._UZ(2,"j-contracts-group",4),t.YNc(3,Ln,1,0,"j-contracts-error",5),t.YNc(4,In,1,2,"j-empty-placeholder",6),t.BQk()}if(2&e){const n=t.oxw();t.xp6(1),t.Q6J("list",n.onSignForMeList)("isSignable",!0)("isSelectable",!0)("isDeletable",!1),t.xp6(1),t.Q6J("list",n.onSignForOthersList)("title",n.mapTranslate("OTHERS_FOR_SIGN")),t.xp6(1),t.Q6J("ngIf",n.errorText),t.xp6(1),t.Q6J("ngIf",0===n.onSignForMeList.length&&0===n.onSignForOthersList.length&&!n.errorText)}}function Fn(e,i){1&e&&(t.TgZ(0,"section",9),t._UZ(1,"j-contracts-loading")(2,"j-contracts-loading",10),t.qZA()),2&e&&(t.xp6(2),t.Q6J("hasTitle",!0))}let ft=(()=>{class e{constructor(n,o,m,h){this.contractsService=n,this.navService=o,this.companyService=m,this.router=h,this.translatePrefix="CONTRACTS.LIST",this.contractType=D.G.ON_SIGN,this.isLoading=!0,this.onSignForMeList=[],this.onSignForOthersList=[],this.errorText=null,this.subscription=new P.w,this.subscription.add(this.companyService.refresh$.subscribe(M=>{const[L,Y,X]=M;X&&this.retrieveContracts()})),this.subscription.add(this.contractsService.getContractsSubmitted().subscribe(()=>{this.retrieveContracts()}))}ngOnDestroy(){this.subscription.unsubscribe()}onSign(){return(0,E.mG)(this,void 0,void 0,function*(){yield this.retrieveContracts(),0==this.onSignForMeList.length&&this.companyService.isPrimaryAuthority()&&this.companyService.isSingleSignScheme()&&this.router.navigateByUrl(`contracts/outcoming/${D.G.PENDING}`)})}onRetry(){this.navService.getContractBadges(),this.retrieveContracts()}retrieveContracts(){return(0,E.mG)(this,void 0,void 0,function*(){this.errorText=null;try{yield Promise.all([this.retrieveOnSignForMe(),this.retrieveOnSignForOthers()])}catch(n){this.errorText=n.description||n}finally{this.isLoading=!1}})}retrieveOnSignForMe(){return(0,E.mG)(this,void 0,void 0,function*(){this.onSignForMeList=yield this.contractsService.getContracts(D.G.ON_SIGN,{onSignForMe:!0})})}retrieveOnSignForOthers(){return(0,E.mG)(this,void 0,void 0,function*(){this.onSignForOthersList=yield this.contractsService.getContracts(D.G.ON_SIGN,{onSignForOthers:!0})})}mapTranslate(n){return`${this.translatePrefix}.${n}`}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(G.W),t.Y36(W.t),t.Y36(Q.J),t.Y36(a.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-on-sign"]],decls:3,vars:2,consts:[[1,"contracts-list"],[4,"ngIf"],["class","py-5 px-4",4,"ngIf"],[3,"list","isSignable","isSelectable","isDeletable","signed"],[1,"d-block","pt-3",3,"list","title"],[3,"retried",4,"ngIf"],[3,"minHeight","label",4,"ngIf"],[3,"retried"],[3,"minHeight","label"],[1,"py-5","px-4"],[3,"hasTitle"]],template:function(n,o){1&n&&(t.TgZ(0,"section",0),t.YNc(1,wn,5,8,"ng-container",1),t.YNc(2,Fn,3,1,"section",2),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngIf",!o.isLoading),t.xp6(1),t.Q6J("ngIf",o.isLoading))},directives:[T.O5,ht,tt,nt.j,et],styles:[".contracts-list[_ngcontent-%COMP%]{background:#fff;border-radius:0 0 .75rem .75rem}"]}),e})();var Rn=r(36053);function jn(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"j-contracts-error",6),t.NdJ("retried",function(){return t.CHM(n),t.oxw(2).retrieveContracts()}),t.qZA()}}function Un(e,i){if(1&e&&t._UZ(0,"j-empty-placeholder",7),2&e){const n=t.oxw(2);t.Q6J("minHeight",478)("label",n.emptyLabel)}}function Jn(e,i){if(1&e&&(t.ynx(0),t._UZ(1,"j-contracts-group",3),t.YNc(2,jn,1,0,"j-contracts-error",4),t.YNc(3,Un,1,2,"j-empty-placeholder",5),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("list",n.contractsList)("contractType",n.contractType)("isSignable",n.isSignable)("isSelectable",n.isSelectable)("isDeletable",n.isDeletable),t.xp6(1),t.Q6J("ngIf",n.errorText),t.xp6(1),t.Q6J("ngIf",0==(null==n.contractsList?null:n.contractsList.length))}}function Gn(e,i){1&e&&(t.TgZ(0,"section",8),t._UZ(1,"j-contracts-loading"),t.qZA())}let it=(()=>{class e{constructor(n,o,m,h){this.navService=n,this.contractsService=o,this.companyService=m,this.route=h,this.isDeletable=!1,this.isSelectable=!1,this.isSignable=!1,this.translatePrefix="CONTRACTS.LIST",this.isLoading=!1,this.subscription=new P.w}ngOnInit(){this.subscription.add((0,Rn.aj)([this.route.data,this.companyService.refresh$]).subscribe(n=>{const[o,m]=n;this.contractType=o.contractType,this.mapListActions(),this.mapEmptyLabel(),this.retrieveContracts()})),this.subscription.add(this.contractsService.getContractsSubmitted().subscribe(()=>{this.retrieveContracts()}))}ngOnDestroy(){this.subscription.unsubscribe()}mapTranslate(n){return`${this.translatePrefix}.${n}`}retrieveContracts(){return(0,E.mG)(this,void 0,void 0,function*(){this.errorText=null,this.isLoading=!0;try{this.contractsList=yield this.contractsService.getContracts(this.contractType),this.navService.retrieveContractBadges()}catch(n){this.errorText=n.description||n.code||n||!0}finally{this.isLoading=!1}})}mapListActions(){this.contractType===D.G.REJECTED&&(this.isSelectable=!0)}mapEmptyLabel(){let n="EMPTY.";switch(this.contractType){case D.G.APPROVED:n+="APPROVED";break;case D.G.REJECTED:n+="REJECTED";break;case D.G.PENDING:n+="PENDING"}this.emptyLabel=this.mapTranslate(n)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(W.t),t.Y36(G.W),t.Y36(Q.J),t.Y36(a.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts-list-base"]],decls:3,vars:2,consts:[[1,"contracts-list"],[4,"ngIf"],["class","py-5 px-4",4,"ngIf"],[3,"list","contractType","isSignable","isSelectable","isDeletable"],[3,"retried",4,"ngIf"],[3,"minHeight","label",4,"ngIf"],[3,"retried"],[3,"minHeight","label"],[1,"py-5","px-4"]],template:function(n,o){1&n&&(t.TgZ(0,"section",0),t.YNc(1,Jn,4,7,"ng-container",1),t.YNc(2,Gn,2,0,"section",2),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngIf",!o.isLoading),t.xp6(1),t.Q6J("ngIf",o.isLoading))},directives:[T.O5,ht,tt,nt.j,et],styles:[".contracts-list[_ngcontent-%COMP%]{background:#fff;border-radius:0 0 .75rem .75rem}"]}),e})();const kn=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["j-contracts"]],decls:1,vars:0,template:function(n,o){1&n&&t._UZ(0,"router-outlet")},directives:[a.lC],styles:[".contracts__row[_ngcontent-%COMP%]{display:block}@media (min-width: 960px){.contracts__row[_ngcontent-%COMP%]{display:grid;grid-column-gap:1rem;column-gap:1rem}}.contracts__header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(183,190,197,.5);padding:20px 1rem;display:none}@media (min-width: 960px){.contracts__header[_ngcontent-%COMP%]{display:grid}}.contracts__item[_ngcontent-%COMP%]{padding:1rem 1rem .5rem;align-content:center;min-height:52px}@media (min-width: 960px){.contracts__item[_ngcontent-%COMP%]{padding:.5rem 1rem}}.contracts__item--hoverable[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease-in-out}.contracts__item--hoverable[_ngcontent-%COMP%]:hover{background:#f5f9fd}.contracts__top[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.contracts__table[_ngcontent-%COMP%]{background:#fff;overflow:hidden;box-shadow:0 0 1px #0000000a,0 0 2px #0000000f,0 4px 8px #0000000a;border-radius:0 0 .5rem .5rem}.contracts__cell[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;margin-bottom:.75rem}@media (min-width: 960px){.contracts__cell[_ngcontent-%COMP%]{margin-bottom:0}}.contracts__icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;display:block;margin-right:.5rem}.contracts__number[_ngcontent-%COMP%]{display:flex;align-items:baseline}.contracts__label[_ngcontent-%COMP%]{margin-bottom:.25rem}@media (min-width: 960px){.contracts__label[_ngcontent-%COMP%]{display:none}}.contracts-info[_ngcontent-%COMP%]{display:grid;grid-row-gap:20px;row-gap:20px}@media (min-width: 1280px){.contracts-info[_ngcontent-%COMP%]{row-gap:0;column-gap:20px;grid-template-columns:repeat(2,calc(50% - 10px))}}.contracts-info__amounts[_ngcontent-%COMP%]{display:grid;margin-bottom:16px;grid-row-gap:16px;row-gap:16px}@media (min-width: 960px){.contracts-info__amounts[_ngcontent-%COMP%]{row-gap:0;column-gap:16px;grid-template-columns:repeat(2,calc(50% - 8px))}}.contracts-info__block[_ngcontent-%COMP%]{background:#fff;padding:22px 18px;border-radius:12px}.contracts-info__heading[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.contracts-info__buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-top:24px}.contracts-info__buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-top:12px}.contracts-info__attachments[_ngcontent-%COMP%]{padding:0;margin:0;list-style:none}.contracts-info__attachment[_ngcontent-%COMP%] + .contracts-info__attachment[_ngcontent-%COMP%]{margin-top:1rem}.contracts-info__filename[_ngcontent-%COMP%]{display:flex;align-items:flex-start;margin-bottom:8px;word-break:break-all}@media (min-width: 960px){.contracts-info__filename[_ngcontent-%COMP%]{margin-bottom:0}}@media (min-width: 960px){.contracts-info__attachment[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between}}.contracts-info__icon[_ngcontent-%COMP%]{margin-right:8px}@media (min-width: 960px){.contracts-info__icon[_ngcontent-%COMP%]{margin-right:16px}}.contracts-info__date[_ngcontent-%COMP%]{flex-shrink:0;margin-left:20px}"]}),e})(),data:{title:"CONTRACTS.TITLE"},children:[{path:"outcoming",component:ut,children:[{path:D.G.ON_SIGN,component:ft,data:{contractType:D.G.ON_SIGN}},{path:D.G.APPROVED,component:_t,data:{contractType:D.G.APPROVED}},{path:D.G.PENDING,component:it,data:{contractType:D.G.PENDING}},{path:D.G.REJECTED,component:it,data:{contractType:D.G.REJECTED}},{path:"**",redirectTo:D.G.ON_SIGN}]},{path:":id",component:k},{path:"**",redirectTo:"outcoming"}]},{path:"**",redirectTo:""}];let Yn=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[a.Bz.forChild(kn)],a.Bz]}),e})();r(55187),r(82131),r(4336);const Qn=[d.m,Yn,s.Yi,v.j];let Bn=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[Qn]]}),e})()},55187:(J,I,r)=>{r.d(I,{W:()=>F});var s=r(70655),v=r(5157),d=r(80457),a=r(5e3),E=r(40703),f=r(26164),S=r(7505),b=r(9661),N=r(77501),P=r(56104),t=r(69544),Z=r(13500),w=r(48622),u=r(70853),x=r(85814),c=r(89854);const l=["commissionAccountDropdown"],p=["fileDrop"];function _(O,R){1&O&&a._UZ(0,"img",24)}let F=(()=>{class O{constructor(y,g,A,U,H,at){this.modal=y,this.companyService=g,this.contractsService=A,this.filesService=U,this.navService=H,this.accountsService=at,this.shouldNavigateToContracts=!1,this.acceptedFormats=".pdf, .jpg, .jpeg, .doc, .png, .tif",this.uploadingFiles=[],this.isLoading=!1,this.isAccountsLoading=!1,this.companyService.refresh$.subscribe(Q=>{const[G,T,$]=Q;$&&this.retrieveAccounts()})}ngOnInit(){this.uploadingFiles=[],this.mapSubmitLabel()}ngOnDestroy(){this.uploadingFiles=[]}onCommissionAccountSelect(y){this.selectedAccount=y}onFileDrop(y){for(const g of y)g.fileEntry.isFile&&g.fileEntry.file(U=>{this.filesService.uploading$.next([U])})}onUploadingFilesUpdate(y){this.uploadingFiles=y}mapTranslate(y){return`CONTRACTS.ADD_CONTRACT_MODAL.${y}`}dismissModal(y=null,g=null,A=null){this.modal.dismiss({error:y,uploadingFiles:g,iban:A}),this.uploadingFiles=[]}closeModal(){this.uploadingFiles=[],this.modal.close()}openFileSelector(){this.fileDrop.openFileSelector()}submitFiles(){return(0,s.mG)(this,void 0,void 0,function*(){if(this.filesService.checkIfCanBeUploadedAndNotify(this.uploadingFiles)&&this.selectedAccount){this.isLoading=!0;try{yield this.contractsService.submitContracts(this.uploadingFiles,this.selectedAccount.iban),this.navService.retrieveContractBadges(),this.closeModal()}catch(g){g?this.dismissModal(g,this.uploadingFiles,this.selectedAccount.iban):this.dismissModal(g)}finally{this.isLoading=!1}}})}mapSubmitLabel(){this.submitLabel=this.companyService.isSecondaryAuthority()?this.mapTranslate("SIGN"):this.companyService.isPrimaryAuthority()&&this.companyService.isSingleSignScheme()?this.mapTranslate("SIGN_AND_SEND"):this.mapTranslate("SENT_FOR_SIGN")}retrieveAccounts(){return(0,s.mG)(this,void 0,void 0,function*(){this.isAccountsLoading=!0;try{const y=yield this.accountsService.getAccounts();this.accounts=y.filter(g=>{var A;return(null===(A=g.balance)||void 0===A?void 0:A.currency)===d.w.KZT&&g.accountType===v.Q5.ACCOUNT}),this.accounts.length&&(this.selectedAccount=this.accounts[0],this.commissionAccountDropdown.selectAccount(this.selectedAccount))}catch(y){}finally{this.isAccountsLoading=!1}})}}return O.\u0275fac=function(y){return new(y||O)(a.Y36(E.Kz),a.Y36(f.J),a.Y36(S.W),a.Y36(b.nS),a.Y36(N.t),a.Y36(P.iu))},O.\u0275cmp=a.Xpm({type:O,selectors:[["j-add-contract-modal"]],viewQuery:function(y,g){if(1&y&&(a.Gf(l,5),a.Gf(p,5)),2&y){let A;a.iGM(A=a.CRH())&&(g.commissionAccountDropdown=A.first),a.iGM(A=a.CRH())&&(g.fileDrop=A.first)}},inputs:{shouldNavigateToContracts:"shouldNavigateToContracts"},decls:43,vars:42,consts:[[1,"modal-body","j-modal-body","p-5"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[3,"hidden"],[1,"add-contract-modal__header"],[1,"btn","btn-outline-primary","add-contract-modal__back-button","mr-3",3,"click"],[3,"inlineSVG"],[1,"m-0"],[1,"add-contract-modal__wrap"],[3,"dropZoneLabel","accept","onFileDrop"],["fileDrop",""],["ngx-file-drop-content-tmp",""],[1,"text-muted","text-center","my-4",3,"innerHTML"],["type","button",1,"btn","btn-primary","btn-block",3,"click"],[3,"isLoading","acceptedFormats","updated"],[1,"form-group"],[3,"isLoading","accounts","label","selected"],["commissionAccountDropdown",""],[1,"commission__helper","text-muted"],[1,"add-contract-modal__footer"],[1,"p4","text-muted",3,"innerHTML"],[1,"add-contract-modal__buttons"],[1,"btn","btn-outline-primary",3,"disabled","click"],[1,"btn","btn-primary",3,"disabled","jLoading","click"],["src","/assets/img/contracts/upload.svg"]],template:function(y,g){1&y&&(a.TgZ(0,"div",0)(1,"button",1),a.NdJ("click",function(){return g.dismissModal()}),a._UZ(2,"img",2),a.ALo(3,"translate"),a.qZA(),a.TgZ(4,"section",3)(5,"div",4)(6,"button",5),a.NdJ("click",function(){return g.dismissModal()}),a._UZ(7,"span",6),a.qZA(),a.TgZ(8,"h5",7),a._uU(9),a.ALo(10,"translate"),a.qZA()(),a.TgZ(11,"div",8)(12,"ngx-file-drop",9,10),a.NdJ("onFileDrop",function(U){return g.onFileDrop(U)}),a.ALo(14,"translate"),a.YNc(15,_,1,0,"ng-template",11),a.qZA(),a._UZ(16,"p",12),a.ALo(17,"translate"),a.TgZ(18,"button",13),a.NdJ("click",function(){return g.openFileSelector()}),a._uU(19),a.ALo(20,"translate"),a.qZA()()(),a.TgZ(21,"section",3)(22,"div",4)(23,"h5",7),a._uU(24),a.ALo(25,"translate"),a.qZA()(),a.TgZ(26,"j-uploading-files",14),a.NdJ("updated",function(U){return g.onUploadingFilesUpdate(U)}),a.qZA(),a.TgZ(27,"div",15)(28,"j-account-dropdown",16,17),a.NdJ("selected",function(U){return g.onCommissionAccountSelect(U)}),a.qZA(),a.TgZ(30,"small",18),a._uU(31),a.ALo(32,"translate"),a.qZA()(),a.TgZ(33,"div",19),a._UZ(34,"p",20),a.ALo(35,"translate"),a.qZA(),a.TgZ(36,"div",21)(37,"button",22),a.NdJ("click",function(){return g.openFileSelector()}),a._uU(38),a.ALo(39,"translate"),a.qZA(),a.TgZ(40,"button",23),a.NdJ("click",function(){return g.submitFiles()}),a._uU(41),a.ALo(42,"translate"),a.qZA()()()()),2&y&&(a.xp6(2),a.s9C("alt",a.lcZ(3,22,"SHARED.CLOSE")),a.xp6(2),a.Q6J("hidden",g.uploadingFiles.length>0),a.xp6(3),a.Q6J("inlineSVG","assets/icons/arrow-left.svg"),a.xp6(2),a.hij(" ",a.lcZ(10,24,g.mapTranslate("HEADING"))," "),a.xp6(3),a.Q6J("dropZoneLabel",a.lcZ(14,26,g.mapTranslate("UPLOAD")))("accept",g.acceptedFormats),a.xp6(4),a.Q6J("innerHTML",a.lcZ(17,28,g.mapTranslate("DESCRIPTION")),a.oJD),a.xp6(3),a.hij(" ",a.lcZ(20,30,g.mapTranslate("UPLOAD"))," "),a.xp6(2),a.Q6J("hidden",0==g.uploadingFiles.length),a.xp6(3),a.hij(" ",a.lcZ(25,32,g.mapTranslate("UPLOADED_HEADING"))," "),a.xp6(2),a.Q6J("isLoading",g.isLoading)("acceptedFormats",g.acceptedFormats),a.xp6(2),a.Q6J("isLoading",g.isAccountsLoading)("accounts",g.accounts)("label",g.mapTranslate("COMMISSION_ACCOUNT")),a.xp6(3),a.Oqu(a.lcZ(32,34,g.mapTranslate("COMMISSION_HELPER"))),a.xp6(3),a.Q6J("innerHTML",a.lcZ(35,36,g.mapTranslate("AGREEMENT")),a.oJD),a.xp6(3),a.Q6J("disabled",g.isLoading),a.xp6(1),a.hij(" ",a.lcZ(39,38,g.mapTranslate("UPLOAD_FILE"))," "),a.xp6(2),a.Q6J("disabled",g.isLoading)("jLoading",g.isLoading),a.xp6(1),a.hij(" ",a.lcZ(42,40,g.submitLabel)," "))},directives:[t.d$,Z.CB,Z.L9,w.z,u.S,x.T],pipes:[c.X$],styles:[":host{position:relative}.add-contract-modal__file-selector{border-radius:30px;border:0;background:none;outline:0;width:100%;height:100%}.commission__helper{margin-top:-12px;display:block}ngx-file-drop .ngx-file-drop__drop-zone{border-radius:30px!important;border:0!important;background-image:url(/assets/img/contracts/dropzone.svg);width:335px;height:165px!important;display:flex;align-items:center;justify-content:center;transition:all .2s ease-in-out}ngx-file-drop .ngx-file-drop__drop-zone:hover,ngx-file-drop .ngx-file-drop__drop-zone--over{background-color:#f5f9fd!important}ngx-file-drop .ngx-file-drop__content{border-radius:30px!important;width:335px!important;height:165px!important}.add-contract-modal__header{display:flex;align-items:center}.add-contract-modal__header h5{font-size:22px}.add-contract-modal__back-button{width:40px;height:40px;padding:0;display:flex;align-items:center;justify-content:center}.add-contract-modal__wrap{padding:50px 0 0;max-width:360px;margin:0 auto;display:flex;flex-direction:column;align-items:center;justify-content:center}.add-contract-modal__close{position:absolute;right:24px;top:24px}.modal-body{position:relative}.add-contract-modal__footer{padding-top:20px;border-top:1px solid rgba(183,190,197,.5)}.add-contract-modal__footer p{line-height:18px}.add-contract-modal__buttons{display:grid;grid-column-gap:12px;column-gap:12px;grid-template-columns:repeat(2,calc(50% - 6px))}.add-contract-modal__buttons .btn{padding-left:0;padding-right:0}\n"],encapsulation:2}),O})()},4336:(J,I,r)=>{r.d(I,{N:()=>b});var s=r(70655),v=r(32146),d=r(5e3),a=r(40703),E=r(7505),f=r(89854),S=r(85814);let b=(()=>{class N{constructor(t,Z){this.modal=t,this.contractsService=Z,this.isLoading=!1}ngOnInit(){this.errorText=this.error.code===v.S.FORBIDDEN?"CONTRACTS.ERROR_MODAL.FORBIDDEN":"CONTRACTS.ERROR_MODAL.GENERAL"}submitContracts(){return(0,s.mG)(this,void 0,void 0,function*(){this.isLoading=!0;try{yield this.contractsService.submitContracts(this.uploadingFiles,this.iban),this.closeModal()}catch(t){}finally{this.isLoading=!1}})}dismissModal(){this.modal.dismiss()}closeModal(){this.modal.close()}}return N.\u0275fac=function(t){return new(t||N)(d.Y36(a.Kz),d.Y36(E.W))},N.\u0275cmp=d.Xpm({type:N,selectors:[["j-contract-error-modal"]],inputs:{description:"description",error:"error",iban:"iban",uploadingFiles:"uploadingFiles"},decls:16,vars:12,consts:[[1,"modal-body","j-modal-body","text-center","contract-modal__body"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","my-2"],[1,"m-0","text-muted"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-primary","btn-block","mb-3",3,"disabled","jLoading","click"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"disabled","click"]],template:function(t,Z){1&t&&(d.TgZ(0,"div",0)(1,"button",1),d.NdJ("click",function(){return Z.dismissModal()}),d._UZ(2,"img",2),d.ALo(3,"translate"),d.qZA(),d._UZ(4,"img",3),d.ALo(5,"translate"),d.TgZ(6,"h3",4),d._uU(7," SHARED.ERROR "),d.qZA(),d.TgZ(8,"p",5),d._uU(9),d.ALo(10,"translate"),d.qZA()(),d.TgZ(11,"div",6)(12,"button",7),d.NdJ("click",function(){return Z.submitContracts()}),d._uU(13," SHARED.TRY_AGAIN "),d.qZA(),d.TgZ(14,"button",8),d.NdJ("click",function(){return Z.dismissModal()}),d._uU(15," SHARED.BACK_TO_HOME "),d.qZA()()),2&t&&(d.xp6(2),d.s9C("alt",d.lcZ(3,6,"SHARED.CLOSE")),d.xp6(2),d.s9C("alt",d.lcZ(5,8,"SHARED.ERROR")),d.xp6(5),d.hij(" ",d.lcZ(10,10,Z.errorText)," "),d.xp6(3),d.Q6J("disabled",Z.isLoading)("jLoading",Z.isLoading),d.xp6(2),d.Q6J("disabled",Z.isLoading))},directives:[f.Pi,S.T],pipes:[f.X$],styles:[".contract-modal__body[_ngcontent-%COMP%]{padding:56px 32px 0}"]}),N})()},82131:(J,I,r)=>{r.d(I,{r:()=>E});var s=r(5e3),v=r(40703),d=r(26164),a=r(89854);let E=(()=>{class f{constructor(b,N){this.modal=b,this.companyService=N}ngOnInit(){this.mapDescription()}dismissModal(){this.modal.dismiss()}closeModal(){this.modal.close()}mapDescription(){this.description=this.companyService.isSecondaryAuthority()?this.mapTranslate("SENT_FOR_PRIMARY_SIGN"):this.companyService.isPrimaryAuthority()&&this.companyService.isSingleSignScheme()?this.mapTranslate("SENT_FOR_CHECK"):this.mapTranslate("SENT_FOR_SIGN")}mapTranslate(b){return`CONTRACTS.SUCCESS_MODAL.${b}`}}return f.\u0275fac=function(b){return new(b||f)(s.Y36(v.Kz),s.Y36(d.J))},f.\u0275cmp=s.Xpm({type:f,selectors:[["j-contract-success-modal"]],decls:12,vars:6,consts:[[1,"modal-body","j-modal-body","text-center","contract-modal__body"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],["src","/assets/img/history/modals/success.svg"],["translate","",1,"light","mb-3","mt-2"],[1,"p2","mb-0",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"]],template:function(b,N){1&b&&(s.TgZ(0,"div",0)(1,"button",1),s.NdJ("click",function(){return N.dismissModal()}),s._UZ(2,"img",2),s.ALo(3,"translate"),s.qZA(),s._UZ(4,"img",3),s.TgZ(5,"h3",4),s._uU(6," CONTRACTS.SUCCESS_MODAL.TITLE "),s.qZA(),s._UZ(7,"p",5),s.ALo(8,"translate"),s.qZA(),s.TgZ(9,"div",6)(10,"button",7),s.NdJ("click",function(){return N.closeModal()}),s._uU(11," SHARED.CLOSE "),s.qZA()()),2&b&&(s.xp6(2),s.s9C("alt",s.lcZ(3,2,"SHARED.CLOSE")),s.xp6(5),s.Q6J("innerHTML",s.lcZ(8,4,N.description),s.oJD))},directives:[a.Pi],pipes:[a.X$],styles:[".contract-modal__body[_ngcontent-%COMP%]{padding-top:56px;padding-bottom:0}"]}),f})()},71811:(J,I,r)=>{r.d(I,{G:()=>s});var s=(()=>{return(v=s||(s={})).ON_SIGN="on-sign",v.APPROVED="approved",v.PENDING="pending",v.REJECTED="rejected",s;var v})()},7505:(J,I,r)=>{r.d(I,{W:()=>u});var s=r(70655),v=r(40520),d=r(8929),a=r(71764),E=r.n(a),f=r(90593),S=r(71811),b=r(5e3),N=r(26164),P=r(82524),t=r(9661),Z=r(82499),w=r(59516);let u=(()=>{class x{constructor(l,p,_,C,F,O){this.companyService=l,this.apiService=p,this.filesService=_,this.listService=C,this.router=F,this.httpClient=O,this.contractsSubmitted$=new d.xQ}getContractsSubmitted(){return this.contractsSubmitted$.asObservable()}mapRemainderMessage(l){var p;return(null===(p=l.remainder)||void 0===p?void 0:p.amount)<=0?"AMOUNT_CLOSED":E()().isAfter(l.dateTo,"date")?"HAS_EXPIRED":null}submitContracts(l,p,_=!1){return(0,s.mG)(this,void 0,void 0,function*(){const C=this.mapApiUrl(),F={commissionWithdrawalIban:p,attachments:l.filter(R=>!R.error&&R.file).map(R=>({fileId:R.file.id}))},O=yield this.apiService.post(C,F);if(yield this.checkAndSignIfNeeded(O),this.contractsSubmitted$.next(),_){let R="contracts/outcoming/";this.companyService.isPrimaryAuthority()&&this.companyService.isSingleSignScheme()?R+=S.G.PENDING:R+=S.G.ON_SIGN,this.router.navigateByUrl(R)}return O})}getContracts(l=null,p=null){const _=this.mapApiUrl();let C=new v.LE;if(C=C.set("fetchAttachments","true"),p)for(const F in p)if(Object.hasOwnProperty.call(p,F)){const O=p[F];O&&(C=C.append(F,O))}switch(l){case S.G.ON_SIGN:C=C.append("status",f.J.ON_SIGN);break;case S.G.APPROVED:C=C.append("status",f.J.REGED);break;case S.G.PENDING:C=C.append("status",f.J.REGISTERED),C=C.append("status",f.J.PROCESSING);break;case S.G.REJECTED:C=C.append("status",f.J.REJECTED)}return this.apiService.get(_,null,C)}getContractCertificate(l){return(0,s.mG)(this,void 0,void 0,function*(){const p=this.mapApiUrl(`${l}/certificate`);let _=new v.WM;return _=_.set("Accept-File","application/pdf"),_=_.set("Content-Type","application/octet-stream"),this.apiService.get(p,_,null,{responseType:"blob"})})}downloadContractCertificate(l){return(0,s.mG)(this,void 0,void 0,function*(){const p=yield this.getContractCertificate(l.id);return yield this.filesService.downloadFile(p,`${l.contractor.name}.pdf`),!0})}sign(l){return this.listService.sign("fx-contracts",l.id)}checkAndSignIfNeeded(l){return(0,s.mG)(this,void 0,void 0,function*(){if(this.companyService.isSecondaryAuthority()||this.companyService.isPrimaryAuthority()&&this.companyService.isSingleSignScheme()){const p=yield this.sign(l);if(!p)throw!1;return p}})}getContractById(l){return(0,s.mG)(this,void 0,void 0,function*(){const p=this.mapApiUrl(l);return this.apiService.get(p)})}getContractByIdObservable(l){const p=this.mapApiUrl(l);return this.apiService.getObservable(p)}mapApiUrl(l=null){return`companies/${this.companyService.currentId}/fx-contracts${l?`/${l}`:""}`}}return x.\u0275fac=function(l){return new(l||x)(b.LFG(N.J),b.LFG(P.sM),b.LFG(t.nS),b.LFG(Z.X),b.LFG(w.F0),b.LFG(v.eN))},x.\u0275prov=b.Yz7({token:x,factory:x.\u0275fac,providedIn:"root"}),x})()},1241:(J,I,r)=>{r.d(I,{T:()=>P,W:()=>s.W});var s=r(7505),v=r(70655),d=r(15057),a=r(55187),E=r(4336),f=r(82131),S=r(5e3),b=r(40703),N=r(9661);let P=(()=>{class t{constructor(w,u,x){this.modalService=w,this.jModalService=u,this.featureFlagsService=x}showAddContractModal(w=!1){return(0,v.mG)(this,void 0,void 0,function*(){if(yield this.featureFlagsService.isDisabledPromise(d.Y.FX_CONTRACTS))return void this.jModalService.showMaintenanceModal();const x=this.modalService.open(a.W,{backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",centered:!0});x.componentInstance.shouldNavigateToContracts=w;try{yield x.result,this.showSuccessModal()}catch({error:c,uploadingFiles:l,iban:p}){l&&this.showErrorModal(c,l,p)}})}showSuccessModal(){this.modalService.open(f.r,{backdropClass:"backdrop_light",windowClass:"modal_light modal_sm",centered:!0})}showErrorModal(w,u,x){return(0,v.mG)(this,void 0,void 0,function*(){const c=this.modalService.open(E.N,{backdropClass:"backdrop_light",windowClass:"modal_light modal_sm",centered:!0});c.componentInstance.iban=x,c.componentInstance.uploadingFiles=u,c.componentInstance.error=w;try{yield c.result,this.showSuccessModal()}catch(l){}})}}return t.\u0275fac=function(w){return new(w||t)(S.LFG(b.FF),S.LFG(N.OP),S.LFG(d.a))},t.\u0275prov=S.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},90593:(J,I,r)=>{r.d(I,{J:()=>v});var v=(()=>{return(d=v||(v={})).PROCESSING="PROCESSING",d.REGISTERED="REGISTERED",d.REGED="REGED",d.REJECTED="REJECTED",d.CLOSED="CLOSED",d.ON_SIGN="ON_SIGN",v;var d})()},13500:(J,I,r)=>{r.d(I,{CB:()=>Z,L9:()=>t,Yi:()=>w});var s=r(5e3),v=r(98723),d=r(69808);const a=["fileSelector"];function E(u,x){if(1&u&&(s.TgZ(0,"div",8),s._uU(1),s.qZA()),2&u){const c=s.oxw(2);s.xp6(1),s.Oqu(c.dropZoneLabel)}}function f(u,x){if(1&u){const c=s.EpF();s.TgZ(0,"div")(1,"input",9),s.NdJ("click",function(p){return s.CHM(c),s.oxw(2).openFileSelector(p)}),s.qZA()()}if(2&u){const c=s.oxw(2);s.xp6(1),s.s9C("value",c.browseBtnLabel),s.Q6J("className",c.browseBtnClassName)}}function S(u,x){if(1&u&&(s.YNc(0,E,2,1,"div",6),s.YNc(1,f,2,2,"div",7)),2&u){const c=s.oxw();s.Q6J("ngIf",c.dropZoneLabel),s.xp6(1),s.Q6J("ngIf",c.showBrowseBtn)}}function b(u,x){}const N=function(u){return{openFileSelector:u}};class P{constructor(x,c){this.relativePath=x,this.fileEntry=c}}let t=(()=>{class u{constructor(c){this.template=c}}return u.\u0275fac=function(c){return new(c||u)(s.Y36(s.Rgc))},u.\u0275dir=s.lG2({type:u,selectors:[["","ngx-file-drop-content-tmp",""]]}),u})(),Z=(()=>{class u{constructor(c,l){this.zone=c,this.renderer=l,this.accept="*",this.directory=!1,this.multiple=!0,this.dropZoneLabel="",this.dropZoneClassName="ngx-file-drop__drop-zone",this.useDragEnter=!1,this.contentClassName="ngx-file-drop__content",this.showBrowseBtn=!1,this.browseBtnClassName="btn btn-primary btn-xs ngx-file-drop__browse-btn",this.browseBtnLabel="Browse files",this.onFileDrop=new s.vpe,this.onFileOver=new s.vpe,this.onFileLeave=new s.vpe,this.isDraggingOverDropZone=!1,this.globalDraggingInProgress=!1,this.files=[],this.numOfActiveReadEntries=0,this.helperFormEl=null,this.fileInputPlaceholderEl=null,this.dropEventTimerSubscription=null,this._disabled=!1,this.openFileSelector=p=>{this.fileSelector&&this.fileSelector.nativeElement&&this.fileSelector.nativeElement.click()},this.globalDragStartListener=this.renderer.listen("document","dragstart",p=>{this.globalDraggingInProgress=!0}),this.globalDragEndListener=this.renderer.listen("document","dragend",p=>{this.globalDraggingInProgress=!1})}get disabled(){return this._disabled}set disabled(c){this._disabled=null!=c&&"false"!=`${c}`}ngOnDestroy(){this.dropEventTimerSubscription&&(this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=null),this.globalDragStartListener(),this.globalDragEndListener(),this.files=[],this.helperFormEl=null,this.fileInputPlaceholderEl=null}onDragOver(c){this.useDragEnter?(this.preventAndStop(c),c.dataTransfer&&(c.dataTransfer.dropEffect="copy")):!this.isDropzoneDisabled()&&!this.useDragEnter&&c.dataTransfer&&(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(c)),this.preventAndStop(c),c.dataTransfer.dropEffect="copy")}onDragEnter(c){!this.isDropzoneDisabled()&&this.useDragEnter&&(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(c)),this.preventAndStop(c))}onDragLeave(c){this.isDropzoneDisabled()||(this.isDraggingOverDropZone&&(this.isDraggingOverDropZone=!1,this.onFileLeave.emit(c)),this.preventAndStop(c))}dropFiles(c){if(!this.isDropzoneDisabled()&&(this.isDraggingOverDropZone=!1,c.dataTransfer)){let l;l=c.dataTransfer.items?c.dataTransfer.items:c.dataTransfer.files,this.preventAndStop(c),this.checkFiles(l)}}uploadFiles(c){!this.isDropzoneDisabled()&&c.target&&(this.checkFiles(c.target.files||[]),this.resetFileInput())}checkFiles(c){for(let l=0;l<c.length;l++){const p=c[l];let _=null;if(this.canGetAsEntry(p)&&(_=p.webkitGetAsEntry()),_)if(_.isFile){const C=new P(_.name,_);this.addToQueue(C)}else _.isDirectory&&this.traverseFileTree(_,_.name);else if(p){const C={name:p.name,isDirectory:!1,isFile:!0,file:O=>O(p)},F=new P(C.name,C);this.addToQueue(F)}}this.dropEventTimerSubscription&&this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=(0,v.H)(200,200).subscribe(()=>{if(this.files.length>0&&0===this.numOfActiveReadEntries){const l=this.files;this.files=[],this.onFileDrop.emit(l)}})}traverseFileTree(c,l){if(c.isFile){const p=new P(l,c);this.files.push(p)}else{l+="/";const p=c.createReader();let _=[];const C=()=>{this.numOfActiveReadEntries++,p.readEntries(F=>{if(F.length)_=_.concat(F),C();else if(0===_.length){const O=new P(l,c);this.zone.run(()=>{this.addToQueue(O)})}else for(let O=0;O<_.length;O++)this.zone.run(()=>{this.traverseFileTree(_[O],l+_[O].name)});this.numOfActiveReadEntries--})};C()}}resetFileInput(){if(this.fileSelector&&this.fileSelector.nativeElement){const c=this.fileSelector.nativeElement,l=c.parentElement,p=this.getHelperFormElement(),_=this.getFileInputPlaceholderElement();l!==p&&(this.renderer.insertBefore(l,_,c),this.renderer.appendChild(p,c),p.reset(),this.renderer.insertBefore(l,c,_),this.renderer.removeChild(l,_))}}getHelperFormElement(){return this.helperFormEl||(this.helperFormEl=this.renderer.createElement("form")),this.helperFormEl}getFileInputPlaceholderElement(){return this.fileInputPlaceholderEl||(this.fileInputPlaceholderEl=this.renderer.createElement("div")),this.fileInputPlaceholderEl}canGetAsEntry(c){return!!c.webkitGetAsEntry}isDropzoneDisabled(){return this.globalDraggingInProgress||this.disabled}addToQueue(c){this.files.push(c)}preventAndStop(c){c.stopPropagation(),c.preventDefault()}}return u.\u0275fac=function(c){return new(c||u)(s.Y36(s.R0b),s.Y36(s.Qsj))},u.\u0275cmp=s.Xpm({type:u,selectors:[["ngx-file-drop"]],contentQueries:function(c,l,p){if(1&c&&s.Suo(p,t,5,s.Rgc),2&c){let _;s.iGM(_=s.CRH())&&(l.contentTemplate=_.first)}},viewQuery:function(c,l){if(1&c&&s.Gf(a,7),2&c){let p;s.iGM(p=s.CRH())&&(l.fileSelector=p.first)}},inputs:{accept:"accept",directory:"directory",multiple:"multiple",dropZoneLabel:"dropZoneLabel",dropZoneClassName:"dropZoneClassName",useDragEnter:"useDragEnter",contentClassName:"contentClassName",showBrowseBtn:"showBrowseBtn",browseBtnClassName:"browseBtnClassName",browseBtnLabel:"browseBtnLabel",disabled:"disabled"},outputs:{onFileDrop:"onFileDrop",onFileOver:"onFileOver",onFileLeave:"onFileLeave"},decls:7,vars:15,consts:[[3,"className","drop","dragover","dragenter","dragleave"],[3,"className"],["type","file",1,"ngx-file-drop__file-input",3,"accept","multiple","change"],["fileSelector",""],["defaultContentTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","ngx-file-drop__drop-zone-label",4,"ngIf"],[4,"ngIf"],[1,"ngx-file-drop__drop-zone-label"],["type","button",3,"className","value","click"]],template:function(c,l){if(1&c&&(s.TgZ(0,"div",0),s.NdJ("drop",function(_){return l.dropFiles(_)})("dragover",function(_){return l.onDragOver(_)})("dragenter",function(_){return l.onDragEnter(_)})("dragleave",function(_){return l.onDragLeave(_)}),s.TgZ(1,"div",1)(2,"input",2,3),s.NdJ("change",function(_){return l.uploadFiles(_)}),s.qZA(),s.YNc(4,S,2,2,"ng-template",null,4,s.W1O),s.YNc(6,b,0,0,"ng-template",5),s.qZA()()),2&c){const p=s.MAs(5);s.ekj("ngx-file-drop__drop-zone--over",l.isDraggingOverDropZone),s.Q6J("className",l.dropZoneClassName),s.xp6(1),s.Q6J("className",l.contentClassName),s.xp6(1),s.Q6J("accept",l.accept)("multiple",l.multiple),s.uIk("directory",l.directory||void 0)("webkitdirectory",l.directory||void 0)("mozdirectory",l.directory||void 0)("msdirectory",l.directory||void 0)("odirectory",l.directory||void 0),s.xp6(4),s.Q6J("ngTemplateOutlet",l.contentTemplate||p)("ngTemplateOutletContext",s.VKq(13,N,l.openFileSelector))}},directives:[d.O5,d.tP],styles:[".ngx-file-drop__drop-zone[_ngcontent-%COMP%]{border:2px dotted #0782d0;border-radius:30px;height:100px;margin:auto}.ngx-file-drop__drop-zone--over[_ngcontent-%COMP%]{background-color:hsla(0,0%,57.6%,.5)}.ngx-file-drop__content[_ngcontent-%COMP%]{align-items:center;color:#0782d0;display:flex;height:100px;justify-content:center}.ngx-file-drop__drop-zone-label[_ngcontent-%COMP%]{text-align:center}.ngx-file-drop__file-input[_ngcontent-%COMP%]{display:none}"]}),u})(),w=(()=>{class u{}return u.\u0275fac=function(c){return new(c||u)},u.\u0275mod=s.oAB({type:u,bootstrap:function(){return[Z]}}),u.\u0275inj=s.cJS({providers:[],imports:[[d.ez]]}),u})()}}]);
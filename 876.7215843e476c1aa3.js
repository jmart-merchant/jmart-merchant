"use strict";(self.webpackChunkjysan=self.webpackChunkjysan||[]).push([[876],{98876:(ai,Xt,u)=>{u.r(Xt),u.d(Xt,{PaymentsModule:()=>ii});var b=u(69808),d=u(93075),B=u(46805),R=u(40703),E=u(89854),je=u(23918),q=u(56104),De=u(93241),we=u(91995),Fe=u(31259),Je=u(62994),Z=u(59516),P=u(38114),D=u(8491),W=u(49653),zt=u(54702),mt=u(11685),M=u(24850),t=u(5e3),te=u(77501),X=u(28706),ee=u(79311),ne=u(94114),oe=u(61459),U=u(70655),v=u(591),re=u(8929),N=u(36053),vt=u(21086),Dt=u(68896),Be=u(5254),S=u(75778),J=u(80013),gt=u(1059),se=u(87168),qe=u(18583),wt=u(87545),Qe=u(27221),Et=u(92198),z=u(2994),$e=u(72986),O=u(7102),Ve=u(90593),x=u(80457),pt=u(31475),Ge=u(83485),Ft=u(47755),Jt=u(98316),j=u(15057),Ct=u(60078),C=u(7500),tt=u(23343),ie=u(84722),He=u(60348),Ke=u(29616),et=u(26484),dt=u(9010),nt=u(65212),Q=u(19208),We=u(57720),ae=u(1241),ot=u(27763);let ce=(()=>{class n{constructor(e){this.el=e,this.containerEl=this.el.nativeElement}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.SBq))},n.\u0275dir=t.lG2({type:n,selectors:[["","jInvalidControlScrollContainer",""]]}),n})(),$=(()=>{class n{constructor(e,o,r,s){this.el=e,this.formGroupDir=o,this.window=r,this.scrollContainerDir=s}get containerEl(){return this.scrollContainerDir?this.scrollContainerDir.containerEl:this.window}onSubmit(e){this.formGroupDir.invalid&&this.scrollToFirstInvalidControl()}scrollToFirstInvalidControl(){const e=this.el.nativeElement.querySelector(".ng-invalid");e&&this.containerEl.scroll({top:this.getTopOffset(e),left:0,behavior:"smooth"})}getTopOffset(e){const r=null==e?void 0:e.getBoundingClientRect().top;if(r&&this.containerEl instanceof HTMLElement){const s=this.containerEl.getBoundingClientRect().top;return r+this.containerEl.scrollTop-s-50}return r+this.window.scrollY-50}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.SBq),t.Y36(d.sg),t.Y36(Window),t.Y36(ce,8))},n.\u0275dir=t.lG2({type:n,selectors:[["","jInvalidControlScroll",""]],hostBindings:function(e,o){1&e&&t.NdJ("ngSubmit",function(){return o.onSubmit()})}}),n})();var Y=u(66821),rt=u(70853),st=u(46755),le=u(85814),V=u(82699),it=u(86984),at=u(91319),w=u(2757),Nt=u(72159),Rt=u(35803),ue=u(32534),ct=u(61235),G=u(23601),Xe=u(87732),At=u(11586),yt=u(67089),Bt=u(69544),qt=u(22695),lt=u(49364),Zt=u(15191),St=u(81907),ut=u(23513),me=u(95017),pe=u(32902),ze=u(67997);const tn=["emailOnSuccess"],en=["senderAccountDropdown"],nn=["contractsSelect"],on=["contractDetails"],rn=["bankDropdown"],sn=["intermediaryBankDropdown"],an=["commissionAccountDropdown"],cn=["rubNonRussiaBankDropdown"],ln=["rubNonRussiaCorrespondentBankDropdown"],un=["rubNonRussiaCorrespondentIbanInput"];function mn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"j-restricted-placeholder",2),t.NdJ("retried",function(){return t.CHM(e),t.oxw().updatePermissions()}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("isRetryable",e.isPermissionsUpdateAllowed)("isLoading",e.isPermissionsUpdating)}}function pn(n,i){if(1&n&&(t.TgZ(0,"div",73),t._UZ(1,"small",74),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.ekj("is-loading",e.isContractsDescriptionLoading),t.Q6J("jLoading",e.isContractsDescriptionLoading)("jLoadingInverted",!0),t.xp6(1),t.Q6J("innerHTML",t.xi3(2,5,"CURRENCY_PAYMENT.CONTRACTS.SWITCH.DESCRIPTION",e.contractsSwitchDescriptionParams),t.oJD)}}function dn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",84),t.NdJ("click",function(){return t.CHM(e),t.oxw(5).openContractsAddingModal()}),t.TgZ(1,"span",13),t._uU(2," CURRENCY_PAYMENT.CONTRACTS.ADD_NEW "),t.qZA()()}}function _n(n,i){if(1&n&&(t.TgZ(0,"div",82),t.YNc(1,dn,3,0,"button",83),t.TgZ(2,"h6",13),t._uU(3,"CURRENCY_PAYMENT.CONTRACTS.TITLE"),t.qZA()()),2&n){const e=t.oxw(4);t.xp6(1),t.Q6J("ngIf",e.filteredContracts.length>0)}}function fn(n,i){if(1&n&&t.YNc(0,_n,4,1,"div",81),2&n){const e=i.searchTerm,o=t.oxw(3);t.Q6J("ngIf",!e&&!o.isContractsLoading)}}function hn(n,i){if(1&n&&(t.TgZ(0,"div",85)(1,"div",86)(2,"span"),t._uU(3),t.qZA(),t._UZ(4,"j-money",87),t.qZA(),t.TgZ(5,"div",88)(6,"span"),t._uU(7),t.qZA(),t.TgZ(8,"div"),t._UZ(9,"span",89),t._uU(10,"\xa0 "),t._UZ(11,"j-money",87),t.qZA()()()),2&n){const e=i.item;t.xp6(3),t.Oqu(e.contractor.name),t.xp6(1),t.Q6J("money",e.amount),t.xp6(3),t.Oqu(e.contractNumber),t.xp6(4),t.Q6J("money",e.remainder)}}function gn(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",90),t._UZ(2,"img",91)(3,"div",92),t.ALo(4,"translate"),t.TgZ(5,"a",93),t.NdJ("click",function(r){return t.CHM(e),t.oxw(4).openContractsAddingModal(r)}),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.BQk()}2&n&&(t.xp6(3),t.Q6J("innerHTML",t.lcZ(4,2,"CURRENCY_PAYMENT.CONTRACTS.EMPTY_STATE"),t.oJD),t.xp6(3),t.hij(" ",t.lcZ(7,4,"CURRENCY_PAYMENT.CONTRACTS.ADD_NEW")," "))}function Cn(n,i){if(1&n){const e=t.EpF();t.ynx(0),t._UZ(1,"j-empty-placeholder",94),t.TgZ(2,"div",95)(3,"a",96),t.NdJ("click",function(r){return t.CHM(e),t.oxw(4).openContractsAddingModal(r)}),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.BQk()}2&n&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"CURRENCY_PAYMENT.CONTRACTS.ADD_NEW")," "))}function An(n,i){if(1&n&&(t.YNc(0,gn,8,6,"ng-container",1),t.YNc(1,Cn,6,3,"ng-container",1)),2&n){const e=t.oxw(3);t.Q6J("ngIf",0==e.contracts.length),t.xp6(1),t.Q6J("ngIf",e.contracts.length>0)}}function yn(n,i){if(1&n&&t._uU(0),2&n){const e=i.item,o=t.oxw(3);t.hij(" ",o.mapContractLabel(e||o.form.controls.contract.value)," ")}}function Tn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"a",97),t.NdJ("click",function(r){return t.CHM(e),t.oxw(3).showContractDetails(r)}),t._uU(1,"CURRENCY_PAYMENT.CONTRACTS.SHOW_DETAILS"),t.qZA()}}function bn(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",75)(2,"j-form-field",null,76)(4,"j-label",13),t._uU(5,"CURRENCY_PAYMENT.RECIPIENT.CONTRACT"),t.qZA(),t.TgZ(6,"j-select",77,78),t.NdJ("change",function(r){return t.CHM(e),t.oxw(2).onContractSelect(r)}),t.YNc(8,fn,1,1,"ng-template",40),t.YNc(9,hn,12,4,"ng-template",26),t.YNc(10,An,2,2,"ng-template",79),t.YNc(11,yn,1,1,"ng-template",27),t.qZA(),t.YNc(12,Tn,2,0,"a",80),t._UZ(13,"j-error",28),t.qZA()(),t.BQk()}if(2&n){const e=t.MAs(3),o=t.MAs(7),r=t.oxw(2);t.xp6(6),t.Q6J("loading",r.isContractsLoading)("appendTo",e.elementRef.nativeElement)("jFocusOnReturn",o)("formControl",r.form.controls.contractId)("clearable",!1)("searchFn",r.contractComparator)("items",r.filteredContracts),t.xp6(6),t.Q6J("ngIf",r.isContractSelected),t.xp6(1),t.Q6J("control",r.form.controls.contractId)("errorMessages",r.errors.contractId)}}function xn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",98),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).openForeignContractsRecipientsDictionary()}),t.qZA()}}function vn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",99),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).openForeignRecipientsDictionary()}),t.qZA()}}function En(n,i){if(1&n&&(t.TgZ(0,"div",100),t._uU(1),t.qZA()),2&n){const e=i.item,o=t.oxw(2);t.xp6(1),t.hij(" ",o.mapCountryLabel(e)," ")}}function Nn(n,i){if(1&n&&t._uU(0),2&n){const e=i.item;t.oxw();const o=t.MAs(33),r=t.oxw();t.hij(" ",o.focused?"":r.mapCountryLabel(e)," ")}}function Rn(n,i){if(1&n&&(t.TgZ(0,"div",20)(1,"j-form-field")(2,"j-label"),t._uU(3),t.ALo(4,"translate"),t.ALo(5,"async"),t.qZA(),t._UZ(6,"input",101)(7,"j-error",28),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,7,t.lcZ(5,9,e.cityPlaceholder$))),t.xp6(3),t.Q6J("mask",e.masks.cityName.mask)("dropSpecialCharacters",!1)("maxlength",e.cityMaxLength)("formControl",e.form.controls.cityName),t.xp6(1),t.Q6J("control",e.form.controls.cityName)("errorMessages",e.errors.purpose)}}function Zn(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",102)(2,"div",20)(3,"j-form-field")(4,"j-label",13),t._uU(5,"CURRENCY_PAYMENT.AUD.INDEX"),t.qZA(),t._UZ(6,"input",103),t.qZA()(),t.TgZ(7,"div",20)(8,"j-form-field")(9,"j-label",13),t._uU(10,"CURRENCY_PAYMENT.AUD.STATE"),t.qZA(),t._UZ(11,"input",104),t.qZA()()(),t.TgZ(12,"div",102)(13,"div",20)(14,"j-form-field")(15,"j-label",13),t._uU(16,"CURRENCY_PAYMENT.AUD.BUILDING_NUMBER"),t.qZA(),t._UZ(17,"input",105),t.qZA()(),t.TgZ(18,"div",20)(19,"j-form-field")(20,"j-label",13),t._uU(21,"CURRENCY_PAYMENT.AUD.STREET"),t.qZA(),t._UZ(22,"input",106),t.qZA()()(),t._UZ(23,"hr",107),t.BQk()),2&n){const e=t.oxw(2);t.xp6(6),t.Q6J("formControl",e.form.controls.audIndex),t.xp6(5),t.Q6J("formControl",e.form.controls.audState),t.xp6(6),t.Q6J("formControl",e.form.controls.audBuildingNumber),t.xp6(5),t.Q6J("formControl",e.form.controls.audStreet)}}function Sn(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",20)(2,"j-form-field")(3,"j-label",13),t._uU(4,"CURRENCY_PAYMENT.AUD.ADDRESS"),t.qZA(),t._UZ(5,"input",108),t.qZA()(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(5),t.Q6J("formControl",e.form.controls.audAddress)}}function Pn(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",20)(2,"j-form-field")(3,"j-label",13),t._uU(4,"CURRENCY_PAYMENT.AUD.ADDRESS"),t.qZA(),t._UZ(5,"input",108),t.qZA()(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(5),t.Q6J("formControl",e.form.controls.canAddress)}}function Mn(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",20),t._UZ(2,"j-foreign-bank-select",109,110),t.qZA(),t.TgZ(4,"div",20)(5,"j-form-field",21)(6,"j-label",13),t._uU(7,"CURRENCY_PAYMENT.RECIPIENT.CORRESPONDENT_IBAN"),t.qZA(),t._UZ(8,"input",111,112)(10,"j-error",32),t.qZA()(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("labelText","CURRENCY_PAYMENT.RECIPIENT.CORRESPONDENT_BIC")("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_CORRESPONDENT_BIC_ENTERED")("labelControl",e.form.controls.rubNonRussiaCorrespondentBankLabel)("errorMessages",e.errors.bankSelect)("bankControl",e.form.controls.rubNonRussiaCorrespondentBank),t.xp6(6),t.Q6J("validation",!1)("mask",e.masks.rubNonRussiaCorrespondentIban.mask)("formControl",e.form.controls.rubNonRussiaCorrespondentIban),t.xp6(2),t.Q6J("control",e.form.controls.rubNonRussiaCorrespondentIban)("errorMessages",e.errors.bankAccount)("params",e.ibanParams(e.form.controls.rubNonRussiaCorrespondentIban))}}function In(n,i){if(1&n&&(t.TgZ(0,"div",20)(1,"j-form-field",21)(2,"j-label",13),t._uU(3,"CURRENCY_PAYMENT.RECIPIENT.KBE"),t.qZA(),t._UZ(4,"input",113)(5,"a",114)(6,"j-error",28),t.qZA()()),2&n){t.oxw();const e=t.MAs(148),o=t.oxw();t.xp6(4),t.Q6J("mask",o.masks.kbeCode.mask)("jShadow",o.masks.kbeCode.shadow)("dropSpecialCharacters",!0)("formControl",o.form.controls.kbeCode),t.xp6(1),t.Q6J("ngbTooltip",e)("inlineSVG","/assets/icons/payments/question.svg"),t.xp6(1),t.Q6J("control",o.form.controls.kbeCode)("errorMessages",o.errors.kbeCode)}}function Ln(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",20),t._UZ(2,"j-foreign-bank-select",109,115),t.qZA(),t.TgZ(4,"div",20)(5,"j-form-field")(6,"j-label"),t._uU(7),t.ALo(8,"translate"),t.ALo(9,"async"),t.qZA(),t._UZ(10,"input",101),t.qZA()(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("labelText","CURRENCY_PAYMENT.RECIPIENT.BANK")("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_BIC_ENTERED")("labelControl",e.form.controls.rubNonRussiaBankLabel)("errorMessages",e.errors.bankSelect)("bankControl",e.form.controls.rubNonRussiaBank),t.xp6(5),t.Oqu(t.lcZ(8,10,t.lcZ(9,12,e.cityPlaceholder$))),t.xp6(3),t.Q6J("mask",e.masks.cityName.mask)("dropSpecialCharacters",!1)("maxlength",e.cityMaxLength)("formControl",e.form.controls.cityName)}}function Un(n,i){1&n&&(t.TgZ(0,"div",46),t._uU(1," CURRENCY_PAYMENT.RECIPIENT.BIC_DESCRIPTION "),t.qZA())}function kn(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",20),t._UZ(2,"j-foreign-bank-select",116,117),t.YNc(4,Un,2,0,"div",118),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_BIC_ENTERED")("labelControl",e.form.controls.bankLabel)("errorMessages",e.errors.bankSelect)("bankControl",e.form.controls.bank),t.xp6(2),t.Q6J("ngIf",!e.isBicRequired)}}function On(n,i){if(1&n&&t._UZ(0,"j-foreign-bank-select",122,123),2&n){const e=t.oxw(3);t.Q6J("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_INTERMEDIARY_BIC_ENTERED")("labelControl",e.form.controls.intermediaryBankLabel)("bankControl",e.form.controls.intermediaryBank)("errorMessages",e.errors.bankSelect)}}function Yn(n,i){if(1&n&&(t.TgZ(0,"div",10),t._UZ(1,"j-switch",11),t.TgZ(2,"div",119)(3,"strong",13),t._uU(4,"CURRENCY_PAYMENT.RECIPIENT.SWITCH.TITLE"),t.qZA(),t.YNc(5,On,2,4,"j-foreign-bank-select",120),t.TgZ(6,"small",121),t._uU(7,"CURRENCY_PAYMENT.RECIPIENT.SWITCH.DESCRIPTION"),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("formControl",e.form.controls.hasIntermediaryBank),t.xp6(4),t.Q6J("ngIf",e.hasIntermediaryBank)}}function jn(n,i){if(1&n&&(t.TgZ(0,"div",20)(1,"j-form-field",21)(2,"j-label",13),t._uU(3,"CURRENCY_PAYMENT.RECIPIENT.KIO"),t.qZA(),t._UZ(4,"input",124)(5,"j-error",28),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("mask",e.masks.kio.mask)("dropSpecialCharacters",!1)("formControl",e.form.controls.kio),t.xp6(1),t.Q6J("control",e.form.controls.kio)("errorMessages",e.errors.kio)}}function Dn(n,i){if(1&n&&(t.TgZ(0,"div",20)(1,"j-form-field",21)(2,"j-label",13),t._uU(3,"CURRENCY_PAYMENT.RECIPIENT.KPP"),t.qZA(),t._UZ(4,"input",125)(5,"a",114),t.qZA(),t.TgZ(6,"div",46),t._uU(7," CURRENCY_PAYMENT.RECIPIENT.KPP_DESCRIPTION "),t.qZA()()),2&n){t.oxw();const e=t.MAs(150),o=t.oxw();t.xp6(4),t.Q6J("mask",o.masks.kpp.mask)("jShadow",o.masks.kpp.shadow)("validation",!1)("formControl",o.form.controls.kpp),t.xp6(1),t.Q6J("ngbTooltip",e)("inlineSVG","/assets/icons/payments/question.svg")}}function wn(n,i){if(1&n&&(t.TgZ(0,"div",131)(1,"j-form-field",21)(2,"j-label",13),t._uU(3,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.KIO"),t.qZA(),t._UZ(4,"input",143)(5,"j-error",28),t.qZA(),t.TgZ(6,"j-form-field",21)(7,"j-label",13),t._uU(8,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.KPP"),t.qZA(),t._UZ(9,"input",136)(10,"a",114),t.qZA()()),2&n){t.oxw(2);const e=t.MAs(150),o=t.oxw();t.xp6(4),t.Q6J("formControl",o.form.controls.payerInn),t.xp6(1),t.Q6J("control",o.form.controls.payerInn)("errorMessages",o.errors.payerInn),t.xp6(4),t.Q6J("mask",o.masks.kpp.mask)("jShadow",o.masks.kpp.shadow)("formControl",o.form.controls.payerKpp),t.xp6(1),t.Q6J("ngbTooltip",e)("inlineSVG","/assets/icons/payments/question.svg")}}function Fn(n,i){if(1&n&&(t.TgZ(0,"div",85)(1,"strong"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4," - "),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA()()),2&n){const e=i.item;t.xp6(2),t.Oqu(e.code),t.xp6(4),t.Oqu(e.description)}}function Jn(n,i){1&n&&t._UZ(0,"j-empty-placeholder",144)}function Bn(n,i){if(1&n&&t._uU(0),2&n){const e=i.item;t.oxw();const o=t.MAs(17);t.hij(" ",o.focused?"":e.code+" - "+e.description," ")}}function qn(n,i){if(1&n&&(t.TgZ(0,"div",85)(1,"strong"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4," - "),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA()()),2&n){const e=i.item;t.xp6(2),t.Oqu(e.code),t.xp6(4),t.Oqu(e.description)}}function Qn(n,i){1&n&&t._UZ(0,"j-empty-placeholder",145)}function $n(n,i){if(1&n&&t._uU(0),2&n){const e=i.item;t.oxw();const o=t.MAs(32);t.hij(" ",o.focused?"":e.code+" - "+e.description," ")}}function Vn(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",20)(2,"j-form-field",21)(3,"j-label",13),t._uU(4,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PURPOSE"),t.qZA(),t._UZ(5,"input",136)(6,"a",114),t.qZA()(),t.TgZ(7,"div",20)(8,"j-form-field",21)(9,"j-label",13),t._uU(10,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.TAX_NUMBER"),t.qZA(),t._UZ(11,"input",136),t.qZA()(),t.TgZ(12,"div",131)(13,"div")(14,"j-form-field",21)(15,"j-label",13),t._uU(16,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PERIOD"),t.qZA(),t._UZ(17,"input",146)(18,"a",114),t.qZA(),t.TgZ(19,"div",46),t._uU(20,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PERIOD_DESCRIPTION "),t.qZA()(),t.TgZ(21,"j-form-field",21)(22,"j-label",13),t._uU(23,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.UIP"),t.qZA(),t._UZ(24,"input",147),t.qZA()(),t.BQk()),2&n){t.oxw(2);const e=t.MAs(154),o=t.MAs(156),r=t.oxw();t.xp6(5),t.Q6J("mask",r.masks.paymentBasis.mask)("jShadow",r.masks.paymentBasis.shadow)("formControl",r.form.controls.paymentBasis),t.xp6(1),t.Q6J("ngbTooltip",e)("inlineSVG","/assets/icons/payments/question.svg"),t.xp6(5),t.Q6J("mask",r.masks.budgetDocNumber.mask)("jShadow",r.masks.budgetDocNumber.shadow)("formControl",r.form.controls.budgetDocNumber),t.xp6(6),t.Q6J("mask",r.masks.budgetPeriod.mask)("jShadow",r.masks.budgetPeriod.shadow)("dropSpecialCharacters",!1)("formControl",r.form.controls.budgetPeriod),t.xp6(1),t.Q6J("ngbTooltip",o)("inlineSVG","/assets/icons/payments/question.svg"),t.xp6(6),t.Q6J("formControl",r.form.controls.uip)}}function Gn(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"fieldset",15)(2,"h5",7),t._uU(3,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.TITLE"),t.qZA(),t.TgZ(4,"div",20)(5,"div",126),t._UZ(6,"input",127),t.TgZ(7,"label",128),t._UZ(8,"span",129),t.qZA()()(),t.YNc(9,wn,11,8,"div",130),t.TgZ(10,"div",131,132)(12,"j-form-field",null,133)(14,"j-label",13),t._uU(15,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.KBK"),t.qZA(),t.TgZ(16,"j-select",134,135),t.YNc(18,Fn,7,2,"ng-template",26),t.YNc(19,Jn,1,0,"ng-template",79),t.YNc(20,Bn,1,1,"ng-template",27),t.qZA()(),t.TgZ(21,"j-form-field",21)(22,"j-label",13),t._uU(23,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.OKTMO"),t.qZA(),t._UZ(24,"input",136)(25,"a",114),t.qZA()(),t.TgZ(26,"div",20)(27,"j-form-field",null,137)(29,"j-label",13),t._uU(30,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PAYER_STATUS"),t.qZA(),t.TgZ(31,"j-select",138,139),t.YNc(33,qn,7,2,"ng-template",26),t.YNc(34,Qn,1,0,"ng-template",79),t.YNc(35,$n,1,1,"ng-template",27),t.qZA()()()(),t.TgZ(36,"fieldset",15)(37,"div",20)(38,"div",126),t._UZ(39,"input",140),t.TgZ(40,"label",141),t._UZ(41,"span",142),t.qZA()()(),t.YNc(42,Vn,25,15,"ng-container",1),t.qZA(),t.BQk()),2&n){const e=t.MAs(11),o=t.MAs(17),r=t.MAs(28),s=t.MAs(32);t.oxw();const l=t.MAs(152),c=t.oxw();t.xp6(6),t.Q6J("formControl",c.form.controls.isRussianTaxPayer),t.xp6(3),t.Q6J("ngIf",c.isRussianTaxpayer),t.xp6(7),t.Q6J("loading",c.isKbkLoading)("appendTo",e)("jFocusOnReturn",o)("formControl",c.form.controls.kbk)("clearable",!1)("searchFn",c.kbkComparator)("items",c.kbkList),t.xp6(8),t.Q6J("mask",c.masks.oktmo.mask)("jShadow",c.masks.oktmo.shadow)("formControl",c.form.controls.oktmo),t.xp6(1),t.Q6J("ngbTooltip",l)("inlineSVG","/assets/icons/payments/question.svg"),t.xp6(6),t.Q6J("loading",c.isStatusesLoading)("appendTo",r.elementRef.nativeElement)("jFocusOnReturn",s)("formControl",c.form.controls.payerStatus)("clearable",!1)("searchFn",c.statusComparator)("items",c.statuses),t.xp6(8),t.Q6J("formControl",c.form.controls.hasRussianBudgetExtras),t.xp6(3),t.Q6J("ngIf",c.hasRussianBudgetExtras)}}function Hn(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"button",84),t.NdJ("click",function(r){t.CHM(e),t.oxw(2);const s=t.MAs(89);return t.oxw().openKnpDictionary(s,r)}),t._UZ(2,"span",148),t.TgZ(3,"span",13),t._uU(4," CURRENCY_PAYMENT.DETAILS.KNP.DICTIONARY "),t.qZA()(),t.TgZ(5,"p",149),t._uU(6,"CURRENCY_PAYMENT.DETAILS.KNP.FREQUENT"),t.qZA(),t.TgZ(7,"p",150),t._uU(8,"CURRENCY_PAYMENT.DETAILS.KNP.DESCRIPTION"),t.qZA()()}2&n&&(t.xp6(2),t.Q6J("inlineSVG","/assets/icons/payments/list.svg"))}function Kn(n,i){1&n&&t.YNc(0,Hn,9,1,"div",1),2&n&&t.Q6J("ngIf",!i.searchTerm)}function Wn(n,i){if(1&n&&(t.TgZ(0,"div",20)(1,"j-form-field")(2,"j-label",13),t._uU(3,"CURRENCY_PAYMENT.DETAILS.KVO"),t.qZA(),t._UZ(4,"input",34),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(4),t.Q6J("mask",e.masks.kvo.mask)("formControl",e.form.controls.kvo)}}function Xn(n,i){if(1&n&&(t.TgZ(0,"div",85),t._uU(1),t.qZA()),2&n){const e=i.item,o=t.oxw(3);t.xp6(1),t.hij(" ",o.mapCodeWordLabel(e)," ")}}function zn(n,i){if(1&n&&t._uU(0),2&n){const e=i.item;t.oxw();const o=t.MAs(8),r=t.oxw(2);t.hij(" ",o.focused?"":r.mapCodeWordLabel(e||(null==r.form.controls.codeWord?null:r.form.controls.codeWord.value))," ")}}function to(n,i){if(1&n&&(t.TgZ(0,"div",20)(1,"j-form-field",null,151)(3,"j-label"),t._uU(4),t.ALo(5,"translate"),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"j-select",134,152),t.YNc(9,Xn,2,1,"ng-template",26),t.YNc(10,zn,1,1,"ng-template",27),t.qZA()()()),2&n){const e=t.MAs(2),o=t.MAs(8),r=t.oxw(2);t.xp6(4),t.Oqu(t.lcZ(5,8,t.lcZ(6,10,r.codeWordLabel$))),t.xp6(3),t.Q6J("loading",r.isCodeWordsLoading)("appendTo",e.elementRef.nativeElement)("jFocusOnReturn",o)("formControl",r.form.controls.codeWord)("clearable",!1)("searchFn",r.codeWordComparator)("items",r.codeWords)}}function eo(n,i){if(1&n&&(t.TgZ(0,"div",153)(1,"div",154),t._uU(2),t.qZA()()),2&n){const e=i.ngIf;t.xp6(2),t.hij(" ",e," ")}}function no(n,i){if(1&n&&(t.TgZ(0,"div",155),t._UZ(1,"span",156),t.ALo(2,"async"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e.comissionMessage),t.oJD)}}function oo(n,i){if(1&n&&(t.TgZ(0,"div",157),t._UZ(1,"span",156),t.ALo(2,"async"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e.amountMessage),t.oJD)}}const ro=function(n){return{amount:n}};function so(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",157),t._UZ(1,"span",158),t.ALo(2,"money"),t.TgZ(3,"a",159),t.NdJ("click",function(r){return t.CHM(e),t.oxw(2).scrollToContracts(r)}),t._uU(4),t.ALo(5,"translate"),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("translate","ERRORS.CURRENCY_PAYMENT.MUST_INCLUDE_CONTRACT")("translateParams",t.VKq(7,ro,t.lcZ(2,3,e.contractMaxAmount))),t.xp6(3),t.Oqu(t.lcZ(5,5,"ERRORS.CURRENCY_PAYMENT.MUST_INCLUDE_CONTRACT_LINK"))}}function io(n,i){if(1&n&&(t.TgZ(0,"div",157),t._UZ(1,"span",156),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("innerHTML",e.comissionMessage,t.oJD)}}function ao(n,i){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function co(n,i){if(1&n&&(t._uU(0),t.ALo(1,"translate"),t._UZ(2,"j-money",87)),2&n){const e=t.oxw(2);t.hij(" ",t.lcZ(1,2,"PAYMENTS.COMMISSION"),": "),t.xp6(2),t.Q6J("money",e.commissionBalance)}}function lo(n,i){1&n&&t._UZ(0,"div",160)}function uo(n,i){if(1&n&&(t.TgZ(0,"li",60),t._UZ(1,"j-switch",11),t.TgZ(2,"span",12)(3,"strong",13),t._uU(4,"CURRENCY_PAYMENT.AGENT.TITLE"),t.qZA(),t._UZ(5,"br"),t.TgZ(6,"small",161),t._uU(7,"CURRENCY_PAYMENT.AGENT.DESCRIPTION"),t.qZA()()()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("formControl",e.form.controls.payComission)}}function mo(n,i){1&n&&(t.TgZ(0,"div")(1,"small",162),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"PAYMENTS.NOTIFY.DESCRIPTION")))}function po(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",163)(1,"j-form-field")(2,"j-label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"input",164,165),t.NdJ("focus",function(r){return t.CHM(e),t.oxw(2).onEmailOnSuccessFocus(r)}),t.qZA(),t._UZ(7,"j-error",28),t.qZA(),t.TgZ(8,"small",162),t._uU(9),t.ALo(10,"translate"),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,6,"PAYMENTS.NOTIFY.EMAIL")),t.xp6(2),t.Q6J("ngbTypeahead",e.search)("formControl",e.form.controls.emailOnSuccess),t.xp6(2),t.Q6J("control",e.form.controls.emailOnSuccess)("errorMessages",e.errors.email),t.xp6(2),t.Oqu(t.lcZ(10,8,"PAYMENTS.NOTIFY.EMAIL"))}}function _o(n,i){if(1&n&&(t._UZ(0,"p",166),t.ALo(1,"translate")),2&n){const e=t.oxw(2);t.Q6J("innerHTML",t.lcZ(1,1,e.agreementText),t.oJD)}}function fo(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",167),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).saveToDraft()}),t.TgZ(2,"strong",13),t._uU(3,"SHARED.SAVE"),t.qZA()(),t.TgZ(4,"button",168),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(5),t.hij("",t.lcZ(6,1,e.submitLabel)," ")}}function ho(n,i){1&n&&(t.ynx(0),t.TgZ(1,"button",169),t._uU(2,"SHARED.SAVE_EDITING"),t.qZA(),t.BQk())}function go(n,i){if(1&n&&t._UZ(0,"j-fx-contract-details",170,171),2&n){const e=t.oxw(2);t.Q6J("contract",e.form.controls.contract.value)}}function Co(n,i){}function Ao(n,i){1&n&&t._UZ(0,"j-kbe-info")}function yo(n,i){1&n&&(t._UZ(0,"div",172),t.ALo(1,"translate")),2&n&&t.Q6J("innerHTML",t.lcZ(1,1,"PAYMENTS.KPP"),t.oJD)}function To(n,i){1&n&&(t._UZ(0,"div",172),t.ALo(1,"translate")),2&n&&t.Q6J("innerHTML",t.lcZ(1,1,"PAYMENTS.OKTMO"),t.oJD)}function bo(n,i){1&n&&(t._UZ(0,"div",172),t.ALo(1,"translate")),2&n&&t.Q6J("innerHTML",t.lcZ(1,1,"PAYMENTS.BASIS"),t.oJD)}function xo(n,i){1&n&&(t._UZ(0,"div",172),t.ALo(1,"translate")),2&n&&t.Q6J("innerHTML",t.lcZ(1,1,"PAYMENTS.BUDGET"),t.oJD)}function vo(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",3)(2,"form",4,5),t.NdJ("submit",function(r){return t.CHM(e),t.oxw().onSubmit(r)}),t.TgZ(4,"fieldset",6)(5,"h5",7),t._uU(6,"CURRENCY_PAYMENT.DEBIT_ACCOUNT"),t.qZA(),t.TgZ(7,"j-account-dropdown",8,9),t.NdJ("selected",function(r){return t.CHM(e),t.oxw().onSenderAccountSelect(r)}),t.qZA(),t.TgZ(9,"div",10),t._UZ(10,"j-switch",11),t.TgZ(11,"div",12)(12,"strong",13),t._uU(13,"CURRENCY_PAYMENT.CONTRACTS.SWITCH.TITLE"),t.qZA(),t.YNc(14,pn,3,8,"div",14),t.qZA()(),t.YNc(15,bn,14,10,"ng-container",1),t.qZA(),t.TgZ(16,"fieldset",15)(17,"div",16)(18,"h5",17),t._uU(19,"CURRENCY_PAYMENT.RECIPIENT.TITLE"),t.qZA(),t.YNc(20,xn,1,0,"button",18),t.YNc(21,vn,1,0,"button",19),t.qZA(),t.TgZ(22,"div",20)(23,"j-form-field",21)(24,"j-label",13),t._uU(25,"CURRENCY_PAYMENT.RECIPIENT.NAME"),t.qZA(),t.TgZ(26,"input",22),t.NdJ("paste",function(r){return t.CHM(e),t.oxw().onNamePaste(r)}),t.qZA()()(),t.TgZ(27,"div",20)(28,"j-form-field",null,23)(30,"j-label",13),t._uU(31,"CURRENCY_PAYMENT.RECIPIENT.COUNTRY"),t.qZA(),t.TgZ(32,"j-select",24,25),t.NdJ("change",function(r){return t.CHM(e),t.oxw().onCountrySelect(r)})("focus",function(){return t.CHM(e),t.oxw().onCountryFocus()})("search",function(r){return t.CHM(e),t.oxw().onCountrySearch(r)}),t.ALo(34,"async"),t.YNc(35,En,2,1,"ng-template",26),t.YNc(36,Nn,1,1,"ng-template",27),t.qZA(),t._UZ(37,"j-error",28),t.qZA()(),t.YNc(38,Rn,8,11,"div",29),t.YNc(39,Zn,24,4,"ng-container",1),t.ALo(40,"async"),t.YNc(41,Sn,6,1,"ng-container",1),t.ALo(42,"async"),t.YNc(43,Pn,6,1,"ng-container",1),t.ALo(44,"async"),t.YNc(45,Mn,11,11,"ng-container",1),t.ALo(46,"async"),t.TgZ(47,"div"),t.ALo(48,"async"),t.YNc(49,In,7,8,"div",29),t.YNc(50,Ln,11,14,"ng-container",1),t.ALo(51,"async"),t.TgZ(52,"div",20)(53,"j-form-field",21)(54,"j-label",13),t._uU(55,"CURRENCY_PAYMENT.RECIPIENT.IBAN"),t.qZA(),t._UZ(56,"input",30,31)(58,"j-error",32),t.qZA()()(),t.YNc(59,kn,5,5,"ng-container",1),t.ALo(60,"async"),t.YNc(61,Yn,8,2,"div",33),t.YNc(62,jn,6,5,"div",29),t.ALo(63,"async"),t.YNc(64,Dn,8,6,"div",29),t.ALo(65,"async"),t.qZA(),t.YNc(66,Gn,43,23,"ng-container",1),t.ALo(67,"async"),t.TgZ(68,"fieldset",15)(69,"h5",7),t._uU(70,"CURRENCY_PAYMENT.DETAILS.TITLE"),t.qZA(),t.TgZ(71,"div",20)(72,"j-form-field")(73,"j-label",13),t._uU(74,"CURRENCY_PAYMENT.DETAILS.DOCUMENT_NUMBER"),t.qZA(),t._UZ(75,"input",34),t.qZA()(),t.TgZ(76,"div",20),t._UZ(77,"j-date-picker",35,36),t.ALo(79,"async"),t.ALo(80,"translate"),t.ALo(81,"translate"),t.ALo(82,"async"),t.qZA(),t.TgZ(83,"div",20)(84,"j-form-field",null,37)(86,"j-label",13),t._uU(87,"CURRENCY_PAYMENT.DETAILS.KNP.TITLE"),t.qZA(),t.TgZ(88,"j-select",38,39),t.NdJ("change",function(){return t.CHM(e),t.oxw().knpIsChanged()}),t.ALo(90,"async"),t.YNc(91,Kn,1,1,"ng-template",40),t.qZA()()(),t.YNc(92,Wn,5,2,"div",29),t.ALo(93,"async"),t.YNc(94,to,11,12,"div",29),t.ALo(95,"async"),t.TgZ(96,"div",41)(97,"span",42),t._uU(98),t.ALo(99,"async"),t.qZA(),t.TgZ(100,"j-form-field")(101,"j-label",13),t._uU(102,"CURRENCY_PAYMENT.DETAILS.PURPOSE"),t.qZA(),t._UZ(103,"textarea",43,44)(105,"j-error",28),t.YNc(106,eo,3,1,"div",45),t.ALo(107,"async"),t.qZA(),t.TgZ(108,"div",46),t._uU(109," CURRENCY_PAYMENT.DETAILS.PURPOSE_DESCRIPTION "),t.qZA()()(),t.TgZ(110,"fieldset",15)(111,"div",47)(112,"j-account-dropdown",48,49),t.NdJ("selected",function(r){return t.CHM(e),t.oxw().onCommissionAccountSelect(r)}),t.qZA(),t.YNc(114,no,3,3,"div",50),t.qZA(),t.TgZ(115,"div",20)(116,"j-form-field",51)(117,"j-label",13),t._uU(118,"CURRENCY_PAYMENT.AMOUNT.TITLE"),t.qZA(),t.TgZ(119,"input",52),t.NdJ("paste",function(r){return t.CHM(e),t.oxw().onAmountPaste(r)}),t.qZA()(),t.YNc(120,oo,3,3,"div",53),t.YNc(121,so,6,9,"div",53),t.YNc(122,io,2,1,"div",53),t.TgZ(123,"div",54),t.YNc(124,ao,3,3,"ng-container",55),t.YNc(125,co,3,4,"ng-template",null,56,t.W1O),t.YNc(127,lo,1,0,"div",57),t.qZA()(),t.TgZ(128,"ul",58),t.YNc(129,uo,8,1,"li",59),t.TgZ(130,"li",60),t._UZ(131,"j-switch",11),t.TgZ(132,"div",61)(133,"strong"),t._uU(134),t.ALo(135,"translate"),t.qZA(),t._UZ(136,"br"),t.YNc(137,mo,4,3,"div",1),t.YNc(138,po,11,10,"div",62),t.qZA()()()(),t.YNc(139,_o,2,3,"p",63),t.TgZ(140,"div",64),t.YNc(141,fo,7,3,"ng-container",1),t.YNc(142,ho,3,0,"ng-container",1),t.qZA(),t._UZ(143,"ngx-spinner",65),t.qZA()(),t.YNc(144,go,2,1,"j-fx-contract-details",66),t.YNc(145,Co,0,0,"ng-template",null,67,t.W1O),t.YNc(147,Ao,1,0,"ng-template",null,68,t.W1O),t.YNc(149,yo,2,3,"ng-template",null,69,t.W1O),t.YNc(151,To,2,3,"ng-template",null,70,t.W1O),t.YNc(153,bo,2,3,"ng-template",null,71,t.W1O),t.YNc(155,xo,2,3,"ng-template",null,72,t.W1O),t.BQk()}if(2&n){const e=t.MAs(29),o=t.MAs(33),r=t.MAs(78),s=t.MAs(85),l=t.MAs(89),c=t.MAs(126),a=t.oxw();t.xp6(2),t.Q6J("formGroup",a.form),t.xp6(5),t.Q6J("isLoading",a.isAccountsLoading)("isDisabledSelectable",!0)("label","CURRENCY_PAYMENT.DEBIT_ACCOUNT")("hasError",a.form.controls.senderAccount.touched&&a.form.controls.senderAccount.errors)("accounts",a.senderAccountsList),t.xp6(3),t.Q6J("formControl",a.form.controls.withinContract),t.xp6(4),t.Q6J("ngIf",a.isContractsDescriptionShown),t.xp6(1),t.Q6J("ngIf",a.withinContract),t.xp6(5),t.Q6J("ngIf",a.withinContract&&(null==a.form.controls.contract||null==a.form.controls.contract.value||null==a.form.controls.contract.value.recipients?null:a.form.controls.contract.value.recipients.length)>1),t.xp6(1),t.Q6J("ngIf",!a.withinContract),t.xp6(5),t.Q6J("mask",a.masks.name.mask)("dropSpecialCharacters",!1)("maxlength",a.withinContract?null:a.nameMaxLength)("formControl",a.form.controls.name),t.xp6(6),t.Q6J("appendTo",e.elementRef.nativeElement)("jFocusOnReturn",o)("formControl",a.form.controls.countryCode)("readonly",a.form.controls.countryCode.disabled)("clearable",!1)("searchFn",a.countryComparator)("items",t.lcZ(34,103,a.countries$)),t.xp6(5),t.Q6J("control",a.form.controls.countryCode)("errorMessages",a.errors.country),t.xp6(1),t.Q6J("ngIf",a.isCityShown),t.xp6(1),t.Q6J("ngIf",t.lcZ(40,105,a.isAustraliaAud$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(42,107,a.isAustraliaNonAud$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(44,109,a.isCountryCanada$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(46,111,a.isRubNonRussia$)),t.xp6(2),t.ekj("kbe-account-row",!(t.lcZ(48,113,a.isRubNonRussia$)||a.withinContract)),t.xp6(2),t.Q6J("ngIf",!a.withinContract),t.xp6(1),t.Q6J("ngIf",t.lcZ(51,115,a.isRubNonRussia$)),t.xp6(2),t.ekj("mb-3",a.withinContract),t.xp6(4),t.Q6J("mask",a.masks.bankAccount.mask)("formControl",a.form.controls.bankAccount),t.xp6(2),t.Q6J("control",a.form.controls.bankAccount)("errorMessages",a.errors.bankAccount)("params",a.ibanParams(a.form.controls.bankAccount)),t.xp6(1),t.Q6J("ngIf",!t.lcZ(60,117,a.isRubNonRussia$)),t.xp6(2),t.Q6J("ngIf",a.isIntermediaryBankSwitchable),t.xp6(1),t.Q6J("ngIf",t.lcZ(63,119,a.isKioEnabled$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(65,121,a.isKppEnabled$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(67,123,a.isRussianBudget$)),t.xp6(9),t.Q6J("mask",a.masks.number.mask)("formControl",a.form.controls.number),t.xp6(2),t.Q6J("datesEnabled",t.lcZ(79,125,a.workingDays$))("formControl",a.form.controls.date)("formatValue",!0)("jFocusOnReturn",r)("label",t.lcZ(80,127,"CURRENCY_PAYMENT.DETAILS.VALUE_DATE"))("minDate",a.dateLimit.minDate)("maxDate",a.dateLimit.maxDate)("helperText",t.lcZ(81,129,t.lcZ(82,131,a.dateMessage$))),t.xp6(11),t.Q6J("jFocusOnReturn",l)("appendTo",s.elementRef.nativeElement)("formControl",a.form.controls.knp)("clearable",!1)("searchMask",a.masks.knp.mask)("shadow",a.masks.knp.shadow)("compareWith",a.knpComparator)("items",t.lcZ(90,133,a.knp$)),t.xp6(4),t.Q6J("ngIf",t.lcZ(93,135,a.isKvoEnabled$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(95,137,a.isCodeWordEnabled$)),t.xp6(4),t.AsE(" ",t.lcZ(99,139,a.purposeLength$),"/",a.rules.purposeLength,""),t.xp6(5),t.Q6J("formControl",a.form.controls.purpose)("mask",a.masks.purpose.mask)("dropSpecialCharacters",!1),t.xp6(2),t.Q6J("control",a.form.controls.purpose)("errorMessages",a.errors.purpose),t.xp6(1),t.Q6J("ngIf",t.lcZ(107,141,a.purposeMessage$)),t.xp6(5),t.Q6J("hidden",!a.isCommissionAccountSelectable),t.xp6(1),t.Q6J("isLoading",a.isAccountsLoading)("accounts",a.commissionAccountsList)("isDisabledSelectable",!0)("hasError",a.form.controls.commissionAccount.touched&&a.form.controls.commissionAccount.errors)("label","CURRENCY_PAYMENT.COMISSION.ACCOUNT"),t.xp6(2),t.Q6J("ngIf",a.comissionMessage),t.xp6(2),t.Q6J("floatLabel","always"),t.xp6(3),t.Q6J("suffix",a.amountSuffix)("placeholder",a.amountPlaceholder)("mask",a.amountMask)("dropSpecialCharacters",!0)("formControl",a.form.controls.amount),t.xp6(1),t.Q6J("ngIf",a.amountMessage),t.xp6(1),t.Q6J("ngIf",a.shouldBindContract),t.xp6(1),t.Q6J("ngIf",a.comissionMessage&&!a.isCommissionAccountSelectable),t.xp6(2),t.Q6J("ngIf",null===a.commissionBalance)("ngIfElse",c),t.xp6(3),t.Q6J("ngIf",0==a.isOurComission&&a.canPayCommission),t.xp6(2),t.Q6J("ngIf",a.canPayCommission),t.xp6(2),t.Q6J("formControl",a.form.controls.notify),t.xp6(3),t.Oqu(t.lcZ(135,143,"PAYMENTS.NOTIFY.TITLE")),t.xp6(3),t.Q6J("ngIf",!a.form.controls.notify.value),t.xp6(1),t.Q6J("ngIf",a.form.controls.notify.value),t.xp6(1),t.Q6J("ngIf",!a.withinContract),t.xp6(2),t.Q6J("ngIf",a.restoredData.status!==a.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("ngIf",a.restoredData.status===a.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("name",a.SPINNER)("fullScreen",!1),t.xp6(1),t.Q6J("ngIf",a.form.controls.contract.value)}}var Pt=(()=>((Pt||(Pt={})).JYSAN="TSESKZKA",Pt))();const de=x.w.JPY,Qt=["342","343","314","312"],Ce=new RegExp(/(([a-zA-Z]{1}[a-zA-Z0-9\/\-?:().,\'+\ ]+)|([a-zA-Z]{1}))+/g),Ae=n=>!!n&&"810"!==n.substring(5,8),Mt=n=>!!n&&["000","001","002"].includes(n.substring(6,9)),_t=n=>!!n&&"0"===n[0],$t=n=>{var i,e,o;return n.value&&5!==(null===(i=n.value)||void 0===i?void 0:i.length)&&10!==(null===(e=n.value)||void 0===e?void 0:e.length)&&12!==(null===(o=n.value)||void 0===o?void 0:o.length)?{lengthMismatch:!0}:null},Yo=n=>{const i=new RegExp("^[0-9]+$");return n.value&&!n.value.match(i)?{rubInvalidNumbers:!0}:n.value&&n.value.length>8&&!_t(n.value)&&Ae(n.value)?{rubInvalid:!0}:n.value&&20!==n.value.length?{rubLength:!0}:null};let ye=(()=>{class n extends tt.S{constructor(e,o,r,s,l,c,a,p,f,m,h,_,g,y,A,T,I,k,L,F,H){super(_.createCurrencyForm(),c,s,l,e,o,r,m,a,h,p,f,A,T),this.companyService=e,this.paymentsService=o,this.maskService=r,this.route=s,this.router=l,this.api=c,this.dictionaries=a,this.translateService=p,this.authorityPermissionsService=f,this.modalService=m,this.pipelines=h,this.paymentsFormsFactory=_,this.maskPipe=g,this.recipientsService=y,this.featureFlagsService=A,this.bankFromAccount=T,this.accountsService=I,this.currencyPaymentService=k,this.curSymbolPipe=L,this.conversionService=F,this.contractsModalsService=H,this.nameMaxLength=103,this.cityMaxLength=32,this.paymentCategory=O.nK.FOREIGN,this.isCounterPartyLoading$=new v.X(null),this.masks={iinOrBin:"iin",bankAccount:"foreignAccount",kbeCode:"kbe",knp:"knp",number:"paymentNum",amount:"amount",name:"foreignLatin",cityName:"foreignLatin",purpose:"foreignLatin",kvo:"kvo",kio:"kio",kpp:"kpp",oktmo:"oktmo",paymentBasis:"basis",budgetDocNumber:"budgetDocNumber",budgetPeriod:"budgetPeriod",rubNonRussiaCorrespondentIban:"russianAccount"},this.focusEmail$=new re.xQ,this.prevEmails$=new v.X([]),this.fetchingEmailsFor$=new v.X(null),this.accounts=[],this.isAccountsLoading=!0,this.contracts=[],this.filteredContracts=[],this.isContractsLoading=!1,this.isContractSelected=!1,this.withinContract=!1,this.isContractsDescriptionShown=!1,this.isContractsAgreementShown=!0,this.isContractsDescriptionLoading=!1,this.contractMaxAmount={amount:1e4,currency:x.w.USD},this.countries=[],this.countries$=new v.X([]),this.hasDefaultCity=!1,this.isCityShown=!1,this.cityPlaceholder$=new v.X("CURRENCY_PAYMENT.RECIPIENT.CITY"),this.isBicRequired=!0,this.isIntermediaryBankSwitchable=!1,this.hasIntermediaryBank=!1,this.ibanMaxLength=34,this.amountMask="separator.2",this.amountPlaceholder="0,00",this.amountSuffix=" ",this.isCommissionAccountSelectable=!0,this.isOurComission=!1,this.canPayCommission=!0,this.commissionBalance=null,this.isKppEnabled$=new v.X(!1),this.isKioEnabled$=new v.X(!1),this.isKvoEnabled$=new v.X(!1),this.codeWordLabel$=new v.X("CURRENCY_PAYMENT.RECIPIENT.CODEWORD"),this.isCodeWordEnabled$=new v.X(!1),this.isRubNonRussia$=new v.X(!1),this.isRubToRussia$=new v.X(!1),this.isRussianBudgetDisabled=!1,this.isRussianBudget$=new v.X(!1),this.isRussianTaxpayer=!1,this.kbkList=[],this.isKbkLoading=!1,this.statuses=[],this.isStatusesLoading=!1,this.hasRussianBudgetExtras=!1,this.isForeignContractDisabled=!1,this.isAustraliaAud$=new v.X(!1),this.isAustraliaNonAud$=new v.X(!1),this.isCountryCanada$=new v.X(!1),this.rules.purposeLength=335,this.isForeignContractDisabled=this.featureFlagsService.isDisabled(j.Y.FOREIGN_CONTRACT),this.featureFlagsService.featureFlags$.subscribe(K=>{this.isForeignContractDisabled=this.featureFlagsService.isDisabled(j.Y.FOREIGN_CONTRACT)}),this.featureFlagsService.checkFeatureRoute(j.Y.FOREIGN_PAYMENT).then(()=>{this.isRussianBudgetDisabled=this.featureFlagsService.isDisabled(j.Y.RUB_BUDGET_PAYMENT),this.isForeignContractDisabled=this.featureFlagsService.isDisabled(j.Y.FOREIGN_CONTRACT)})}ngOnInit(){super.ngOnInit(),this.accountStore=this.accountsService.store,this.dateLimit=this.paymentsService.stdDateRangeNgb,this.retrieveKnps(),this.retrieveAccounts(),this.retrieveCountries(),this.retrieveContracts(),this.retrieveCodeWords(),this.retrieveKbks(),this.retrieveStatuses(),this.createControlsStream(this.form),this.getMaskConfig(),this.listenCommission(),this.listenCountrySelect(),this.listenWithinContractSwitch(),this.listenContractsSwitchDescription(),this.listenContractSelect(),this.listenEmailSearch(),this.listenWorkingDays(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.listenPurpose(),this.listenPayComission(),this.listenIntermediaryBankSwitch(),this.listenIntermediaryBankSwitchable(),this.listenAmount(),this.applyAmountValidation(),this.listenAmountMessage(),this.setAutoNumeration(),this.listenCompanyType(),this.listenIsRussianBudget(),this.listenIsRussianTaxpayer(),this.listenHasRussianBudgetExtras(),this.listenRouterParams(),this.listenKvo(),this.listenKio(),this.listenCodeWordEnabling(),this.listenCodeWord(),this.listenCodeWordsList(),this.listenRubToNonRussia(),this.listenRubNonRussiaCorrespondentBank(),this.listenAudToAustralia(),this.listenAudNonAustralia(),this.listenCountryIsCanada(),this.listenMaxLengths(),this.applyKbeRules(),this.applyNameRules(),this.applyCountryRules(),this.applyIbanRules()}applyKbeRules(){this.subs.add(this.controlsStream.withinContract.subscribe(e=>{e?this.clearValidation([this.form.controls.kbeCode]):this.setValidation([this.form.controls.kbeCode],[d.kI.required,Ge.hM.kbe])}))}applyAmlRules(){localStorage.getItem("aml-modal-shown")||(localStorage.setItem("aml-modal-shown","true"),this.modalService.open(Ke.T,{backdropClass:"backdrop_light",windowClass:"modal_light modal_sm",backdrop:"static",centered:!0}))}applyNameRules(){const{name:e}=this.form.controls,{withinContract:o,senderAccount:r}=this.controlsStream;this.subs.add((0,N.aj)([o,r]).pipe((0,S.x)()).subscribe(s=>{var l;const[c,a]=s,p=null===(l=null==a?void 0:a.balance)||void 0===l?void 0:l.currency,f=e.pristine;c?(e.disable(),this.clearValidation([e]),this.masks.name={mask:null}):(e.enable(),this.setValidation([e],[d.kI.required]),this.masks.name=p===x.w.RUB?pt.K.foreignCyrillic:pt.K.foreignLatin),setTimeout(()=>{f&&e.markAsPristine()},0)}))}ibanParams(e){var o;return(null===(o=null==e?void 0:e.errors)||void 0===o?void 0:o.bankRestricted)?{bankName:this.bankFromAccount.transform(e.value,"name")}:null}onNamePaste(e){e.preventDefault();const s=(e.clipboardData||window.clipboardData).getData("text").substring(0,this.nameMaxLength);this.form.controls.name.setValue(s)}applyCountryRules(){const{countryCode:e}=this.form.controls,{withinContract:o,senderAccount:r,contract:s}=this.controlsStream;this.subs.add((0,N.aj)([o,r,s]).pipe((0,S.x)()).subscribe(l=>{var c;const[a,p]=l,f=null===(c=null==p?void 0:p.balance)||void 0===c?void 0:c.currency,m=e.pristine;if(a)e.disable(),this.clearValidation([e]);else{e.enable();const h=[d.kI.required];f===x.w.CNY&&h.push(_=>_.value!==C.si.CN?{cnyOnlyToChina:!0}:null),this.setValidation([e],h)}setTimeout(()=>{m&&e.markAsPristine()},0)}))}onCountrySearch({term:e}){if(!e)return void this.countries$.next(this.countries);const s=this.countries.filter(l=>l.code.toLowerCase().includes(e.toLowerCase())||l.nameEn.toLowerCase().includes(e.toLowerCase())||l.nameKk.toLowerCase().includes(e.toLowerCase())||l.nameRu.toLowerCase().includes(e.toLowerCase())).sort((l,c)=>this.countrySorter(l,c,e));this.countries$.next(s)}onCountryFocus(){this.form.controls.senderAccount.value||(this.senderAccountDropdown.hasError=!0)}onCountrySelect(e){this.hasDefaultCity=!!e.defaultCityName,this.form.controls.country.setValue(e)}countrySorter(e,o,r){if(e.code.toLowerCase()===r.toLowerCase())return-1;if(o.code.toLowerCase()===r.toLowerCase())return 1;if(e.code.toLowerCase().includes(r.toLowerCase()))return-1;if(o.code.toLowerCase().includes(r.toLowerCase()))return 1;switch(this.translateService.currentLang){case"ru":return e.nameRu<o.nameRu?-1:1;case"en":return e.nameEn<o.nameEn?-1:1;case"kk":return e.nameKk<o.nameKk?-1:1;default:return 0}}countryComparator(e,o){return!0}mapCountryLabel(e){let o;switch(this.translateService.currentLang){case"ru":default:o=e.nameRu;break;case"kk":o=e.nameKk;break;case"en":o=e.nameEn}return`${e.code} - ${o||e.name}`}get currentCountryCode(){var e,o,r;const s=(null===(r=null===(o=null===(e=this.formValue.contract)||void 0===e?void 0:e.contractor)||void 0===o?void 0:o.country)||void 0===r?void 0:r.code)||null;return this.formValue.withinContract&&s?s.substring(0,2):!this.formValue.withinContract&&this.formValue.countryCode?this.formValue.countryCode.substring(0,2):null}retrieveCountries(){return(0,U.mG)(this,void 0,void 0,function*(){this.countries=yield this.currencyPaymentService.getCountries(),this.countries$.next(this.countries)})}applyIbanRules(){const{senderAccount:e,country:o,countryCode:r,contract:s,contractId:l,bank:c,rubNonRussiaBank:a,withinContract:p}=this.controlsStream;this.subs.add((0,N.aj)([e,c,a,o,r,s,l,p,this.countries$]).subscribe(f=>{var m,h,_;const[g,y,A]=f,T=[d.kI.required],I=[Ft.W.externalIbanRestricted(this.dictionaries)],k=null===(h=null===(m=g)||void 0===m?void 0:m.balance)||void 0===h?void 0:h.currency,F=this.form.controls.bankAccount.pristine;if(k===x.w.RUB&&this.currentCountryCode===C.si.RU)this.masks.bankAccount=pt.K.russianAccount,T.push(H=>{var K;return((n,i)=>{const e=new RegExp("^[0-9]+$");return n.value&&!n.value.match(e)?{rubInvalidNumbers:!0}:n.value&&i&&!_t(n.value)&&Mt(i)?{rubInvalidBudget:!0}:n.value&&i&&n.value.length>8&&!_t(n.value)&&Ae(n.value)?{rubInvalid:!0}:n.value&&20!==n.value.length?{rubLength:!0}:null})(H,null===(K=y)||void 0===K?void 0:K.bic)});else{const H=k===x.w.RUB?A:y,K=null===(_=this.countries.find(Kt=>{var Wt;return Kt.id===(null===(Wt=H)||void 0===Wt?void 0:Wt.countryId)}))||void 0===_?void 0:_.code;this.masks.bankAccount=pt.K.foreignAccount,T.push(Kt=>((n,i)=>{var e,o;const r=null===(e=n.value)||void 0===e?void 0:e.substring(0,2).match(/[A-Za-z]{2}/);return i&&r&&(null===(o=n.value)||void 0===o?void 0:o.substring(0,2).toUpperCase())!==(null==i?void 0:i.substring(0,2).toUpperCase())?{currencyMismatch:!0}:null})(Kt,K)),T.push(d.kI.maxLength(this.ibanMaxLength))}this.setValidation([this.form.controls.bankAccount],T,I),setTimeout(()=>{F&&this.form.controls.bankAccount.markAsPristine()},0)}))}openForeignContractsRecipientsDictionary(){return(0,U.mG)(this,void 0,void 0,function*(){const e=this.modals.open(ie.A,{backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",centered:!0}),{contract:o}=this.form.getRawValue();e.componentInstance.recipients=o.recipients;try{const r=yield e.result;this.selectContractRecipient(r)}catch(r){}})}selectContractRecipient(e){var o,r,s,l;if(!e)return;const{name:c,country:a,countryCode:p,bankAccount:f,bank:m,cityName:h,fxContractRecipient:_,fxContractRecipientId:g}=this.form.controls;_.setValue(e),g.setValue(e.id),c.setValue(e.name||""),(null===(o=e.country)||void 0===o?void 0:o.code)&&!this.countries.find(y=>{var A;return y.code===(null===(A=e.country)||void 0===A?void 0:A.code)})&&this.countries$.next([...this.countries,e.country]),a.setValue(e.country),p.setValue((null===(r=e.country)||void 0===r?void 0:r.code)||e.countryCode),(e.cityName||e.defaultCityName)&&h.setValue(e.cityName||e.defaultCityName||""),e.iban&&f.setValue(e.iban),e.bankBic&&(m.setValue({code:e.bankBic,name:e.bankName}),null===(s=this.bankDropdown)||void 0===s||s.selectByBic(e.bankBic),null===(l=this.rubNonRussiaBankDropdown)||void 0===l||l.selectByBic(e.bankBic))}showContractDetails(e){e.preventDefault(),e.stopPropagation(),this.contractDetails.show()}onContractSelect(e,o=!1){var r,s;return(0,U.mG)(this,void 0,void 0,function*(){const{contract:l,kio:c,contractId:a}=this.form.controls;try{const _=yield this.currencyPaymentService.getContractById(e.id);Object.assign(e,_)}catch(_){}l.setValue(e),a.setValue(e.id),e.contractor.iinOrBin&&!o&&(null==c||c.setValue(e.contractor.iinOrBin));let p=null===(r=e.recipients)||void 0===r?void 0:r.find(_=>_.primary);const{fxContractRecipient:f,fxContractRecipientId:m}=this.form.getRawValue();if(!f&&!m&&p)return void this.selectContractRecipient(p);const h=null===(s=e.recipients)||void 0===s?void 0:s.find(_=>(null==f?void 0:f.id)===_.id||m===_.id);h&&(p=h),this.selectContractRecipient(p)})}onEmailOnSuccessFocus(e){this.focusEmail$.next(e.target.value)}onSenderAccountSelect(e){!e||(this.form.controls.senderAccount.setValue(e),this.form.controls.senderAccount.markAsDirty(),this.senderAccountDropdown.hasError=!1)}onCommissionAccountSelect(e){this.form.controls.commissionAccount.setValue(e)}get senderAccountsList(){return this.accounts}get commissionAccountsList(){const o=this.form.getRawValue().senderAccount;return this.accounts.filter(r=>{var s;return r.balance.currency===x.w.KZT||r.balance.currency===(null===(s=null==o?void 0:o.balance)||void 0===s?void 0:s.currency)})}codeWordComparator(e,o){return!e||o.name.toLowerCase().includes(e.toLowerCase())||o.code.toLowerCase().includes(e.toLowerCase())}kbkComparator(e,o){return!e||o.code.toLowerCase().includes(e.toLowerCase())||o.description.toLowerCase().includes(e.toLowerCase())}statusComparator(e,o){return!e||o.code.toLowerCase().includes(e.toLowerCase())||o.description.toLowerCase().includes(e.toLowerCase())}scrollToContracts(e){return(0,U.mG)(this,void 0,void 0,function*(){e.preventDefault(),yield this.form.controls.withinContract.setValue(!0),setTimeout(()=>{document.getElementById("contractGroup").scrollIntoView({behavior:"smooth"}),this.contractsSelect.focus(),this.contractsSelect.open()},100)})}onAmountPaste(e){var o,r;e.preventDefault();const s=this.form.getRawValue(),c=(e.clipboardData||window.clipboardData).getData("text");let a=this.maskService.getNumberedAmount(c);(null===(r=null===(o=s.senderAccount)||void 0===o?void 0:o.balance)||void 0===r?void 0:r.currency)===de&&(a=Math.trunc(a)),this.form.controls.amount.setValue(a)}mapCodeWordLabel(e){if(e)return`${e.code} - ${e.name}`}listenMaxLengths(){this.subs.add((0,N.aj)([this.isAustraliaAud$,this.isAustraliaNonAud$,this.isCountryCanada$,this.isRubNonRussia$,this.isRubToRussia$,this.controlsStream.name,this.controlsStream.purpose,this.purposeMessage$,this.controlsStream.countryCode]).subscribe(e=>{let[o,r,s,l,c,a,p,f]=e;if(c=c||"",a=a||"",p=p||"",o?(this.nameMaxLength=35,this.cityMaxLength=26):r?(this.nameMaxLength=35,this.cityMaxLength=31):s?(this.nameMaxLength=35,this.cityMaxLength=32):(this.nameMaxLength=103,this.cityMaxLength=32),l||s){this.rules.purposeLength=203;const h=c.match(Ce);(null==h?void 0:h.length)>0&&(this.nameMaxLength-=2*h.length);const _=a.match(Ce);(null==_?void 0:_.length)>0&&(this.rules.purposeLength-=2*_.length)}else this.rules.purposeLength=f===C.si.CN?300:335;this.setValidation([this.form.controls.purpose],[d.kI.required,d.kI.maxLength(f===C.si.CN?this.rules.purposeLength:this.rules.purposeLength-p.length)],null,!1)}))}listenAudToAustralia(){this.subs.add(this.isAustraliaAud$.subscribe(e=>{const{audIndex:o,audState:r,audStreet:s,audBuildingNumber:l}=this.form.controls;e?this.setValidation([o,r,s,l],[d.kI.required]):this.clearValidation([o,r,s,l])}))}listenAudNonAustralia(){this.subs.add(this.isAustraliaNonAud$.subscribe(e=>{const{audAddress:o}=this.form.controls;e?this.setValidation([o],[d.kI.required]):this.clearValidation([o])}))}listenCountryIsCanada(){this.subs.add(this.isCountryCanada$.subscribe(e=>{const{canAddress:o}=this.form.controls;e?this.setValidation([o],[d.kI.required]):this.clearValidation([o])}))}listenCompanyType(){this.subs.add(this.companyService.refresh$.subscribe(e=>{this.companyService.currentCompany.type===Jt.cN.CORPORATE?(this.agreementText="CURRENCY_PAYMENT.AGREEMENT.CORPORATE",this.isForeignContractDisabled&&(this.isContractsAgreementShown=!1),this.isContractsDescriptionShown=!0):(this.agreementText="CURRENCY_PAYMENT.AGREEMENT.ENTREPRENEUR",this.isForeignContractDisabled&&(this.isContractsAgreementShown=!0),this.isContractsDescriptionShown=!1)}))}retrieveKnps(){this.knp$=this.combineKNP([e=>this.dictionaries.selectByPaymentType(e,{type:O.V_.FOREIGN,sortFavourite:!1})])}retrieveAccounts(){return(0,U.mG)(this,void 0,void 0,function*(){this.isAccountsLoading=!0;try{const e=yield this.accountsService.getAccounts(this.companyService.currentId);this.accounts=e.filter(o=>o.balance.currency&&o.accountType===q.Q5.ACCOUNT).sort(this.sortAccounts),this.selectDefaultSenderAccount(),this.listenCommissionAccount()}catch(e){}finally{this.isAccountsLoading=!1}})}selectDefaultSenderAccount(){try{1===this.senderAccountsList.length&&(this.senderAccountDropdown.selectAccount(this.senderAccountsList[0]),this.onSenderAccountSelect(this.senderAccountsList[0]),this.senderAccountDropdown.isDisabled=!0)}catch(e){}}retrieveContracts(){var e,o;return(0,U.mG)(this,void 0,void 0,function*(){this.isContractsLoading=!0;try{const r=yield this.currencyPaymentService.getContracts();this.contracts=r.filter(l=>l.status===Ve.J.REGED);const s=null===(o=null===(e=this.formValue.senderAccount)||void 0===e?void 0:e.balance)||void 0===o?void 0:o.currency;this.filteredContracts=s?this.contracts.filter(l=>l.permittedCurrencies.includes(s)):[...this.contracts]}catch(r){}finally{this.isContractsLoading=!1}})}retrieveKbks(){return(0,U.mG)(this,void 0,void 0,function*(){this.isKbkLoading=!0;try{this.kbkList=yield this.currencyPaymentService.getKbkList()}catch(e){}finally{this.isKbkLoading=!1}})}retrieveStatuses(){return(0,U.mG)(this,void 0,void 0,function*(){this.isStatusesLoading=!0;try{this.statuses=yield this.currencyPaymentService.getStatuses()}catch(e){}finally{this.isStatusesLoading=!1}})}retrieveCodeWords(e=this.currentCountryCode){return(0,U.mG)(this,void 0,void 0,function*(){if(!this.isCodeWordsLoading){this.isCodeWordsLoading=!0;try{if(e){this.codeWords=yield this.currencyPaymentService.getCodeWords(e);const o=this.form.controls.codeWord.value;this.codeWords.find(r=>o.code===r.code&&o.countryCode===r.countryCode)||this.form.controls.codeWord.setValue("")}}catch(o){}finally{this.isCodeWordsLoading=!1}}})}listenCountrySelect(){const{countryCode:e,senderAccount:o,country:r}=this.controlsStream;this.subs.add((0,N.aj)([e,o,r]).pipe((0,S.x)()).subscribe(s=>{var l,c,a;const[p,f]=s;!p||(this.form.controls.bankLabel.setValue(""),this.form.controls.bank.setValue(null),(null===(l=null==f?void 0:f.balance)||void 0===l?void 0:l.currency)===x.w.RUB||this.hasDefaultCity?(this.isCityShown=!1,this.clearValidation([this.form.controls.cityName])):(this.isCityShown=!0,this.setValidation([this.form.controls.cityName],[d.kI.required])),this.currentCountryCode===C.si.RU&&(null===(a=null===(c=f)||void 0===c?void 0:c.balance)||void 0===a?void 0:a.currency)===x.w.RUB&&(this.canPayCommission=!1))}))}listenContractsSwitchDescription(){this.subs.add(this.controlsStream.senderAccount.subscribe(e=>{var o,r,s,l;this.filteredContracts=this.contracts.filter(c=>{var a,p;return null===(a=c.permittedCurrencies)||void 0===a?void 0:a.includes(null===(p=null==e?void 0:e.balance)||void 0===p?void 0:p.currency)}),(null===(r=null===(o=this.formValue.contract)||void 0===o?void 0:o.amount)||void 0===r?void 0:r.currency)!==(null===(s=null==e?void 0:e.balance)||void 0===s?void 0:s.currency)&&(this.form.controls.contract.setValue(null),this.form.controls.contractId.setValue("")),this.updateContractsSwitchDescriptionParams((null===(l=null==e?void 0:e.balance)||void 0===l?void 0:l.currency)||null)}))}listenIsRussianBudget(){this.subs.add((0,N.aj)([this.controlsStream.senderAccount,this.controlsStream.bankAccount,this.controlsStream.bank,this.controlsStream.withinContract,this.controlsStream.contract,this.controlsStream.country]).subscribe(e=>{var o;const[r,s,l]=e,c=_t(s)&&Mt(null==l?void 0:l.bic);this.currentCountryCode===C.si.RU&&(null===(o=null==r?void 0:r.balance)||void 0===o?void 0:o.currency)===x.w.RUB&&c&&!this.featureFlagsService.isDisabled(j.Y.RUB_BUDGET_PAYMENT)?(this.isRussianBudget$.next(!0),this.form.controls.isRussianBudget.setValue(!0)):(this.isRussianBudget$.next(!1),this.form.controls.isRussianBudget.setValue(!1))}))}listenWithinContractSwitch(){const{withinContract:e,senderAccount:o,contract:r,country:s}=this.controlsStream;this.subs.add((0,N.aj)([e,o,r,s]).pipe((0,S.x)()).subscribe(l=>{var c;const[a,p,f,m]=l;this.withinContract=a;const h=null===(c=null==p?void 0:p.balance)||void 0===c?void 0:c.currency,{bank:_,bankLabel:g}=this.form.controls,y=[_,g];if(this.currentCountryCode===C.si.US?(this.cityPlaceholder$.next("CURRENCY_PAYMENT.RECIPIENT.CITY_STATE"),this.clearValidation([this.form.controls.bankLabel,this.form.controls.bank])):this.cityPlaceholder$.next(this.formValue.isRubNonRussia?"CURRENCY_PAYMENT.RECIPIENT.CITY_BANK":"CURRENCY_PAYMENT.RECIPIENT.CITY"),a){const I=h===x.w.RUB;this.isKioEnabled$.next(!((null==f?void 0:f.contractor.iinOrBin)||!I)),this.clearValidation(y),this.setValidation([this.form.controls.contractId],[H=>this.currentCountryCode!==C.si.CN&&h===x.w.CNY?{cnyOnlyToChina:!0}:null,d.kI.required],null,!1);const k=h===x.w.AUD,L=this.currentCountryCode===C.si.CA,F=this.currentCountryCode===C.si.AU;this.isAustraliaAud$.next(k&&F),this.isAustraliaNonAud$.next(!k&&F),this.isCountryCanada$.next(L),this.currentCountryCode&&h===x.w.RUB&&(this.rubNonRussiaWithinContractCountry=f.contractor.country.code,this.applyRubPaymentRules(this.rubNonRussiaWithinContractCountry))}else{this.form.controls.contract.setValue(null,{emitEvent:!1}),this.form.controls.contractId.setValue(null),this.clearValidation([this.form.controls.contractId]),this.setValidation(y,[d.kI.required]);const A=h===x.w.AUD,T=this.currentCountryCode===C.si.AU,I=this.currentCountryCode===C.si.CA;this.isAustraliaAud$.next(A&&T),this.isAustraliaNonAud$.next(!A&&T),this.isCountryCanada$.next(I),h===x.w.RUB?this.applyRubPaymentRules(this.currentCountryCode):h===x.w.CNY?(this.form.controls.codeWord.setValue(""),this.applyChinaPaymentRules(this.currentCountryCode)):this.applyDefaultPaymentRules()}}))}listenCodeWordEnabling(){const{withinContract:e,contract:o,country:r}=this.controlsStream;this.subs.add((0,N.aj)([e,o,r]).subscribe(s=>{this.currentCountryCode===C.si.AE?(this.isCodeWordEnabled$.next(!0),this.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD_AE")):this.currentCountryCode===C.si.CN?(this.isCodeWordEnabled$.next(!0),this.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD")):(this.isCodeWordEnabled$.next(!1),this.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD"))}))}listenContractSelect(){this.subs.add(this.controlsStream.contractId.pipe((0,S.x)()).subscribe(e=>{this.isContractSelected=!!e}))}updateContractsSwitchDescriptionParams(e=x.w.USD){return(0,U.mG)(this,void 0,void 0,function*(){if(e&&e!==x.w.USD){this.isContractsDescriptionLoading=!0;const s={currencyFrom:e,currencyTo:x.w.USD,sum:{amount:1e4,currency:x.w.USD}};try{const l=yield this.conversionService.getRate(s);this.contractMaxAmount={amount:l.calculatedSum,currency:e}}catch(l){this.contractMaxAmount={amount:1e4,currency:x.w.USD}}finally{this.isContractsDescriptionLoading=!1}}else this.contractMaxAmount={amount:1e4,currency:x.w.USD};let o=this.maskService.getMaskedAmount(this.contractMaxAmount.amount);o=o.split(",").filter(s=>parseInt(s,10)>0).map((s,l)=>1===l&&s.length<2?`${s}0`:s).join(",");const r=this.curSymbolPipe.transform(this.contractMaxAmount.currency);this.contractsSwitchDescriptionParams={amount:`${o} ${r}`}})}openForeignRecipientsDictionary(){var e;return(0,U.mG)(this,void 0,void 0,function*(){const o=this.modals.open(Ct.PE,{backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",centered:!0});try{const r=yield o.result,{countryCode:s,cityName:l,name:c,bankAccount:a,kbeCode:p,bank:f,kio:m}=this.form.controls,{recipient:h,account:_}=r;s.setValue(h.countryCode),l.setValue(h.cityName||""),c.setValue(h.name||""),a.setValue(_.iban),p.setValue(h.kbe.code),f.setValue({bic:_.bic,name:_.bankName}),this.bankDropdown.selectByBic(_.bic),null===(e=this.rubNonRussiaBankDropdown)||void 0===e||e.selectByBic(_.bic),null==m||m.setValue(h.iinOrBin)}catch(r){}})}get formValue(){return this.form.getRawValue()}get shouldBindContract(){var e,o;return-1===Qt.indexOf(this.formValue.knp)&&!this.isForeignContractDisabled&&(null===(o=null===(e=this.formValue.senderAccount)||void 0===e?void 0:e.balance)||void 0===o?void 0:o.currency)===this.contractMaxAmount.currency&&!this.formValue.contractId&&this.maskService.getNumberedAmount(this.formValue.amount)>this.contractMaxAmount.amount}applyAmountValidation(){this.subs.add((0,N.aj)([this.controlsStream.senderAccount,this.controlsStream.contractId]).subscribe(e=>{var o;const[r,s]=e;let l=[d.kI.required,d.kI.min(this.paymentsService.rules.minAmount),d.kI.max(this.paymentsService.rules.maxAmount),c=>0===(null==c?void 0:c.value)?{cantBeZero:!0}:null];(null===(o=null==r?void 0:r.balance)||void 0===o?void 0:o.currency)===this.contractMaxAmount.currency&&!s&&l.push(c=>{const a=this.maskService.getNumberedAmount(c.value);if(!this.isForeignContractDisabled&&!this.withinContract)return a>this.contractMaxAmount.amount?-1!==Qt.indexOf(this.formValue.knp)?null:{mustIncludeContract:!0}:null}),this.setValidation([this.form.controls.amount],l,null,!1)}))}setValidation(e,o,r=[],s=!0){e.forEach(l=>{const c=l.pristine;l.setValidators(o),l.setAsyncValidators(r),l.updateValueAndValidity({emitEvent:s}),setTimeout(()=>{c&&l.markAsPristine()},0)})}clearValidation(e,o=!0){e.forEach(r=>{const s=r.pristine;r.clearValidators(),r.clearAsyncValidators(),r.updateValueAndValidity({emitEvent:o}),setTimeout(()=>{s&&r.markAsPristine()},0)})}listenPayComission(){this.subs.add(this.controlsStream.payComission.pipe((0,S.x)()).subscribe(e=>{this.isOurComission=e}))}listenIntermediaryBankSwitchable(){const{senderAccount:e,country:o,bank:r}=this.controlsStream;this.subs.add((0,N.aj)([e,o,r]).subscribe(s=>{var l;const[c,a,p]=s,f=null===(l=null==c?void 0:c.balance)||void 0===l?void 0:l.currency;(f===x.w.EUR||f===x.w.USD&&this.currentCountryCode!==C.si.US)&&(null==p?void 0:p.bic)!==Pt.JYSAN?(this.isIntermediaryBankSwitchable=!0,this.setValidation([this.form.controls.intermediaryBankLabel],[h=>{const _=this.form.getRawValue();return h.value&&h.value===_.bankLabel?{equalBanks:!0}:null}],Ft.W.bankRestricted(this.dictionaries))):(this.clearValidation([this.form.controls.intermediaryBankLabel]),this.isIntermediaryBankSwitchable=!1)}))}listenIntermediaryBankSwitch(){this.subs.add(this.controlsStream.hasIntermediaryBank.pipe((0,S.x)()).subscribe(e=>{this.hasIntermediaryBank=e,e||(this.form.controls.intermediaryBankLabel.setValue(""),this.form.controls.intermediaryBank.setValue(null))}))}listenEmailSearch(){const{emailOnSuccess:e}=this.form.controls;this.subs.add(this.controlsStream.notify.pipe((0,J.b)(100)).subscribe(o=>o?e.enable():e.disable())),this.search=o=>(0,N.aj)([this.prevEmails$.pipe((0,M.U)(r=>r.map(s=>s.email))),o.pipe((0,J.b)(200),(0,S.x)(),(0,gt.O)("")),this.focusEmail$]).pipe((0,M.U)(([r,s,l])=>s?r.filter(c=>c.toLowerCase().indexOf(s.toLowerCase())>-1).slice(0,3):r.slice(0,3)))}setAutoNumeration(){this.subs.add(this.paymentsService.foreignPaymentNumber$.pipe((0,se.M)(this.controlsStream.number)).subscribe(([e,o])=>{o||this.form.controls.number.setValue(e)}))}listenCommission(){const{senderAccount:e,date:o,commissionAccount:r,amount:s,payComission:l}=this.controlsStream;(0,N.aj)([e,o,r,s,l,this.workingHours$.asObservable()]).pipe((0,J.b)(300)).subscribe(c=>{this.updateComission()})}updateComission(){var e,o,r,s,l,c,a,p,f,m,h,_;return(0,U.mG)(this,void 0,void 0,function*(){const{senderAccount:g,date:y,commissionAccount:A,amount:T,payComission:I}=this.form.controls;let k=!0;if([g,y,A,T,I].forEach(F=>{F.invalid&&(k=!1)}),!k)return;const L=this.form.getRawValue();try{const F=L.date?(0,D.ngbStructToISO)(L.date):null,H=this.maskService.getNumberedAmount(L.amount),K={companyId:this.companyService.currentId,category:O.nK.FOREIGN,type:O.V_.FOREIGN,details:{valueDate:F,paymentAmount:{amount:H,currency:null===(o=null===(e=L.senderAccount)||void 0===e?void 0:e.balance)||void 0===o?void 0:o.currency},foreignPaymentDetails:{type:L.payComission?"OUR":"SHA"},urgent:!1,payerIban:L.senderAccount.iban}};this.commissionBalance=yield this.api.getCommissionWithCurrency(K),this.form.controls.comission.setValue((null===(r=this.commissionBalance)||void 0===r?void 0:r.amount)||0),this.form.controls.comissionCurrency.setValue(this.commissionBalance.currency),this.comissionMessage=(null===(l=null===(s=L.commissionAccount)||void 0===s?void 0:s.balance)||void 0===l?void 0:l.amount)<(null===(c=this.commissionBalance)||void 0===c?void 0:c.amount)&&(null===(p=null===(a=L.commissionAccount)||void 0===a?void 0:a.balance)||void 0===p?void 0:p.currency)===(null===(f=this.commissionBalance)||void 0===f?void 0:f.currency)?this.mapCommissionMessage({amount:(null===(m=this.commissionBalance)||void 0===m?void 0:m.amount)-(null===(_=null===(h=L.commissionAccount)||void 0===h?void 0:h.balance)||void 0===_?void 0:_.amount),currency:this.commissionBalance.currency}):(0,vt.of)(null)}catch(F){this.commission$.next(null),this.comissionMessage=null}})}mapCommissionMessage(e,o=this.workingHours$.value){const s=this.form.getRawValue().date,l=this.maskService.formatAmount(e.amount),c=this.curSymbolPipe.transform(e.currency),a=(null==o?void 0:o.endTime)||D.edgeTimeLabel;return this.translateService.get(s?"CURRENCY_PAYMENT.MESSAGES.COMMISSION.WITH_DATE":"CURRENCY_PAYMENT.MESSAGES.COMMISSION.DEFAULT",{amount:`${l} ${c}`,edge:`${(0,D.formatNgbDate)(s,this.translateService.currentLang)} ${a}`})}mapAmountMessage(e,o=this.workingHours$.value){const s=this.form.getRawValue().date,l=this.maskService.formatAmount(e.amount),c=this.curSymbolPipe.transform(e.currency),a=(null==o?void 0:o.endTime)||D.edgeTimeLabel;return this.translateService.get(s?"CURRENCY_PAYMENT.MESSAGES.AMOUNT.WITH_DATE":"CURRENCY_PAYMENT.MESSAGES.AMOUNT.DEFAULT",{amount:`${l} ${c}`,edge:`${(0,D.formatNgbDate)(s,this.translateService.currentLang)} ${a}`})}sortAccounts(e,o){return e.balance.currency===o.balance.currency?0:e.balance.currency===x.w.USD?-1:1}listenAmount(){const{amount:e}=this.form.controls;this.subs.add(this.controlsStream.senderAccount.pipe((0,S.x)(),(0,M.U)(o=>{var r;const s=null===(r=null==o?void 0:o.balance)||void 0===r?void 0:r.currency,l=e.pristine;return this.amountSuffix=` ${this.curSymbolPipe.transform(s)||s||this.curSymbolPipe.transform(x.w.KZT)}`,s===de?(this.amountMask="separator.0",this.amountPlaceholder="0"):(this.amountMask="separator.2",this.amountPlaceholder="0,00"),l}),(0,qe.g)(0)).subscribe(o=>{o&&o!==e.pristine&&e.markAsPristine()}))}listenAmountMessage(){const{senderAccount:e,date:o,amount:r,contractId:s}=this.controlsStream;(0,N.aj)([e,o,r,s,this.workingHours$.asObservable()]).pipe((0,S.x)()).subscribe(l=>{var c,a;const[p,f,m,h,_]=l,g=this.maskService.getNumberedAmount(m),y=(null===(c=null==p?void 0:p.balance)||void 0===c?void 0:c.amount)<g&&!this.shouldBindContract;this.amountMessage=y?this.mapAmountMessage({amount:g-(null===(a=null==p?void 0:p.balance)||void 0===a?void 0:a.amount),currency:p.balance.currency}):(0,vt.of)(null)})}listenCommissionAccount(){this.subs.add(this.controlsStream.senderAccount.pipe((0,S.x)()).subscribe(e=>{var o,r,s,l,c;const p=this.form.getRawValue().commissionAccount;if(p&&(null===(o=null==p?void 0:p.balance)||void 0===o?void 0:o.currency)!=(null===(r=null==e?void 0:e.balance)||void 0===r?void 0:r.currency)&&(this.commissionAccountDropdown.clearSelected(),this.onCommissionAccountSelect(null)),1===this.commissionAccountsList.length){const m=this.commissionAccountsList[0];null===(s=this.commissionAccountDropdown)||void 0===s||s.selectAccount(m),this.onCommissionAccountSelect(m),this.isCommissionAccountSelectable=!1}else this.isCommissionAccountSelectable=!0;const f=this.commissionAccountsList.filter(m=>m.balance.currency===x.w.KZT);1===(null==f?void 0:f.length)?(null===(l=this.commissionAccountDropdown)||void 0===l||l.selectAccount(f[0]),this.onCommissionAccountSelect(f[0])):0===f.length&&e&&(null===(c=this.commissionAccountDropdown)||void 0===c||c.selectAccount(e),this.onCommissionAccountSelect(e))}))}saveToDraft(e){var o;this.formDirective.submitted=!0,this.formDirective.form.markAsPristine();const r=this.paymentsService.foreignPaymentNumber,s=e||Object.assign({},this.form.value);r.entity=null,this.processingPayment$.next(Object.assign({id:this.paymentId},s)),this.pipeline.saveToDrafts(s,{paymentId:this.paymentId,type:O.V_.FOREIGN,commission:null===(o=this.commissionBalance)||void 0===o?void 0:o.amount,userPurpose:this.form.value.purpose,category:O.nK.FOREIGN}).then(l=>{l.id!==this.paymentId&&(l&&(this.restoredData={status:l.status,signatures:l.signatures,companyId:l.companyId}),this.router.navigate([this.route.snapshot.params.paymentId?"../":".",l.id],{relativeTo:this.route,replaceUrl:!0,state:{silent:!0,resolvedPayment:this.currencyPaymentService.mapForm(this.form.getRawValue())}}))}).catch(l=>{!r.entity&&!r.fetching&&(r.entity=s.number)}).finally(()=>{this.processingPayment$.next(null)})}listenRouterParams(){this.subs.add(this.route.params.pipe((0,M.U)(e=>({state:window.history.state,params:e,route:this.route})),(0,J.b)(0),(0,wt.w)(({params:e,state:o})=>{if(null==o?void 0:o.silent)return this.restoredData.status===O.R$.DRAFT?this.paymentsService.rootTitle=C.TB.EDIT_DRAFT:this.restoredData.status===O.R$.CREATED&&(this.paymentsService.rootTitle=C.TB.EDIT_PAYMENT),Dt.E;if(null==o?void 0:o.resolvedPayment)return(0,vt.of)(o.resolvedPayment);if(e.paymentId||(null==o?void 0:o.repeatPaymentId)){const r=e.paymentId||o.repeatPaymentId;return(0,Be.D)(this.api.getPaymentById(r)).pipe((0,Qe.K)(s=>(this.router.navigate([this.router.url.replace("/"+r,"")]),Dt.E)))}return this.setAutoNumeration(),this.paymentsService.rootTitle=C.TB.NEW,Dt.E})).subscribe(e=>{this.restorePayment(e)}))}restorePayment(e){this.subs.add((0,N.aj)([this.knpStore.fetched$]).pipe((0,Et.h)(o=>o.every(r=>r)),(0,z.b)(()=>{var o;let r;try{r=this.pipeline.flattenPaymentToModel(e)}catch(s){r={}}this.restoredData={companyId:e.companyId,status:null===(o=e.status)||void 0===o?void 0:o.code,signatures:e.signatures},e.isNewPayment||e.id&&!this.paymentId?(r.number="",r.date=null,this.restoredData.status=null,this.paymentsService.rootTitle=C.TB.NEW):this.paymentsService.rootTitle=this.restoredData.status===O.R$.DRAFT?C.TB.EDIT_DRAFT:C.TB.EDIT_PAYMENT,r.emailOnSuccess&&(r.notify=!0),this.form.patchValue(Object.assign({},r)),this.restoreAsyncData(e),this.isImported=e.imported,r.number||this.setAutoNumeration()}),(0,J.b)(10),(0,$e.q)(1)).subscribe())}sendPayment(e){var o,r;this.formDirective.form.markAsPristine();const s=this.paymentsService.paymentNumber,l=e||Object.assign({},this.form.value);return this.processingPayment$.next(l),this.paymentsService.paymentNumber.entity=null,this.pipeline.processPayment({paymentId:this.paymentId,total:l.amount,commission:null===(o=this.commissionBalance)||void 0===o?void 0:o.amount,status:null===(r=this.restoredData)||void 0===r?void 0:r.status,userPurpose:this.form.value.purpose,rawBody:l}).then(c=>{c?this.restoredData={status:c.status.code,signatures:c.signatures,companyId:c.companyId}:(this.restoredData=null,!s.entity&&!s.fetching&&(s.entity=l.number))}).catch(c=>{}).finally(()=>{this.processingPayment$.next(null)})}onSubmit(e){e&&e.preventDefault(),this.form.valid?this.processPayment():this.form.markAllAsTouched()}processPayment(){return(0,U.mG)(this,void 0,void 0,function*(){const e=this.form.getRawValue();this.processingPayment$.next(e);try{const o=yield this.api.checkWorkingTime(e.date),r=yield this.api.checkAmountLimit(e.amount,this.paymentType);o&&r?this.sendPayment():this.processingPayment$.next(null)}catch(o){this.processingPayment$.next(null)}})}showAmlMainModal(){return(0,U.mG)(this,void 0,void 0,function*(){const e=this.modalService.open(He.g,{backdropClass:"backdrop_light",windowClass:"modal_light modal_sm",centered:!0});try{yield e.result}catch(o){}finally{return}})}openContractsAddingModal(e=null){null==e||e.preventDefault(),this.contractsModalsService.showAddContractModal(!1)}openKnpDictionary(e,o){e.close(),e.blur(),setTimeout(()=>{this.modals.open(Ct.Rp,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then(r=>{this.form.controls.knp.patchValue(r),this.form.controls.knpObject.patchValue(r)}).catch(()=>{})},0)}restoreAsyncData(e){var o,r,s,l,c,a,p,f,m,h,_,g,y;return(0,U.mG)(this,void 0,void 0,function*(){yield this.retrieveAccounts(),this.senderAccountDropdown.selectByIban(null===(o=e.details)||void 0===o?void 0:o.payerIban);const A=null===(s=null===(r=null==e?void 0:e.paymentRecipient)||void 0===r?void 0:r.recipientAccount)||void 0===s?void 0:s.bic,T=null===(c=null===(l=null==e?void 0:e.details)||void 0===l?void 0:l.foreignPaymentDetails)||void 0===c?void 0:c.intermediaryBankBic,I=null===(p=null===(a=null==e?void 0:e.details)||void 0===a?void 0:a.foreignPaymentDetails)||void 0===p?void 0:p.intermediaryBankIban;(null===(f=this.formValue.senderAccount)||void 0===f?void 0:f.balance.currency)===x.w.RUB&&this.currentCountryCode!==C.si.RU&&this.isRubNonRussia$.next(!0),A&&setTimeout(()=>{var k,L;this.formValue.isRubNonRussia?null===(k=this.rubNonRussiaBankDropdown)||void 0===k||k.selectByBic(A):null===(L=this.bankDropdown)||void 0===L||L.selectByBic(A)},100),T&&setTimeout(()=>{var k;this.formValue.isRubNonRussia?this.rubNonRussiaCorrespondentBankDropdown.selectByBic(T):null===(k=this.intermediaryBankDropdown)||void 0===k||k.selectByBic(T)},100),I&&this.formValue.isRubNonRussia&&this.form.controls.rubNonRussiaCorrespondentIban.setValue(I),this.withinContract&&this.onContractSelect(this.formValue.contract,!0),(null===(m=e.details)||void 0===m?void 0:m.foreignPaymentDetails.codeWord)&&(yield this.retrieveCodeWords(),this.form.controls.codeWord.setValue(e.details.foreignPaymentDetails.codeWord)),this.commissionAccountDropdown.selectByIban(e.details.foreignPaymentDetails.commissionWithdrawalIban),this.hasDefaultCity=!!(null===(_=null===(h=e.paymentRecipient)||void 0===h?void 0:h.country)||void 0===_?void 0:_.defaultCityName),(null===(y=null===(g=null==e?void 0:e.details)||void 0===g?void 0:g.paymentAmount)||void 0===y?void 0:y.currency)===x.w.RUB||this.hasDefaultCity?(this.isCityShown=!1,this.clearValidation([this.form.controls.cityName])):(this.isCityShown=!0,this.setValidation([this.form.controls.cityName],[d.kI.required]))})}listenPurposeMessageStream(){this.subs.add((0,N.aj)([this.purposeMessage$,this.controlsStream.purpose,this.controlsStream.countryCode]).pipe((0,M.U)(e=>{const[o,r,s]=e;return s===C.si.CN?(r||"").length:(o||"").length+(r||"").length})).subscribe(this.purposeLength$)),this.validatePurpose()}listenIsRussianTaxpayer(){this.subs.add(this.controlsStream.isRussianTaxPayer.subscribe(e=>{e?(this.isRussianTaxpayer=!0,this.setValidation([this.form.controls.payerInn],[d.kI.required,$t])):(this.isRussianTaxpayer=!1,this.clearValidation([this.form.controls.payerInn]))}))}listenHasRussianBudgetExtras(){this.subs.add(this.controlsStream.hasRussianBudgetExtras.subscribe(e=>{this.hasRussianBudgetExtras=!!e}))}listenKvo(){this.subs.add(this.isKvoEnabled$.pipe((0,S.x)()).subscribe(e=>{e?this.setValidation([this.form.controls.kvo],[d.kI.required]):this.clearValidation([this.form.controls.kvo])}))}listenPurpose(){this.subs.add((0,N.aj)([this.isKvoEnabled$.pipe((0,S.x)()),this.controlsStream.kvo.pipe((0,S.x)()),this.controlsStream.isRubNonRussia.pipe((0,S.x)()),this.controlsStream.name.pipe((0,S.x)()),this.controlsStream.withinContract.pipe((0,S.x)()),this.controlsStream.bankAccount,this.controlsStream.country,this.controlsStream.countryCode,this.controlsStream.codeWord]).subscribe(e=>{var o;const[r,s,l,c,a,p,f,m,h]=e;let _="";r&&(_+=`'(VO${s||""})'`),l&&!a&&(_+=` \u0434\u043b\u044f ${c||""} \u0441\u0447\u0451\u0442 '${p||""}'`),m===C.si.CN&&(_+=`//${(null===(o=h)||void 0===o?void 0:o.code)||""}`),this.purposeMessage$.next(_)}))}listenKio(){this.subs.add((0,N.aj)([this.isKioEnabled$,this.isRussianBudget$]).pipe((0,S.x)()).subscribe(e=>{const[o,r]=e;if(o){let s;s=r?[$t,d.kI.required]:[$t],this.setValidation([this.form.controls.kio],s)}else this.clearValidation([this.form.controls.kio])}))}listenCodeWordsList(){const{country:e,countryCode:o,contract:r,withinContract:s}=this.controlsStream;this.subs.add((0,N.aj)([e,o,r,s]).subscribe(l=>{this.retrieveCodeWords()}))}listenCodeWord(){this.subs.add(this.isCodeWordEnabled$.pipe((0,S.x)()).subscribe(e=>{e?this.setValidation([this.form.controls.codeWord],[d.kI.required]):this.clearValidation([this.form.controls.codeWord])}))}listenRubToNonRussia(){this.subs.add((0,N.aj)([this.isRussianBudget$,this.isRubToRussia$,this.isRubNonRussia$,this.controlsStream.senderAccount,this.controlsStream.contract,this.controlsStream.withinContract,this.controlsStream.bankAccount,this.controlsStream.bank]).subscribe(e=>{var o;const[r,s,l,c,a,p,f,m]=e;this.form.controls.isRubNonRussia.setValue(l);const h=null===(o=a)||void 0===o?void 0:o.contractor.bankCountryCode;l?(h&&h===C.si.RU?setTimeout(()=>{this.rubNonRussiaCorrespondentBankDropdown.selectByBic(a.contractor.bank.code)},100):h&&h!==C.si.RU&&setTimeout(()=>{var _;this.rubNonRussiaBankDropdown.selectByBic(null===(_=this.formValue.contract)||void 0===_?void 0:_.contractor.bank.code)},100),this.clearValidation([this.form.controls.bank,this.form.controls.bankLabel],!1),this.setValidation([this.form.controls.rubNonRussiaBank,this.form.controls.rubNonRussiaBankLabel],[d.kI.required]),this.setValidation([this.form.controls.rubNonRussiaCorrespondentBankLabel],[d.kI.required,_=>_.value?null:{required:!0},()=>{var _;const g=this.dictionaries.bankDictionary.getItemByKey(null===(_=this.form.controls.rubNonRussiaBank.value)||void 0===_?void 0:_.id,"id");return!1===(null==g?void 0:g.transferAllowed)?{bankRestricted:!0}:null}]),this.setValidation([this.form.controls.rubNonRussiaCorrespondentIban],[d.kI.required,Yo],Ft.W.externalIbanRestricted(this.dictionaries))):(p?this.clearValidation([this.form.controls.bank,this.form.controls.bankLabel],!1):(this.setValidation([this.form.controls.bank],[d.kI.required],null,!1),this.setValidation([this.form.controls.bankLabel],[d.kI.required,()=>{var _,g,y,A,T,I;return this.currentCountryCode===C.si.RU&&(null===(g=null===(_=c)||void 0===_?void 0:_.balance)||void 0===g?void 0:g.currency)===x.w.RUB&&_t(f)&&Mt(null===(y=m)||void 0===y?void 0:y.bic)&&this.isRussianBudgetDisabled?{rubBudgetDisabled:!0}:this.currentCountryCode===C.si.RU&&(null===(T=null===(A=c)||void 0===A?void 0:A.balance)||void 0===T?void 0:T.currency)===x.w.RUB&&_t(f)&&!Mt(null===(I=m)||void 0===I?void 0:I.bic)?{rubBudgetWrongBic:!0}:null},()=>{var _;const g=this.dictionaries.bankDictionary.getItemByKey(null===(_=this.form.controls.bank.value)||void 0===_?void 0:_.id,"id");return!1===(null==g?void 0:g.transferAllowed)?{bankRestricted:!0}:null}])),this.clearValidation([this.form.controls.rubNonRussiaCorrespondentBankLabel,this.form.controls.rubNonRussiaCorrespondentIban]))}))}listenRubNonRussiaCorrespondentBank(){this.subs.add(this.controlsStream.rubNonRussiaBank.subscribe(e=>{(null==e?void 0:e.cityName)&&this.form.controls.cityName.setValue(e.cityName)}))}applyRubPaymentRules(e){!e||(this.applyRubPurposeRules(),e===C.si.RU?(this.isRubNonRussia$.next(!1),this.isRubToRussia$.next(!0),this.applyRubToRussiaKvoAndKioRules(),this.applyRubToRussiaPayCommissionRules()):(this.isRubNonRussia$.next(!0),this.isRubToRussia$.next(!1),this.applyRubToNonRussiaCorrespondentRules(),this.applyRubToNonRussiaKvoAndKioRules()))}applyRubPurposeRules(){this.masks.purpose=pt.K.foreignCyrillic}applyRubToRussiaKvoAndKioRules(){this.isKvoEnabled$.next(!0),this.isKioEnabled$.next(!0),this.isKppEnabled$.next(!0)}applyRubToRussiaPayCommissionRules(){this.canPayCommission=!1,this.form.controls.payComission.setValue(!1)}applyRubToNonRussiaCorrespondentRules(){this.cityPlaceholder$.next("CURRENCY_PAYMENT.RECIPIENT.CITY_BANK")}applyRubToNonRussiaKvoAndKioRules(){this.isKvoEnabled$.next(!0),this.isKioEnabled$.next(!1),this.isKppEnabled$.next(!1)}applyDefaultPaymentRules(){this.isRubNonRussia$.next(!1),this.applyDefaultPaymentPurposeRules(),this.applyDefaultPaymentKvoAndKioRules(),this.applyDefaultPaymentPayCommissionRules(),this.applyDefaultPaymentCodeWordRules()}applyDefaultPaymentPayCommissionRules(){this.canPayCommission=!0}applyDefaultPaymentPurposeRules(){this.masks.purpose=pt.K.foreignLatin}applyDefaultPaymentKvoAndKioRules(){this.isKioEnabled$.next(!1),this.isKvoEnabled$.next(!1),this.isKppEnabled$.next(!1)}applyDefaultPaymentCodeWordRules(){this.isCodeWordEnabled$.next(!1)}applyChinaPaymentRules(e){e||(this.form.controls.countryCode.setValue(C.si.CN),this.hasDefaultCity=!1,this.retrieveCodeWords(C.si.CN)),this.isCodeWordEnabled$.next(!0),this.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD")}knpIsChanged(){this.subs.add((0,N.aj)([this.controlsStream.senderAccount,this.controlsStream.contractId]).subscribe(e=>{const o=[d.kI.required,d.kI.min(this.paymentsService.rules.minAmount),d.kI.max(this.paymentsService.rules.maxAmount),r=>0===(null==r?void 0:r.value)?{cantBeZero:!0}:null];o.push(r=>{const s=this.maskService.getNumberedAmount(r.value);if(!this.isForeignContractDisabled&&!this.withinContract)return s>this.contractMaxAmount.amount?-1!==Qt.indexOf(this.formValue.knp)?null:{mustIncludeContract:!0}:null}),this.setValidation([this.form.controls.amount],o,null,!1)}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Jt.JN),t.Y36(C.cR),t.Y36(et.O),t.Y36(Z.gz),t.Y36(Z.F0),t.Y36(C.e6),t.Y36(dt.$),t.Y36(E.sK),t.Y36(nt.Eg),t.Y36(R.FF),t.Y36(C.Zx),t.Y36(C.$g),t.Y36(B.Iq),t.Y36(Jt.Fb),t.Y36(j.a),t.Y36(Q.vI),t.Y36(q.iu),t.Y36(C.hm),t.Y36(Q.M),t.Y36(We.r),t.Y36(ae.T))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-currency-payment"]],viewQuery:function(e,o){if(1&e&&(t.Gf(tn,7),t.Gf(en,5),t.Gf(nn,5),t.Gf(on,5),t.Gf(rn,5),t.Gf(sn,5),t.Gf(an,5),t.Gf(cn,5),t.Gf(ln,5),t.Gf(un,5)),2&e){let r;t.iGM(r=t.CRH())&&(o.emailOnSuccess=r.first),t.iGM(r=t.CRH())&&(o.senderAccountDropdown=r.first),t.iGM(r=t.CRH())&&(o.contractsSelect=r.first),t.iGM(r=t.CRH())&&(o.contractDetails=r.first),t.iGM(r=t.CRH())&&(o.bankDropdown=r.first),t.iGM(r=t.CRH())&&(o.intermediaryBankDropdown=r.first),t.iGM(r=t.CRH())&&(o.commissionAccountDropdown=r.first),t.iGM(r=t.CRH())&&(o.rubNonRussiaBankDropdown=r.first),t.iGM(r=t.CRH())&&(o.rubNonRussiaCorrespondentBankDropdown=r.first),t.iGM(r=t.CRH())&&(o.rubNonRussiaCorrespondentIbanInput=r.first)}},features:[t._Bn([{provide:mt.rD,useClass:mt.hu}]),t.qOj],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],[1,"payment-section"],["autocomplete","off","jInvalidControlScroll","","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"mb-4"],["translate","",1,"mb-4"],[3,"isLoading","isDisabledSelectable","label","hasError","accounts","selected"],["senderAccountDropdown",""],[1,"j-switch-wrap","form-group"],[3,"formControl"],[1,"ml-3"],["translate",""],["class","contracts-description",3,"jLoading","jLoadingInverted","is-loading",4,"ngIf"],[1,"form-section"],[1,"recipient-title","mb-4"],["translate","",1,"m-0"],["class","btn btn-link p-0 p3","type","button","translate","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.OPEN",3,"click",4,"ngIf"],["class","btn btn-link p-0 p3","type","button","translate","CURRENCY_PAYMENT.DICTIONARY.OPEN",3,"click",4,"ngIf"],[1,"form-group"],["clearable","true"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","dropSpecialCharacters","maxlength","formControl","paste"],["countryWrapper",""],["bindValue","code",3,"appendTo","jFocusOnReturn","formControl","readonly","clearable","searchFn","items","change","focus","search"],["countrySelect",""],["j-option-tmp",""],["j-label-tmp",""],[3,"control","errorMessages"],["class","form-group",4,"ngIf"],["type","text","jFormInput","","jFocusOnReturn","","jUppercase","",1,"form-control",3,"mask","formControl"],["accountInput","jFormInput"],[3,"control","errorMessages","params"],["class","j-switch-wrap form-group",4,"ngIf"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","formControl"],["allowAuto","true",3,"datesEnabled","formControl","formatValue","jFocusOnReturn","label","minDate","maxDate","helperText"],["datePicker",""],["knpWrapper",""],["bindLabel","label","bindValue","code",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","compareWith","items","change"],["knpSelect",""],["j-header-tmp",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl","mask","dropSpecialCharacters"],["purpose",""],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],["translate","",1,"j-input-helper","text-muted","mt-1","mb-0","p3"],[3,"hidden"],[3,"isLoading","accounts","isDisabledSelectable","hasError","label","selected"],["commissionAccountDropdown",""],["class","j-input-helper text-muted comission-message p3",4,"ngIf"],["clearable","true",3,"floatLabel"],["jFocusOnReturn","","jFormInput","","jCursorBound","","jReplaceDot","","thousandSeparator"," ","decimalMarker",",","maxlength","29",1,"form-control",3,"suffix","placeholder","mask","dropSpecialCharacters","formControl","paste"],["class","j-input-helper text-muted mt-1 p3",4,"ngIf"],[1,"j-input-helper","text-muted","mt-2","p3","position-relative"],[4,"ngIf","ngIfElse"],["commission",""],["class","mt-2","translate","CURRENCY_PAYMENT.COMISSION.DESCRIPTION",4,"ngIf"],[1,"list-group"],["class","list-group-item d-flex align-items-center",4,"ngIf"],[1,"list-group-item","d-flex","align-items-center"],[1,"ml-3","flex-grow-1"],["class","mt-1",4,"ngIf"],["class","my-3 p3 text-muted",3,"innerHTML",4,"ngIf"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],[3,"contract",4,"ngIf"],["amountInfo",""],["kbeInfo",""],["kppInfo",""],["oktmoInfo",""],["basisInfo",""],["budgetPeriodInfo",""],[1,"contracts-description",3,"jLoading","jLoadingInverted"],[1,"text-gray",3,"innerHTML"],["id","contractGroup",1,"form-group","mt-4"],["contractsWrapper",""],["bindValue","id",3,"loading","appendTo","jFocusOnReturn","formControl","clearable","searchFn","items","change"],["contractsSelect",""],["j-notfound-tmp",""],["href","#","jSuffix","","class","mr-1 p3","translate","",3,"click",4,"ngIf"],["class","mb-3",4,"ngIf"],[1,"mb-3"],["type","button","class","list-dictionary form-section--action btn btn-xs btn-link float-right",3,"click",4,"ngIf"],["type","button",1,"list-dictionary","form-section--action","btn","btn-xs","btn-link","float-right",3,"click"],[1,"j-option-label","text-wrap","p3"],[1,"text-dark","contract-row"],[3,"money"],[1,"text-muted","contract-row"],["translate","CURRENCY_PAYMENT.CONTRACTS.SELECT.REMAINDER"],[1,"contracts__empty"],["src","assets/img/payments/no_contract.svg"],[1,"mx-auto","mt-3","p2","text-muted",3,"innerHTML"],["href","#",1,"link","d-inline-block","mt-3",3,"click"],["label","CURRENCY_PAYMENT.CONTRACTS.NOT_FOUND"],[1,"text-center","my-2"],["href","#",1,"link","d-inline-block",3,"click"],["href","#","jSuffix","","translate","",1,"mr-1","p3",3,"click"],["type","button","translate","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.OPEN",1,"btn","btn-link","p-0","p3",3,"click"],["type","button","translate","CURRENCY_PAYMENT.DICTIONARY.OPEN",1,"btn","btn-link","p-0","p3",3,"click"],[1,"j-option-label","text-wrap"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","dropSpecialCharacters","maxlength","formControl"],[1,"kbe-account-row"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","4",1,"form-control",3,"formControl"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","28",1,"form-control",3,"formControl"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","10",1,"form-control",3,"formControl"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","25",1,"form-control",3,"formControl"],[1,"mt-0"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","70",1,"form-control",3,"formControl"],[3,"labelText","placeholderText","labelControl","errorMessages","bankControl"],["rubNonRussiaCorrespondentBankDropdown",""],["type","text","jFormInput","","jFocusOnReturn","","jUppercase","",1,"form-control",3,"validation","mask","formControl"],["rubNonRussiaCorrespondentIbanInput","jFormInput"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","jShadow","dropSpecialCharacters","formControl"],["href","javascript:void(0)","jSuffix","","tooltipClass","tooltip-light tooltip-large","triggers","mouseenter:mouseleave",1,"mr-1","link-gray",3,"ngbTooltip","inlineSVG"],["rubNonRussiaBankDropdown",""],[3,"placeholderText","labelControl","errorMessages","bankControl"],["bankDropdown",""],["class","j-input-helper text-muted mt-1 mb-0 p3","translate","",4,"ngIf"],[1,"intermediatory-content","ml-3"],["class","intermediatory-input",3,"placeholderText","labelControl","bankControl","errorMessages",4,"ngIf"],["translate","",1,"d-block","text-gray"],[1,"intermediatory-input",3,"placeholderText","labelControl","bankControl","errorMessages"],["intermediaryBankDropdown",""],["type","text","jFocusOnReturn","","jFormInput","","maxlength","12",1,"form-control",3,"mask","dropSpecialCharacters","formControl"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","jShadow","validation","formControl"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","isRussianTaxPayer",1,"custom-control-input",3,"formControl"],["for","isRussianTaxPayer",1,"custom-control-label"],["translate","CURRENCY_PAYMENT.RUSSIAN_BUDGET.IS_TAXPAYER",1,"p3","text-muted"],["class","russian-row",4,"ngIf"],[1,"russian-row"],["kbkRowWrapper",""],["kbkWrapper",""],[3,"loading","appendTo","jFocusOnReturn","formControl","clearable","searchFn","items"],["kbkSelect",""],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","jShadow","formControl"],["payerStatusWrap",""],["bindValue","code",3,"loading","appendTo","jFocusOnReturn","formControl","clearable","searchFn","items"],["payerStatusSelect",""],["type","checkbox","id","hasRussianBudgetExtras",1,"custom-control-input",3,"formControl"],["for","hasRussianBudgetExtras",1,"custom-control-label"],["translate","CURRENCY_PAYMENT.RUSSIAN_BUDGET.EXTRAS",1,"p3","text-muted"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","12",1,"form-control",3,"formControl"],["label","CURRENCY_PAYMENT.RUSSIAN_BUDGET.KBK_NOT_FOUND"],["label","CURRENCY_PAYMENT.RUSSIAN_BUDGET.STATUS_NOT_FOUND"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","jShadow","dropSpecialCharacters","formControl"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"formControl"],[1,"mr-2",3,"inlineSVG"],["translate","",1,"p2","m-0"],["translate","",1,"p3","text-gray"],["codeWordsWrapper",""],["codeWordsSelect",""],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"j-input-helper","text-muted","comission-message","p3"],[3,"innerHTML"],[1,"j-input-helper","text-muted","mt-1","p3"],[1,"text-danger","mr-1",3,"translate","translateParams"],["href","#",1,"link-blue","contracts-scroll-link",3,"click"],["translate","CURRENCY_PAYMENT.COMISSION.DESCRIPTION",1,"mt-2"],["translate","",1,"text-gray"],[1,"text-gray"],[1,"mt-1"],["type","email","jFormInput","","jFocusOnReturn","","autocomplete","off",1,"form-control",3,"ngbTypeahead","formControl","focus"],["emailOnSuccess","ngbTypeahead"],[1,"my-3","p3","text-muted",3,"innerHTML"],["type","button",1,"btn","btn-link","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit","translate","",1,"btn","btn-outline-primary","btn-static"],[3,"contract"],["contractDetails",""],[1,"p4",3,"innerHTML"]],template:function(e,o){1&e&&(t.YNc(0,mn,1,2,"j-restricted-placeholder",0),t.YNc(1,vo,157,145,"ng-container",1)),2&e&&(t.Q6J("ngIf",o.isRestricted),t.xp6(1),t.Q6J("ngIf",!o.isRestricted))},directives:[b.O5,ot.G,d._Y,d.JL,$,Y.L,d.sg,E.Pi,rt.S,st.q,d.JJ,d.oH,le.T,V.O8,it.I,at.F,Y.v,w.BN,w.Ok,Nt.y,w.qg,Rt.j,w.Fe,ue.v,ct.k,G.m,B.hx,d.Fj,d.nD,Xe.B,At.q,yt.N,R._L,Bt.d$,d.Wl,qt.Q,lt.L,Zt.a,St.s,R.dR,ut.Ro,me.W,pe.s],pipes:[E.X$,b.Ov,ze.L],styles:[".payments__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem}.payment-section--submit{text-align:right}.payment-section{max-width:582px}.payment-section--purpose-length{position:absolute;right:.8rem;top:.4rem;z-index:1}.payment-section--summary .payment-section--amount-warn{color:#666c72}@media (min-width: 960px){.payment-section--summary .payment-section--amount-warn{width:70%;text-align:right;margin-left:auto}}.kbe-account-row{margin-bottom:1rem}@media (min-width: 960px){.kbe-account-row{display:grid;grid-column-gap:12px;column-gap:12px;grid-template-columns:130px 1fr}}@media (min-width: 960px){.kbe-account-row .form-group{margin-bottom:0}}.intermediatory-content{width:100%}.intermediatory-input{margin-top:.5rem;position:relative;margin-bottom:.25rem}.intermediatory-input .bic-dropdown{left:0;right:0}.list-dictionary{display:inline-flex;align-items:center;line-height:1}.list-dictionary span{display:block}.comission-message{margin-top:-12px}.j-select .j-spinner-loader{top:19px}.contract-row{display:flex;width:100%;justify-content:space-between}.contract-row>*:first-child{padding-right:1rem}.contracts__empty{text-align:center;max-width:312px;margin:0 auto}.contracts-description{position:relative}.contracts-description.is-loading small{opacity:.5}.contracts-scroll-link{border-bottom:1px dashed #1586bb}.contracts-scroll-link:hover{border-color:#ef5630}.russian-row{position:relative;display:flex;justify-content:space-between;margin-bottom:1rem}.russian-row>*{width:100%;max-width:calc(50% - 6px)}.recipient-title{display:flex;justify-content:space-between;align-items:center}\n"],encapsulation:2}),n})();const jo=["paymentComponent"];let Te=(()=>{class n{constructor(e,o,r){this.location=e,this.navService=o,this.paymentsService=r}ngOnInit(){this.title$=this.paymentsService.rootTitle$.pipe((0,M.U)(e=>`CURRENCY_PAYMENT.${e}`))}onClose(){this.navService.retrieveContractBadges(),this.navService.retrieveLetterBadges(),this.location.back()}ngAfterViewInit(){this.formDirective=this.paymentComponent.formDirective,this.form=this.paymentComponent.form}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(b.Ye),t.Y36(te.t),t.Y36(X.cR))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-currency-payments"]],viewQuery:function(e,o){if(1&e&&t.Gf(jo,5),2&e){let r;t.iGM(r=t.CRH())&&(o.paymentComponent=r.first)}},features:[t._Bn([{provide:mt.rD,useClass:mt.hu}])],decls:9,vars:5,consts:[[3,"closed"],[1,"f-page-title"],["paymentComponent",""]],template:function(e,o){1&e&&(t.TgZ(0,"f-page",0),t.NdJ("closed",function(){return o.onClose()}),t.TgZ(1,"f-page-header")(2,"h1",1),t._uU(3),t.ALo(4,"translate"),t.ALo(5,"async"),t.qZA()(),t.TgZ(6,"f-page-body"),t._UZ(7,"j-currency-payment",null,2),t.qZA()()),2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,1,t.lcZ(5,3,o.title$))," "))},directives:[ee.J,ne.M,oe.G,ye],pipes:[E.X$,b.Ov],styles:[""]}),n})();var be=u(54103),It=u(42654),Do=u(43489);class Fo{call(i,e){return e.subscribe(new Jo(i))}}class Jo extends Do.L{constructor(i){super(i),this.hasPrev=!1}_next(i){let e;this.hasPrev?e=[this.prev,i]:this.hasPrev=!0,this.prev=i,e&&this.destination.next(e)}}var Bo=u(88117);let xe=(()=>{class n{constructor(){this.subs=new It.w,this.itemChanges$=new v.X(0),this.routerTrigger$=this.itemChanges$.pipe((0,gt.O)(this.itemChanges$.getValue()),function wo(){return n=>n.lift(new Fo)}(),(0,M.U)(([e,o])=>{const r={offsetEnterX:0,offsetLeaveX:0};return 0!==e&&(r.offsetEnterX=e>o?-100:100,r.offsetLeaveX=e>o?100:-100),{value:o,params:r}}),(0,Bo.B)())}ngOnInit(){this.subs.add(this.routerTrigger$.subscribe())}ngOnDestroy(){this.subs.unsubscribe()}onActivate(e,o){o.activatedRouteData&&o.activatedRouteData.animation&&o.activatedRouteData.index!==this.itemChanges$.getValue()&&this.itemChanges$.next(o.activatedRouteData.index)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=t.lG2({type:n}),n})();const Vt=function(n){return[n]};let ve=(()=>{class n extends xe{constructor(e,o,r,s){super(),this.navService=e,this.router=o,this.paymentsService=r,this.location=s,this.routes=P.KK}ngOnInit(){super.ngOnInit(),this.title$=this.paymentsService.rootTitle$.pipe((0,M.U)(e=>`PAYMENTS.${e}`))}onClose(){this.navService.retrieveContractBadges(),this.navService.retrieveLetterBadges(),this.location.back()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(te.t),t.Y36(Z.F0),t.Y36(X.cR),t.Y36(b.Ye))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-tenge-payments"]],features:[t._Bn([{provide:mt.rD,useClass:mt.hu}]),t.qOj],decls:21,vars:23,consts:[[3,"closed"],[1,"f-page-title"],[1,"f-page-tabs-wrap"],[1,"f-page-tabs"],["routerLinkActive","active",3,"routerLink"],[1,"outlet-animation-wrapper"],["outlet","outlet"]],template:function(e,o){1&e&&(t.TgZ(0,"f-page",0),t.NdJ("closed",function(){return o.onClose()}),t.TgZ(1,"f-page-header")(2,"h1",1),t._uU(3),t.ALo(4,"translate"),t.ALo(5,"async"),t.qZA(),t.TgZ(6,"div",2)(7,"nav",3)(8,"a",4),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"a",4),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.TgZ(14,"a",4),t._uU(15),t.ALo(16,"translate"),t.qZA()()()(),t.TgZ(17,"f-page-body")(18,"div",5),t._UZ(19,"router-outlet",null,6),t.qZA()()()),2&e&&(t.xp6(3),t.hij(" ",t.lcZ(4,7,t.lcZ(5,9,o.title$))," "),t.xp6(5),t.Q6J("routerLink",t.VKq(17,Vt,o.routes.tenge.order)),t.xp6(1),t.hij(" ",t.lcZ(10,11,"PAYMENTS.TABS.PAYMENT_ORDER")," "),t.xp6(2),t.Q6J("routerLink",t.VKq(19,Vt,o.routes.tenge.state.root)),t.xp6(1),t.hij(" ",t.lcZ(13,13,"PAYMENTS.TABS.BUDGET")," "),t.xp6(2),t.Q6J("routerLink",t.VKq(21,Vt,o.routes.tenge.salary)),t.xp6(1),t.hij(" ",t.lcZ(16,15,"PAYMENTS.TABS.SALARY")," "))},directives:[ee.J,ne.M,Z.yS,Z.Od,oe.G,Z.lC],pipes:[E.X$,b.Ov],styles:[".payment-section--submit{text-align:right}.payment-section{max-width:582px}.payment-section--purpose-length{position:absolute;right:.8rem;top:.4rem;z-index:1}.payment-section--summary .payment-section--amount-warn{color:#666c72}\n"],encapsulation:2,data:{animation:[be.rc]}}),n})();var qo=u(87510),Qo=u(51782),$o=u(43164),Lt=u(89848),Ut=(u(39112),u(82882),u(36466));u(28203),u(51884),u(31872);var ft=u(26164),Tt=u(91024),bt=u(74967),xt=u(39996),kt=u(84685),Gt=u(43915),tr=u(97063),Ht=u(8295),ht=u(47365);const er=["vinTpl"],nr=["protocolNumberTpl"];function or(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"j-restricted-placeholder",2),t.NdJ("retried",function(){return t.CHM(e),t.oxw().updatePermissions()}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("isRetryable",e.isPermissionsUpdateAllowed)("isLoading",e.isPermissionsUpdating)}}function rr(n,i){if(1&n&&(t.TgZ(0,"div",55)(1,"p",56),t._uU(2),t.qZA(),t.TgZ(3,"p",57),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&n){const e=i.item;t.xp6(2),t.Oqu(e.label),t.xp6(2),t.AsE("",t.lcZ(5,3,"PAYMENTS.FORM.BIN")," ",e.bin,"")}}function sr(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"button",58),t.NdJ("click",function(r){t.CHM(e),t.oxw(2);const s=t.MAs(19);return t.oxw().openDepartmentDictionary(s,r)}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p",59),t._uU(5),t.ALo(6,"translate"),t.qZA()()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"PAYMENTS.DICTIONARY.TITLE")," "),t.xp6(3),t.Oqu(t.lcZ(6,4,"PAYMENTS.DICTIONARY.FREQUENT_UGD")))}function ir(n,i){1&n&&t.YNc(0,sr,7,6,"div",1),2&n&&t.Q6J("ngIf",!i.searchTerm)}function ar(n,i){1&n&&t._UZ(0,"div",9)}function cr(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"button",58),t.NdJ("click",function(r){t.CHM(e),t.oxw(2);const s=t.MAs(67);return t.oxw().openKBKDictionary(s,r)}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p",59),t._uU(5),t.ALo(6,"translate"),t.qZA()()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,2,"PAYMENTS.DICTIONARY.TITLE")," "),t.xp6(3),t.hij(" ",t.lcZ(6,4,"PAYMENTS.DICTIONARY.FREQUENT_KBK")," "))}function lr(n,i){1&n&&t.YNc(0,cr,7,6,"div",1),2&n&&t.Q6J("ngIf",!i.searchTerm)}function ur(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"button",58),t.NdJ("click",function(r){t.CHM(e),t.oxw(2);const s=t.MAs(77);return t.oxw().openKnpDictionary(s,r)}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p",60),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"p",61),t._uU(8),t.ALo(9,"translate"),t.qZA()()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,3,"PAYMENTS.DICTIONARY.TITLE")," "),t.xp6(3),t.Oqu(t.lcZ(6,5,"PAYMENTS.DICTIONARY.FREQUENT_KNP")),t.xp6(3),t.Oqu(t.lcZ(9,7,"PAYMENTS.DICTIONARY.KNP_DESCRIPTION")))}function mr(n,i){1&n&&t.YNc(0,ur,10,9,"div",1),2&n&&t.Q6J("ngIf",!i.searchTerm)}function pr(n,i){if(1&n&&(t.TgZ(0,"div",62)(1,"div",63),t._uU(2),t.qZA()()),2&n){const e=i.ngIf;t.xp6(2),t.hij(" ",e," ")}}function dr(n,i){1&n&&t._UZ(0,"div",9)}function _r(n,i){if(1&n&&(t.TgZ(0,"div",64),t._UZ(1,"span",65),t.ALo(2,"translate"),t.qZA()),2&n){const e=i.ngIf;t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e),t.oJD)}}function fr(n,i){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function hr(n,i){if(1&n&&(t._uU(0),t.ALo(1,"translate"),t.ALo(2,"amountFormat"),t.ALo(3,"async")),2&n){const e=t.oxw(2);t.AsE(" ",t.lcZ(1,2,"PAYMENTS.COMMISSION"),": ",t.lcZ(2,4,t.lcZ(3,6,e.commission$))," \u20b8 ")}}function gr(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",66),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).saveToDraft()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",67),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"PAYMENTS.FORM.SAVE")),t.xp6(3),t.hij("",t.lcZ(6,4,e.submitLabel)," ")}}function Cr(n,i){1&n&&(t.ynx(0),t.TgZ(1,"button",68),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function Ar(n,i){if(1&n&&(t.TgZ(0,"div",69)(1,"div",70),t._UZ(2,"j-period-input",71,72),t.ALo(4,"translate"),t.qZA()()),2&n){const e=t.MAs(3),o=t.oxw(2);t.xp6(2),t.Q6J("hasError",o.hasError(e,o.form.controls.period))("label",t.lcZ(4,3,"SHARED.TIME.PERIOD"))("formControl",o.form.controls.period)}}function yr(n,i){if(1&n&&(t.TgZ(0,"div",69)(1,"div",73),t._UZ(2,"j-period-input",71,74),t.ALo(4,"translate"),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"div",73),t._UZ(7,"j-period-input",71,75),t.ALo(9,"translate"),t.ALo(10,"translate"),t.qZA()()),2&n){const e=t.MAs(3),o=t.MAs(8),r=t.oxw(2);t.xp6(2),t.hYB("label","",t.lcZ(4,8,"SHARED.TIME.MONTH")," ",t.lcZ(5,10,"SHARED.PREPOSITION.FROM"),""),t.Q6J("hasError",r.hasError(e,r.form.controls.periodStart)||r.hasError(o,r.form.controls.periodEnd))("formControl",r.form.controls.periodStart),t.xp6(5),t.hYB("label","",t.lcZ(9,12,"SHARED.TIME.MONTH")," ",t.lcZ(10,14,"SHARED.PREPOSITION.TO"),""),t.Q6J("hasError",r.hasError(o,r.form.controls.periodEnd)||r.hasError(e,r.form.controls.periodStart))("formControl",r.form.controls.periodEnd)}}function Tr(n,i){if(1&n&&(t.TgZ(0,"j-form-field",15)(1,"j-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"input",76)(5,"j-error",39),t.qZA(),t.TgZ(6,"div",64),t._UZ(7,"span",65),t.qZA()),2&n){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,5,"PAYMENTS.FORM.VIN")),t.xp6(2),t.Q6J("formControl",e.form.controls.vin),t.xp6(1),t.Q6J("control",e.form.controls.vin)("errorMessages",e.errors.vin),t.xp6(2),t.Q6J("innerHTML",e.vinMessage,t.oJD)}}function br(n,i){if(1&n&&(t.TgZ(0,"j-form-field",15)(1,"j-label"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t._UZ(4,"input",21),t.qZA()),2&n){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,3,"PAYMENTS.FORM.PROTOCOL_NUMBER")),t.xp6(2),t.Q6J("mask",e.masks.protocolNumber.mask)("formControl",e.form.controls.protocolNumber)}}function xr(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",3,4),t.NdJ("submit",function(r){return t.CHM(e),t.oxw().onSubmit(r)}),t.TgZ(3,"div",5)(4,"fieldset")(5,"div",6)(6,"h2",7),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"button",8),t.NdJ("click",function(r){t.CHM(e);const s=t.MAs(19);return t.oxw().openDepartmentDictionary(s,r)}),t._uU(10),t.ALo(11,"translate"),t.qZA()(),t.TgZ(12,"div",9)(13,"j-form-field",null,10)(15,"j-label"),t._uU(16),t.ALo(17,"translate"),t.qZA(),t.TgZ(18,"j-select",11,12),t.ALo(20,"async"),t.YNc(21,rr,6,5,"ng-template",13),t.YNc(22,ir,1,1,"ng-template",14),t.qZA()()(),t.TgZ(23,"div",9)(24,"j-form-field",15),t._UZ(25,"j-entity-logo",16),t.ALo(26,"bankFromAccount"),t.TgZ(27,"j-label"),t._uU(28),t.ALo(29,"translate"),t.qZA(),t._UZ(30,"input",17,18)(32,"j-error",19),t.qZA()()()(),t.TgZ(33,"div",5)(34,"fieldset")(35,"legend",20),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.TgZ(38,"div",9)(39,"j-form-field")(40,"j-label"),t._uU(41),t.ALo(42,"translate"),t.qZA(),t._UZ(43,"input",21),t.qZA()(),t.YNc(44,ar,1,0,"div",22),t.TgZ(45,"div",9)(46,"ul",23)(47,"li",24),t._UZ(48,"j-switch",25),t.TgZ(49,"span",26),t._uU(50),t.ALo(51,"translate"),t._UZ(52,"br"),t.TgZ(53,"small",27),t._uU(54),t.ALo(55,"translate"),t.TgZ(56,"span",28),t._uU(57),t.ALo(58,"async"),t.qZA()()()()()(),t.TgZ(59,"div",9)(60,"div",9)(61,"j-form-field",null,29)(63,"j-label"),t._uU(64),t.ALo(65,"translate"),t.qZA(),t.TgZ(66,"j-select",30,31),t.ALo(68,"async"),t.YNc(69,lr,1,1,"ng-template",14),t.qZA()()()(),t.TgZ(70,"div",9)(71,"j-form-field",null,32)(73,"j-label"),t._uU(74),t.ALo(75,"translate"),t.qZA(),t.TgZ(76,"j-select",33,34),t.YNc(78,mr,1,1,"ng-template",14),t.qZA()()(),t.TgZ(79,"div",35)(80,"span",36),t._uU(81),t.ALo(82,"async"),t.qZA(),t.TgZ(83,"j-form-field")(84,"j-label"),t._uU(85),t.ALo(86,"translate"),t.qZA(),t._UZ(87,"textarea",37,38)(89,"j-error",39),t.YNc(90,pr,3,1,"div",40),t.ALo(91,"async"),t.qZA()(),t.YNc(92,dr,1,0,"div",22),t.qZA()(),t.TgZ(93,"div",5)(94,"fieldset")(95,"div",9)(96,"j-account-dropdown",41,42),t.NdJ("selected",function(r){return t.CHM(e),t.oxw().onSenderAccountSelect(r)}),t.ALo(98,"async"),t.ALo(99,"async"),t.qZA()(),t.TgZ(100,"div",9)(101,"div",9)(102,"j-form-field",43)(103,"j-label"),t._uU(104),t.ALo(105,"translate"),t.qZA(),t._UZ(106,"input",44),t.qZA(),t.YNc(107,_r,3,3,"div",45),t.ALo(108,"async"),t.TgZ(109,"div",46),t.YNc(110,fr,3,3,"ng-container",47),t.ALo(111,"async"),t.YNc(112,hr,4,8,"ng-template",null,48,t.W1O),t.qZA()()(),t.TgZ(114,"div",9)(115,"ul",23)(116,"li",24),t._UZ(117,"j-switch",25),t.TgZ(118,"span",26),t._uU(119),t.ALo(120,"translate"),t._UZ(121,"br"),t.TgZ(122,"small",27),t._uU(123),t.ALo(124,"translate"),t.qZA()()()()()()(),t.TgZ(125,"div",49)(126,"div",49),t.YNc(127,gr,7,6,"ng-container",1),t.YNc(128,Cr,4,3,"ng-container",1),t.qZA()(),t.YNc(129,Ar,5,5,"ng-template",null,50,t.W1O),t.YNc(131,yr,11,16,"ng-template",null,51,t.W1O),t.YNc(133,Tr,8,7,"ng-template",null,52,t.W1O),t.YNc(135,br,5,5,"ng-template",null,53,t.W1O),t._UZ(137,"ngx-spinner",54)(138,"ngx-spinner",54),t.qZA(),t.BQk()}if(2&n){const e=t.MAs(14),o=t.MAs(19),r=t.MAs(62),s=t.MAs(67),l=t.MAs(72),c=t.MAs(77),a=t.MAs(113),p=t.MAs(130),f=t.MAs(132),m=t.oxw();t.xp6(1),t.Q6J("formGroup",m.form),t.xp6(6),t.hij(" ",t.lcZ(8,73,"PAYMENTS.RECIPIENT.TITLE")," "),t.xp6(3),t.hij(" ",t.lcZ(11,75,"PAYMENTS.SELECT_FROM_DICTIONARY")," "),t.xp6(6),t.Oqu(t.lcZ(17,77,"PAYMENTS.FORM.UGD")),t.xp6(2),t.Q6J("appendTo",e.elementRef.nativeElement)("jFocusOnReturn",o)("formControl",m.form.controls.ugd)("clearable",!1)("searchFn",m.paymentsService.ugdSearchFn)("items",t.lcZ(20,79,m.ugdStore.items$)),t.xp6(7),t.Q6J("name",t.lcZ(26,81,"KZ"+m.form.controls.bankAccount.value)),t.xp6(3),t.Oqu(t.lcZ(29,83,"PAYMENTS.FORM.IBAN")),t.xp6(2),t.Q6J("jShadow",m.masks.bankAccount.shadow)("dropSpecialCharacters",!0)("mask",m.masks.bankAccount.mask)("formControl",m.form.controls.bankAccount),t.xp6(2),t.Q6J("control",m.form.controls.bankAccount)("errorMessages",m.errors.bankAccount)("params",m.bankAccountErrorParams),t.xp6(4),t.Oqu(t.lcZ(37,85,"PAYMENTS.FORM.DETAILS")),t.xp6(5),t.Oqu(t.lcZ(42,87,"PAYMENTS.FORM.DOCUMENT_NUMBER")),t.xp6(2),t.Q6J("mask",m.masks.number.mask)("formControl",m.form.controls.number),t.xp6(1),t.Q6J("ngTemplateOutlet",m.form.controls.intervalEnabled.value?f:p),t.xp6(4),t.Q6J("formControl",m.form.controls.intervalEnabled),t.xp6(2),t.hij(" ",t.lcZ(51,89,"PAYMENTS.FORPERIOD")," "),t.xp6(4),t.hij(" ",t.lcZ(55,91,m.intervalSwitchLabel)," "),t.xp6(2),t.Q6J("hidden",!m.form.controls.intervalEnabled.value),t.xp6(1),t.hij(": ",t.lcZ(58,93,m.periodMessage$)," "),t.xp6(7),t.Oqu(t.lcZ(65,95,"PAYMENTS.FORM.KBK")),t.xp6(2),t.Q6J("jFocusOnReturn",s)("appendTo",r.elementRef.nativeElement)("formControl",m.form.controls.kbk)("clearable",!1)("searchMask",m.masks.kbk.mask)("shadow",m.masks.kbk.shadow)("items",t.lcZ(68,97,m.kbkStore.items$)),t.xp6(8),t.Oqu(t.lcZ(75,99,"PAYMENTS.FORM.KNP_REGULAR")),t.xp6(2),t.Q6J("appendTo",l.elementRef.nativeElement)("jFocusOnReturn",c)("formControl",m.form.controls.knp)("clearable",!1)("searchMask",m.masks.knp.mask)("shadow",m.masks.knp.shadow)("items",m.filteredKnpList),t.xp6(5),t.AsE(" ",t.lcZ(82,101,m.purposeLength$),"/",m.rules.purposeLength,""),t.xp6(4),t.Oqu(t.lcZ(86,103,"PAYMENTS.FORM.PURPOSE")),t.xp6(2),t.Q6J("formControl",m.form.controls.purpose),t.xp6(2),t.Q6J("control",m.form.controls.purpose)("errorMessages",m.errors.purpose),t.xp6(1),t.Q6J("ngIf",t.lcZ(91,105,m.purposeMessage$)),t.xp6(2),t.Q6J("ngTemplateOutlet",m.associatedFieldTpl),t.xp6(4),t.Q6J("isLoading",t.lcZ(98,107,m.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",m.form.controls.senderAccount.touched&&m.form.controls.senderAccount.errors)("accounts",t.lcZ(99,109,m.acceptableAccounts$)),t.xp6(6),t.Q6J("floatLabel","always"),t.xp6(2),t.Oqu(t.lcZ(105,111,"PAYMENTS.FORM.AMOUNT")),t.xp6(2),t.Q6J("dropSpecialCharacters",!0)("formControl",m.form.controls.amount),t.xp6(1),t.Q6J("ngIf",t.lcZ(108,113,m.amountMessage$)),t.xp6(3),t.Q6J("ngIf",null===t.lcZ(111,115,m.commission$))("ngIfElse",a),t.xp6(7),t.Q6J("formControl",m.form.controls.urgent),t.xp6(2),t.hij("",t.lcZ(120,117,"PAYMENTS.FORM.URGENT")," "),t.xp6(4),t.Oqu(t.lcZ(124,119,"PAYMENTS.URGENT_HELPER")),t.xp6(4),t.Q6J("ngIf",m.restoredData.status!==m.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("ngIf",m.restoredData.status===m.PAYMENT_STATUS.CREATED),t.xp6(9),t.Q6J("name",m.SPINNER)("fullScreen",!1),t.xp6(1),t.Q6J("name",m.SPINNER)("fullScreen",!1)}}let Re=(()=>{class n extends tt.S{constructor(e,o,r,s,l,c,a,p,f,m,h,_,g,y,A,T,I){super(A.createTaxForm(),_,e,o,s,r,c,m,g,h,a,T,y,I),this.route=e,this.router=o,this.paymentsService=r,this.companyService=s,this.dateAdapter=l,this.maskService=c,this.translate=a,this.datePipe=p,this.accountsService=f,this.modalService=m,this.pipelines=h,this.api=_,this.dictionaries=g,this.featureFlagsService=y,this.paymentsFormsFactory=A,this.authorityPermissionsService=T,this.bankFromAccount=I,this.associatedFieldTpl=void 0,this.masks={number:"paymentNum",amount:"amount",vin:"vin",knp:"knp",kbk:"kbk",protocolNumber:"protocol",bankAccount:"tengeAccount"},this.commission$=new v.X(0),this.protocolMessage$=new v.X(""),this.vinLength=17,this.subs=new It.w,this.paymentType=O.V_.TAX}ngOnInit(){super.ngOnInit(),this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe((0,z.b)(o=>this.checkPersonalAccounts(o))),this.getMaskConfig(),this.createControlsStream(this.form),this.combineKBK(this.paymentType),this.knp$=this.combineKNP([o=>this.dictionaries.selectByPaymentType(o,{type:O.V_.TAX,sortFavourite:!1})]),this.listenWorkingDays(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenKnpUpdates(),this.subs.add(this.createPeriodMessage$().subscribe(this.periodMessage$)),this.subs.add((0,N.aj)([this.controlsStream.vin.pipe((0,M.U)(o=>o?`VIN${o}/V`:"")),this.controlsStream.protocolNumber.pipe((0,M.U)(o=>o?`ADM${o}/A`:""))]).subscribe(o=>{this.protocolMessage$.next(o.join(" "))}));const e=[this.protocolMessage$.pipe((0,M.U)(o=>["protocol",o])),(0,N.aj)([this.translate.get("SHARED.NOT_SELECTED"),this.translate.get("SHARED.TIME.PERIOD"),this.periodMessage$]).pipe((0,M.U)(([o,r,s])=>s&&s!==o?`${r}: ${s}.`:""),(0,M.U)(o=>["period",o]))];this.listenPurposeMessageStream(e,["protocol","kbk","knp","period"]),this.subs.add(this.controlsStream.kbk.pipe().subscribe(o=>{const{protocolNumber:r,vin:s}=this.form.controls;this.rules.kbkCodeVinReq.some(l=>l===o)?(s.enable(),r.disable(),r.value&&r.patchValue(""),this.associatedFieldTpl=this.vinTpl):/^204\d+$/.test(o)?(s.disable(),s.value&&s.patchValue(""),r.enable(),this.associatedFieldTpl=this.protocolNumberTpl):(this.associatedFieldTpl=null,s.disable(),r.disable(),r.value&&r.patchValue(""),s.value&&s.patchValue(""))})),this.subs.add(this.controlsStream.intervalEnabled.pipe((0,$o.p)(300,void 0,{leading:!0,trailing:!0}),(0,S.x)()).subscribe(o=>{const{period:r,periodEnd:s,periodStart:l}=this.form.controls;o?([s,l].forEach(c=>c.enable()),r.disable()):([s,l].forEach(c=>c.disable()),r.enable())})),this.form.get("bankAccount").value||this.form.get("bankAccount").setValue(O.SV.TAX_ACCOUNT)}get intervalSwitchLabel(){return this.form.controls.intervalEnabled.value?"PAYMENTS.INTERVAL.ENABLED":"PAYMENTS.INTERVAL.DISABLED"}onKbkSelect(e){!this.form.controls.knp.value&&e.associatedKnpList&&this.form.controls.knp.setValue(e.associatedKnpList[0])}openDepartmentDictionary(e,o){o&&o.preventDefault(),e&&(e.blur(),e.close()),this.modalService.open(Qo.h,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then(r=>{this.form.controls.ugd.setValue(r.code)}).catch(()=>{})}openKBKDictionary(e,o){o&&o.preventDefault(),e&&(e.blur(),e.close());const r=this.modalService.open(qo.o,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});Object.assign(r.componentInstance,{store:this.kbkStore}),r.result.then(s=>{this.form.controls.kbk.setValue(s.code)}).catch(()=>{})}onUgdSelect(e){}createPeriodMessage$(){const{intervalEnabled:e,periodEnd:o,periodStart:r,period:s}=this.controlsStream;return(0,N.aj)([e,this.translate.get("SHARED.NOT_SELECTED"),s,r,o]).pipe((0,J.b)(0),(0,M.U)(([l,c,...a])=>{const[p,f,m]=a.map(h=>h?this.datePipe.transform(h,"MM.yyyy"):"");return!l&&!p||l&&!f&&!m?c:l?`${f||c} - ${m||c}`:`${p||c}`}))}sendPayment(){return super.sendPayment(this.constructTaxPaymentBody())}saveToDraft(){return super.saveToDraft(this.constructTaxPaymentBody())}openKnpDictionary(e,o){e.close(),e.blur(),setTimeout(()=>{const r=this.modals.open(Ct.Rp,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});r.componentInstance.paymentType=this.paymentType,r.result.then(s=>{this.form.controls.knp.patchValue(s.code)}).catch(()=>{})},0)}constructTaxPaymentBody(){const e=this.form.value,o=this.protocolMessage$.getValue();let r="";return r=o?this.purposeMessage$.getValue().replace(o,[o,e.purpose].filter(s=>!!s).join(" ")):[e.purpose,this.purposeMessage$.getValue()].filter(s=>!!s).join(". "),Object.assign(Object.assign({},e),{purpose:r})}listenKnpUpdates(){this.knp$.subscribe(e=>{this.filteredKnpList=e})}get vinMessage(){var e,o;return this.form.controls.vin.value&&0!==this.form.controls.vin.value.length?(null===(e=this.form.controls.vin.value)||void 0===e?void 0:e.length)<this.vinLength?this.translate.instant("PAYMENTS.VIN_MESSAGE.LESS",{length:this.vinLength}):(null===(o=this.form.controls.vin.value)||void 0===o?void 0:o.length)>this.vinLength?this.translate.instant("PAYMENTS.VIN_MESSAGE.MORE",{length:this.vinLength}):"":this.translate.instant("PAYMENTS.VIN_MESSAGE.OPTIONAL")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Z.gz),t.Y36(Z.F0),t.Y36(X.cR),t.Y36(ft.J),t.Y36(R.NG),t.Y36(et.O),t.Y36(E.sK),t.Y36(b.uU),t.Y36(q.iu),t.Y36(R.FF),t.Y36(Tt.Z),t.Y36(bt.e),t.Y36(dt.$),t.Y36(j.a),t.Y36(xt.$),t.Y36(nt.Eg),t.Y36(Q.vI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-tax-payment"]],viewQuery:function(e,o){if(1&e&&(t.Gf(d.F,5),t.Gf(Y.L,5),t.Gf(er,5,t.Rgc),t.Gf(nr,5,t.Rgc)),2&e){let r;t.iGM(r=t.CRH())&&(o.ngForm=r.first),t.iGM(r=t.CRH())&&(o.focusableContainer=r.first),t.iGM(r=t.CRH())&&(o.vinTpl=r.first),t.iGM(r=t.CRH())&&(o.protocolNumberTpl=r.first)}},features:[t.qOj],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],["autocomplete","off","jInvalidControlScroll","","jFocusableContainer","",1,"p-relative",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"payments__header"],[1,"h2","mb-0"],["type","button",1,"btn","btn-link","p-0","p3",3,"click"],[1,"form-group"],["selectWrapper",""],["bindValue","code","bindLabel","label",3,"appendTo","jFocusOnReturn","formControl","clearable","searchFn","items"],["ugdSelect",""],["j-option-tmp",""],["j-header-tmp",""],["clearable","true"],["jPrefix","","hideEmpty","true",3,"name"],["type","text","jFormInput","","jReplaceOnPaste","KZ","jDynamicPrefix","KZ","jFocusOnReturn","","jUppercase","",1,"form-control",3,"jShadow","dropSpecialCharacters","mask","formControl"],["accountInput","jFormInput"],[3,"control","errorMessages","params"],[1,"h2"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","formControl"],["class","form-group",4,"ngTemplateOutlet"],[1,"list-group"],[1,"list-group-item","text-left","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[3,"hidden"],["kbkWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["kbkSelect",""],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"appendTo","jFocusOnReturn","formControl","clearable","searchMask","shadow","items"],["knpSelect",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],["clearable","true",3,"floatLabel"],["type","text","suffix"," \u20b8","jFormInput","","jCursorBound","","placeholder","0,00","mask","separator.2","jReplaceDot","","thousandSeparator"," ","decimalMarker",",",1,"form-control",3,"dropSpecialCharacters","formControl"],["class","j-input-helper text-muted mt-1 p3",4,"ngIf"],[1,"j-input-helper","text-muted","mt-1","p3","position-relative"],[4,"ngIf","ngIfElse"],["commission",""],[1,"payment-section--submit","form-group","pt-4"],["periodTpl",""],["intervalTpl",""],["vinTpl",""],["protocolNumberTpl",""],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],[1,"j-option-label","text-wrap"],[1,"m-0"],[1,"p3","text-gray","m-0"],["type","button",1,"form-section--action","btn","btn-xs","btn-link","float-right",3,"click"],[1,"p2"],[1,"p2","m-0"],[1,"p3","text-gray"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"j-input-helper","text-muted","mt-1","p3"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"],[1,"row"],[1,"col"],[3,"hasError","label","formControl"],["period",""],[1,"col","col-md-6"],["periodStart",""],["periodEnd",""],["type","text","jFormInput","","jFocusOnReturn","","maxlength","64","jUppercase","",1,"form-control",3,"formControl"]],template:function(e,o){1&e&&(t.YNc(0,or,1,2,"j-restricted-placeholder",0),t.YNc(1,xr,139,121,"ng-container",1)),2&e&&(t.Q6J("ngIf",o.isRestricted),t.xp6(1),t.Q6J("ngIf",!o.isRestricted))},directives:[b.O5,ot.G,d._Y,d.JL,$,Y.L,d.sg,V.O8,it.I,at.F,Y.v,d.JJ,d.oH,w.Ok,w.BN,kt.k,Gt.X,G.m,B.hx,d.Fj,Ut.w,Lt.u,At.q,yt.N,ct.k,b.tP,st.q,lt.L,rt.S,Zt.a,St.s,tr.L,d.nD,ut.Ro],pipes:[E.X$,b.Ov,Ht.vI,ht.n],styles:[".payments__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem}"]}),n})();const Ot=function(n){return[n]};let Ze=(()=>{class n extends xe{constructor(){super(),this.routes=P.KK}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-budget-payments"]],features:[t.qOj],decls:17,vars:24,consts:[[1,"payment-section"],[1,"form-group","mb-5"],["routerLinkActive","active",1,"btn","btn-sm","btn-outline-dark","btn-shadow",3,"routerLink"],["routerLinkActive","active",1,"btn","btn-sm","btn-outline-dark","btn-shadow","ml-2",3,"routerLink"],[1,"outlet-animation-wrapper"],[3,"activate"],["outlet","outlet"]],template:function(e,o){if(1&e){const r=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"a",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"a",3),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"a",3),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"a",3),t._uU(12),t.ALo(13,"translate"),t.qZA()(),t.TgZ(14,"div",4)(15,"router-outlet",5,6),t.NdJ("activate",function(l){t.CHM(r);const c=t.MAs(16);return o.onActivate(l,c)}),t.qZA()()()}2&e&&(t.xp6(2),t.Q6J("routerLink",t.VKq(16,Ot,o.routes.tenge.state.tax)),t.xp6(1),t.Oqu(t.lcZ(4,8,"PAYMENTS.TABS.TAX")),t.xp6(2),t.Q6J("routerLink",t.VKq(18,Ot,o.routes.tenge.state.pension)),t.xp6(1),t.Oqu(t.lcZ(7,10,"PAYMENTS.TABS.PENSION")),t.xp6(2),t.Q6J("routerLink",t.VKq(20,Ot,o.routes.tenge.state.social)),t.xp6(1),t.Oqu(t.lcZ(10,12,"PAYMENTS.TABS.SOCIAL")),t.xp6(2),t.Q6J("routerLink",t.VKq(22,Ot,o.routes.tenge.state.osms)),t.xp6(1),t.Oqu(t.lcZ(13,14,"PAYMENTS.TABS.MEDICAL")))},directives:[Z.yS,Z.Od,Z.lC],pipes:[E.X$],styles:[""],data:{animation:[be.rc]}}),n})();var Se=u(93751),vr=u(40537),Er=u(12908),Nr=u(61326),Pe=u(9661);const Rr=["emailOnSuccess"],Zr=["contractDetails"];function Sr(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"j-restricted-placeholder",2),t.NdJ("retried",function(){return t.CHM(e),t.oxw().updatePermissions()}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("isRetryable",e.isPermissionsUpdateAllowed)("isLoading",e.isPermissionsUpdating)}}function Pr(n,i){1&n&&(t.TgZ(0,"span")(1,"span",56),t._uU(2,"PAYMENTS.TRUSTED_COUNTERPARTY"),t.qZA(),t._UZ(3,"span",57),t.qZA()),2&n&&(t.xp6(3),t.Q6J("inlineSVG","/assets/icons/counterparty/status.svg"))}function Mr(n,i){1&n&&(t.TgZ(0,"span")(1,"span",56),t._uU(2,"PAYMENTS.UNTRUSTED_COUNTERPARTY"),t.qZA(),t._UZ(3,"span",58),t.qZA()),2&n&&(t.xp6(3),t.Q6J("inlineSVG","/assets/icons/counterparty/status.svg"))}function Ir(n,i){if(1&n&&(t.TgZ(0,"li",59),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.hij(" \u2022 ",t.lcZ(2,1,e.name)," ")}}function Lr(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"button",74),t.NdJ("click",function(){return t.CHM(e),t.oxw(6).openContractsAddingModal()}),t.TgZ(1,"span",61),t._uU(2," CURRENCY_PAYMENT.CONTRACTS.ADD_NEW "),t.qZA()()}}function Ur(n,i){if(1&n&&(t.TgZ(0,"div",72),t.YNc(1,Lr,3,0,"button",73),t.TgZ(2,"h6",61),t._uU(3,"CURRENCY_PAYMENT.CONTRACTS.TITLE"),t.qZA()()),2&n){const e=t.oxw(5);t.xp6(1),t.Q6J("ngIf",e.fxContracts.length>0)}}function kr(n,i){if(1&n&&t.YNc(0,Ur,4,1,"div",71),2&n){const e=i.searchTerm,o=t.oxw(4);t.Q6J("ngIf",!e&&!o.fxContracts)}}function Or(n,i){if(1&n&&(t.TgZ(0,"div",75)(1,"div",76)(2,"span"),t._uU(3),t.qZA(),t._UZ(4,"j-money",77),t.qZA(),t.TgZ(5,"div",78)(6,"span"),t._uU(7),t.qZA(),t.TgZ(8,"div"),t._UZ(9,"span",79),t._uU(10,"\xa0 "),t._UZ(11,"j-money",77),t.qZA()()()),2&n){const e=i.item;t.xp6(3),t.Oqu(e.contractor.name),t.xp6(1),t.Q6J("money",e.amount),t.xp6(3),t.Oqu(e.contractNumber),t.xp6(4),t.Q6J("money",e.remainder)}}function Yr(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",80),t._UZ(2,"img",81)(3,"div",82),t.ALo(4,"translate"),t.TgZ(5,"a",83),t.NdJ("click",function(r){return t.CHM(e),t.oxw(5).openContractsAddingModal(r)}),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.BQk()}2&n&&(t.xp6(3),t.Q6J("innerHTML",t.lcZ(4,2,"CURRENCY_PAYMENT.CONTRACTS.EMPTY_STATE"),t.oJD),t.xp6(3),t.hij(" ",t.lcZ(7,4,"CURRENCY_PAYMENT.CONTRACTS.ADD_NEW")," "))}function jr(n,i){if(1&n){const e=t.EpF();t.ynx(0),t._UZ(1,"j-empty-placeholder",84),t.TgZ(2,"div",85)(3,"a",86),t.NdJ("click",function(r){return t.CHM(e),t.oxw(5).openContractsAddingModal(r)}),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.BQk()}2&n&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"CURRENCY_PAYMENT.CONTRACTS.ADD_NEW")," "))}function Dr(n,i){if(1&n&&(t.YNc(0,Yr,8,6,"ng-container",1),t.YNc(1,jr,6,3,"ng-container",1)),2&n){const e=t.oxw(4);t.Q6J("ngIf",0==e.fxContracts.length),t.xp6(1),t.Q6J("ngIf",e.fxContracts.length>0)}}function wr(n,i){if(1&n&&t._uU(0),2&n){const e=i.item,o=t.oxw(4);t.hij(" ",o.mapContractLabel(e||o.form.controls.contract.value)," ")}}function Fr(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"a",87),t.NdJ("click",function(r){return t.CHM(e),t.oxw(4).showContractDetails(r)}),t._uU(1,"CURRENCY_PAYMENT.CONTRACTS.SHOW_DETAILS"),t.qZA()}}function Jr(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",63)(1,"j-form-field",null,64)(3,"j-label",61),t._uU(4,"CURRENCY_PAYMENT.RECIPIENT.CONTRACT"),t.qZA(),t.TgZ(5,"j-select",65,66),t.NdJ("change",function(r){return t.CHM(e),t.oxw(3).onContractSelect(r)}),t.YNc(7,kr,1,1,"ng-template",31),t.YNc(8,Or,12,4,"ng-template",67),t.YNc(9,Dr,2,2,"ng-template",68),t.YNc(10,wr,1,1,"ng-template",69),t.qZA(),t.YNc(11,Fr,2,0,"a",70),t.qZA()()}if(2&n){const e=t.MAs(2),o=t.MAs(6),r=t.oxw(3);t.xp6(5),t.Q6J("loading",r.isFxContractsLoading)("appendTo",e.elementRef.nativeElement)("jFocusOnReturn",o)("formControl",r.form.controls.contract)("clearable",!1)("searchFn",r.contractComparator)("items",r.fxContracts),t.xp6(6),t.Q6J("ngIf",r.form.controls.contractId.value)}}function Br(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",60),t._UZ(2,"j-switch",48),t.TgZ(3,"div",49)(4,"strong",61),t._uU(5,"CURRENCY_PAYMENT.CONTRACTS.SWITCH.TITLE"),t.qZA()()(),t.YNc(6,Jr,12,8,"div",62),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("formControl",e.form.controls.withinContract),t.xp6(4),t.Q6J("ngIf",e.form.controls.withinContract.value)}}function qr(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"button",88),t.NdJ("click",function(r){t.CHM(e),t.oxw(2);const s=t.MAs(79);return t.oxw().openKnpDictionary(s,r)}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p",89),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"p",90),t._uU(8),t.ALo(9,"translate"),t.qZA()()}2&n&&(t.xp6(2),t.hij(" ",t.lcZ(3,3,"PAYMENTS.DICTIONARY.TITLE")," "),t.xp6(3),t.Oqu(t.lcZ(6,5,"PAYMENTS.DICTIONARY.FREQUENT_KNP")),t.xp6(3),t.Oqu(t.lcZ(9,7,"PAYMENTS.DICTIONARY.KNP_DESCRIPTION")))}function Qr(n,i){1&n&&t.YNc(0,qr,10,9,"div",1),2&n&&t.Q6J("ngIf",!i.searchTerm)}function $r(n,i){if(1&n&&(t.TgZ(0,"div",91)(1,"div",92),t._uU(2),t.qZA()()),2&n){const e=i.ngIf;t.xp6(2),t.hij(" ",e," ")}}function Vr(n,i){if(1&n&&(t.TgZ(0,"div",37),t._UZ(1,"span",93),t.ALo(2,"translate"),t.qZA()),2&n){const e=i.ngIf;t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e),t.oJD)}}function Gr(n,i){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function Hr(n,i){if(1&n&&(t._uU(0),t.ALo(1,"translate"),t.ALo(2,"amountFormat"),t.ALo(3,"async")),2&n){const e=t.oxw(2);t.AsE(" ",t.lcZ(1,2,"PAYMENTS.COMMISSION"),": ",t.lcZ(2,4,t.lcZ(3,6,e.commission$))," \u20b8 ")}}function Kr(n,i){1&n&&(t.TgZ(0,"div")(1,"small",50),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"PAYMENTS.NOTIFY.DESCRIPTION")))}function Wr(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",94)(1,"j-form-field")(2,"j-label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"input",95,96),t.NdJ("focus",function(r){return t.CHM(e),t.oxw(2).onEmailOnSuccessFocus(r)}),t.qZA(),t._UZ(7,"j-error",13),t.qZA(),t.TgZ(8,"small",50),t._uU(9),t.ALo(10,"translate"),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,6,"PAYMENTS.NOTIFY.EMAIL")),t.xp6(2),t.Q6J("ngbTypeahead",e.search)("formControl",e.form.controls.emailOnSuccess),t.xp6(2),t.Q6J("control",e.form.controls.emailOnSuccess)("errorMessages",e.errors.email),t.xp6(2),t.Oqu(t.lcZ(10,8,"PAYMENTS.NOTIFY.EMAIL"))}}function Xr(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",97),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).saveToDraft()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",98),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"PAYMENTS.FORM.SAVE")),t.xp6(3),t.hij("",t.lcZ(6,4,e.submitLabel)," ")}}function zr(n,i){1&n&&(t.ynx(0),t.TgZ(1,"button",99),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function ts(n,i){1&n&&t._UZ(0,"j-kbe-info")}function es(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",3)(2,"form",4,5),t.NdJ("submit",function(r){return t.CHM(e),t.oxw().onSubmit(r)}),t.TgZ(4,"div",6)(5,"fieldset")(6,"div",7)(7,"h2",8),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().openSavedPayments()}),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"div",10)(14,"j-form-field")(15,"j-label"),t._uU(16),t.ALo(17,"translate"),t.qZA(),t._UZ(18,"input",11),t.TgZ(19,"div",12),t.ALo(20,"async"),t.YNc(21,Pr,4,1,"span",1),t.ALo(22,"async"),t.YNc(23,Mr,4,1,"span",1),t.ALo(24,"async"),t.qZA(),t._UZ(25,"j-error",13),t.qZA(),t.TgZ(26,"ul",14),t.YNc(27,Ir,3,3,"li",15),t.qZA()(),t.TgZ(28,"div",10)(29,"j-form-field",16)(30,"j-label"),t._uU(31),t.ALo(32,"translate"),t.qZA(),t._UZ(33,"input",17),t.qZA()(),t.TgZ(34,"div",10)(35,"j-form-field",16),t._UZ(36,"j-entity-logo",18),t.ALo(37,"bankFromAccount"),t.TgZ(38,"j-label"),t._uU(39),t.ALo(40,"translate"),t.qZA(),t._UZ(41,"input",19,20)(43,"j-error",21),t.qZA()(),t.TgZ(44,"div",10)(45,"j-form-field",16)(46,"j-label"),t._uU(47),t.ALo(48,"translate"),t.qZA(),t._UZ(49,"input",22)(50,"a",23)(51,"j-error",13),t.qZA()()()(),t.TgZ(52,"div",6)(53,"fieldset")(54,"legend",24),t._uU(55),t.ALo(56,"translate"),t.qZA(),t.YNc(57,Br,7,2,"ng-container",1),t.ALo(58,"async"),t.TgZ(59,"div",10)(60,"j-form-field")(61,"j-label"),t._uU(62),t.ALo(63,"translate"),t.qZA(),t._UZ(64,"input",25),t.qZA()(),t.TgZ(65,"div",10),t._UZ(66,"j-date-picker",26,27),t.ALo(68,"async"),t.ALo(69,"translate"),t.ALo(70,"translate"),t.ALo(71,"async"),t.qZA(),t.TgZ(72,"div",10)(73,"j-form-field",null,28)(75,"j-label"),t._uU(76),t.ALo(77,"translate"),t.qZA(),t.TgZ(78,"j-select",29,30),t.ALo(80,"async"),t.YNc(81,Qr,1,1,"ng-template",31),t.qZA()()(),t.TgZ(82,"div",32)(83,"span",33),t._uU(84),t.ALo(85,"async"),t.qZA(),t.TgZ(86,"j-form-field")(87,"j-label"),t._uU(88),t.ALo(89,"translate"),t.qZA(),t._UZ(90,"textarea",34,35)(92,"j-error",13),t.YNc(93,$r,3,1,"div",36),t.ALo(94,"async"),t.qZA(),t.TgZ(95,"div",37),t._uU(96),t.ALo(97,"translate"),t.qZA()()()(),t.TgZ(98,"div",6)(99,"fieldset")(100,"div",10)(101,"j-account-dropdown",38,39),t.NdJ("selected",function(r){return t.CHM(e),t.oxw().onSenderAccountSelect(r)}),t.ALo(103,"async"),t.ALo(104,"async"),t.qZA()(),t.TgZ(105,"div",10)(106,"div",10)(107,"j-form-field",40)(108,"j-label"),t._uU(109),t.ALo(110,"translate"),t.qZA(),t._UZ(111,"input",41),t.qZA(),t.YNc(112,Vr,3,3,"div",42),t.ALo(113,"async"),t.TgZ(114,"div",43),t.YNc(115,Gr,3,3,"ng-container",44),t.ALo(116,"async"),t.YNc(117,Hr,4,8,"ng-template",null,45,t.W1O),t.qZA()()(),t.TgZ(119,"div",10)(120,"ul",46)(121,"li",47),t._UZ(122,"j-switch",48),t.TgZ(123,"span",49),t._uU(124),t.ALo(125,"translate"),t._UZ(126,"br"),t.TgZ(127,"small",50),t._uU(128),t.ALo(129,"translate"),t.ALo(130,"amountFormat"),t.ALo(131,"async"),t.qZA()()(),t.TgZ(132,"li",47),t._UZ(133,"j-switch",48),t.TgZ(134,"span",49),t._uU(135),t.ALo(136,"translate"),t._UZ(137,"br"),t.TgZ(138,"small",50),t._uU(139),t.ALo(140,"translate"),t.qZA()()(),t.TgZ(141,"li",47),t._UZ(142,"j-switch",48),t.TgZ(143,"div",51)(144,"strong"),t._uU(145),t.ALo(146,"translate"),t.qZA(),t._UZ(147,"br"),t.YNc(148,Kr,4,3,"div",1),t.YNc(149,Wr,11,10,"div",52),t.qZA()()()()()(),t.TgZ(150,"div",53)(151,"div",53),t.YNc(152,Xr,7,6,"ng-container",1),t.YNc(153,zr,4,3,"ng-container",1),t.qZA()(),t._UZ(154,"ngx-spinner",54),t.qZA()(),t.YNc(155,ts,1,0,"ng-template",null,55,t.W1O),t.BQk()}if(2&n){const e=t.MAs(67),o=t.MAs(74),r=t.MAs(79),s=t.MAs(118),l=t.MAs(156),c=t.oxw();t.xp6(2),t.Q6J("formGroup",c.form),t.xp6(6),t.hij(" ",t.lcZ(9,91,"PAYMENTS.RECIPIENT.TITLE")," "),t.xp6(3),t.hij(" ",t.lcZ(12,93,"PAYMENTS.SELECT_FROM_DICTIONARY")," "),t.xp6(5),t.Oqu(t.lcZ(17,95,"PAYMENTS.FORM.IIN")),t.xp6(2),t.Q6J("dropSpecialCharacters",!0)("jShadow",c.masks.iinOrBin.shadow)("mask",c.masks.iinOrBin.mask)("formControl",c.form.controls.iinOrBin),t.xp6(1),t.Q6J("jLoading",t.lcZ(20,97,c.isCounterPartyLoading$))("jLoadingInverted",!0),t.xp6(2),t.Q6J("ngIf",t.lcZ(22,99,c.counterParty$)===c.counterPartyStatus.SUCCESS),t.xp6(2),t.Q6J("ngIf",t.lcZ(24,101,c.counterParty$)===c.counterPartyStatus.ERROR),t.xp6(2),t.Q6J("control",c.form.controls.iinOrBin)("errorMessages",c.errors.iinOrBin),t.xp6(2),t.Q6J("ngForOf",c.riskGroups),t.xp6(4),t.Oqu(t.lcZ(32,103,"PAYMENTS.FORM.NAME")),t.xp6(2),t.Q6J("formControl",c.form.controls.name),t.xp6(3),t.Q6J("name",t.lcZ(37,105,"KZ"+c.form.controls.bankAccount.value)),t.xp6(3),t.Oqu(t.lcZ(40,107,"PAYMENTS.FORM.IBAN")),t.xp6(2),t.Q6J("jShadow",c.masks.bankAccount.shadow)("dropSpecialCharacters",!0)("mask",c.masks.bankAccount.mask)("formControl",c.form.controls.bankAccount),t.xp6(2),t.Q6J("control",c.form.controls.bankAccount)("errorMessages",c.errors.bankAccount)("params",c.bankAccountErrorParams),t.xp6(4),t.Oqu(t.lcZ(48,109,"PAYMENTS.FORM.KBE")),t.xp6(2),t.Q6J("mask",c.masks.kbeCode.mask)("jShadow",c.masks.kbeCode.shadow)("dropSpecialCharacters",!0)("formControl",c.form.controls.kbeCode),t.xp6(1),t.Q6J("ngbTooltip",l)("inlineSVG","/assets/icons/payments/question.svg"),t.xp6(1),t.Q6J("control",c.form.controls.kbeCode)("errorMessages",c.errors.kbeCode),t.xp6(4),t.Oqu(t.lcZ(56,111,"PAYMENTS.FORM.DETAILS")),t.xp6(2),t.Q6J("ngIf",t.lcZ(58,113,c.isContractApplyable$)),t.xp6(5),t.Oqu(t.lcZ(63,115,"PAYMENTS.FORM.DOCUMENT_NUMBER")),t.xp6(2),t.Q6J("mask",c.masks.number.mask)("formControl",c.form.controls.number),t.xp6(2),t.Q6J("datesEnabled",t.lcZ(68,117,c.workingDays$))("formControl",c.form.controls.date)("formatValue",!0)("jFocusOnReturn",e)("label",t.lcZ(69,119,"PAYMENTS.FORM.VALUE_DATE"))("minDate",c.dateLimit.minDate)("maxDate",c.dateLimit.maxDate)("helperText",t.lcZ(70,121,t.lcZ(71,123,c.dateMessage$))),t.xp6(10),t.Oqu(t.lcZ(77,125,"PAYMENTS.FORM.KNP_REGULAR")),t.xp6(2),t.Q6J("jFocusOnReturn",r)("appendTo",o.elementRef.nativeElement)("formControl",c.form.controls.knp)("clearable",!1)("searchMask",c.masks.knp.mask)("shadow",c.masks.knp.shadow)("compareWith",c.knpComparator)("items",t.lcZ(80,127,c.knp$)),t.xp6(6),t.AsE(" ",t.lcZ(85,129,c.purposeLength$),"/",c.rules.purposeLength,""),t.xp6(4),t.Oqu(t.lcZ(89,131,"PAYMENTS.FORM.PURPOSE")),t.xp6(2),t.Q6J("formControl",c.form.controls.purpose),t.xp6(2),t.Q6J("control",c.form.controls.purpose)("errorMessages",c.errors.purpose),t.xp6(1),t.Q6J("ngIf",t.lcZ(94,133,c.purposeMessage$)),t.xp6(3),t.hij(" ",t.lcZ(97,135,"PAYMENTS.FORM.PURPOSE_HELPER")," "),t.xp6(5),t.Q6J("isLoading",t.lcZ(103,137,c.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",c.form.controls.senderAccount.touched&&c.form.controls.senderAccount.errors)("accounts",t.lcZ(104,139,c.acceptableAccounts$)),t.xp6(6),t.Q6J("floatLabel","always"),t.xp6(2),t.Oqu(t.lcZ(110,141,"PAYMENTS.FORM.AMOUNT")),t.xp6(2),t.Q6J("dropSpecialCharacters",!0)("formControl",c.form.controls.amount),t.xp6(1),t.Q6J("ngIf",t.lcZ(113,143,c.amountMessage$)),t.xp6(3),t.Q6J("ngIf",null===t.lcZ(116,145,c.commission$))("ngIfElse",s),t.xp6(7),t.Q6J("formControl",c.form.controls.vat),t.xp6(2),t.hij(" ",t.lcZ(125,147,"PAYMENTS.VAT.TITLE"),""),t.xp6(4),t.AsE("",t.lcZ(129,149,"PAYMENTS.VAT.DESCRIPTION")," = ",t.lcZ(130,151,t.lcZ(131,153,c.vat$))," \u20b8"),t.xp6(5),t.Q6J("formControl",c.form.controls.urgent),t.xp6(2),t.hij("",t.lcZ(136,155,"PAYMENTS.FORM.URGENT")," "),t.xp6(4),t.Oqu(t.lcZ(140,157,"PAYMENTS.URGENT_HELPER")),t.xp6(3),t.Q6J("formControl",c.form.controls.notify),t.xp6(3),t.Oqu(t.lcZ(146,159,"PAYMENTS.NOTIFY.TITLE")),t.xp6(3),t.Q6J("ngIf",!c.form.controls.notify.value),t.xp6(1),t.Q6J("ngIf",c.form.controls.notify.value),t.xp6(3),t.Q6J("ngIf",c.restoredData.status!==c.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("ngIf",c.restoredData.status===c.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("name",c.SPINNER)("fullScreen",!1)}}var Yt=(()=>{return(n=Yt||(Yt={})).SUCCESS="SUCCESS",n.ERROR="ERROR",Yt;var n})();let Me=(()=>{class n extends tt.S{constructor(e,o,r,s,l,c,a,p,f,m,h,_,g,y,A,T,I,k,L){super(A.createPaymentInTengeForm(),c,s,l,e,o,r,g,a,y,p,f,m,h),this.companyService=e,this.paymentsService=o,this.maskService=r,this.route=s,this.router=l,this.api=c,this.dictionaries=a,this.translateService=p,this.authorityPermissionsService=f,this.featureFlagsService=m,this.bankFromAccount=h,this.accountsService=_,this.modalService=g,this.pipelines=y,this.paymentsFormsFactory=A,this.recipientsService=T,this.userService=I,this.contractsModalsService=k,this.currencyPaymentService=L,this.isCounterPartyLoading$=new v.X(null),this.masks={iinOrBin:"iin",bankAccount:"tengeAccount",kbeCode:"kbe",knp:"knp",number:"paymentNum",amount:"amount"},this.riskGroups=[],this.counterPartyStatus=Yt,this.counterParty$=new v.X(null),this.focusEmail$=new re.xQ,this.prevEmails$=new v.X([]),this.fetchingEmailsFor$=new v.X(null),this.iinIsSubmitted$=new v.X(null),this.iinIsFound$=new v.X(null),this.isFxContractsLoading=!0,this.fxContracts=[],this.paymentType=O.V_.REGULAR_PAYMENT_ORDER,this.user=this.userService.user}ngOnInit(){super.ngOnInit(),this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe((0,z.b)(r=>this.checkPersonalAccounts(r))),this.knp$=this.combineKNP([r=>this.dictionaries.selectByPaymentType(r,{type:O.V_.REGULAR_PAYMENT_ORDER,sortFavourite:!0})]),this.listenWorkingDays(),this.getMaskConfig(),this.createControlsStream(this.form),this.listenVAT(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.listenEmailSearch(),this.retrieveContracts();const{bankAccount:e,senderAccount:o}=this.controlsStream;this.subs.add((0,N.aj)([e.pipe((0,Et.h)(r=>this.form.controls.bankAccount.valid),(0,gt.O)("")),o.pipe((0,Et.h)(r=>this.form.controls.senderAccount.valid),(0,M.U)(r=>r.iban),(0,gt.O)(""))]).pipe((0,M.U)(([r,s])=>this.paymentsService.checkPaymentTypeFromIban(s,"KZ"+r))).subscribe(r=>this.paymentType=r)),this.applyCounterAgentVerification(),this.applyContractApplyableRule(),this.applyContractValidationRule()}openSavedPayments(){this.modalService.open(Se.D,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then(({recipient:e,account:o})=>{this.form.patchValue({bankAccount:o.iban,iinOrBin:e.iinOrBin,name:e.name,kbeCode:e.kbe.code}),this.form.markAsDirty()}).catch(()=>{})}onEmailOnSuccessFocus(e){this.focusEmail$.next(e.target.value)}openContractsAddingModal(e=null){null==e||e.preventDefault(),this.contractsModalsService.showAddContractModal(!1)}showContractDetails(e){e.preventDefault(),e.stopPropagation(),this.contractDetails.show()}retrieveContracts(){this.subs.add(this.api.getFxContracts().pipe((0,vr.x)(()=>{this.isFxContractsLoading=!1}),(0,M.U)(e=>e.filter(o=>o.permittedCurrencies.includes(Er.w.KZT)))).subscribe(e=>{this.fxContracts=e}))}onContractSelect(e){var o,r;return(0,U.mG)(this,void 0,void 0,function*(){const{contract:s,contractId:l}=this.form.controls,c=yield this.currencyPaymentService.getContractById(e.id);Object.assign(e,c),s.setValue(e),l.setValue(e.id);let a=null===(o=e.recipients)||void 0===o?void 0:o.find(h=>h.primary);const{fxContractRecipient:p,fxContractRecipientId:f}=this.form.getRawValue();if(!p&&!f&&a)return void this.selectContractRecipient(a);const m=null===(r=e.recipients)||void 0===r?void 0:r.find(h=>(null==p?void 0:p.id)===h.id||f===h.id);m&&(a=m),this.selectContractRecipient(a)})}selectContractRecipient(e){if(!e)return;const{fxContractRecipient:o,fxContractRecipientId:r}=this.form.controls;o.setValue(e),r.setValue(e.id)}openKnpDictionary(e,o){e.close(),e.blur(),setTimeout(()=>{const r=this.modals.open(Ct.Rp,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});r.componentInstance.paymentType=O.V_.REGULAR_PAYMENT_ORDER,r.result.then(s=>{this.form.controls.knp.patchValue(s.code)}).catch(()=>{})},0)}applyContractApplyableRule(){this.isContractApplyable$=this.controlsStream.kbeCode.pipe((0,M.U)(e=>e&&e[0]!==this.companyService.currentCompany.kod[0]))}applyContractValidationRule(){this.subs.add(this.controlsStream.withinContract.subscribe(e=>{e?this.form.controls.contract.setValidators(d.kI.required):this.form.controls.contract.clearValidators(),this.form.controls.contract.updateValueAndValidity()}))}applyCounterAgentVerification(){const{iinOrBin:e}=this.form.controls;this.subs.add(this.controlsStream.iinOrBin.pipe((0,S.x)(),(0,J.b)(300),(0,wt.w)(o=>(this.counterParty$.next(null),this.iinIsFound$.next(null),this.iinIsSubmitted$.next(null),e.valid&&(this.iinIsNotOwn=this.user.iin!==o,this.isCounterPartyLoading$.next(o)),this.isCounterPartyLoading$.next(null),(0,vt.of)(null)))).subscribe(o=>{o&&this.checkCounterParty(o),this.isCounterPartyLoading$.next(null)}))}checkCounterParty(e){var o,r,s;(null===(o=e.companyInfo)||void 0===o?void 0:o.name)&&this.form.controls.name.setValue(null===(r=e.companyInfo)||void 0===r?void 0:r.name),e.riskGroups&&(this.riskGroups=e.riskGroups),this.counterParty$.next(0===(null===(s=e.riskGroups)||void 0===s?void 0:s.length)?this.counterPartyStatus.SUCCESS:this.counterPartyStatus.ERROR)}listenEmailSearch(){const{emailOnSuccess:e}=this.form.controls;this.subs.add(this.controlsStream.notify.pipe((0,J.b)(100)).subscribe(o=>o?e.enable():e.disable())),this.subs.add(this.controlsStream.iinOrBin.pipe((0,J.b)(200),(0,Et.h)(o=>this.form.controls.iinOrBin.valid),(0,wt.w)(o=>(this.fetchingEmailsFor$.next(o),this.prevEmails$.next([]),this.recipientsService.getPrevNotifications(o).catch(r=>[])))).subscribe(o=>{this.prevEmails$.next(o),this.fetchingEmailsFor$.next(null)})),this.search=o=>(0,N.aj)([this.prevEmails$.pipe((0,M.U)(r=>r.map(s=>s.email))),o.pipe((0,J.b)(200),(0,S.x)(),(0,gt.O)("")),this.focusEmail$]).pipe((0,M.U)(([r,s,l])=>s?r.filter(c=>c.toLowerCase().indexOf(s.toLowerCase())>-1).slice(0,3):r.slice(0,3)))}checkIin(){return(0,U.mG)(this,void 0,void 0,function*(){this.riskGroups=[],this.iinIsSubmitted$.next(!0);const e=this.form.controls.iinOrBin.value;this.isCounterPartyLoading$.next(e),this.recipientsService.checkCounterParty(e).then(o=>(0,U.mG)(this,void 0,void 0,function*(){o&&this.checkCounterParty(o),yield this.successfulCounterPartyResult()})).catch(o=>{console.error(o),this.iinIsSubmitted$.next(null),this.iinIsFound$.next(null),this.isCounterPartyLoading$.next(null),this.showSignError()})})}showSignError(){return(0,U.mG)(this,void 0,void 0,function*(){return this.modalService.open(Ct.BB,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result})}successfulCounterPartyResult(){return(0,U.mG)(this,void 0,void 0,function*(){this.iinIsSubmitted$.next(null),this.iinIsFound$.next(!0),this.isCounterPartyLoading$.next(null)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(ft.J),t.Y36(X.cR),t.Y36(et.O),t.Y36(Z.gz),t.Y36(Z.F0),t.Y36(bt.e),t.Y36(dt.$),t.Y36(E.sK),t.Y36(nt.Eg),t.Y36(j.a),t.Y36(Q.vI),t.Y36(q.iu),t.Y36(R.FF),t.Y36(Tt.Z),t.Y36(xt.$),t.Y36(Nr.F),t.Y36(Pe.KD),t.Y36(ae.T),t.Y36(C.hm))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-payment-order"]],viewQuery:function(e,o){if(1&e&&(t.Gf(Rr,7),t.Gf(Zr,5)),2&e){let r;t.iGM(r=t.CRH())&&(o.emailOnSuccess=r.first),t.iGM(r=t.CRH())&&(o.contractDetails=r.first)}},features:[t.qOj],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],[1,"payment-section"],["jInvalidControlScroll","","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"payments__header"],[1,"h2","mb-0"],["type","button",1,"btn","btn-link","p-0","p3",3,"click"],[1,"form-group"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"dropSpecialCharacters","jShadow","mask","formControl"],["jSuffix","",1,"counterParty","p3",3,"jLoading","jLoadingInverted"],[3,"control","errorMessages"],[1,"navbar-nav","mt-2"],["class","p3 risk-li text-muted",4,"ngFor","ngForOf"],["clearable","true"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"formControl"],["jPrefix","","hideEmpty","true",3,"name"],["type","text","jFormInput","","jReplaceOnPaste","KZ","jDynamicPrefix","KZ","jFocusOnReturn","","jUppercase","",1,"form-control",3,"jShadow","dropSpecialCharacters","mask","formControl"],["accountInput","jFormInput"],[3,"control","errorMessages","params"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","jShadow","dropSpecialCharacters","formControl"],["href","javascript:void(0)","jSuffix","","tooltipClass","tooltip-light tooltip-large","triggers","mouseenter:mouseleave",1,"mr-1","link-gray",3,"ngbTooltip","inlineSVG"],[1,"h2"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","formControl"],["allowAuto","true",3,"datesEnabled","formControl","formatValue","jFocusOnReturn","label","minDate","maxDate","helperText"],["datePicker",""],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","compareWith","items"],["select",""],["j-header-tmp",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[1,"j-input-helper","text-muted","mt-1","p3"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],["clearable","true",3,"floatLabel"],["type","text","jFocusOnReturn","","jFormInput","","jCursorBound","","jReplaceDot","","suffix"," \u20b8","placeholder","0,00","mask","separator.2","thousandSeparator"," ","decimalMarker",",",1,"form-control",3,"dropSpecialCharacters","formControl"],["class","j-input-helper text-muted mt-1 p3",4,"ngIf"],[1,"j-input-helper","text-muted","mt-1","p3","position-relative"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group"],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"ml-3","flex-grow-1"],["class","mt-1",4,"ngIf"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["kbeInfo",""],["translate","",1,"text-muted","mr-2"],[1,"text-success",3,"inlineSVG"],[1,"text-danger",3,"inlineSVG"],[1,"p3","risk-li","text-muted"],[1,"j-switch-wrap","form-group"],["translate",""],["id","contractGroup","class","form-group mt-4",4,"ngIf"],["id","contractGroup",1,"form-group","mt-4"],["contractsWrapper",""],[3,"loading","appendTo","jFocusOnReturn","formControl","clearable","searchFn","items","change"],["contractsSelect",""],["j-option-tmp",""],["j-notfound-tmp",""],["j-label-tmp",""],["href","#","jSuffix","","class","mr-1 p3","translate","",3,"click",4,"ngIf"],["class","mb-3",4,"ngIf"],[1,"mb-3"],["type","button","class","list-dictionary form-section--action btn btn-xs btn-link float-right",3,"click",4,"ngIf"],["type","button",1,"list-dictionary","form-section--action","btn","btn-xs","btn-link","float-right",3,"click"],[1,"j-option-label","text-wrap","p3"],[1,"text-dark","contract-row"],[3,"money"],[1,"text-muted","contract-row"],["translate","CURRENCY_PAYMENT.CONTRACTS.SELECT.REMAINDER"],[1,"contracts__empty"],["src","assets/img/payments/no_contract.svg"],[1,"mx-auto","mt-3","p2","text-muted",3,"innerHTML"],["href","#",1,"link","d-inline-block","mt-3",3,"click"],["label","CURRENCY_PAYMENT.CONTRACTS.NOT_FOUND"],[1,"text-center","my-2"],["href","#",1,"link","d-inline-block",3,"click"],["href","#","jSuffix","","translate","",1,"mr-1","p3",3,"click"],["type","button",1,"form-section--action","btn","btn-xs","btn-link","float-right",3,"click"],[1,"p2","m-0"],[1,"p3","text-gray"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[3,"innerHTML"],[1,"mt-1"],["type","email","jFormInput","","jFocusOnReturn","","autocomplete","off",1,"form-control",3,"ngbTypeahead","formControl","focus"],["emailOnSuccess","ngbTypeahead"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"]],template:function(e,o){1&e&&(t.YNc(0,Sr,1,2,"j-restricted-placeholder",0),t.YNc(1,es,157,161,"ng-container",1)),2&e&&(t.Q6J("ngIf",o.isRestricted),t.xp6(1),t.Q6J("ngIf",!o.isRestricted))},directives:[b.O5,ot.G,d._Y,d.JL,$,Y.L,d.sg,V.O8,it.I,G.m,B.hx,d.Fj,Y.v,yt.N,d.JJ,d.oH,ue.v,le.T,E.Pi,Bt.d$,ct.k,b.sg,kt.k,Gt.X,Ut.w,Lt.u,At.q,R._L,st.q,at.F,w.BN,w.Ok,Nt.y,w.qg,Rt.j,w.Fe,qt.Q,lt.L,rt.S,Zt.a,St.s,R.dR,ut.Ro,pe.s],pipes:[E.X$,b.Ov,Ht.vI,ht.n],styles:[".payments__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem}.counterParty[_ngcontent-%COMP%]{position:relative;min-width:40px;height:100%}li.risk-li[_ngcontent-%COMP%] + li.risk-li[_ngcontent-%COMP%]{margin-top:.5rem}.j-select[_ngcontent-%COMP%]   .j-spinner-loader[_ngcontent-%COMP%]{top:19px}.contract-row[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-between}.contract-row[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:first-child{padding-right:1rem}.contracts__empty[_ngcontent-%COMP%]{text-align:center;max-width:312px;margin:0 auto}.contracts-description[_ngcontent-%COMP%]{position:relative}.contracts-description.is-loading[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{opacity:.5}.contracts-scroll-link[_ngcontent-%COMP%]{border-bottom:1px dashed #1586bb}.contracts-scroll-link[_ngcontent-%COMP%]:hover{border-color:#ef5630}"]}),n})();var jt=u(61322);function us(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"j-restricted-placeholder",2),t.NdJ("retried",function(){return t.CHM(e),t.oxw().updatePermissions()}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("isRetryable",e.isPermissionsUpdateAllowed)("isLoading",e.isPermissionsUpdating)}}function ms(n,i){if(1&n&&(t.TgZ(0,"div",36)(1,"div",37),t._uU(2),t.qZA()()),2&n){const e=i.ngIf;t.xp6(2),t.hij(" ",e," ")}}function ps(n,i){if(1&n&&(t.TgZ(0,"div",38),t._UZ(1,"span",39),t.ALo(2,"translate"),t.qZA()),2&n){const e=i.ngIf;t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e),t.oJD)}}function ds(n,i){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function _s(n,i){if(1&n&&(t._uU(0),t.ALo(1,"translate"),t.ALo(2,"amountFormat"),t.ALo(3,"async")),2&n){const e=t.oxw(2);t.AsE(" ",t.lcZ(1,2,"PAYMENTS.COMMISSION"),": ",t.lcZ(2,4,t.lcZ(3,6,e.commission$))," \u20b8 ")}}function fs(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",40),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).saveToDraft()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",41),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"PAYMENTS.FORM.SAVE")),t.xp6(3),t.hij("",t.lcZ(6,4,e.submitLabel)," ")}}function hs(n,i){1&n&&(t.ynx(0),t.TgZ(1,"button",42),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function gs(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",3,4),t.NdJ("submit",function(r){return t.CHM(e),t.oxw().onSubmit(r)}),t.TgZ(3,"div",5)(4,"fieldset")(5,"legend",6),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",7)(9,"j-form-field")(10,"j-label"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t._UZ(13,"input",8),t.qZA()(),t.TgZ(14,"div",7)(15,"j-form-field",null,9)(17,"j-label"),t._uU(18),t.ALo(19,"translate"),t.qZA(),t._UZ(20,"j-select",10,11),t.ALo(22,"async"),t.qZA()(),t.TgZ(23,"div",12)(24,"span",13),t._uU(25),t.ALo(26,"async"),t.qZA(),t.TgZ(27,"j-form-field")(28,"j-label"),t._uU(29),t.ALo(30,"translate"),t.qZA(),t._UZ(31,"textarea",14,15)(33,"j-error",16),t.YNc(34,ms,3,1,"div",17),t.ALo(35,"async"),t.qZA()(),t.TgZ(36,"div",7)(37,"j-account-dropdown",18,19),t.NdJ("selected",function(r){return t.CHM(e),t.oxw().onSenderAccountSelect(r)}),t.ALo(39,"async"),t.ALo(40,"async"),t.qZA()()()(),t.TgZ(41,"div",5)(42,"fieldset")(43,"j-employee-group-control",20),t._UZ(44,"j-error",16),t.qZA()()(),t.TgZ(45,"div",21)(46,"div",7)(47,"fieldset")(48,"ul",22)(49,"li",23)(50,"h5",24),t._uU(51),t.ALo(52,"translate"),t.TgZ(53,"span",25)(54,"strong"),t._uU(55),t.ALo(56,"amountFormat"),t.ALo(57,"async"),t.qZA(),t._uU(58," \u20b8"),t.qZA()(),t.YNc(59,ps,3,3,"div",26),t.ALo(60,"async"),t.TgZ(61,"p",27),t.YNc(62,ds,3,3,"ng-container",28),t.ALo(63,"async"),t.YNc(64,_s,4,8,"ng-template",null,29,t.W1O),t.qZA()(),t.TgZ(66,"li",30),t._UZ(67,"j-switch",31),t.TgZ(68,"span",32),t._uU(69),t.ALo(70,"translate"),t._UZ(71,"br"),t.TgZ(72,"small",33),t._uU(73),t.ALo(74,"translate"),t.qZA()()()()()()(),t.TgZ(75,"div",34)(76,"div",34),t.YNc(77,fs,7,6,"ng-container",1),t.YNc(78,hs,4,3,"ng-container",1),t.qZA()(),t._UZ(79,"ngx-spinner",35),t.qZA(),t.BQk()}if(2&n){const e=t.MAs(16),o=t.MAs(21),r=t.MAs(65),s=t.oxw();t.xp6(1),t.Q6J("formGroup",s.form),t.xp6(5),t.Oqu(t.lcZ(7,45,"PAYMENTS.FORM.DETAILS")),t.xp6(5),t.Oqu(t.lcZ(12,47,"PAYMENTS.FORM.DOCUMENT_NUMBER")),t.xp6(2),t.Q6J("mask",s.masks.number.mask)("formControl",s.form.controls.number),t.xp6(5),t.Oqu(t.lcZ(19,49,"PAYMENTS.FORM.KNP")),t.xp6(2),t.Q6J("jFocusOnReturn",o)("appendTo",e.elementRef.nativeElement)("formControl",s.form.controls.knp)("clearable",!1)("searchMask",s.masks.knp.mask)("shadow",s.masks.knp.shadow)("items",t.lcZ(22,51,s.knp$)),t.xp6(5),t.AsE(" ",t.lcZ(26,53,s.purposeLength$),"/",s.rules.purposeLength,""),t.xp6(4),t.Oqu(t.lcZ(30,55,"PAYMENTS.FORM.PURPOSE")),t.xp6(2),t.Q6J("formControl",s.form.controls.purpose),t.xp6(2),t.Q6J("control",s.form.controls.purpose)("errorMessages",s.errors.purpose),t.xp6(1),t.Q6J("ngIf",t.lcZ(35,57,s.purposeMessage$)),t.xp6(3),t.Q6J("isLoading",t.lcZ(39,59,s.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",s.form.controls.senderAccount.touched&&s.form.controls.senderAccount.errors)("accounts",t.lcZ(40,61,s.acceptableAccounts$)),t.xp6(6),t.Q6J("formControl",s.form.controls.employees)("paymentType",s.paymentType)("minAmount",s.employeeMinAmount)("maxAmount",s.employeeMaxAmount)("periodRequired",!0)("birthDateRequired",!0)("additionalPeriodEnabled",!0),t.xp6(1),t.Q6J("control",s.form.controls.employees)("errorMessages",s.errors.employees),t.xp6(7),t.hij("",t.lcZ(52,63,"PAYMENTS.FORM.TOTAL_AMOUNT"),": "),t.xp6(4),t.Oqu(t.lcZ(56,65,t.lcZ(57,67,s.total$))),t.xp6(4),t.Q6J("ngIf",t.lcZ(60,69,s.amountMessage$)),t.xp6(3),t.Q6J("ngIf",null===t.lcZ(63,71,s.commission$))("ngIfElse",r),t.xp6(5),t.Q6J("formControl",s.form.controls.urgent),t.xp6(2),t.hij("",t.lcZ(70,73,"PAYMENTS.FORM.URGENT")," "),t.xp6(4),t.Oqu(t.lcZ(74,75,"PAYMENTS.URGENT_HELPER")),t.xp6(4),t.Q6J("ngIf",s.restoredData.status!==s.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("ngIf",s.restoredData.status===s.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("name",s.SPINNER)("fullScreen",!1)}}let Ie=(()=>{class n extends tt.S{constructor(e,o,r,s,l,c,a,p,f,m,h,_,g,y,A,T){super(y.createPensionForm(),m,e,o,s,r,c,p,f,h,_,g,A,T),this.route=e,this.router=o,this.paymentsService=r,this.companyService=s,this.dateAdapter=l,this.maskService=c,this.accountsService=a,this.modalService=p,this.dictionaries=f,this.api=m,this.pipeline=h,this.translateService=_,this.authorityPermissionsService=g,this.paymentsFormsFactory=y,this.featureFlagsService=A,this.bankFromAccount=T,this.masks={number:"paymentNum",amount:"amount",knp:"knp"},this.employeeMinAmount=6e3,this.employeeMaxAmount=null,this.employees$=new v.X([]),this.amount$=new v.X(0),this.subs=new It.w,this.paymentType=O.V_.PENSION}ngOnInit(){super.ngOnInit(),this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe((0,z.b)(e=>this.checkPersonalAccounts(e))),this.getMaskConfig(),this.createControlsStream(this.form),this.knp$=this.combineKNP(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Z.gz),t.Y36(Z.F0),t.Y36(C.cR),t.Y36(ft.J),t.Y36(R.NG),t.Y36(et.O),t.Y36(q.iu),t.Y36(R.FF),t.Y36(Pe.$d),t.Y36(C.e6),t.Y36(C.Zx),t.Y36(E.sK),t.Y36(nt.Eg),t.Y36(C.$g),t.Y36(j.a),t.Y36(Q.vI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-pension-payment"]],features:[t.qOj],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],["jInvalidControlScroll","","autocomplete","off","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"h2"],[1,"form-group"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","minAmount","maxAmount","periodRequired","birthDateRequired","additionalPeriodEnabled"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"]],template:function(e,o){1&e&&(t.YNc(0,us,1,2,"j-restricted-placeholder",0),t.YNc(1,gs,80,77,"ng-container",1)),2&e&&(t.Q6J("ngIf",o.isRestricted),t.xp6(1),t.Q6J("ngIf",!o.isRestricted))},directives:[b.O5,ot.G,d._Y,d.JL,$,Y.L,d.sg,V.O8,it.I,G.m,B.hx,d.Fj,Y.v,d.JJ,d.oH,at.F,ct.k,lt.L,rt.S,jt.p,st.q,ut.Ro],pipes:[E.X$,b.Ov,ht.n],styles:[""],encapsulation:2}),n})();function Cs(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"j-restricted-placeholder",2),t.NdJ("retried",function(){return t.CHM(e),t.oxw().updatePermissions()}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("isRetryable",e.isPermissionsUpdateAllowed)("isLoading",e.isPermissionsUpdating)}}function As(n,i){if(1&n&&(t.TgZ(0,"div",36)(1,"div",37),t._uU(2),t.qZA()()),2&n){const e=i.ngIf;t.xp6(2),t.hij(" ",e," ")}}function ys(n,i){if(1&n&&(t.TgZ(0,"div",38),t._UZ(1,"span",39),t.ALo(2,"translate"),t.qZA()),2&n){const e=i.ngIf;t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e),t.oJD)}}function Ts(n,i){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function bs(n,i){if(1&n&&(t._uU(0),t.ALo(1,"translate"),t.ALo(2,"amountFormat"),t.ALo(3,"async")),2&n){const e=t.oxw(2);t.AsE(" ",t.lcZ(1,2,"PAYMENTS.COMMISSION"),": ",t.lcZ(2,4,t.lcZ(3,6,e.commission$))," \u20b8 ")}}function xs(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",40),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).saveToDraft()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",41),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"PAYMENTS.FORM.SAVE")),t.xp6(3),t.hij("",t.lcZ(6,4,e.submitLabel)," ")}}function vs(n,i){1&n&&(t.ynx(0),t.TgZ(1,"button",42),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function Es(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",3,4),t.NdJ("submit",function(r){return t.CHM(e),t.oxw().onSubmit(r)}),t.TgZ(3,"div",5)(4,"fieldset")(5,"legend",6),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",7)(9,"j-form-field")(10,"j-label"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t._UZ(13,"input",8),t.qZA()(),t.TgZ(14,"div",7)(15,"j-form-field",null,9)(17,"j-label"),t._uU(18),t.ALo(19,"translate"),t.qZA(),t._UZ(20,"j-select",10,11),t.ALo(22,"async"),t.qZA()(),t.TgZ(23,"div",12)(24,"span",13),t._uU(25),t.ALo(26,"async"),t.qZA(),t.TgZ(27,"j-form-field")(28,"j-label"),t._uU(29),t.ALo(30,"translate"),t.qZA(),t._UZ(31,"textarea",14,15)(33,"j-error",16),t.YNc(34,As,3,1,"div",17),t.ALo(35,"async"),t.qZA()(),t.TgZ(36,"div",7)(37,"j-account-dropdown",18,19),t.NdJ("selected",function(r){return t.CHM(e),t.oxw().onSenderAccountSelect(r)}),t.ALo(39,"async"),t.ALo(40,"async"),t.qZA()()()(),t.TgZ(41,"div",5)(42,"fieldset")(43,"j-employee-group-control",20),t._UZ(44,"j-error",16),t.qZA()()(),t.TgZ(45,"div",21)(46,"div",7)(47,"fieldset")(48,"ul",22)(49,"li",23)(50,"h5",24),t._uU(51),t.ALo(52,"translate"),t.TgZ(53,"span",25)(54,"strong"),t._uU(55),t.ALo(56,"amountFormat"),t.ALo(57,"async"),t.qZA(),t._uU(58," \u20b8"),t.qZA()(),t.YNc(59,ys,3,3,"div",26),t.ALo(60,"async"),t.TgZ(61,"p",27),t.YNc(62,Ts,3,3,"ng-container",28),t.ALo(63,"async"),t.YNc(64,bs,4,8,"ng-template",null,29,t.W1O),t.qZA()(),t.TgZ(66,"li",30),t._UZ(67,"j-switch",31),t.TgZ(68,"span",32),t._uU(69),t.ALo(70,"translate"),t._UZ(71,"br"),t.TgZ(72,"small",33),t._uU(73),t.ALo(74,"translate"),t.qZA()()()()()()(),t.TgZ(75,"div",34)(76,"div",34),t.YNc(77,xs,7,6,"ng-container",1),t.YNc(78,vs,4,3,"ng-container",1),t.qZA()(),t._UZ(79,"ngx-spinner",35),t.qZA(),t.BQk()}if(2&n){const e=t.MAs(16),o=t.MAs(21),r=t.MAs(65),s=t.oxw();t.xp6(1),t.Q6J("formGroup",s.form),t.xp6(5),t.Oqu(t.lcZ(7,45,"PAYMENTS.FORM.DETAILS")),t.xp6(5),t.Oqu(t.lcZ(12,47,"PAYMENTS.FORM.DOCUMENT_NUMBER")),t.xp6(2),t.Q6J("mask",s.masks.number.mask)("formControl",s.form.controls.number),t.xp6(5),t.Oqu(t.lcZ(19,49,"PAYMENTS.FORM.KNP")),t.xp6(2),t.Q6J("jFocusOnReturn",o)("appendTo",e.elementRef.nativeElement)("formControl",s.form.controls.knp)("clearable",!1)("searchMask",s.masks.knp.mask)("shadow",s.masks.knp.shadow)("items",t.lcZ(22,51,s.knp$)),t.xp6(5),t.AsE(" ",t.lcZ(26,53,s.purposeLength$),"/",s.rules.purposeLength,""),t.xp6(4),t.Oqu(t.lcZ(30,55,"PAYMENTS.FORM.PURPOSE")),t.xp6(2),t.Q6J("formControl",s.form.controls.purpose),t.xp6(2),t.Q6J("control",s.form.controls.purpose)("errorMessages",s.errors.purpose),t.xp6(1),t.Q6J("ngIf",t.lcZ(35,57,s.purposeMessage$)),t.xp6(3),t.Q6J("isLoading",t.lcZ(39,59,s.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",s.form.controls.senderAccount.touched&&s.form.controls.senderAccount.errors)("accounts",t.lcZ(40,61,s.acceptableAccounts$)),t.xp6(6),t.Q6J("formControl",s.form.controls.employees)("paymentType",s.paymentType)("periodRequired",!0)("birthDateRequired",!0)("minAmount",s.employeeMinAmount)("maxAmount",s.employeeMaxAmount)("additionalPeriodEnabled",!0),t.xp6(1),t.Q6J("control",s.form.controls.employees)("errorMessages",s.errors.employees),t.xp6(7),t.hij("",t.lcZ(52,63,"PAYMENTS.FORM.TOTAL_AMOUNT"),": "),t.xp6(4),t.Oqu(t.lcZ(56,65,t.lcZ(57,67,s.total$))),t.xp6(4),t.Q6J("ngIf",t.lcZ(60,69,s.amountMessage$)),t.xp6(3),t.Q6J("ngIf",null===t.lcZ(63,71,s.commission$))("ngIfElse",r),t.xp6(5),t.Q6J("formControl",s.form.controls.urgent),t.xp6(2),t.hij("",t.lcZ(70,73,"PAYMENTS.FORM.URGENT")," "),t.xp6(4),t.Oqu(t.lcZ(74,75,"PAYMENTS.URGENT_HELPER")),t.xp6(4),t.Q6J("ngIf",s.restoredData.status!==s.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("ngIf",s.restoredData.status===s.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("name",s.SPINNER)("fullScreen",!1)}}let Le=(()=>{class n extends tt.S{constructor(e,o,r,s,l,c,a,p,f,m,h,_,g,y,A,T){super(g.createSocialForm(),f,s,l,o,e,c,p,m,h,_,A,y,T),this.paymentsService=e,this.companyService=o,this.dateAdapter=r,this.route=s,this.router=l,this.maskService=c,this.accountsService=a,this.modalService=p,this.api=f,this.dictionaries=m,this.pipeline=h,this.translateService=_,this.paymentsFormsFactory=g,this.featureFlagsService=y,this.authorityPermissionsService=A,this.bankFromAccount=T,this.masks={number:"paymentNum",amount:"amount",knp:"knp"},this.employeeMinAmount=2100,this.employeeMaxAmount=null,this.paymentType=O.V_.SOCIAL}ngOnInit(){super.ngOnInit(),this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe((0,z.b)(e=>this.checkPersonalAccounts(e))),this.getMaskConfig(),this.createControlsStream(this.form),this.listenWorkingDays(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.knp$=this.combineKNP()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(X.cR),t.Y36(ft.J),t.Y36(R.NG),t.Y36(Z.gz),t.Y36(Z.F0),t.Y36(et.O),t.Y36(q.iu),t.Y36(R.FF),t.Y36(bt.e),t.Y36(dt.$),t.Y36(Tt.Z),t.Y36(E.sK),t.Y36(xt.$),t.Y36(j.a),t.Y36(nt.Eg),t.Y36(Q.vI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-social-payment"]],features:[t.qOj],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],["jInvalidControlScroll","","jFocusableContainer","","autocomplete","off",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"h2"],[1,"form-group"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","periodRequired","birthDateRequired","minAmount","maxAmount","additionalPeriodEnabled"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"]],template:function(e,o){1&e&&(t.YNc(0,Cs,1,2,"j-restricted-placeholder",0),t.YNc(1,Es,80,77,"ng-container",1)),2&e&&(t.Q6J("ngIf",o.isRestricted),t.xp6(1),t.Q6J("ngIf",!o.isRestricted))},directives:[b.O5,ot.G,d._Y,d.JL,$,Y.L,d.sg,V.O8,it.I,G.m,B.hx,d.Fj,Y.v,d.JJ,d.oH,at.F,ct.k,lt.L,rt.S,jt.p,st.q,ut.Ro],pipes:[E.X$,b.Ov,ht.n],styles:[""]}),n})();function Ns(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"j-restricted-placeholder",2),t.NdJ("retried",function(){return t.CHM(e),t.oxw().updatePermissions()}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("isRetryable",e.isPermissionsUpdateAllowed)("isLoading",e.isPermissionsUpdating)}}function Rs(n,i){if(1&n&&(t.TgZ(0,"div",36)(1,"div",37),t._uU(2),t.ALo(3,"translate"),t.qZA()()),2&n){const e=i.ngIf;t.xp6(2),t.hij(" ",t.lcZ(3,1,e)," ")}}function Zs(n,i){if(1&n&&(t.TgZ(0,"div",38),t._UZ(1,"span",39),t.ALo(2,"translate"),t.qZA()),2&n){const e=i.ngIf;t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e),t.oJD)}}function Ss(n,i){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function Ps(n,i){if(1&n&&(t._uU(0),t.ALo(1,"translate"),t.ALo(2,"amountFormat"),t.ALo(3,"async")),2&n){const e=t.oxw(2);t.AsE(" ",t.lcZ(1,2,"PAYMENTS.COMMISSION"),": ",t.lcZ(2,4,t.lcZ(3,6,e.commission$))," \u20b8 ")}}function Ms(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",40),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).saveToDraft()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",41),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"PAYMENTS.FORM.SAVE")),t.xp6(3),t.hij("",t.lcZ(6,4,e.submitLabel)," ")}}function Is(n,i){1&n&&(t.ynx(0),t.TgZ(1,"button",42),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function Ls(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"form",3,4),t.NdJ("submit",function(r){return t.CHM(e),t.oxw().onSubmit(r)}),t.TgZ(3,"div",5)(4,"fieldset")(5,"legend",6),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",7)(9,"j-form-field")(10,"j-label"),t._uU(11),t.ALo(12,"translate"),t.qZA(),t._UZ(13,"input",8),t.qZA()(),t.TgZ(14,"div",7)(15,"j-form-field",null,9)(17,"j-label"),t._uU(18),t.ALo(19,"translate"),t.qZA(),t._UZ(20,"j-select",10,11),t.ALo(22,"async"),t.qZA()(),t.TgZ(23,"div",12)(24,"span",13),t._uU(25),t.ALo(26,"async"),t.qZA(),t.TgZ(27,"j-form-field")(28,"j-label"),t._uU(29),t.ALo(30,"translate"),t.qZA(),t._UZ(31,"textarea",14,15)(33,"j-error",16),t.YNc(34,Rs,4,3,"div",17),t.ALo(35,"async"),t.qZA()(),t.TgZ(36,"div",7)(37,"j-account-dropdown",18,19),t.NdJ("selected",function(r){return t.CHM(e),t.oxw().onSenderAccountSelect(r)}),t.ALo(39,"async"),t.ALo(40,"async"),t.qZA()()()(),t.TgZ(41,"div",5)(42,"fieldset")(43,"j-employee-group-control",20),t._UZ(44,"j-error",16),t.qZA()()(),t.TgZ(45,"div",21)(46,"div",7)(47,"fieldset")(48,"ul",22)(49,"li",23)(50,"h5",24),t._uU(51),t.ALo(52,"translate"),t.TgZ(53,"span",25)(54,"strong"),t._uU(55),t.ALo(56,"amountFormat"),t.ALo(57,"async"),t.qZA(),t._uU(58," \u20b8"),t.qZA()(),t.YNc(59,Zs,3,3,"div",26),t.ALo(60,"async"),t.TgZ(61,"p",27),t.YNc(62,Ss,3,3,"ng-container",28),t.ALo(63,"async"),t.YNc(64,Ps,4,8,"ng-template",null,29,t.W1O),t.qZA()(),t.TgZ(66,"li",30),t._UZ(67,"j-switch",31),t.TgZ(68,"span",32),t._uU(69),t.ALo(70,"translate"),t._UZ(71,"br"),t.TgZ(72,"small",33),t._uU(73),t.ALo(74,"translate"),t.qZA()()()()()()(),t.TgZ(75,"div",34),t.YNc(76,Ms,7,6,"ng-container",1),t.YNc(77,Is,4,3,"ng-container",1),t.qZA(),t._UZ(78,"ngx-spinner",35),t.qZA(),t.BQk()}if(2&n){const e=t.MAs(16),o=t.MAs(21),r=t.MAs(65),s=t.oxw();t.xp6(1),t.Q6J("formGroup",s.form),t.xp6(5),t.Oqu(t.lcZ(7,45,"PAYMENTS.FORM.DETAILS")),t.xp6(5),t.Oqu(t.lcZ(12,47,"PAYMENTS.FORM.DOCUMENT_NUMBER")),t.xp6(2),t.Q6J("mask",s.masks.number.mask)("formControl",s.form.controls.number),t.xp6(5),t.Oqu(t.lcZ(19,49,"PAYMENTS.FORM.KNP")),t.xp6(2),t.Q6J("jFocusOnReturn",o)("appendTo",e.elementRef.nativeElement)("formControl",s.form.controls.knp)("clearable",!1)("searchMask",s.masks.knp.mask)("shadow",s.masks.knp.shadow)("items",t.lcZ(22,51,s.knp$)),t.xp6(5),t.AsE(" ",t.lcZ(26,53,s.purposeLength$),"/",s.rules.purposeLength,""),t.xp6(4),t.Oqu(t.lcZ(30,55,"PAYMENTS.FORM.PURPOSE")),t.xp6(2),t.Q6J("formControl",s.form.controls.purpose),t.xp6(2),t.Q6J("control",s.form.controls.purpose)("errorMessages",s.errors.purpose),t.xp6(1),t.Q6J("ngIf",t.lcZ(35,57,s.purposeMessage$)),t.xp6(3),t.Q6J("isLoading",t.lcZ(39,59,s.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",s.form.controls.senderAccount.touched&&s.form.controls.senderAccount.errors)("accounts",t.lcZ(40,61,s.acceptableAccounts$)),t.xp6(6),t.Q6J("formControl",s.form.controls.employees)("paymentType",s.paymentType)("minAmount",s.employeeMinAmount)("maxAmount",s.employeeMaxAmount)("periodRequired",!0)("birthDateRequired",!0)("additionalPeriodEnabled",!0),t.xp6(1),t.Q6J("control",s.form.controls.employees)("errorMessages",s.errors.employees),t.xp6(7),t.hij("",t.lcZ(52,63,"PAYMENTS.FORM.TOTAL_AMOUNT"),": "),t.xp6(4),t.Oqu(t.lcZ(56,65,t.lcZ(57,67,s.total$))),t.xp6(4),t.Q6J("ngIf",t.lcZ(60,69,s.amountMessage$)),t.xp6(3),t.Q6J("ngIf",null===t.lcZ(63,71,s.commission$))("ngIfElse",r),t.xp6(5),t.Q6J("formControl",s.form.controls.urgent),t.xp6(2),t.hij("",t.lcZ(70,73,"PAYMENTS.FORM.URGENT")," "),t.xp6(4),t.Oqu(t.lcZ(74,75,"PAYMENTS.URGENT_HELPER")),t.xp6(3),t.Q6J("ngIf",s.restoredData.status!==s.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("ngIf",s.restoredData.status===s.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("name",s.SPINNER)("fullScreen",!1)}}let Ue=(()=>{class n extends tt.S{constructor(e,o,r,s,l,c,a,p,f,m,h,_,g,y,A,T){super(g.createMedicalForm(),m,e,o,s,r,c,p,f,h,_,y,A,T),this.route=e,this.router=o,this.paymentsService=r,this.companyService=s,this.dateAdapter=l,this.maskService=c,this.accountsService=a,this.modalService=p,this.dictionaries=f,this.api=m,this.pipeline=h,this.translateService=_,this.paymentsFormsFactory=g,this.authorityPermissionsService=y,this.featureFlagsService=A,this.bankFromAccount=T,this.masks={number:"paymentNum",amount:"amount",knp:"knp"},this.employeeMinAmount=4200,this.employeeMaxAmount=null,this.paymentType=O.V_.MEDICAL}ngOnInit(){super.ngOnInit(),this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe((0,z.b)(e=>this.checkPersonalAccounts(e))),this.getMaskConfig(),this.createControlsStream(this.form),this.knp$=this.combineKNP(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Z.gz),t.Y36(Z.F0),t.Y36(X.cR),t.Y36(ft.J),t.Y36(R.NG),t.Y36(et.O),t.Y36(q.iu),t.Y36(R.FF),t.Y36(dt.$),t.Y36(bt.e),t.Y36(Tt.Z),t.Y36(E.sK),t.Y36(xt.$),t.Y36(nt.Eg),t.Y36(j.a),t.Y36(Q.vI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-medical-payment"]],features:[t.qOj],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],["jInvalidControlScroll","","jFocusableContainer","","autocomplete","off",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"h2"],[1,"form-group"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","minAmount","maxAmount","periodRequired","birthDateRequired","additionalPeriodEnabled"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"]],template:function(e,o){1&e&&(t.YNc(0,Ns,1,2,"j-restricted-placeholder",0),t.YNc(1,Ls,79,77,"ng-container",1)),2&e&&(t.Q6J("ngIf",o.isRestricted),t.xp6(1),t.Q6J("ngIf",!o.isRestricted))},directives:[b.O5,ot.G,d._Y,d.JL,$,Y.L,d.sg,V.O8,it.I,G.m,B.hx,d.Fj,Y.v,d.JJ,d.oH,at.F,ct.k,lt.L,rt.S,jt.p,st.q,ut.Ro],pipes:[E.X$,b.Ov,ht.n],styles:[""]}),n})();var Us=u(62981);function ks(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"j-restricted-placeholder",2),t.NdJ("retried",function(){return t.CHM(e),t.oxw().updatePermissions()}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("isRetryable",e.isPermissionsUpdateAllowed)("isLoading",e.isPermissionsUpdating)}}function Os(n,i){1&n&&(t.TgZ(0,"j-label"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij("",t.lcZ(2,1,"PAYMENTS.FORM.RECEIVER_BANK")," "))}function Ys(n,i){if(1&n&&(t.TgZ(0,"div",57)(1,"div",58),t._UZ(2,"j-entity-logo",59),t.qZA(),t.TgZ(3,"div",60)(4,"p",61),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"p",62),t._uU(8),t.qZA()()()),2&n){const e=i.item;t.xp6(2),t.Q6J("name",e.bic),t.xp6(3),t.hij(" ",e.salaryTransitIban?t.lcZ(6,4,"PAYMENTS.FORM.ACCOUNT")+e.salaryTransitIban:e.name," "),t.xp6(3),t.AsE("",e.bic,": ",e.name,"")}}function js(n,i){if(1&n&&(t.TgZ(0,"div",63)(1,"div",58),t._UZ(2,"j-entity-logo",59),t.qZA(),t.TgZ(3,"div",60)(4,"p",61),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"p",62),t._uU(8),t.qZA()()()),2&n){const e=i.item;t.xp6(2),t.Q6J("name",e.bic),t.xp6(3),t.hij(" ",e.salaryTransitIban?t.lcZ(6,4,"PAYMENTS.FORM.ACCOUNT")+e.salaryTransitIban:e.name," "),t.xp6(3),t.AsE("",e.bic,": ",e.name," ")}}function Ds(n,i){if(1&n&&(t.TgZ(0,"div",10)(1,"j-form-field",64)(2,"j-label"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t._UZ(5,"input",65,66)(7,"j-error",16),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(3),t.Oqu(t.lcZ(4,8,"PAYMENTS.FORM.BANK_IBAN")),t.xp6(2),t.Q6J("jShadow",e.masks.bankAccount.shadow)("dropSpecialCharacters",!0)("mask",e.masks.bankAccount.mask)("formControl",e.form.controls.bankAccount),t.xp6(2),t.Q6J("control",e.form.controls.bankAccount)("errorMessages",e.errors.bankAccount)("params",e.bankAccountErrorParams)}}function ws(n,i){if(1&n&&(t.TgZ(0,"div",67),t._uU(1),t.qZA()),2&n){const e=i.item;t.xp6(1),t.Oqu(e.label)}}function Fs(n,i){if(1&n&&(t.TgZ(0,"div",68)(1,"div",69),t._uU(2),t.qZA()()),2&n){const e=i.ngIf;t.xp6(2),t.hij(" ",e," ")}}function Js(n,i){if(1&n&&(t.TgZ(0,"div",70),t._UZ(1,"span",71),t.ALo(2,"translate"),t.qZA()),2&n){const e=i.ngIf;t.xp6(1),t.Q6J("innerHTML",t.lcZ(2,1,e),t.oJD)}}function Bs(n,i){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function qs(n,i){if(1&n&&(t._uU(0),t.ALo(1,"translate"),t.ALo(2,"amountFormat"),t.ALo(3,"async")),2&n){const e=t.oxw(2);t.AsE(" ",t.lcZ(1,2,"PAYMENTS.COMMISSION"),": ",t.lcZ(2,4,t.lcZ(3,6,e.commission$))," \u20b8 ")}}function Qs(n,i){1&n&&(t._UZ(0,"p",72),t.ALo(1,"translate")),2&n&&t.Q6J("innerHTML",t.lcZ(1,1,"PAYMENTS.FORM.RESIDENT_AGREEMENT"),t.oJD)}function $s(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",73),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).saveToDraft()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"button",74),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(2),t.Oqu(t.lcZ(3,2,"PAYMENTS.FORM.SAVE")),t.xp6(3),t.hij("",t.lcZ(6,4,e.submitLabel)," ")}}function Vs(n,i){1&n&&(t.ynx(0),t.TgZ(1,"button",75),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()),2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"PAYMENTS.FORM.SAVE_EDIT")))}function Gs(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",3)(2,"form",4,5),t.NdJ("submit",function(r){return t.CHM(e),t.oxw().onSubmit(r)}),t.TgZ(4,"div",6)(5,"fieldset")(6,"div",7)(7,"h2",8),t._uU(8),t.ALo(9,"translate"),t.qZA(),t.TgZ(10,"button",9),t.NdJ("click",function(){return t.CHM(e),t.oxw().openBanksDictionary()}),t._uU(11),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"div",10)(14,"j-form-field",null,11),t.YNc(16,Os,3,3,"j-label",1),t.TgZ(17,"j-select",12,13),t.ALo(19,"async"),t.YNc(20,Ys,9,6,"ng-template",14),t.YNc(21,js,9,6,"ng-template",15),t.qZA(),t._UZ(22,"j-error",16),t.qZA()(),t.YNc(23,Ds,8,10,"div",17),t.qZA()(),t.TgZ(24,"div",6)(25,"fieldset")(26,"legend",18),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"div",10)(30,"j-form-field")(31,"j-label"),t._uU(32),t.ALo(33,"translate"),t.qZA(),t._UZ(34,"input",19),t.qZA()(),t.TgZ(35,"div",10),t._UZ(36,"j-date-picker",20,21),t.ALo(38,"async"),t.ALo(39,"translate"),t.ALo(40,"translate"),t.ALo(41,"async"),t.qZA(),t.TgZ(42,"div",10)(43,"j-form-field",null,22)(45,"j-label"),t._uU(46),t.ALo(47,"translate"),t.qZA(),t.TgZ(48,"j-select",23,24),t.ALo(50,"async"),t.YNc(51,ws,2,1,"ng-template",14),t.qZA()()(),t.TgZ(52,"div",25)(53,"span",26),t._uU(54),t.ALo(55,"async"),t.qZA(),t.TgZ(56,"j-form-field")(57,"j-label"),t._uU(58),t.ALo(59,"translate"),t.qZA(),t._UZ(60,"textarea",27,28)(62,"j-error",29),t.YNc(63,Fs,3,1,"div",30),t.ALo(64,"async"),t.qZA()(),t.TgZ(65,"div",10)(66,"j-account-dropdown",31,32),t.NdJ("selected",function(r){return t.CHM(e),t.oxw().onSenderAccountSelect(r)}),t.ALo(68,"async"),t.ALo(69,"async"),t.qZA()()()(),t.TgZ(70,"div",6)(71,"fieldset")(72,"j-employee-group-control",33)(73,"div",34)(74,"div",35)(75,"div",36),t._UZ(76,"input",37),t.TgZ(77,"label",38),t._uU(78),t.ALo(79,"translate"),t.qZA()()(),t.TgZ(80,"div",35)(81,"div",36),t._UZ(82,"input",39),t.TgZ(83,"label",40),t._uU(84),t.ALo(85,"translate"),t.qZA()()()(),t._UZ(86,"j-error",29),t.qZA()()(),t.TgZ(87,"div",41)(88,"div",10)(89,"fieldset")(90,"ul",42)(91,"li",43)(92,"h5",44),t._uU(93),t.ALo(94,"translate"),t.TgZ(95,"span",45)(96,"strong"),t._uU(97),t.ALo(98,"amountFormat"),t.ALo(99,"async"),t.qZA(),t._uU(100," \u20b8"),t.qZA()(),t.YNc(101,Js,3,3,"div",46),t.ALo(102,"async"),t.TgZ(103,"p",47),t.YNc(104,Bs,3,3,"ng-container",48),t.ALo(105,"async"),t.YNc(106,qs,4,8,"ng-template",null,49,t.W1O),t.qZA()(),t.TgZ(108,"li",50),t._UZ(109,"j-switch",51),t.TgZ(110,"span",52),t._uU(111),t.ALo(112,"translate"),t._UZ(113,"br"),t.TgZ(114,"small",53),t._uU(115),t.ALo(116,"translate"),t.qZA()()()()()()(),t.TgZ(117,"div",54),t.YNc(118,Qs,2,3,"p",55),t.ALo(119,"async"),t.TgZ(120,"div",54),t.YNc(121,$s,7,6,"ng-container",1),t.YNc(122,Vs,4,3,"ng-container",1),t.qZA()(),t._UZ(123,"ngx-spinner",56),t.qZA()(),t.BQk()}if(2&n){const e=t.MAs(15),o=t.MAs(18),r=t.MAs(37),s=t.MAs(44),l=t.MAs(49),c=t.MAs(107),a=t.oxw();t.xp6(2),t.Q6J("formGroup",a.form),t.xp6(6),t.hij(" ",t.lcZ(9,70,"PAYMENTS.RECIPIENT.TITLE")," "),t.xp6(3),t.hij(" ",t.lcZ(12,72,"PAYMENTS.SELECT_FROM_DICTIONARY")," "),t.xp6(5),t.Q6J("ngIf",!a.form.controls.bankReceiver.value),t.xp6(1),t.Q6J("searchFn",a.paymentsService.bankReceiverSearchFn)("jFocusOnReturn",o)("appendTo",e.elementRef.nativeElement)("formControl",a.form.controls.bankReceiver)("clearable",!1)("items",t.lcZ(19,74,a.banks.items$)),t.xp6(5),t.Q6J("control",a.form.controls.bankReceiver)("errorMessages",a.errors.bankReceiver)("params",a.bankReceiverErrorParams),t.xp6(1),t.Q6J("ngIf",a.form.controls.bankAccount.enabled),t.xp6(4),t.Oqu(t.lcZ(28,76,"PAYMENTS.FORM.DETAILS")),t.xp6(5),t.Oqu(t.lcZ(33,78,"PAYMENTS.FORM.DOCUMENT_NUMBER")),t.xp6(2),t.Q6J("mask",a.masks.number.mask)("formControl",a.form.controls.number),t.xp6(2),t.Q6J("jFocusOnReturn",r)("datesEnabled",t.lcZ(38,80,a.workingDays$))("formControl",a.form.controls.date)("formatValue",!0)("label",t.lcZ(39,82,"PAYMENTS.FORM.VALUE_DATE"))("minDate",a.dateLimit.minDate)("maxDate",a.dateLimit.maxDate)("helperText",t.lcZ(40,84,t.lcZ(41,86,a.dateMessage$))),t.xp6(10),t.Oqu(t.lcZ(47,88,"PAYMENTS.FORM.KNP")),t.xp6(2),t.Q6J("jFocusOnReturn",l)("appendTo",s.elementRef.nativeElement)("formControl",a.form.controls.knp)("clearable",!1)("searchMask",a.masks.knp.mask)("shadow",a.masks.knp.shadow)("items",t.lcZ(50,90,a.knp$)),t.xp6(6),t.AsE(" ",t.lcZ(55,92,a.purposeLength$),"/",a.rules.purposeLength,""),t.xp6(4),t.Oqu(t.lcZ(59,94,"PAYMENTS.FORM.PURPOSE")),t.xp6(2),t.Q6J("formControl",a.form.controls.purpose),t.xp6(2),t.Q6J("control",a.form.controls.purpose)("errorMessages",a.errors.purpose),t.xp6(1),t.Q6J("ngIf",t.lcZ(64,96,a.purposeMessage$)),t.xp6(3),t.Q6J("isLoading",t.lcZ(68,98,a.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",a.form.controls.senderAccount.touched&&a.form.controls.senderAccount.errors)("accounts",t.lcZ(69,100,a.acceptableAccounts$)),t.xp6(6),t.Q6J("formControl",a.form.controls.employees)("paymentType",a.paymentType)("minAmount",a.employeeMinAmount)("maxAmount",a.employeeMaxAmount)("birthDateRequired",!1)("ibanRequired",!0),t.xp6(4),t.Q6J("value",!0),t.xp6(2),t.hij(" ",t.lcZ(79,102,"PAYMENTS.FORM.EMPLOYEE_RESIDENTS")," "),t.xp6(4),t.Q6J("value",!1),t.xp6(2),t.hij(" ",t.lcZ(85,104,"PAYMENTS.FORM.EMPLOYEE_NON-RESIDENTS")," "),t.xp6(2),t.Q6J("control",a.form.controls.employees)("errorMessages",a.errors.employees),t.xp6(7),t.hij("",t.lcZ(94,106,"PAYMENTS.FORM.TOTAL_AMOUNT"),": "),t.xp6(4),t.Oqu(t.lcZ(98,108,t.lcZ(99,110,a.total$))),t.xp6(4),t.Q6J("ngIf",t.lcZ(102,112,a.amountMessage$)),t.xp6(3),t.Q6J("ngIf",null===t.lcZ(105,114,a.commission$))("ngIfElse",c),t.xp6(5),t.Q6J("formControl",a.form.controls.urgent),t.xp6(2),t.hij("",t.lcZ(112,116,"PAYMENTS.FORM.URGENT")," "),t.xp6(4),t.Oqu(t.lcZ(116,118,"PAYMENTS.URGENT_HELPER")),t.xp6(3),t.Q6J("ngIf",t.lcZ(119,120,a.controlsStream.isResidents)),t.xp6(3),t.Q6J("ngIf",a.restoredData.status!==a.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("ngIf",a.restoredData.status===a.PAYMENT_STATUS.CREATED),t.xp6(1),t.Q6J("name",a.SPINNER)("fullScreen",!1)}}let ke=(()=>{class n extends tt.S{constructor(e,o,r,s,l,c,a,p,f,m,h,_,g,y,A,T){super(g.createSalaryForm(),f,s,l,o,e,c,p,m,h,_,y,A,T),this.paymentsService=e,this.companyService=o,this.dateAdapter=r,this.route=s,this.router=l,this.maskService=c,this.accountsService=a,this.modalService=p,this.api=f,this.dictionaries=m,this.pipeline=h,this.translateService=_,this.paymentsFormsFactory=g,this.authorityPermissionsService=y,this.featureFlagsService=A,this.bankFromAccount=T,this.masks={number:"paymentNum",amount:"amount",knp:"knp",bankAccount:"tengeAccount"},this.employeeMinAmount=.01,this.employeeMaxAmount=null,this.paymentType=O.V_.SALARY}ngOnInit(){super.ngOnInit(),this.banks=this.dictionaries.bankDictionary,this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe((0,z.b)(e=>this.checkPersonalAccounts(e))),this.getMaskConfig(),this.createControlsStream(this.form),this.listenWorkingDays(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.knp$=this.dictionaries.KNPDictionary.items$,this.subs.add(this.controlsStream.bankReceiver.pipe((0,se.M)(this.banks.entities$),(0,M.U)(([e,o])=>e&&o[e]),(0,S.x)()).subscribe(e=>{const{bankAccount:o}=this.form.controls;!e||e.salaryTransitIban&&o.enabled?(o.disable(),o.patchValue("")):e&&!e.salaryTransitIban&&o.disabled?o.enable():e&&o.updateValueAndValidity()}))}openBanksDictionary(){this.modals.open(Us.Q,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then(e=>e&&this.form.controls.bankReceiver.patchValue(e.id)).catch(()=>{})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(X.cR),t.Y36(ft.J),t.Y36(R.NG),t.Y36(Z.gz),t.Y36(Z.F0),t.Y36(et.O),t.Y36(q.iu),t.Y36(R.FF),t.Y36(bt.e),t.Y36(dt.$),t.Y36(Tt.Z),t.Y36(E.sK),t.Y36(xt.$),t.Y36(nt.Eg),t.Y36(j.a),t.Y36(Q.vI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-salary-payment"]],features:[t.qOj],decls:2,vars:2,consts:[["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried",4,"ngIf"],[4,"ngIf"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",3,"isRetryable","isLoading","retried"],[1,"payment-section"],["jInvalidControlScroll","","autocomplete","off","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"payments__header"],[1,"h2","mb-0"],["type","button",1,"btn","btn-link","p-0","p3",3,"click"],[1,"form-group"],["receiverWrapper",""],["bindValue","id",3,"searchFn","jFocusOnReturn","appendTo","formControl","clearable","items"],["receiverSelect",""],["j-label-tmp",""],["j-option-tmp",""],[3,"control","errorMessages","params"],["class","form-group",4,"ngIf"],[1,"h2"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["allowAuto","true",3,"jFocusOnReturn","datesEnabled","formControl","formatValue","label","minDate","maxDate","helperText"],["datepicker",""],["knpWrapper",""],["bindValue","code",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","minAmount","maxAmount","birthDateRequired","ibanRequired"],["ngProjectAs","[header]",5,["","header",""],1,"row"],[1,"form-group","col"],[1,"custom-control","custom-radio"],["type","radio","id","residents","name","isResidents","formControlName","isResidents",1,"custom-control-input",3,"value"],["for","residents",1,"custom-control-label","text-muted","p3"],["type","radio","id","nonResident","name","isResidents","formControlName","isResidents",1,"custom-control-input",3,"value"],["for","nonResident",1,"custom-control-label","text-muted","p3"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],["class","p3 text-gray text-right",3,"innerHTML",4,"ngIf"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],[1,"account-pill","pl-0","pr-0"],[1,"account-pill--logo"],[3,"name"],[1,"account-pill--content","small"],[1,"wrap-text"],[1,"wrap-text","text-gray"],[1,"account-pill","account-pill_gray","account-pill_fill"],["clearable","true"],["type","text","jFormInput","","jReplaceOnPaste","KZ","jDynamicPrefix","KZ","jFocusOnReturn","","jUppercase","",1,"form-control",3,"jShadow","dropSpecialCharacters","mask","formControl"],["accountInput","jFormInput"],[1,"text-truncate"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],[1,"p3","text-gray","text-right",3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"]],template:function(e,o){1&e&&(t.YNc(0,ks,1,2,"j-restricted-placeholder",0),t.YNc(1,Gs,124,122,"ng-container",1)),2&e&&(t.Q6J("ngIf",o.isRestricted),t.xp6(1),t.Q6J("ngIf",!o.isRestricted))},directives:[b.O5,ot.G,d._Y,d.JL,$,Y.L,d.sg,V.O8,it.I,at.F,Y.v,d.JJ,d.oH,w.Fe,kt.k,w.Ok,ct.k,G.m,B.hx,d.Fj,Ut.w,Lt.u,At.q,yt.N,qt.Q,lt.L,rt.S,jt.p,d._,d.u,st.q,ut.Ro],pipes:[E.X$,b.Ov,ht.n],styles:[".payments__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem}"]}),n})();const Hs=[{path:P.Wm.root,component:ve,children:[{path:"",canActivate:[zt.k]},{path:P.pG.root,component:Ze,data:{animation:"slideOrFade",index:2},children:[{path:P.pG.tax,matcher:(0,D.factoryUserPageMatcher)(P.pG.tax,"paymentId"),component:Re,canDeactivate:[W.P],data:{animation:"slideOrFade",index:21}},{path:P.pG.pension,matcher:(0,D.factoryUserPageMatcher)(P.pG.pension,"paymentId"),component:Ie,canDeactivate:[W.P],data:{animation:"slideOrFade",index:22}},{path:P.pG.social,matcher:(0,D.factoryUserPageMatcher)(P.pG.social,"paymentId"),component:Le,canDeactivate:[W.P],data:{animation:"slideOrFade",index:23}},{path:P.pG.osms,matcher:(0,D.factoryUserPageMatcher)(P.pG.osms,"paymentId"),component:Ue,canDeactivate:[W.P],data:{animation:"slideOrFade",index:24}},{path:"**",redirectTo:P.pG.tax}]},{path:P.Wm.order,matcher:(0,D.factoryUserPageMatcher)(P.Wm.order,"paymentId"),component:Me,canDeactivate:[W.P],data:{animation:"slideOrFade",index:1}},{path:P.Wm.salary,matcher:(0,D.factoryUserPageMatcher)(P.Wm.salary,"paymentId"),component:ke,canDeactivate:[W.P],data:{animation:"slideOrFade",index:3}},{path:":paymentId",canActivate:[zt.k]},{path:"**",redirectTo:P.Wm.order}]},{path:P.KK.foreignCurrency,canDeactivate:[W.P],matcher:(0,D.factoryUserPageMatcher)(P.KK.foreignCurrency,"paymentId"),component:Te},{path:"**",redirectTo:P.Wm.root}];let Ks=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[Z.Bz.forChild(Hs)],Z.Bz]}),n})();u(2776);var Ws=u(30395),Xs=u(47680),Oe=u(82329),zs=u(63289),ti=(u(59596),u(20382),u(37074)),ei=u(54507),ni=u(68221),oi=u(25021),Ye=u(35446),ri=u(10532),si=u(53571);let ii=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[Je._0],imports:[[b.ez,d.u5,d.UX,B.yI,R.M,R.dT,R.ZS,R.jF,je.hx,E.aw,q.jW,we.m,Fe.A,Ks,De.ContractsModule],R.bz,R.dT]}),n})();t.B6R(Ws.R,[b.O5,Nt.y],[E.X$]),t.B6R(Se.D,[V.O8,ti.o,Gt.X,G.m,d.Fj,d.JJ,d.oH,b.sg,kt.k,b.O5,R.N9],[E.X$,b.Ov,Ht.vI]),t.B6R(me.W,[b.O5,Bt.d$,E.Pi,Nt.y,ei.t,ni.k,oi.p,b.sg],[b.uU]),t.B6R(Xs.P,[E.Pi,Ye.J,b.O5,Rt.j,b.sg,Oe.V],[]),t.B6R(ie.A,[E.Pi,Ye.J,b.O5,Rt.j,b.sg,zs.g],[]),t.B6R(Oe.V,[b.sg,E.Pi],[ri.S,si.O])}}]);
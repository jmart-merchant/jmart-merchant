function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_nonIterableRest()}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){i=!0,o=s}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{"E+oP":function(e,t,n){var r=n("A90E"),i=n("QqLw"),o=n("03A+"),a=n("Z0cm"),c=n("MMmD"),s=n("DSRE"),l=n("6sVZ"),u=n("c6wG"),b=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(c(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||s(e)||u(e)||o(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(l(e))return!r(e).length;for(var n in e)if(b.call(e,n))return!1;return!0}},T9EB:function(e,t,n){"use strict";n.r(t);var r=n("ofXK"),i=n("3Pt+"),o=n("tmjD"),a=n("1kSV"),c=n("sYmb"),s=n("xJkR"),l=n("4Nuw"),u=n("Rreu"),b=n("PCNd"),d=n("fXoL"),m=n("eNwd"),p=1,f=Promise.resolve(),h={};function v(e){return e in h&&(delete h[e],!0)}var g=function(e){var t=p++;return h[t]=!0,f.then((function(){return v(t)&&e()})),t},y=function(e){v(e)},C=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e,n))).scheduler=e,r.work=n,r}return _inherits(t,e),_createClass(t,[{key:"requestAsyncId",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0?_get(_getPrototypeOf(t.prototype),"requestAsyncId",this).call(this,e,n,r):(e.actions.push(this),e.scheduled||(e.scheduled=g(e.flush.bind(e,null))))}},{key:"recycleAsyncId",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==r&&r>0||null===r&&this.delay>0)return _get(_getPrototypeOf(t.prototype),"recycleAsyncId",this).call(this,e,n,r);0===e.actions.length&&(y(n),e.scheduled=void 0)}}]),t}(n("3N8a").a),k=new(function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"flush",value:function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}}}]),t}(n("IjjT").a))(C),A=n("XNiG"),T=n("xgIS"),R=n("VRyK"),_=n("1G5W"),S=n("D0XW"),j=n("l7GE"),O=n("ZUHj"),I=function(){function e(t){_classCallCheck(this,e),this.durationSelector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new V(e,this.durationSelector))}}]),e}(),V=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).durationSelector=n,r.hasValue=!1,r}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){if(this.value=e,this.hasValue=!0,!this.throttled){var t;try{t=(0,this.durationSelector)(e)}catch(r){return this.destination.error(r)}var n=Object(O.a)(this,t);!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}}},{key:"clearThrottle",value:function(){var e=this.value,t=this.hasValue,n=this.throttled;n&&(this.remove(n),this.throttled=null,n.unsubscribe()),t&&(this.value=null,this.hasValue=!1,this.destination.next(e))}},{key:"notifyNext",value:function(e,t,n,r){this.clearThrottle()}},{key:"notifyComplete",value:function(){this.clearThrottle()}}]),t}(j.a),E=n("PqYM"),x=/[&<>"']/g,w=RegExp(x.source),W={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function N(e){return null!=e}function P(e){return"object"==typeof e&&N(e)}function M(e){return e instanceof Function}var L,D=((L=function(){function e(){_classCallCheck(this,e),this._dimensions={itemHeight:0,panelHeight:0,itemsPerViewport:0}}return _createClass(e,[{key:"calculateItems",value:function(e,t,n){var r=this._dimensions,i=r.itemHeight*t,o=Math.max(0,e)/i*t,a=Math.min(t,Math.ceil(o)+(r.itemsPerViewport+1)),c=Math.max(0,a-r.itemsPerViewport),s=Math.min(c,Math.floor(o)),l=r.itemHeight*Math.ceil(s)-r.itemHeight*Math.min(s,n);return l=isNaN(l)?0:l,s=isNaN(s)?-1:s,a=isNaN(a)?-1:a,s-=n,a+=n,{topPadding:l,scrollHeight:i,start:s=Math.max(0,s),end:a=Math.min(t,a)}}},{key:"setDimensions",value:function(e,t){var n=Math.max(1,Math.floor(t/e));this._dimensions={itemHeight:e,panelHeight:t,itemsPerViewport:n}}},{key:"getScrollTo",value:function(e,t,n){var r=this.dimensions.panelHeight,i=e+t,o=n+r;return r>=i&&n===e?null:i>o?n+i-o:e<=n?e:null}},{key:"dimensions",get:function(){return this._dimensions}}]),e}()).\u0275fac=function(e){return new(e||L)},L.\u0275prov=d.Mb({token:L,factory:L.\u0275fac}),L),Q=["content"],F=["scroll"],B=["padding"],$=function(e){return{searchTerm:e}};function U(e,t){if(1&e&&(d.Wb(0,"div",6),d.Sb(1,7),d.Vb()),2&e){var n=d.lc();d.Ab(1),d.rc("ngTemplateOutlet",n.headerTemplate)("ngTemplateOutletContext",d.wc(2,$,n.filterValue))}}function Y(e,t){if(1&e&&(d.Wb(0,"div",8),d.Sb(1,7),d.Vb()),2&e){var n=d.lc();d.Ab(1),d.rc("ngTemplateOutlet",n.footerTemplate)("ngTemplateOutletContext",d.wc(2,$,n.filterValue))}}var K,H,G,z,q,X,Z,J,ee,te,ne,re,ie,oe,ae=["*"],ce="undefined"!=typeof requestAnimationFrame?m.a:k,se=((K=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this._renderer=t,this._zone=n,this._panelService=r,this._document=o,this.items=[],this.position="auto",this.virtualScroll=!1,this.filterValue=null,this.update=new d.n,this.scroll=new d.n,this.scrollToEnd=new d.n,this.outsideClick=new d.n,this._destroy$=new A.a,this._scrollToEndFired=!1,this._updateScrollHeight=!1,this._lastScrollPosition=0,this._dropdown=i.nativeElement}return _createClass(e,[{key:"handleMousedown",value:function(e){"INPUT"!==e.target.tagName&&e.preventDefault()}},{key:"ngOnInit",value:function(){this._select=this._dropdown.parentElement,this._virtualPadding=this.paddingElementRef.nativeElement,this._scrollablePanel=this.scrollElementRef.nativeElement,this._contentPanel=this.contentElementRef.nativeElement,this._handleScroll(),this._handleOutsideClick(),this._appendDropdown()}},{key:"ngOnChanges",value:function(e){if(e.items){var t=e.items;this._onItemsChange(t.currentValue,t.firstChange)}}},{key:"ngOnDestroy",value:function(){this._destroy$.next(),this._destroy$.complete(),this._destroy$.unsubscribe(),this.appendTo&&this._renderer.removeChild(this._dropdown.parentNode,this._dropdown)}},{key:"scrollTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var n=this.items.indexOf(e);if(!(n<0||n>=this.itemsLength)){var r;if(this.virtualScroll){var i=this._panelService.dimensions.itemHeight;r=this._panelService.getScrollTo(n*i,i,this._lastScrollPosition)}else{var o=this._dropdown.querySelector("#".concat(e.htmlId));r=this._panelService.getScrollTo(o.offsetTop,o.clientHeight,t?o.offsetTop:this._lastScrollPosition)}N(r)&&(this._scrollablePanel.scrollTop=r)}}}},{key:"scrollToTag",value:function(){var e=this._scrollablePanel;e.scrollTop=e.scrollHeight-e.clientHeight}},{key:"adjustPosition",value:function(){var e=this._parent.getBoundingClientRect(),t=this._select.getBoundingClientRect();this._setOffset(e,t)}},{key:"_handleDropdownPosition",value:function(){this._currentPosition=this._calculateCurrentPosition(this._dropdown),"top"===this._currentPosition?(this._renderer.addClass(this._dropdown,"j-select-top"),this._renderer.removeClass(this._dropdown,"j-select-bottom"),this._renderer.addClass(this._select,"j-select-top"),this._renderer.removeClass(this._select,"j-select-bottom")):(this._renderer.addClass(this._dropdown,"j-select-bottom"),this._renderer.removeClass(this._dropdown,"j-select-top"),this._renderer.addClass(this._select,"j-select-bottom"),this._renderer.removeClass(this._select,"j-select-top")),this.appendTo&&this._updatePosition(),this._dropdown.style.opacity="1"}},{key:"_handleScroll",value:function(){var e=this;this._zone.runOutsideAngular((function(){Object(T.a)(e.scrollElementRef.nativeElement,"scroll").pipe(Object(_.a)(e._destroy$),function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S.a;return t=function(){return Object(E.a)(e,n)},function(e){return e.lift(new I(t))}}(0,ce)).subscribe((function(t){return e._onContentScrolled(t.target.scrollTop)}))}))}},{key:"_handleOutsideClick",value:function(){var e=this;this._document&&this._zone.runOutsideAngular((function(){Object(R.a)(Object(T.a)(e._document,"touchstart",{capture:!0}),Object(T.a)(e._document,"mousedown",{capture:!0})).pipe(Object(_.a)(e._destroy$)).subscribe((function(t){return e._checkToClose(t)}))}))}},{key:"_checkToClose",value:function(e){var t=this;if(!this._select.contains(e.target)&&!this._dropdown.contains(e.target)){var n=e.path||e.composedPath&&e.composedPath();e.target&&e.target.shadowRoot&&n&&n[0]&&this._select.contains(n[0])||this._zone.run((function(){return t.outsideClick.emit()}))}}},{key:"_onItemsChange",value:function(e,t){this.items=e||[],this._scrollToEndFired=!1,this.itemsLength=e.length,this.virtualScroll?this._updateItemsRange(t):this._updateItems(t)}},{key:"_updateItems",value:function(e){var t=this;this.update.emit(this.items),!1!==e&&this._zone.runOutsideAngular((function(){Promise.resolve().then((function(){t._panelService.setDimensions(0,t._scrollablePanel.clientHeight),t._handleDropdownPosition(),t.scrollTo(t.markedItem,e)}))}))}},{key:"_updateItemsRange",value:function(e){var t=this;this._zone.runOutsideAngular((function(){t._measureDimensions().then((function(){e?(t._renderItemsRange(t._startOffset),t._handleDropdownPosition()):t._renderItemsRange()}))}))}},{key:"_onContentScrolled",value:function(e){this.virtualScroll&&this._renderItemsRange(e),this._lastScrollPosition=e,this._fireScrollToEnd(e)}},{key:"_updateVirtualHeight",value:function(e){this._updateScrollHeight&&(this._virtualPadding.style.height="".concat(e,"px"),this._updateScrollHeight=!1)}},{key:"_onItemsLengthChanged",value:function(){this._updateScrollHeight=!0}},{key:"_renderItemsRange",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!t||this._lastScrollPosition!==t){var n=this._panelService.calculateItems(t=t||this._scrollablePanel.scrollTop,this.itemsLength,this.bufferAmount);this._updateVirtualHeight(n.scrollHeight),this._contentPanel.style.transform="translateY(".concat(n.topPadding,"px)"),this._zone.run((function(){e.update.emit(e.items.slice(n.start,n.end)),e.scroll.emit({start:n.start,end:n.end})})),N(t)&&0===this._lastScrollPosition&&(this._scrollablePanel.scrollTop=t,this._lastScrollPosition=t)}}},{key:"_measureDimensions",value:function(){var e=this;if(this._panelService.dimensions.itemHeight>0||0===this.itemsLength)return Promise.resolve(this._panelService.dimensions);var t=_slicedToArray(this.items,1)[0];return this.update.emit([t]),Promise.resolve().then((function(){var n=e._dropdown.querySelector("#".concat(t.htmlId)).clientHeight;return e._virtualPadding.style.height="".concat(n*e.itemsLength,"px"),e._panelService.setDimensions(n,e._scrollablePanel.clientHeight),e._panelService.dimensions}))}},{key:"_fireScrollToEnd",value:function(e){var t=this;this._scrollToEndFired||0===e||e+this._dropdown.clientHeight>=(this.virtualScroll?this._virtualPadding:this._contentPanel).clientHeight&&(this._zone.run((function(){return t.scrollToEnd.emit()})),this._scrollToEndFired=!0)}},{key:"_calculateCurrentPosition",value:function(e){if("auto"!==this.position)return this.position;var t=this._select.getBoundingClientRect(),n=document.documentElement.scrollTop||document.body.scrollTop;return t.top+window.pageYOffset+t.height+e.getBoundingClientRect().height>n+document.documentElement.clientHeight?"top":"bottom"}},{key:"_appendDropdown",value:function(){if(this.appendTo){if("string"==typeof this.appendTo){if(this._parent=document.querySelector(this.appendTo),!this._parent)throw new Error("appendTo selector ".concat(this.appendTo," did not found any parent element"))}else this._parent=this.appendTo;this._parent.appendChild(this._dropdown)}}},{key:"_updatePosition",value:function(){var e=this._select.getBoundingClientRect(),t=this._parent.getBoundingClientRect();this._setOffset(t,e),this._dropdown.style.width=t.width+"px",this._dropdown.style.minWidth=t.width+"px"}},{key:"_setOffset",value:function(e,t){var n=t.height;"top"===this._currentPosition?(this._dropdown.style.bottom=e.bottom-t.bottom+n+"px",this._dropdown.style.top="auto"):"bottom"===this._currentPosition&&(this._dropdown.style.top=t.top-e.top+n+"px",this._dropdown.style.bottom="auto")}},{key:"currentPosition",get:function(){return this._currentPosition}},{key:"itemsLength",get:function(){return this._itemsLength},set:function(e){e!==this._itemsLength&&(this._itemsLength=e,this._onItemsLengthChanged())}},{key:"_startOffset",get:function(){if(this.markedItem){var e=this._panelService.dimensions,t=e.itemHeight,n=e.panelHeight,r=this.markedItem.index*t;return n>r?0:r}return 0}}]),e}()).\u0275fac=function(e){return new(e||K)(d.Qb(d.D),d.Qb(d.z),d.Qb(D),d.Qb(d.l),d.Qb(r.e,8))},K.\u0275cmp=d.Kb({type:K,selectors:[["j-dropdown-panel"]],viewQuery:function(e,t){var n;1&e&&(d.Lc(Q,!0,d.l),d.Lc(F,!0,d.l),d.Lc(B,!0,d.l)),2&e&&(d.Bc(n=d.jc())&&(t.contentElementRef=n.first),d.Bc(n=d.jc())&&(t.scrollElementRef=n.first),d.Bc(n=d.jc())&&(t.paddingElementRef=n.first))},hostBindings:function(e,t){1&e&&d.ic("mousedown",(function(e){return t.handleMousedown(e)}))},inputs:{items:"items",markedItem:"markedItem",position:"position",appendTo:"appendTo",bufferAmount:"bufferAmount",virtualScroll:"virtualScroll",headerTemplate:"headerTemplate",footerTemplate:"footerTemplate",filterValue:"filterValue"},outputs:{update:"update",scroll:"scroll",scrollToEnd:"scrollToEnd",outsideClick:"outsideClick"},features:[d.yb()],ngContentSelectors:ae,decls:9,vars:6,consts:[["class","j-dropdown-header",4,"ngIf"],[1,"j-dropdown-panel-items","scroll-host"],["scroll",""],["padding",""],["content",""],["class","j-dropdown-footer",4,"ngIf"],[1,"j-dropdown-header"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"j-dropdown-footer"]],template:function(e,t){1&e&&(d.qc(),d.Oc(0,U,2,4,"div",0),d.Wb(1,"div",1,2),d.Rb(3,"div",null,3),d.Wb(5,"div",null,4),d.pc(7),d.Vb(),d.Vb(),d.Oc(8,Y,2,4,"div",5)),2&e&&(d.rc("ngIf",t.headerTemplate),d.Ab(3),d.Hb("total-padding",t.virtualScroll),d.Ab(2),d.Hb("scrollable-content",t.virtualScroll&&t.items.length),d.Ab(3),d.rc("ngIf",t.footerTemplate))},directives:[r.u,r.B],encapsulation:2,changeDetection:0}),K),le=["*"],ue=((H=function(){function e(t){_classCallCheck(this,e),this.elementRef=t,this.stateChange$=new A.a,this._disabled=!1}return _createClass(e,[{key:"ngOnChanges",value:function(e){e.disabled&&this.stateChange$.next({value:this.value,disabled:this._disabled})}},{key:"ngAfterViewChecked",value:function(){this.label!==this._previousLabel&&(this._previousLabel=this.label,this.stateChange$.next({value:this.value,disabled:this._disabled,label:this.elementRef.nativeElement.innerHTML}))}},{key:"ngOnDestroy",value:function(){this.stateChange$.complete()}},{key:"_isDisabled",value:function(e){return null!=e&&"false"!=="".concat(e)}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=this._isDisabled(e)}},{key:"label",get:function(){return(this.elementRef.nativeElement.textContent||"").trim()}}]),e}()).\u0275fac=function(e){return new(e||H)(d.Qb(d.l))},H.\u0275cmp=d.Kb({type:H,selectors:[["j-option"]],inputs:{value:"value",disabled:"disabled"},features:[d.yb()],ngContentSelectors:le,decls:1,vars:0,template:function(e,t){1&e&&(d.qc(),d.pc(0))},encapsulation:2,changeDetection:0}),H),be=n("JX91"),de=n("vkgz"),me=n("Kj3r"),pe=n("pLZG"),fe=n("lJxs"),he=((oe=function(){function e(t){_classCallCheck(this,e),this.element=t,this.escape=!0}return _createClass(e,[{key:"ngOnChanges",value:function(e){var t;this.element.nativeElement.innerHTML=this.escape?(t=this.ngItemLabel)&&w.test(t)?t.replace(x,(function(e){return W[e]})):t:this.ngItemLabel}}]),e}()).\u0275fac=function(e){return new(e||oe)(d.Qb(d.l))},oe.\u0275dir=d.Lb({type:oe,selectors:[["","ngItemLabel",""]],inputs:{ngItemLabel:"ngItemLabel",escape:"escape"},features:[d.yb()]}),oe),ve=((ie=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||ie)(d.Qb(d.L))},ie.\u0275dir=d.Lb({type:ie,selectors:[["","j-option-tmp",""]]}),ie),ge=((re=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||re)(d.Qb(d.L))},re.\u0275dir=d.Lb({type:re,selectors:[["","j-optgroup-tmp",""]]}),re),ye=((ne=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||ne)(d.Qb(d.L))},ne.\u0275dir=d.Lb({type:ne,selectors:[["","j-label-tmp",""]]}),ne),Ce=((te=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||te)(d.Qb(d.L))},te.\u0275dir=d.Lb({type:te,selectors:[["","j-multi-label-tmp",""]]}),te),ke=((ee=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||ee)(d.Qb(d.L))},ee.\u0275dir=d.Lb({type:ee,selectors:[["","j-header-tmp",""]]}),ee),Ae=((J=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||J)(d.Qb(d.L))},J.\u0275dir=d.Lb({type:J,selectors:[["","j-footer-tmp",""]]}),J),Te=((Z=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||Z)(d.Qb(d.L))},Z.\u0275dir=d.Lb({type:Z,selectors:[["","j-notfound-tmp",""]]}),Z),Re=((X=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||X)(d.Qb(d.L))},X.\u0275dir=d.Lb({type:X,selectors:[["","j-typetosearch-tmp",""]]}),X),_e=((q=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||q)(d.Qb(d.L))},q.\u0275dir=d.Lb({type:q,selectors:[["","j-loadingtext-tmp",""]]}),q),Se=((z=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||z)(d.Qb(d.L))},z.\u0275dir=d.Lb({type:z,selectors:[["","j-tag-tmp",""]]}),z),je=((G=function e(t){_classCallCheck(this,e),this.template=t}).\u0275fac=function(e){return new(e||G)(d.Qb(d.L))},G.\u0275dir=d.Lb({type:G,selectors:[["","j-loadingspinner-tmp",""]]}),G),Oe=n("YMfE"),Ie=function(){function e(t,n){_classCallCheck(this,e),this._ngSelect=t,this._selectionModel=n,this._items=[],this._filteredItems=[],this._markedIndex=-1}return _createClass(e,[{key:"setItems",value:function(e){var t=this;this._items=e.map((function(e,n){return t.mapItem(e,n)})),this._ngSelect.groupBy?(this._groups=this._groupBy(this._items,this._ngSelect.groupBy),this._items=this._flatten(this._groups)):(this._groups=new Map,this._groups.set(void 0,this._items)),this._filteredItems=_toConsumableArray(this._items)}},{key:"select",value:function(e){if(!e.selected&&!this.maxItemsSelected){var t=this._ngSelect.multiple;t||this.clearSelected(),this._selectionModel.select(e,t,this._ngSelect.selectableGroupAsModel),this._ngSelect.hideSelected&&this._hideSelected(e)}}},{key:"unselect",value:function(e){e.selected&&(this._selectionModel.unselect(e,this._ngSelect.multiple),this._ngSelect.hideSelected&&N(e.index)&&this._ngSelect.multiple&&this._showSelected(e))}},{key:"findItem",value:function(e){var t,n=this;return t=this._ngSelect.compareWith?function(t){return n._ngSelect.compareWith(t.value,e)}:this._ngSelect.bindValue?function(t){return!t.children&&n.resolveNested(t.value,n._ngSelect.bindValue)===e}:function(t){return t.value===e||!t.children&&t.label&&t.label===n.resolveNested(e,n._ngSelect.bindLabel)},this._items.find((function(e){return t(e)}))}},{key:"addItem",value:function(e){var t=this.mapItem(e,this._items.length);return this._items.push(t),this._filteredItems.push(t),t}},{key:"clearSelected",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._selectionModel.clear(e),this._items.forEach((function(t){t.selected=e&&t.selected&&t.disabled,t.marked=!1})),this._ngSelect.hideSelected&&this.resetFilteredItems()}},{key:"findByLabel",value:function(e){return e=e.toLocaleLowerCase(),this.filteredItems.find((function(t){return t.label.toLocaleLowerCase().substr(0,e.length)===e}))}},{key:"filter",value:function(e){var t=this;if(e){this._filteredItems=[],e=this._ngSelect.searchFn?e:e.toLocaleLowerCase();for(var n=this._ngSelect.searchFn||this._defaultSearchFn,r=this._ngSelect.hideSelected,i=0,o=Array.from(this._groups.keys());i<o.length;i++){var a=o[i],c=[],s=!0,l=!1,u=void 0;try{for(var b,d=this._groups.get(a)[Symbol.iterator]();!(s=(b=d.next()).done);s=!0){var m=b.value;r&&(m.parent&&m.parent.selected||m.selected)||n(e,this._ngSelect.searchFn?m.value:m)&&c.push(m)}}catch(p){l=!0,u=p}finally{try{s||null==d.return||d.return()}finally{if(l)throw u}}c.length>0&&function(){var e,n=_slicedToArray(c.slice(-1),1)[0];if(n.parent){var r=t._items.find((function(e){return e===n.parent}));t._filteredItems.push(r)}(e=t._filteredItems).push.apply(e,c)}()}}else this.resetFilteredItems()}},{key:"resetFilteredItems",value:function(){this._filteredItems.length!==this._items.length&&(this._filteredItems=this._ngSelect.hideSelected&&this.selectedItems.length>0?this._items.filter((function(e){return!e.selected})):this._items)}},{key:"unmarkItem",value:function(){this._markedIndex=-1}},{key:"markNextItem",value:function(){this._stepToItem(1)}},{key:"markPreviousItem",value:function(){this._stepToItem(-1)}},{key:"markItem",value:function(e){this._markedIndex=this._filteredItems.indexOf(e)}},{key:"markSelectedOrDefault",value:function(e){if(0!==this._filteredItems.length){var t=this._getLastMarkedIndex();this._markedIndex=t>-1?t:e?this.filteredItems.findIndex((function(e){return!e.disabled})):-1}}},{key:"resolveNested",value:function(e,t){if(t){if(!P(e))return e;if(-1===t.indexOf("."))return e[t];for(var n=t.split("."),r=e,i=0,o=n.length;i<o;++i){if(null==r)return null;r=r[n[i]]}return r}}},{key:"mapItem",value:function(e,t){var n=N(e.$ngOptionLabel)?e.$ngOptionLabel:this.resolveNested(e,this._ngSelect.bindLabel),r=N(e.$ngOptionValue)?e.$ngOptionValue:e;return{index:t,label:N(n)?n.toString():"",value:r,disabled:e.disabled,htmlId:"".concat(this._ngSelect.dropdownId,"-").concat(t)}}},{key:"mapSelectedItems",value:function(){var e=this,t=this._ngSelect.multiple,n=!0,r=!1,i=void 0;try{for(var o,a=this.selectedItems[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var c=o.value,s=this._ngSelect.bindValue?this.resolveNested(c.value,this._ngSelect.bindValue):c.value,l=N(s)?this.findItem(s):null;this._selectionModel.unselect(c,t),this._selectionModel.select(l||c,t,this._ngSelect.selectableGroupAsModel)}}catch(u){r=!0,i=u}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}this._ngSelect.hideSelected&&(this._filteredItems=this.filteredItems.filter((function(t){return-1===e.selectedItems.indexOf(t)})))}},{key:"_showSelected",value:function(e){if(this._filteredItems.push(e),e.parent){var t=e.parent;this._filteredItems.find((function(e){return e===t}))||this._filteredItems.push(t)}else if(e.children){var n=!0,r=!1,i=void 0;try{for(var o,a=e.children[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var c=o.value;c.selected=!1,this._filteredItems.push(c)}}catch(s){r=!0,i=s}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}this._filteredItems=_toConsumableArray(this._filteredItems.sort((function(e,t){return e.index-t.index})))}},{key:"_hideSelected",value:function(e){this._filteredItems=this._filteredItems.filter((function(t){return t!==e})),e.parent?e.parent.children.every((function(e){return e.selected}))&&(this._filteredItems=this._filteredItems.filter((function(t){return t!==e.parent}))):e.children&&(this._filteredItems=this.filteredItems.filter((function(t){return t.parent!==e})))}},{key:"_defaultSearchFn",value:function(e,t){return t.label.toLocaleLowerCase().indexOf(e)>-1}},{key:"_getNextItemIndex",value:function(e){return e>0?this._markedIndex===this._filteredItems.length-1?0:this._markedIndex+1:this._markedIndex<=0?this._filteredItems.length-1:this._markedIndex-1}},{key:"_stepToItem",value:function(e){0===this._filteredItems.length||this._filteredItems.every((function(e){return e.disabled}))||(this._markedIndex=this._getNextItemIndex(e),this.markedItem.disabled&&this._stepToItem(e))}},{key:"_getLastMarkedIndex",value:function(){if(this._ngSelect.hideSelected)return-1;if(this._markedIndex>-1&&void 0===this.markedItem)return-1;var e=this._filteredItems.indexOf(this.lastSelectedItem);return this.lastSelectedItem&&e<0?-1:Math.max(this.markedIndex,e)}},{key:"_groupBy",value:function(e,t){var n=this,r=new Map;if(0===e.length)return r;if(Array.isArray(e[0].value[t])){var i=!0,o=!1,a=void 0;try{for(var c,s=e[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){var l=c.value,u=(l.value[t]||[]).map((function(e,t){return n.mapItem(e,t)}));r.set(l,u)}}catch(k){o=!0,a=k}finally{try{i||null==s.return||s.return()}finally{if(o)throw a}}return r}var b=M(this._ngSelect.groupBy),d=function(e){var n=b?t(e.value):e.value[t];return N(n)?n:void 0},m=!0,p=!1,f=void 0;try{for(var h,v=e[Symbol.iterator]();!(m=(h=v.next()).done);m=!0){var g=h.value,y=d(g),C=r.get(y);C?C.push(g):r.set(y,[g])}}catch(k){p=!0,f=k}finally{try{m||null==v.return||v.return()}finally{if(p)throw f}}return r}},{key:"_flatten",value:function(e){for(var t=this,n=M(this._ngSelect.groupBy),r=[],i=function(){var i=a[o],c=r.length;if(void 0===i){var s=e.get(void 0)||[];return r.push.apply(r,_toConsumableArray(s.map((function(e){return Object.assign(Object.assign({},e),{index:c++})})))),"continue"}var l=P(i),u={label:l?"":String(i),children:void 0,parent:null,index:c++,disabled:!t._ngSelect.selectableGroup,htmlId:Object(Oe.generateUniqueId)()},b=n?t._ngSelect.bindLabel:t._ngSelect.groupBy,d=t._ngSelect.groupValue||function(){return l?i.value:_defineProperty({},b,i)},m=e.get(i).map((function(e){return e.parent=u,e.children=void 0,e.index=c++,e}));u.children=m,u.value=d(i,m.map((function(e){return e.value}))),r.push(u),r.push.apply(r,_toConsumableArray(m))},o=0,a=Array.from(e.keys());o<a.length;o++)i();return r}},{key:"items",get:function(){return this._items}},{key:"filteredItems",get:function(){return this._filteredItems}},{key:"markedIndex",get:function(){return this._markedIndex}},{key:"selectedItems",get:function(){return this._selectionModel.value}},{key:"markedItem",get:function(){return this._filteredItems[this._markedIndex]}},{key:"noItemsToSelect",get:function(){return this._ngSelect.hideSelected&&this._items.length===this.selectedItems.length}},{key:"maxItemsSelected",get:function(){return this._ngSelect.multiple&&this._ngSelect.maxSelectedItems<=this.selectedItems.length}},{key:"lastSelectedItem",get:function(){for(var e=this.selectedItems.length-1;e>=0;e--){var t=this.selectedItems[e];if(!t.disabled)return t}return null}}]),e}(),Ve=function(e){return e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Esc=27]="Esc",e[e.Space=32]="Space",e[e.ArrowUp=38]="ArrowUp",e[e.ArrowDown=40]="ArrowDown",e[e.Backspace=8]="Backspace",e}({});function Ee(){return new we}var xe,we=function(){function e(){_classCallCheck(this,e),this._selected=[]}return _createClass(e,[{key:"select",value:function(e,t,n){if(e.selected=!0,(!e.children||!t&&n)&&this._selected.push(e),t)if(e.parent){var r=e.parent.children.length,i=e.parent.children.filter((function(e){return e.selected})).length;e.parent.selected=r===i}else e.children&&(this._setChildrenSelectedState(e.children,!0),this._removeChildren(e),this._selected=n&&this._activeChildren(e)?[].concat(_toConsumableArray(this._selected.filter((function(t){return t.parent!==e}))),[e]):[].concat(_toConsumableArray(this._selected),_toConsumableArray(e.children.filter((function(e){return!e.disabled})))))}},{key:"unselect",value:function(e,t){if(this._selected=this._selected.filter((function(t){return t!==e})),e.selected=!1,t)if(e.parent&&e.parent.selected){var n,r=e.parent.children;this._removeParent(e.parent),this._removeChildren(e.parent),(n=this._selected).push.apply(n,_toConsumableArray(r.filter((function(t){return t!==e&&!t.disabled})))),e.parent.selected=!1}else e.children&&(this._setChildrenSelectedState(e.children,!1),this._removeChildren(e))}},{key:"clear",value:function(e){this._selected=e?this._selected.filter((function(e){return e.disabled})):[]}},{key:"_setChildrenSelectedState",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var c=o.value;c.disabled||(c.selected=t)}}catch(s){r=!0,i=s}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"_removeChildren",value:function(e){this._selected=[].concat(_toConsumableArray(this._selected.filter((function(t){return t.parent!==e}))),_toConsumableArray(e.children.filter((function(t){return t.parent===e&&t.disabled&&t.selected}))))}},{key:"_removeParent",value:function(e){this._selected=this._selected.filter((function(t){return t!==e}))}},{key:"_activeChildren",value:function(e){return e.children.every((function(e){return!e.disabled||e.selected}))}},{key:"value",get:function(){return this._selected}}]),e}(),We=n("fbp8"),Ne=n("6tGF"),Pe=((xe=function e(){_classCallCheck(this,e),this.notFoundText="\u042d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b",this.typeToSearchText="\u041f\u043e\u0438\u0441\u043a",this.addTagText="\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",this.loadingText="\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...",this.clearAllText="\u041e\u0447\u0438\u0441\u0442\u0438\u0442\u044c",this.disableVirtualScroll=!0,this.openOnEnter=!0,this.appearance="underline"}).\u0275fac=function(e){return new(e||xe)},xe.\u0275prov=d.Mb({token:xe,factory:xe.\u0275fac,providedIn:"root"}),xe),Me=n("eEJz"),Le=["searchInput"];function De(e,t){if(1&e){var n=d.Xb();d.Wb(0,"span",15),d.ic("click",(function(e){d.Fc(n);var t=d.lc().$implicit;return d.lc(2).unselect(t)})),d.Qc(1,"\xd7"),d.Vb(),d.Rb(2,"span",16)}if(2&e){var r=d.lc().$implicit,i=d.lc(2);d.Ab(2),d.rc("ngItemLabel",r.label)("escape",i.escapeHTML)}}function Qe(e,t){}var Fe=function(e,t,n){return{item:e,clear:t,label:n}};function Be(e,t){if(1&e&&(d.Wb(0,"div",12),d.Oc(1,De,3,2,"ng-template",null,13,d.Pc),d.Oc(3,Qe,0,0,"ng-template",14),d.Vb()),2&e){var n=t.$implicit,r=d.Cc(2),i=d.lc(2);d.Hb("j-value-disabled",n.disabled),d.Ab(3),d.rc("ngTemplateOutlet",i.labelTemplate||r)("ngTemplateOutletContext",d.yc(4,Fe,n.value,i.clearItem,n.label))}}function $e(e,t){if(1&e&&(d.Ub(0),d.Oc(1,Be,4,8,"div",11),d.Tb()),2&e){var n=d.lc();d.Ab(1),d.rc("ngForOf",n.selectedItems)("ngForTrackBy",n.trackByOption)}}function Ue(e,t){}var Ye=function(e,t){return{items:e,clear:t}};function Ke(e,t){if(1&e&&d.Oc(0,Ue,0,0,"ng-template",14),2&e){var n=d.lc();d.rc("ngTemplateOutlet",n.multiLabelTemplate)("ngTemplateOutletContext",d.xc(2,Ye,n.selectedValues,n.clearItem))}}function He(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"input",17,18),d.ic("input",(function(e){d.Fc(n);var t=d.Cc(2);return d.lc().filter(t.value)}))("compositionstart",(function(e){return d.Fc(n),d.lc().onCompositionStart()}))("compositionend",(function(e){d.Fc(n);var t=d.Cc(2);return d.lc().onCompositionEnd(t.value)}))("focus",(function(e){return d.Fc(n),d.lc().onInputFocus(e)}))("blur",(function(e){return d.Fc(n),d.lc().onInputBlur(e)}))("change",(function(e){return d.Fc(n),e.stopPropagation()})),d.Vb(),d.Tb()}if(2&e){var r=d.lc();d.Ab(1),d.rc("readOnly",!r.searchable||r.itemsList.maxItemsSelected)("disabled",r.disabled)("value",r.searchTerm?r.searchTerm:"")("jShadow",r.shadow)("mask",r.searchMask),d.Bb("id",r.labelForId)("tabindex",r.tabIndex)("aria-expanded",r.isOpen)("aria-owns",r.isOpen?r.dropdownId:null)("aria-activedescendant",r.isOpen?null==r.itemsList?null:null==r.itemsList.markedItem?null:r.itemsList.markedItem.htmlId:null)}}function Ge(e,t){if(1&e){var n=d.Xb();d.Wb(0,"input",19,18),d.ic("input",(function(e){d.Fc(n);var t=d.Cc(1);return d.lc().filter(t.value)}))("compositionstart",(function(e){return d.Fc(n),d.lc().onCompositionStart()}))("compositionend",(function(e){d.Fc(n);var t=d.Cc(1);return d.lc().onCompositionEnd(t.value)}))("focus",(function(e){return d.Fc(n),d.lc().onInputFocus(e)}))("blur",(function(e){return d.Fc(n),d.lc().onInputBlur(e)}))("change",(function(e){return d.Fc(n),e.stopPropagation()})),d.Vb()}if(2&e){var r=d.lc();d.rc("readOnly",!r.searchable||r.itemsList.maxItemsSelected)("disabled",r.disabled)("value",r.searchTerm?r.searchTerm:""),d.Bb("id",r.labelForId)("tabindex",r.tabIndex)("aria-expanded",r.isOpen)("aria-owns",r.isOpen?r.dropdownId:null)("aria-activedescendant",r.isOpen?null==r.itemsList?null:null==r.itemsList.markedItem?null:r.itemsList.markedItem.htmlId:null)}}function ze(e,t){1&e&&d.Rb(0,"div",22)}function qe(e,t){}function Xe(e,t){if(1&e&&(d.Ub(0),d.Oc(1,ze,1,0,"ng-template",null,20,d.Pc),d.Oc(3,qe,0,0,"ng-template",21),d.Tb()),2&e){var n=d.Cc(2),r=d.lc();d.Ab(3),d.rc("ngTemplateOutlet",r.loadingSpinnerTemplate||n)}}function Ze(e,t){if(1&e&&(d.Wb(0,"span",23),d.Wb(1,"span",24),d.Qc(2,"\xd7"),d.Vb(),d.Vb()),2&e){var n=d.lc();d.sc("title",n.clearAllText)}}function Je(e,t){if(1&e&&d.Rb(0,"span",30),2&e){var n=d.lc().$implicit,r=d.lc(2);d.rc("ngItemLabel",n.label)("escape",r.escapeHTML)}}function et(e,t){}var tt=function(e,t,n,r){return{item:e,item$:t,index:n,searchTerm:r}};function nt(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div",28),d.ic("click",(function(e){d.Fc(n);var r=t.$implicit;return d.lc(2).toggleItem(r,e)}))("mouseover",(function(e){d.Fc(n);var r=t.$implicit;return d.lc(2).onItemHover(r)})),d.Oc(1,Je,1,2,"ng-template",null,29,d.Pc),d.Oc(3,et,0,0,"ng-template",14),d.Vb()}if(2&e){var r=t.$implicit,i=d.Cc(2),o=d.lc(2);d.Hb("j-option-disabled",r.disabled)("j-option-selected",r.selected)("j-optgroup",r.children)("j-option",!r.children)("j-option-child",!!r.parent)("j-option-marked",r===o.itemsList.markedItem),d.Bb("role",r.children?"group":"option")("aria-selected",r.selected)("id",null==r?null:r.htmlId),d.Ab(3),d.rc("ngTemplateOutlet",r.children?o.optgroupTemplate||i:o.optionTemplate||i)("ngTemplateOutletContext",d.zc(17,tt,r.value,r,r.index,o.searchTerm))}}function rt(e,t){if(1&e&&(d.Wb(0,"span"),d.Wb(1,"span",33),d.Qc(2),d.Vb(),d.Qc(3),d.Vb()),2&e){var n=d.lc(3);d.Ab(2),d.Rc(n.addTagText),d.Ab(1),d.Sc('"',n.searchTerm,'"')}}function it(e,t){}var ot=function(e){return{searchTerm:e}};function at(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div",31),d.ic("mouseover",(function(e){return d.Fc(n),d.lc(2).itemsList.unmarkItem()}))("click",(function(e){return d.Fc(n),d.lc(2).selectTag()})),d.Oc(1,rt,4,2,"ng-template",null,32,d.Pc),d.Oc(3,it,0,0,"ng-template",14),d.Vb()}if(2&e){var r=d.Cc(2),i=d.lc(2);d.Hb("j-option-marked",!i.itemsList.markedItem),d.Ab(3),d.rc("ngTemplateOutlet",i.tagTemplate||r)("ngTemplateOutletContext",d.wc(4,ot,i.searchTerm))}}function ct(e,t){if(1&e&&(d.Wb(0,"div",35),d.Wb(1,"span",36),d.Qc(2),d.Vb(),d.Vb()),2&e){var n=d.lc(3);d.Ab(2),d.Rc(n.notFoundText)}}function st(e,t){}function lt(e,t){if(1&e&&(d.Ub(0),d.Oc(1,ct,3,1,"ng-template",null,34,d.Pc),d.Oc(3,st,0,0,"ng-template",14),d.Tb()),2&e){var n=d.Cc(2),r=d.lc(2);d.Ab(3),d.rc("ngTemplateOutlet",r.notFoundTemplate||n)("ngTemplateOutletContext",d.wc(2,ot,r.searchTerm))}}function ut(e,t){if(1&e&&(d.Wb(0,"div",35),d.Qc(1),d.Vb()),2&e){var n=d.lc(3);d.Ab(1),d.Rc(n.typeToSearchText)}}function bt(e,t){}function dt(e,t){if(1&e&&(d.Ub(0),d.Oc(1,ut,2,1,"ng-template",null,37,d.Pc),d.Oc(3,bt,0,0,"ng-template",21),d.Tb()),2&e){var n=d.Cc(2),r=d.lc(2);d.Ab(3),d.rc("ngTemplateOutlet",r.typeToSearchTemplate||n)}}function mt(e,t){if(1&e&&(d.Wb(0,"div",35),d.Qc(1),d.Vb()),2&e){var n=d.lc(3);d.Ab(1),d.Rc(n.loadingText)}}function pt(e,t){}function ft(e,t){if(1&e&&(d.Ub(0),d.Oc(1,mt,2,1,"ng-template",null,38,d.Pc),d.Oc(3,pt,0,0,"ng-template",14),d.Tb()),2&e){var n=d.Cc(2),r=d.lc(2);d.Ab(3),d.rc("ngTemplateOutlet",r.loadingTextTemplate||n)("ngTemplateOutletContext",d.wc(2,ot,r.searchTerm))}}function ht(e,t){if(1&e){var n=d.Xb();d.Wb(0,"j-dropdown-panel",25),d.ic("update",(function(e){return d.Fc(n),d.lc().viewPortItems=e}))("scroll",(function(e){return d.Fc(n),d.lc().scroll.emit(e)}))("scrollToEnd",(function(e){return d.Fc(n),d.lc().scrollToEnd.emit(e)}))("outsideClick",(function(e){return d.Fc(n),d.lc().close()})),d.Ub(1),d.Oc(2,nt,4,22,"div",26),d.Oc(3,at,4,6,"div",27),d.Tb(),d.Oc(4,lt,4,4,"ng-container",3),d.Oc(5,dt,4,1,"ng-container",3),d.Oc(6,ft,4,4,"ng-container",3),d.Vb()}if(2&e){var r=d.lc();d.Hb("j-select-multiple",r.multiple),d.rc("virtualScroll",r.virtualScroll)("bufferAmount",r.bufferAmount)("appendTo",r.appendTo)("position",r.dropdownPosition)("headerTemplate",r.headerTemplate)("footerTemplate",r.footerTemplate)("filterValue",r.searchTerm)("items",r.itemsList.filteredItems)("markedItem",r.itemsList.markedItem)("ngClass",r.appendTo?r.classes:null)("id",r.dropdownId),d.Ab(2),d.rc("ngForOf",r.viewPortItems)("ngForTrackBy",r.trackByOption),d.Ab(1),d.rc("ngIf",r.showAddTag),d.Ab(1),d.rc("ngIf",r.showNoItemsFound()),d.Ab(1),d.rc("ngIf",r.showTypeToSearch()),d.Ab(1),d.rc("ngIf",r.loading&&0===r.itemsList.filteredItems.length)}}var vt,gt,yt=new d.q("j-select-selection-model"),Ct=Object(Ne.a)(function(){return function e(t,n,r,i,o){_classCallCheck(this,e),this._elementRef=t,this._defaultErrorStateMatcher=n,this._parentForm=r,this._parentFormGroup=i,this.ngControl=o}}()),kt=((vt=function(e){function t(e,n,r,i,o,a,c,s,l,u){var b;return _classCallCheck(this,t),(b=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,o,l,c,s,a))).classes=e,b.autoFocus=n,b.ngControl=a,b._cd=u,b.markFirst=!0,b.dropdownPosition="auto",b.loading=!1,b.closeOnSelect=!0,b.hideSelected=!1,b.selectOnTab=!1,b.bufferAmount=4,b.selectableGroup=!1,b.selectableGroupAsModel=!0,b.searchFn=null,b.trackByFn=null,b.clearOnBackspace=!0,b.labelForId=null,b.inputAttrs={},b.readonly=!1,b.searchWhileComposing=!0,b.minTermLength=0,b.editableSearchTerm=!1,b.keyDownFn=function(e){return!0},b.multiple=!1,b.addTag=!1,b.searchable=!0,b.clearable=!0,b.isOpen=!1,b.controlType="select",b.blurEvent=new d.n,b.focusEvent=new d.n,b.changeEvent=new d.n,b.openEvent=new d.n,b.closeEvent=new d.n,b.searchEvent=new d.n,b.clearEvent=new d.n,b.addEvent=new d.n,b.removeEvent=new d.n,b.scroll=new d.n,b.scrollToEnd=new d.n,b.viewPortItems=[],b.searchTerm=null,b.dropdownId=Object(Oe.generateUniqueId)(),b.id=b.dropdownId,b.escapeHTML=!0,b.useDefaultClass=!0,b.stateChanges=new A.a,b._items=[],b._defaultLabel="label",b._pressedKeys=[],b._isComposing=!1,b._destroy$=new A.a,b._keyPress$=new A.a,b._onChange=function(e){},b._onTouched=function(){},b.clearItem=function(e){var t=b.selectedItems.find((function(t){return t.value===e}));b.unselect(t)},b.trackByOption=function(e,t){return b.trackByFn?b.trackByFn(t.value):t},b.ngControl&&(b.ngControl.valueAccessor=_assertThisInitialized(b)),b._mergeGlobalConfig(r),b.itemsList=new Ie(_assertThisInitialized(b),i()),b.element=o.nativeElement,b}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnChanges",value:function(e){e.multiple&&this.itemsList.clearSelected(),e.items&&this._setItems(e.items.currentValue||[]),e.isOpen&&(this._manualOpen=N(e.isOpen.currentValue))}},{key:"ngDoCheck",value:function(){this.ngControl&&this.updateErrorState()}},{key:"ngAfterViewInit",value:function(){this._handleKeyPresses(),this._setInputAttributes(),this._itemsAreUsed||(this.escapeHTML=!1,this._setItemsFromNgOptions()),N(this.autoFocus)&&this.focus()}},{key:"ngOnDestroy",value:function(){this._destroy$.next(),this._destroy$.complete()}},{key:"handleKeyDown",value:function(e){if(Ve[e.which]){if(!1===this.keyDownFn(e))return;this.handleKeyCode(e)}else e.key&&1===e.key.length&&this._keyPress$.next(e.key.toLocaleLowerCase())}},{key:"handleKeyCode",value:function(e){switch(e.which){case Ve.ArrowDown:this._handleArrowDown(e);break;case Ve.ArrowUp:this._handleArrowUp(e);break;case Ve.Space:this._handleSpace(e);break;case Ve.Enter:this._handleEnter(e);break;case Ve.Tab:this._handleTab(e);break;case Ve.Esc:this.close(),e.preventDefault();break;case Ve.Backspace:this._handleBackspace()}}},{key:"handleMousedown",value:function(e){var t=e.target;"INPUT"!==t.tagName&&e.preventDefault(),t.classList.contains("j-clear-wrapper")?this.handleClearClick():t.classList.contains("j-arrow-wrapper")?this.handleArrowClick():t.classList.contains("j-value-icon")||(this.focused||this.focus(),this.searchable?this.open():this.toggle())}},{key:"onContainerClick",value:function(e){this.handleMousedown(e)}},{key:"handleArrowClick",value:function(){this.isOpen?this.close():this.open()}},{key:"handleClearClick",value:function(){this.hasValue&&(this.itemsList.clearSelected(!0),this._updateNgModel()),this._clearSearch(),this.focus(),this.clearEvent.emit(),this._onSelectionChanged()}},{key:"clearModel",value:function(){this.clearable&&(this.itemsList.clearSelected(),this._updateNgModel())}},{key:"writeValue",value:function(e){this.itemsList.clearSelected(),this._handleWriteValue(e),this._cd.markForCheck()}},{key:"setDescribedByIds",value:function(e){}},{key:"registerOnChange",value:function(e){this._onChange=e}},{key:"registerOnTouched",value:function(e){this._onTouched=e}},{key:"setDisabledState",value:function(e){this._disabled=e}},{key:"toggle",value:function(){this.isOpen?this.close():this.open()}},{key:"open",value:function(){this.disabled||this.isOpen||this.itemsList.maxItemsSelected||this._manualOpen||(this._isTypeahead||this.addTag||!this.itemsList.noItemsToSelect)&&(this.isOpen=!0,this.itemsList.markSelectedOrDefault(this.markFirst),this.openEvent.emit(),this.searchable&&!this.searchTerm&&this.focus(),this.detectChanges())}},{key:"close",value:function(){this.isOpen&&!this._manualOpen&&(this.isOpen=!1,this._editableSearchTerm?this.itemsList.resetFilteredItems():this._clearSearch(),this.itemsList.unmarkItem(),this._onTouched(),this.closeEvent.emit(),this.stateChanges.next(),this._cd.markForCheck())}},{key:"toggleItem",value:function(e,t){t&&t.stopPropagation(),!e||e.disabled||this.disabled||(this.multiple&&e.selected?this.unselect(e):this.select(e),this._editableSearchTerm&&this._setSearchTermFromItems(),this._onSelectionChanged())}},{key:"select",value:function(e){e.selected||(this.itemsList.select(e),this.clearSearchOnAdd&&!this._editableSearchTerm&&this._clearSearch(),this._updateNgModel(),this.multiple&&this.addEvent.emit(e.value)),(this.closeOnSelect||this.itemsList.noItemsToSelect)&&this.close()}},{key:"focus",value:function(){this.searchInput.nativeElement.focus()}},{key:"blur",value:function(){this.searchInput.nativeElement.blur()}},{key:"unselect",value:function(e){e&&(this.itemsList.unselect(e),this.focus(),this._updateNgModel(),this.removeEvent.emit(e))}},{key:"selectTag",value:function(){var e,t=this;e=M(this.addTag)?this.addTag(this.searchTerm):this._primitive?this.searchTerm:_defineProperty({},this.bindLabel,this.searchTerm);var n=function(e){return t._isTypeahead||!t.isOpen?t.itemsList.mapItem(e,null):t.itemsList.addItem(e)};e instanceof Promise?e.then((function(e){return t.select(n(e))})).catch((function(){})):e&&this.select(n(e))}},{key:"showClear",value:function(){return this.clearable&&(this.hasValue||this.searchTerm)&&!this.disabled}},{key:"showNoItemsFound",value:function(){var e=0===this.itemsList.filteredItems.length;return(e&&!this._isTypeahead&&!this.loading||e&&this._isTypeahead&&this._validTerm&&!this.loading)&&!this.showAddTag}},{key:"showTypeToSearch",value:function(){return 0===this.itemsList.filteredItems.length&&this._isTypeahead&&!this._validTerm&&!this.loading}},{key:"onCompositionStart",value:function(){this._isComposing=!0}},{key:"onCompositionEnd",value:function(e){this._isComposing=!1,this.searchWhileComposing||this.filter(e)}},{key:"filter",value:function(e){this._isComposing&&!this.searchWhileComposing||(this.searchTerm=e,this._isTypeahead&&(this._validTerm||0===this.minTermLength)&&this.typeahead.next(e),this._isTypeahead||(this.itemsList.filter(this.searchTerm),this.isOpen&&this.itemsList.markSelectedOrDefault(this.markFirst)),this.searchEvent.emit({term:e,items:this.itemsList.filteredItems.map((function(e){return e.value}))}),this.open())}},{key:"onInputFocus",value:function(e){this.focused||(this._editableSearchTerm&&this._setSearchTermFromItems(),this.element.classList.add("j-select-focused"),this.focusEvent.emit(e),this.focused=!0,this.stateChanges.next())}},{key:"onInputBlur",value:function(e){this.element.classList.remove("j-select-focused"),this.blurEvent.emit(e),this.isOpen||this.disabled||(this._onTouched(),this.stateChanges.next(),this._cd.markForCheck()),this._editableSearchTerm&&this._setSearchTermFromItems(),this.focused=!1}},{key:"onItemHover",value:function(e){e.disabled||this.itemsList.markItem(e)}},{key:"detectChanges",value:function(){this._cd.destroyed||this._cd.markForCheck()}},{key:"_setSearchTermFromItems",value:function(){var e=this.selectedItems&&this.selectedItems[0];this.searchTerm=e&&e.label||null}},{key:"_setItems",value:function(e){var t=e[0];this.bindLabel=this.bindLabel||this._defaultLabel,this._primitive=N(t)?!P(t):this._primitive||this.bindLabel===this._defaultLabel,this.itemsList.setItems(e),e.length>0&&this.hasValue&&this.itemsList.mapSelectedItems(),this.isOpen&&N(this.searchTerm)&&!this._isTypeahead&&this.itemsList.filter(this.searchTerm),(this._isTypeahead||this.isOpen)&&this.itemsList.markSelectedOrDefault(this.markFirst)}},{key:"_setItemsFromNgOptions",value:function(){var e=this;this.ngOptions.changes.pipe(Object(be.a)(this.ngOptions),Object(_.a)(this._destroy$)).subscribe((function(t){var n;e.bindLabel=e._defaultLabel,function(t){e.items=t.map((function(e){return{$ngOptionValue:e.value,$ngOptionLabel:e.elementRef.nativeElement.innerHTML,disabled:e.disabled}})),e.itemsList.setItems(e.items),e.hasValue&&e.itemsList.mapSelectedItems(),e.detectChanges()}(t),n=Object(R.a)(e.ngOptions.changes,e._destroy$),Object(R.a).apply(void 0,_toConsumableArray(e.ngOptions.map((function(e){return e.stateChange$})))).pipe(Object(_.a)(n)).subscribe((function(t){var n=e.itemsList.findItem(t.value);n.disabled=t.disabled,n.label=t.label||n.label}))}))}},{key:"_isValidWriteValue",value:function(e){var t=this;if(!N(e)||this.multiple&&""===e||Array.isArray(e)&&0===e.length)return!1;var n=function(e){return!(!N(t.compareWith)&&P(e)&&t.bindValue)};return this.multiple?!!Array.isArray(e)&&e.every((function(e){return n(e)})):n(e)}},{key:"_handleWriteValue",value:function(e){var t=this;if(this._isValidWriteValue(e)){var n=function(e){var n=t.itemsList.findItem(e);if(n)t.itemsList.select(n);else{var r,i=P(e),o=!i&&!t.bindValue;i||o?t.itemsList.select(t.itemsList.mapItem(e,null)):t.bindValue&&e&&(_defineProperty(r={},t.bindLabel,null),_defineProperty(r,t.bindValue,e),n=r,t.itemsList.select(t.itemsList.mapItem(n,null)))}};this.multiple?e.forEach((function(e){return n(e)})):n(e)}}},{key:"_handleKeyPresses",value:function(){var e=this;this.searchable||this._keyPress$.pipe(Object(_.a)(this._destroy$),Object(de.a)((function(t){return e._pressedKeys.push(t)})),Object(me.a)(200),Object(pe.a)((function(){return e._pressedKeys.length>0})),Object(fe.a)((function(){return e._pressedKeys.join("")}))).subscribe((function(t){var n=e.itemsList.findByLabel(t);n&&(e.isOpen?e.itemsList.markItem(n):e.select(n)),e._pressedKeys=[]}))}},{key:"_setInputAttributes",value:function(){for(var e=this.searchInput.nativeElement,t=Object.assign({type:"text",autocorrect:"off",autocapitalize:"off",autocomplete:this.labelForId?"off":this.dropdownId},this.inputAttrs),n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];e.setAttribute(i,t[i])}}},{key:"_updateNgModel",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var i,o=this.selectedItems[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var a,c=i.value;if(this.bindValue)a=c.children?c.value[(this.groupValue?this.bindValue:this.groupBy)||this.groupBy]:this.itemsList.resolveNested(c.value,this.bindValue),e.push(a);else e.push(c.value)}}catch(l){n=!0,r=l}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}var s=this.selectedItems.map((function(e){return e.value}));this.multiple?(this._onChange(e),this.changeEvent.emit(s)):(this._onChange(N(e[0])?e[0]:null),this.changeEvent.emit(s[0]))}},{key:"_clearSearch",value:function(){this.searchTerm&&(this._changeSearch(null),this.itemsList.resetFilteredItems())}},{key:"_changeSearch",value:function(e){this.searchTerm=e,this._isTypeahead&&this.typeahead.next(e)}},{key:"_scrollToMarked",value:function(){this.isOpen&&this.dropdownPanel&&this.dropdownPanel.scrollTo(this.itemsList.markedItem)}},{key:"_scrollToTag",value:function(){this.isOpen&&this.dropdownPanel&&this.dropdownPanel.scrollToTag()}},{key:"_onSelectionChanged",value:function(){this.isOpen&&this.multiple&&this.appendTo&&this.dropdownPanel.adjustPosition()}},{key:"_handleTab",value:function(e){(!1!==this.isOpen||this.addTag)&&(this.selectOnTab?this.itemsList.markedItem?(this.toggleItem(this.itemsList.markedItem),e.preventDefault()):this.showAddTag?(this.selectTag(),e.preventDefault()):this.close():this.close())}},{key:"_handleEnter",value:function(e){if(this.isOpen||this._manualOpen)this.itemsList.markedItem?this.toggleItem(this.itemsList.markedItem):this.showAddTag&&this.selectTag();else{if(!this.openOnEnter)return;this.open()}e.preventDefault()}},{key:"_handleSpace",value:function(e){this.isOpen||this._manualOpen||(this.open(),e.preventDefault())}},{key:"_handleArrowDown",value:function(e){this._nextItemIsTag(1)?(this.itemsList.unmarkItem(),this._scrollToTag()):(this.itemsList.markNextItem(),this._scrollToMarked()),this.open(),e.preventDefault()}},{key:"_handleArrowUp",value:function(e){this.isOpen&&(this._nextItemIsTag(-1)?(this.itemsList.unmarkItem(),this._scrollToTag()):(this.itemsList.markPreviousItem(),this._scrollToMarked()),e.preventDefault())}},{key:"_nextItemIsTag",value:function(e){var t=this.itemsList.markedIndex+e;return this.addTag&&this.searchTerm&&this.itemsList.markedItem&&(t<0||t===this.itemsList.filteredItems.length)}},{key:"_handleBackspace",value:function(){!this.searchTerm&&this.clearable&&this.clearOnBackspace&&this.hasValue&&(this.multiple?this.unselect(this.itemsList.lastSelectedItem):this.clearModel())}},{key:"_mergeGlobalConfig",value:function(e){this.placeholder=this.placeholder||e.placeholder,this.notFoundText=this.notFoundText||e.notFoundText,this.typeToSearchText=this.typeToSearchText||e.typeToSearchText,this.addTagText=this.addTagText||e.addTagText,this.loadingText=this.loadingText||e.loadingText,this.clearAllText=this.clearAllText||e.clearAllText,this.virtualScroll=N(this.virtualScroll)?this.virtualScroll:!!N(e.disableVirtualScroll)&&!e.disableVirtualScroll,this.openOnEnter=N(this.openOnEnter)?this.openOnEnter:e.openOnEnter,this.appendTo=this.appendTo||e.appendTo,this.bindValue=this.bindValue||e.bindValue,this.appearance=this.appearance||e.appearance}},{key:"items",get:function(){return this._items},set:function(e){this._itemsAreUsed=!0,this._items=e}},{key:"compareWith",get:function(){return this._compareWith},set:function(e){if(!M(e))throw Error("`compareWith` must be a function.");this._compareWith=e}},{key:"value",get:function(){return this._value},set:function(e){e!==this._value&&(this.writeValue(e),this._value=e)}},{key:"clearSearchOnAdd",get:function(){return N(this._clearSearchOnAdd)?this._clearSearchOnAdd:this.closeOnSelect},set:function(e){this._clearSearchOnAdd=e}},{key:"disabled",get:function(){return this.readonly||this._disabled}},{key:"filtered",get:function(){return!!this.searchTerm&&this.searchable||this._isComposing}},{key:"_editableSearchTerm",get:function(){return this.editableSearchTerm&&!this.multiple}},{key:"shouldLabelFloat",get:function(){return this.isOpen&&this.searchable||this.searchable&&this.focused||!this.empty}},{key:"empty",get:function(){return!this.hasValue}},{key:"selectedItems",get:function(){return this.itemsList.selectedItems}},{key:"selectedValues",get:function(){return this.selectedItems.map((function(e){return e.value}))}},{key:"hasValue",get:function(){return this.selectedItems.some((function(e){return e.value}))}},{key:"currentPanelPosition",get:function(){if(this.dropdownPanel)return this.dropdownPanel.currentPosition}},{key:"showAddTag",get:function(){if(!this._validTerm)return!1;var e=this.searchTerm.toLowerCase().trim();return this.addTag&&!this.itemsList.filteredItems.some((function(t){return t.label.toLowerCase()===e}))&&(!this.hideSelected&&this.isOpen||!this.selectedItems.some((function(t){return t.label.toLowerCase()===e})))&&!this.loading}},{key:"_isTypeahead",get:function(){return this.typeahead&&this.typeahead.observers.length>0}},{key:"_validTerm",get:function(){var e=this.searchTerm&&this.searchTerm.trim();return e&&e.length>=this.minTermLength}}]),t}(Ct)).\u0275fac=function(e){return new(e||vt)(d.fc("class"),d.fc("autofocus"),d.Qb(Pe),d.Qb(yt),d.Qb(d.l),d.Qb(i.s,10),d.Qb(i.v,8),d.Qb(i.l,8),d.Qb(Me.a),d.Qb(d.h))},vt.\u0275cmp=d.Kb({type:vt,selectors:[["j-select"]],contentQueries:function(e,t,n){var r;1&e&&(d.Ib(n,ve,!0,d.L),d.Ib(n,ge,!0,d.L),d.Ib(n,ye,!0,d.L),d.Ib(n,Ce,!0,d.L),d.Ib(n,ke,!0,d.L),d.Ib(n,Ae,!0,d.L),d.Ib(n,Te,!0,d.L),d.Ib(n,Re,!0,d.L),d.Ib(n,_e,!0,d.L),d.Ib(n,Se,!0,d.L),d.Ib(n,je,!0,d.L),d.Ib(n,ue,!0)),2&e&&(d.Bc(r=d.jc())&&(t.optionTemplate=r.first),d.Bc(r=d.jc())&&(t.optgroupTemplate=r.first),d.Bc(r=d.jc())&&(t.labelTemplate=r.first),d.Bc(r=d.jc())&&(t.multiLabelTemplate=r.first),d.Bc(r=d.jc())&&(t.headerTemplate=r.first),d.Bc(r=d.jc())&&(t.footerTemplate=r.first),d.Bc(r=d.jc())&&(t.notFoundTemplate=r.first),d.Bc(r=d.jc())&&(t.typeToSearchTemplate=r.first),d.Bc(r=d.jc())&&(t.loadingTextTemplate=r.first),d.Bc(r=d.jc())&&(t.tagTemplate=r.first),d.Bc(r=d.jc())&&(t.loadingSpinnerTemplate=r.first),d.Bc(r=d.jc())&&(t.ngOptions=r))},viewQuery:function(e,t){var n;1&e&&(d.Vc(se,!0),d.Vc(Le,!0)),2&e&&(d.Bc(n=d.jc())&&(t.dropdownPanel=n.first),d.Bc(n=d.jc())&&(t.searchInput=n.first))},hostAttrs:["role","listbox"],hostVars:20,hostBindings:function(e,t){1&e&&d.ic("keydown",(function(e){return t.handleKeyDown(e)})),2&e&&d.Hb("j-select",t.useDefaultClass)("j-select-single",!t.multiple)("j-select-typeahead",t.typeahead)("j-select-multiple",t.multiple)("j-select-taggable",t.addTag)("j-select-searchable",t.searchable)("j-select-clearable",t.clearable)("j-select-opened",t.isOpen)("j-select-disabled",t.disabled)("j-select-filtered",t.filtered)},inputs:{bindLabel:"bindLabel",bindValue:"bindValue",markFirst:"markFirst",placeholder:"placeholder",notFoundText:"notFoundText",typeToSearchText:"typeToSearchText",addTagText:"addTagText",loadingText:"loadingText",clearAllText:"clearAllText",appearance:"appearance",dropdownPosition:"dropdownPosition",appendTo:"appendTo",loading:"loading",closeOnSelect:"closeOnSelect",hideSelected:"hideSelected",selectOnTab:"selectOnTab",openOnEnter:"openOnEnter",maxSelectedItems:"maxSelectedItems",groupBy:"groupBy",groupValue:"groupValue",bufferAmount:"bufferAmount",virtualScroll:"virtualScroll",selectableGroup:"selectableGroup",selectableGroupAsModel:"selectableGroupAsModel",searchFn:"searchFn",trackByFn:"trackByFn",clearOnBackspace:"clearOnBackspace",labelForId:"labelForId",inputAttrs:"inputAttrs",tabIndex:"tabIndex",readonly:"readonly",searchWhileComposing:"searchWhileComposing",minTermLength:"minTermLength",editableSearchTerm:"editableSearchTerm",errorStateMatcher:"errorStateMatcher",searchMask:"searchMask",keyDownFn:"keyDownFn",shadow:"shadow",typeahead:"typeahead",multiple:"multiple",addTag:"addTag",searchable:"searchable",clearable:"clearable",isOpen:"isOpen",items:"items",compareWith:"compareWith",value:"value",clearSearchOnAdd:"clearSearchOnAdd",required:"required"},outputs:{blurEvent:"blur",focusEvent:"focus",changeEvent:"change",openEvent:"open",closeEvent:"close",searchEvent:"search",clearEvent:"clear",addEvent:"add",removeEvent:"remove",scroll:"scroll",scrollToEnd:"scrollToEnd"},features:[d.zb([{provide:We.a,useExisting:vt},D]),d.xb,d.yb()],decls:15,vars:12,consts:[[1,"j-select-container"],[1,"j-value-container","form-control"],[1,"j-placeholder"],[4,"ngIf"],[1,"j-search-input"],[4,"ngIf","ngIfElse"],["noMask",""],["class","j-clear-wrapper",3,"title",4,"ngIf"],[1,"j-arrow-wrapper"],[1,"j-arrow"],["class","j-dropdown-panel",3,"virtualScroll","bufferAmount","appendTo","position","headerTemplate","footerTemplate","filterValue","items","markedItem","j-select-multiple","ngClass","id","update","scroll","scrollToEnd","outsideClick",4,"ngIf"],["class","j-value",3,"j-value-disabled",4,"ngFor","ngForOf","ngForTrackBy"],[1,"j-value"],["defaultLabelTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["aria-hidden","true",1,"j-value-icon","left",3,"click"],[1,"j-value-label","j-value-label-default","text-truncate",3,"ngItemLabel","escape"],["role","combobox",3,"readOnly","disabled","value","jShadow","mask","input","compositionstart","compositionend","focus","blur","change"],["searchInput",""],["role","combobox",3,"readOnly","disabled","value","input","compositionstart","compositionend","focus","blur","change"],["defaultLoadingSpinnerTemplate",""],[3,"ngTemplateOutlet"],[1,"j-spinner-loader"],[1,"j-clear-wrapper",3,"title"],["aria-hidden","true",1,"j-clear"],[1,"j-dropdown-panel",3,"virtualScroll","bufferAmount","appendTo","position","headerTemplate","footerTemplate","filterValue","items","markedItem","ngClass","id","update","scroll","scrollToEnd","outsideClick"],["class","j-option",3,"j-option-disabled","j-option-selected","j-optgroup","j-option","j-option-child","j-option-marked","click","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","j-option","role","option",3,"j-option-marked","mouseover","click",4,"ngIf"],[1,"j-option",3,"click","mouseover"],["defaultOptionTemplate",""],[1,"j-option-label",3,"ngItemLabel","escape"],["role","option",1,"j-option",3,"mouseover","click"],["defaultTagTemplate",""],[1,"j-tag-label"],["defaultNotFoundTemplate",""],[1,"j-option","j-option-disabled"],[1,"text-center","text-muted"],["defaultTypeToSearchTemplate",""],["defaultLoadingTextTemplate",""]],template:function(e,t){if(1&e&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Wb(2,"div",2),d.Qc(3),d.Vb(),d.Oc(4,$e,2,2,"ng-container",3),d.Oc(5,Ke,1,5,void 0,3),d.Wb(6,"div",4),d.Oc(7,He,3,10,"ng-container",5),d.Oc(8,Ge,2,8,"ng-template",null,6,d.Pc),d.Vb(),d.Vb(),d.Oc(10,Xe,4,1,"ng-container",3),d.Oc(11,Ze,3,1,"span",7),d.Wb(12,"span",8),d.Rb(13,"span",9),d.Vb(),d.Vb(),d.Oc(14,ht,7,19,"j-dropdown-panel",10)),2&e){var n=d.Cc(9);d.Hb("j-appearance-outline","outline"===t.appearance)("j-has-value",t.hasValue),d.Ab(3),d.Rc(t.placeholder),d.Ab(1),d.rc("ngIf",!t.multiLabelTemplate&&t.selectedItems.length>0),d.Ab(1),d.rc("ngIf",t.multiLabelTemplate&&t.selectedValues.length>0),d.Ab(2),d.rc("ngIf",t.searchMask)("ngIfElse",n),d.Ab(3),d.rc("ngIf",t.loading),d.Ab(1),d.rc("ngIf",t.showClear()),d.Ab(3),d.rc("ngIf",t.isOpen)}},styles:[".j-select{position:relative;display:block;width:100%}.j-select [hidden]{display:none}.j-select.j-select-searchable .j-select-container .j-value-container .j-search-input{opacity:1}.j-select.j-select-disabled .j-select-container .j-value-container .j-placeholder,.j-select.j-select-disabled .j-select-container .j-value-container .j-value{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.j-select.j-select-disabled .j-arrow-wrapper{cursor:default}.j-select.j-select-filtered .j-placeholder{display:none}.j-select .j-select-container{cursor:default;display:-webkit-box;display:flex;outline:none;overflow:hidden;width:100%}.j-select .j-select-container .j-value-container{display:-webkit-box;display:flex;-webkit-box-flex:1;flex:1;-webkit-box-align:center;align-items:center}.j-select .j-select-container .j-value-container .j-search-input{opacity:0}.j-select .j-select-container .j-value-container .j-search-input>input{box-sizing:content-box;background:none transparent;border:0;box-shadow:none;outline:none;padding-left:2px;cursor:default;width:100%}.j-select .j-select-container .j-value-container .j-search-input>input::-ms-clear{display:none}.j-select .j-select-container .j-value-container .j-search-input>input[readonly]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:0;padding:0}.j-select.j-select-single.j-select-filtered .j-select-container .j-value-container .j-value{visibility:hidden}.j-select.j-select-single .j-select-container .j-value-container{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.j-select.j-select-single .j-select-container .j-value-container .j-value{padding-left:1px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.j-select.j-select-single .j-select-container .j-value-container .j-value .j-value-icon{display:none}.j-select.j-select-single .j-select-container .j-value-container .j-search-input{top:1.2em;position:absolute;left:0;width:100%}.j-select.j-select-multiple.j-select-disabled>.j-select-container .j-value-container .j-value .j-value-icon{display:none}.j-select.j-select-multiple .j-select-container .j-value-container{flex-wrap:wrap}.j-select.j-select-multiple .j-select-container .j-value-container .j-placeholder{position:absolute}.j-select.j-select-multiple .j-select-container .j-value-container .j-value{white-space:nowrap}.j-select.j-select-multiple .j-select-container .j-value-container .j-value.j-value-disabled .j-value-icon{display:none}.j-select.j-select-multiple .j-select-container .j-value-container .j-value .j-value-icon{cursor:pointer}.j-select.j-select-multiple .j-select-container .j-value-container .j-search-input{-webkit-box-flex:1;flex:1;z-index:2}.j-select.j-select-multiple .j-select-container .j-value-container .j-placeholder{z-index:1}.j-select .j-clear-wrapper{cursor:pointer;position:relative;width:17px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.j-select .j-clear-wrapper .j-clear{display:inline-block;font-size:18px;line-height:1;pointer-events:none}.j-select .j-spinner-loader{border-radius:50%;width:17px;height:17px;margin-right:5px;font-size:10px;position:relative;text-indent:-9999em;border:2px solid rgba(66,66,66,.2);border-left-color:#424242;-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-animation:load8 .8s linear infinite;animation:load8 .8s linear infinite}.j-select .j-spinner-loader:after{border-radius:50%;width:17px;height:17px}@-webkit-keyframes load8{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes load8{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}.j-select .j-arrow-wrapper{cursor:pointer;position:relative;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.j-select .j-arrow-wrapper .j-arrow{pointer-events:none;display:inline-block;height:0;width:0;position:absolute}.j-dropdown-panel{box-sizing:border-box;position:absolute;opacity:0;width:100%;z-index:1050;-webkit-overflow-scrolling:touch}.j-dropdown-panel .j-dropdown-panel-items{display:block;height:auto;box-sizing:border-box;max-height:300px;overflow-y:auto}.j-dropdown-panel .j-dropdown-panel-items .j-optgroup{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.j-dropdown-panel .j-dropdown-panel-items .j-option{box-sizing:border-box;cursor:pointer;display:block}.j-dropdown-panel .j-dropdown-panel-items .j-option .highlighted{font-weight:700;text-decoration:underline}.j-dropdown-panel .j-dropdown-panel-items .j-option.disabled{cursor:default}.j-dropdown-panel .scroll-host{overflow:hidden;overflow-y:auto;position:relative;display:block;-webkit-overflow-scrolling:touch;padding-right:.5rem}.j-dropdown-panel .scroll-host::-webkit-scrollbar{width:8px}.j-dropdown-panel .scroll-host::-webkit-scrollbar-track{background:#fff}.j-dropdown-panel .scroll-host::-webkit-scrollbar-thumb{background:#b7bec5;border-radius:10px}.j-dropdown-panel .scrollable-content{top:0;left:0;width:100%;height:100%;position:absolute}.j-dropdown-panel .total-padding{width:1px;opacity:0}.j-form-field-type-select .j-form-field .j-form-field--infix{border-top:0;padding:0}.j-form-field-type-select .j-form-field-flex{display:-webkit-box;display:flex}.j-form-field-type-select .j-form-field--label-wrapper{top:0;box-sizing:border-box}.j-select:not(.j-select-filtered) .j-has-value .input-shadow{opacity:0}.j-value-container{position:relative;border:0;margin-left:.5em;margin-right:.5em;border-radius:0;background:none;padding:0;height:3.5em}.j-form-field-has-label .j-value-container{padding-top:1.7em;padding-bottom:.4em}.j-dropdown-panel{background-color:#fff;padding:1.5rem}.j-dropdown-panel.j-select-bottom{border-radius:0 0 8px 8px;margin-top:1px;box-shadow:0 14px 16px rgba(0,0,0,.05)}.j-dropdown-panel.j-select-top{border-radius:8px 8px 0 0;margin-bottom:2px;box-shadow:0 -1rem 3rem rgba(26,28,31,.175)}.j-dropdown-panel .j-option+.j-option{margin-top:.5rem}.j-value-label-default{display:block}.j-form-field-has-label .j-select.j-select-single .j-select-container .j-search-input{top:1.7em}"],encapsulation:2,changeDetection:0}),vt),At=n("JvPu"),Tt=n("wwEr"),Rt=n("3v+J"),_t=n("Y+uv"),St=n("/zfT"),jt=n("xWtO"),Ot=n("BV3K"),It=n("B+58"),Vt=n("zOyH"),Et=n("Cg+c"),xt=n("Dwsl"),wt=n("+uUT"),Wt=n("Ya7Z"),Nt=n("13E/"),Pt=n("cZYL"),Mt=n("jMpN"),Lt=n("ttPG"),Dt=n("vZvt"),Qt=n("0eeg"),Ft=n("Wo9y"),Bt=n("EBek"),$t=n("570E"),Ut=n("zdqJ"),Yt=n("i2Gl"),Kt=n("Kcpt"),Ht=n("Frqi"),Gt=n("M6pS"),zt=n("paXB"),qt=n("Q98t"),Xt=n("EiG8"),Zt=n("4oqK"),Jt=n("c66K"),en=n("QfCG"),tn=n("oa9T"),nn=n("SfXN"),rn=n("H6TZ"),on=n("jRXw"),an=n("2aJj"),cn=n("VA2L"),sn=n("0AMz"),ln=n("W3Es"),un=n("R4CF"),bn=n("9txL"),dn=n("LXWx"),mn=n("5I09"),pn=n("S1F0"),fn=n("oKsb"),hn=n("fvpk"),vn=n("Tile"),gn=n("aF9I"),yn=n("aZ8m"),Cn=n("UhoJ"),kn=n("sCra"),An=n("fGuG"),Tn=n("7/bn"),Rn=n("Bl/x"),_n=n("zN9f"),Sn=n("Kx/q"),jn=n("2FF4"),On=n("bSvt"),In=n("jH+I"),Vn=n("4cI0"),En=n("kUBv"),xn=n("9Udv"),wn=n("0jn5"),Wn=n("fK/r"),Nn=n("Hjq/"),Pn=n("PGAL"),Mn=n("Kx0l"),Ln=n("gdaf"),Dn=n("LFY/"),Qn=n("I+WJ"),Fn=n("lABO"),Bn=n("hJI6"),$n=n("JB36"),Un=n("4zJ+"),Yn=n("XpgD"),Kn=n("MfWJ"),Hn=n("B8HE"),Gn=n("NpBu"),zn=n("TaxS"),qn=n("tkTF"),Xn=n("yy4r"),Zn=n("wGsJ"),Jn=n("ZVDf"),er=n("l/gM"),tr=n("UoEe"),nr=n("gN/K"),rr=n("+hcb"),ir=n("h7tf"),or=n("9odQ"),ar=n("WqMH"),cr=n("3MRA"),sr=n("Zgqj"),lr=n("oMXN"),ur=n("rqas"),br=n("dnqU"),dr=n("tp+K"),mr=n("saU0"),pr=n("ZF3e"),fr=n("JqCM"),hr=n("qew9"),vr=n("d/d6"),gr=n("e8Ap"),yr=n("Dvla"),Cr=n("K1R0"),kr=n("dlKe"),Ar=n("DPnb"),Tr=n("C6g9"),Rr=n("3M96"),_r=n("DHcY"),Sr=n("adOO"),jr=n("Eajh"),Or=n("Ub7F"),Ir=n("OHc7"),Vr=n("I0Rk"),Er=n("tepA"),xr=n("Bs9s"),wr=n("ScFe"),Wr=n("SCaJ"),Nr=n("wV3k"),Pr=n("wY9W"),Mr=n("7Fmj"),Lr=n("3skF"),Dr=((gt=function e(){_classCallCheck(this,e)}).\u0275mod=d.Ob({type:gt}),gt.\u0275inj=d.Nb({factory:function(e){return new(e||gt)},providers:[{provide:yt,useValue:Ee}],imports:[[r.c,b.a,o.c.forChild()]]}),gt);d.Ic(kt,[se,ue,kt,ge,ve,ye,Ce,ke,Ae,Te,Re,_e,Se,je,he,r.r,r.s,r.t,r.u,r.B,r.x,r.y,r.z,r.A,r.v,r.w,At.a,Tt.a,Rt.a,_t.a,St.a,jt.a,Ot.b,It.a,Vt.a,Et.a,xt.a,wt.a,Wt.a,Ot.a,Nt.a,Pt.b,Pt.a,Mt.a,Lt.a,Dt.a,Qt.a,Ft.a,Bt.a,$t.a,Ut.a,Yt.b,Kt.a,Ht.a,Gt.a,zt.a,qt.a,Xt.a,Zt.a,Jt.a,en.a,tn.a,nn.a,rn.a,on.a,an.a,cn.a,sn.a,ln.a,un.a,bn.a,dn.a,mn.a,pn.a,fn.a,hn.a,vn.a,gn.a,yn.a,Cn.a,kn.a,An.a,Tn.a,Rn.a,_n.a,Sn.a,jn.a,On.a,In.a,Vn.a,En.a,xn.a,wn.a,Wn.a,Nn.a,Pn.a,Mn.a,Ln.a,Dn.a,Qn.a,Fn.a,Bn.a,$n.a,Un.a,Yn.a,Kn.a,Hn.a,Gn.a,zn.a,qn.a,Xn.a,Zn.a,Jn.a,er.a,tr.a,nr.a,rr.a,ir.a,or.b,ar.a,cr.a,sr.a,lr.a,ur.a,br.a,dr.a,mr.a,pr.a,fr.a,hr.a,vr.a,gr.a,c.a,a.E,yr.a,yr.b,Cr.a,s.a,kr.a,Ar.a,Ar.c,Ar.b,Tr.a,Rr.a,o.a],[r.b,r.I,r.q,r.l,r.F,r.g,r.D,r.G,r.d,r.f,r.j,r.k,r.m,_r.a,Sr.a,jr.a,Or.a,Ir.a,Vr.a,Er.a,xr.a,wr.a,Wr.a,Nr.a,Pr.a,Mr.a,Lr.a,c.d,o.b]);var Qr=n("ebvF"),Fr=n("tyNb"),Br=n("gzBp"),$r=n("FSxY"),Ur=n("gm23"),Yr=n("0mgW"),Kr=n("mrSG"),Hr=n("2Vo4"),Gr=n("itXk"),zr=n("EY2u"),qr=n("LRne"),Xr=n("Cfvw"),Zr=n("/uUt"),Jr=n("zp1y"),ei=n("3E0/"),ti=n("eIep"),ni=n("JIr8"),ri=n("IzEk"),ii=n("TwVa"),oi=n("+/Tu"),ai=n("S09V"),ci=n("SMdK"),si=n("SpoB"),li=n("VnnJ"),ui=n("B1Ao"),bi=n("Kd2e");function di(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div",19),d.ic("click",(function(e){d.Fc(n);var r=t.$implicit,i=d.lc().$implicit;return d.lc().closeModal(i,r)})),d.Wb(1,"div",20),d.Rb(2,"j-entity-logo",21),d.mc(3,"bankFromAccount"),d.Vb(),d.Wb(4,"div",22),d.Wb(5,"p",23),d.Qc(6),d.Vb(),d.Wb(7,"p",24),d.Qc(8),d.mc(9,"bankFromAccount"),d.mc(10,"bankFromAccount"),d.Vb(),d.Vb(),d.Vb()}if(2&e){var r=t.$implicit;d.Ab(2),d.rc("name",d.nc(3,4,r.iban)),d.Ab(4),d.Sc("\u0421\u0447\u0435\u0442: ",r.iban,""),d.Ab(2),d.Tc(" ",d.nc(9,6,r.iban),": ",d.oc(10,8,r.iban,"name")," ")}}function mi(e,t){if(1&e&&(d.Wb(0,"li"),d.Wb(1,"div",15),d.Wb(2,"p",16),d.Qc(3),d.Vb(),d.Wb(4,"p",17),d.Qc(5),d.Vb(),d.Oc(6,di,11,11,"div",18),d.Vb(),d.Vb()),2&e){var n=t.$implicit;d.Ab(3),d.Rc(n.name),d.Ab(2),d.Sc("\u0418\u0418\u041d/\u0411\u0418\u041d: ",n.iinOrBin,""),d.Ab(1),d.rc("ngForOf",n.accounts)}}function pi(e,t){1&e&&(d.Wb(0,"div"),d.Wb(1,"p",25),d.Qc(2,"\u041f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"),d.Vb(),d.Vb())}var fi,hi=((fi=function(){function e(t,n,r){_classCallCheck(this,e),this.paymentsS=t,this.recipients=n,this.modal=r,this.collectionSize$=new Hr.a(0),this.currentPage$=new Hr.a(0),this.pageSize=10}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.recipients.getRecipients(),this.search=new i.h(""),this.list$=Object(Gr.a)([this.recipients.store.items$.pipe(Object(fe.a)((function(e){return e.filter((function(e){return!!e.accounts}))}))),this.search.valueChanges.pipe(Object(me.a)(100),Object(Zr.a)(),Object(be.a)(this.search.value)),this.currentPage$]).pipe(Object(fe.a)((function(t){var n=_slicedToArray(t,3),r=n[0],i=n[1],o=n[2],a=e.recipients.filterRecipients(r,i);return e.collectionSize$.next(a.length>e.pageSize?a.length-e.pageSize:a.length),a.slice(o>1?o*e.pageSize:0,(o+1)*e.pageSize)})))}},{key:"onClose",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(e,t){this.modal.close({recipient:e,account:t})}},{key:"page",get:function(){return this.currentPage$.getValue()},set:function(e){this.currentPage$.next(e)}}]),e}()).\u0275fac=function(e){return new(e||fi)(d.Qb(Yr.c),d.Qb(ui.a),d.Qb(a.a))},fi.\u0275cmp=d.Kb({type:fi,selectors:[["j-recipients-dictionary"]],decls:21,vars:17,consts:[[1,"dictionary-modal"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body"],[1,"form-group"],["clearable","true"],["jPrefix","","viewBox","0 0 24 24","name","search",1,"ttext-gray","d-block","mt-n1"],["type","text","jFormInput","","placeholder","\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u043a\u043e\u0434\u0443",1,"form-control",3,"formControl"],[1,"dictionary-modal--list"],[1,"scrolled"],[1,"scrolled--content"],[1,"list-unstyled"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"page","maxSize","rotate","pageSize","collectionSize","pageChange"],[1,"recipient-dict-item"],[1,"recipient-title"],[1,"small","text-gray","mb-2"],["class","account-pill account-pill_gray account-pill_fill",3,"click",4,"ngFor","ngForOf"],[1,"account-pill","account-pill_gray","account-pill_fill",3,"click"],[1,"account-pill--logo"],[3,"name"],[1,"account-pill--content","small"],[1,"wrap-text"],[1,"wrap-text","text-gray"],[1,"text-center","text-light","light"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"button",1),d.ic("click",(function(e){return t.modal.dismiss()})),d.Rb(2,"img",2),d.mc(3,"translate"),d.Vb(),d.Wb(4,"div",3),d.Wb(5,"h5"),d.Qc(6,"\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a"),d.Vb(),d.Wb(7,"div",4),d.Wb(8,"j-form-field",5),d.Rb(9,"j-icon",6),d.Rb(10,"input",7),d.Vb(),d.Vb(),d.Wb(11,"div",8),d.Wb(12,"div",9),d.Wb(13,"div",10),d.Wb(14,"ul",11),d.Oc(15,mi,7,3,"li",12),d.mc(16,"async"),d.Vb(),d.Oc(17,pi,3,0,"div",13),d.mc(18,"async"),d.Wb(19,"ngb-pagination",14),d.ic("pageChange",(function(e){return t.page=e})),d.mc(20,"async"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(2),d.sc("alt",d.nc(3,9,"SHARED.CLOSE")),d.Ab(8),d.rc("formControl",t.search),d.Ab(5),d.rc("ngForOf",d.nc(16,11,t.list$)),d.Ab(2),d.rc("ngIf",0===d.nc(18,13,t.list$).length),d.Ab(2),d.rc("page",t.page)("maxSize",5)("rotate",!0)("pageSize",t.pageSize)("collectionSize",d.nc(20,15,t.collectionSize$)))},directives:[Zt.a,Kt.a,tn.a,an.a,i.c,i.t,i.i,r.t,r.u,a.u,_n.a],pipes:[c.d,r.b,jr.a],styles:[".recipient-dict-item{padding:1rem 0}.recipient-dict-item .recipient-title{font-weight:500;font-size:16px}.recipient-dict-item .account-pill{margin-top:.5rem}.recipient-dict-item p{margin-bottom:.5em;line-height:1.4}"],encapsulation:2}),fi),vi=n("bHA9");function gi(e,t){if(1&e){var n=d.Xb();d.Wb(0,"li",14),d.ic("click",(function(e){d.Fc(n);var r=t.$implicit;return d.lc().closeModal(r)})),d.Wb(1,"div",15),d.Qc(2),d.Vb(),d.Vb()}if(2&e){var r=t.$implicit;d.Ab(2),d.Rc(r.label)}}function yi(e,t){1&e&&(d.Wb(0,"div"),d.Wb(1,"p",16),d.Qc(2,"\u041a\u041d\u041f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"),d.Vb(),d.Vb())}var Ci,ki=((Ci=function(){function e(t,n,r){_classCallCheck(this,e),this.paymentsS=t,this.dictionaries=n,this.modal=r}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.search=new i.h(""),this.list$=Object(Gr.a)([this.dictionaries.KNPDictionary.items$,this.search.valueChanges.pipe(Object(me.a)(100),Object(Zr.a)(),Object(be.a)(this.search.value))]).pipe(Object(fe.a)((function(t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return e.paymentType?e.dictionaries.selectByPaymentType(r,{type:e.paymentType}).filter((function(t){return e.paymentsS.genericSearchTerm(i,t)})).sort((function(e,t){return e.code>t.code?1:-1})):r.filter((function(t){return e.paymentsS.genericSearchTerm(i,t)})).sort((function(e,t){return e.code>t.code?1:-1}))})))}},{key:"closeModal",value:function(e){this.modal.close(e)}}]),e}()).\u0275fac=function(e){return new(e||Ci)(d.Qb(Yr.c),d.Qb(vi.a),d.Qb(a.a))},Ci.\u0275cmp=d.Kb({type:Ci,selectors:[["j-knp-dictionary"]],inputs:{paymentType:"paymentType"},decls:18,vars:7,consts:[[1,"dictionary-modal"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg"],[1,"modal-body"],[1,"form-group"],["clearable","true"],["jPrefix","","name","search",1,"text-gray","d-block","mt-n1"],["type","text","jFormInput","","placeholder","\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u043a\u043e\u0434\u0443",1,"form-control",3,"formControl"],[1,"dictionary-modal--list"],[1,"scrolled"],[1,"scrolled--content"],[1,"list-unstyled"],["class","j-option-label ",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"j-option-label",3,"click"],[1,""],[1,"text-center","text-light","light"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"button",1),d.ic("click",(function(e){return t.modal.dismiss()})),d.Rb(2,"img",2),d.Vb(),d.Wb(3,"div",3),d.Wb(4,"h5"),d.Qc(5,"\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a"),d.Vb(),d.Wb(6,"div",4),d.Wb(7,"j-form-field",5),d.Rb(8,"j-icon",6),d.Rb(9,"input",7),d.Vb(),d.Vb(),d.Wb(10,"div",8),d.Wb(11,"div",9),d.Wb(12,"div",10),d.Wb(13,"ul",11),d.Oc(14,gi,3,1,"li",12),d.mc(15,"async"),d.Vb(),d.Oc(16,yi,3,0,"div",13),d.mc(17,"async"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(9),d.rc("formControl",t.search),d.Ab(5),d.rc("ngForOf",d.nc(15,3,t.list$)),d.Ab(2),d.rc("ngIf",0===d.nc(17,5,t.list$).length))},directives:[Zt.a,Kt.a,tn.a,an.a,i.c,i.t,i.i,r.t,r.u],pipes:[r.b],styles:[""],encapsulation:2}),Ci);function Ai(e,t){if(1&e){var n=d.Xb();d.Wb(0,"li",14),d.ic("click",(function(e){d.Fc(n);var r=t.$implicit;return d.lc().closeModal(r)})),d.Wb(1,"p",15),d.Qc(2),d.Vb(),d.Wb(3,"p",16),d.Qc(4),d.Vb(),d.Vb()}if(2&e){var r=t.$implicit;d.Ab(2),d.Rc(r.label),d.Ab(2),d.Sc("\u0411\u0418\u041d: ",r.bin,"")}}function Ti(e,t){1&e&&(d.Wb(0,"div"),d.Wb(1,"p",17),d.Qc(2,"\u0423\u0413\u0414 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"),d.Vb(),d.Vb())}var Ri,_i=((Ri=function(){function e(t,n,r){_classCallCheck(this,e),this.paymentsS=t,this.dictionaries=n,this.modal=r}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.search=new i.h(""),this.list$=Object(Gr.a)(this.dictionaries.UGDictionary.items$,this.search.valueChanges.pipe(Object(me.a)(100),Object(Zr.a)(),Object(be.a)(this.search.value))).pipe(Object(fe.a)((function(t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return r.filter((function(t){return e.paymentsS.ugdSearchFn(i,t)}))})))}},{key:"closeModal",value:function(e){this.modal.close(e)}}]),e}()).\u0275fac=function(e){return new(e||Ri)(d.Qb(Yr.c),d.Qb(vi.a),d.Qb(a.a))},Ri.\u0275cmp=d.Kb({type:Ri,selectors:[["j-ugd-dictionary"]],decls:19,vars:10,consts:[[1,"dictionary-modal"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body"],[1,"form-group"],["clearable","true"],["jPrefix","","name","search",1,"text-gray","d-block","mt-n1"],["type","text","jFormInput","","placeholder","\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u043a\u043e\u0434\u0443",1,"form-control",3,"formControl"],[1,"dictionary-modal--list"],[1,"scrolled"],[1,"scrolled--content"],[1,"list-unstyled"],["class","j-option-label",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"j-option-label",3,"click"],[1,"m-0","text-wrap"],[1,"p3","text-gray","m-0"],[1,"text-center","text-light","light"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"button",1),d.ic("click",(function(e){return t.modal.dismiss()})),d.Rb(2,"img",2),d.mc(3,"translate"),d.Vb(),d.Wb(4,"div",3),d.Wb(5,"h5"),d.Qc(6,"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e, \u043a\u043e\u0434\u0443 \u0438 \u0411\u0418\u041d-\u0443 \u0423\u0413\u0414"),d.Vb(),d.Wb(7,"div",4),d.Wb(8,"j-form-field",5),d.Rb(9,"j-icon",6),d.Rb(10,"input",7),d.Vb(),d.Vb(),d.Wb(11,"div",8),d.Wb(12,"div",9),d.Wb(13,"div",10),d.Wb(14,"ul",11),d.Oc(15,Ai,5,2,"li",12),d.mc(16,"async"),d.Vb(),d.Oc(17,Ti,3,0,"div",13),d.mc(18,"async"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(2),d.sc("alt",d.nc(3,4,"SHARED.CLOSE")),d.Ab(8),d.rc("formControl",t.search),d.Ab(5),d.rc("ngForOf",d.nc(16,6,t.list$)),d.Ab(2),d.rc("ngIf",0===d.nc(18,8,t.list$).length))},directives:[Zt.a,Kt.a,tn.a,an.a,i.c,i.t,i.i,r.t,r.u],pipes:[c.d,r.b],styles:[""],encapsulation:2}),Ri),Si=n("HghS");function ji(e,t){if(1&e){var n=d.Xb();d.Wb(0,"li",14),d.Wb(1,"div",15),d.ic("click",(function(e){d.Fc(n);var r=t.$implicit;return d.lc().closeModal(r)})),d.Wb(2,"div",16),d.Rb(3,"j-entity-logo",17),d.Vb(),d.Wb(4,"div",18),d.Wb(5,"p",19),d.Qc(6),d.Vb(),d.Wb(7,"p",20),d.Qc(8),d.Vb(),d.Vb(),d.Vb(),d.Vb()}if(2&e){var r=t.$implicit;d.Ab(3),d.rc("name",r.bic),d.Ab(3),d.Rc(r.salaryTransitIban?"\u0421\u0447\u0435\u0442: "+r.salaryTransitIban:r.name),d.Ab(2),d.Tc("",r.bic,": ",r.name,"")}}function Oi(e,t){1&e&&(d.Wb(0,"div"),d.Wb(1,"p",21),d.Qc(2,"\u0411\u0430\u043d\u043a \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d"),d.Vb(),d.Vb())}var Ii,Vi=((Ii=function(){function e(t,n,r){_classCallCheck(this,e),this.modal=t,this.paymentsS=n,this.dict=r}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.search=new i.h(""),this.list$=Object(Gr.a)(this.dict.bankDictionary.items$,this.search.valueChanges.pipe(Object(me.a)(100),Object(Zr.a)(),Object(be.a)(this.search.value))).pipe(Object(fe.a)((function(t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return r.filter((function(t){return e.paymentsS.bankReceiverSearchFn(i,t)}))})))}},{key:"closeModal",value:function(e){this.modal.close(e)}}]),e}()).\u0275fac=function(e){return new(e||Ii)(d.Qb(a.a),d.Qb(Yr.c),d.Qb(vi.a))},Ii.\u0275cmp=d.Kb({type:Ii,selectors:[["j-banks-receivers"]],decls:19,vars:10,consts:[[1,"dictionary-modal"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body"],[1,"form-group"],["clearable","true"],["jPrefix","","name","search",1,"text-gray","d-block","mt-n1"],["type","text","jFormInput","","placeholder","\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e, IBAN \u0438\u043b\u0438 \u0411\u0418\u041a-\u0443",1,"form-control",3,"formControl"],[1,"dictionary-modal--list"],[1,"scrolled"],[1,"scrolled--content"],[1,"list-unstyled"],["class","mb-2",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"mb-2"],[1,"account-pill","account-pill_gray","account-pill_fill",3,"click"],[1,"account-pill--logo"],[3,"name"],[1,"account-pill--content","small"],[1,"wrap-text"],[1,"wrap-text","text-gray"],[1,"text-center","text-light","light"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"button",1),d.ic("click",(function(e){return t.modal.dismiss()})),d.Rb(2,"img",2),d.mc(3,"translate"),d.Vb(),d.Wb(4,"div",3),d.Wb(5,"h5"),d.Qc(6,"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e, IBAN \u0438 \u0411\u0418\u041a-\u0443"),d.Vb(),d.Wb(7,"div",4),d.Wb(8,"j-form-field",5),d.Rb(9,"j-icon",6),d.Rb(10,"input",7),d.Vb(),d.Vb(),d.Wb(11,"div",8),d.Wb(12,"div",9),d.Wb(13,"div",10),d.Wb(14,"ul",11),d.Oc(15,ji,9,4,"li",12),d.mc(16,"async"),d.Vb(),d.Oc(17,Oi,3,0,"div",13),d.mc(18,"async"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(2),d.sc("alt",d.nc(3,4,"SHARED.CLOSE")),d.Ab(8),d.rc("formControl",t.search),d.Ab(5),d.rc("ngForOf",d.nc(16,6,t.list$)),d.Ab(2),d.rc("ngIf",!d.nc(18,8,t.list$)))},directives:[Zt.a,Kt.a,tn.a,an.a,i.c,i.t,i.i,r.t,r.u,_n.a],pipes:[c.d,r.b],styles:[""]}),Ii);function Ei(e,t){if(1&e){var n=d.Xb();d.Wb(0,"li",14),d.ic("click",(function(e){d.Fc(n);var r=t.$implicit;return d.lc().closeModal(r)})),d.Wb(1,"div",15),d.Qc(2),d.Vb(),d.Vb()}if(2&e){var r=t.$implicit;d.Ab(2),d.Rc(r.label||r.description)}}function xi(e,t){1&e&&(d.Wb(0,"div"),d.Wb(1,"p",16),d.Qc(2,"\u042d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043d\u044b"),d.Vb(),d.Vb())}var wi,Wi,Ni,Pi=((wi=function(){function e(t,n){_classCallCheck(this,e),this.paymentsS=t,this.modal=n,this.searchPlaceholder="\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u043a\u043e\u0434\u0443",this.title="\u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a"}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.search=new i.h(""),this.list$=Object(Gr.a)(this.store.items$,this.search.valueChanges.pipe(Object(me.a)(100),Object(Zr.a)(),Object(be.a)(this.search.value))).pipe(Object(fe.a)((function(t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return r.filter((function(t){return e.searchFn?e.searchFn(i,t):e.paymentsS.genericSearchTerm(i,t)}))})))}},{key:"closeModal",value:function(e){this.modal.close(e)}}]),e}()).\u0275fac=function(e){return new(e||wi)(d.Qb(Yr.c),d.Qb(a.a))},wi.\u0275cmp=d.Kb({type:wi,selectors:[["j-generic-dictionary"]],inputs:{store:"store",searchFn:"searchFn",searchPlaceholder:"searchPlaceholder",title:"title"},decls:19,vars:11,consts:[[1,"dictionary-modal"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body"],[1,"form-group"],["clearable","true"],["jPrefix","","name","search",1,"text-gray","d-block","mt-n1"],["type","text","jFormInput","","placeholder","\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044e \u0438\u043b\u0438 \u043a\u043e\u0434\u0443",1,"form-control",3,"formControl"],[1,"dictionary-modal--list"],[1,"scrolled"],[1,"scrolled--content"],[1,"list-unstyled"],["class","j-option-label ",3,"click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"j-option-label",3,"click"],[1,""],[1,"text-center","text-light","light"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"button",1),d.ic("click",(function(e){return t.modal.dismiss()})),d.Rb(2,"img",2),d.mc(3,"translate"),d.Vb(),d.Wb(4,"div",3),d.Wb(5,"h5"),d.Qc(6),d.Vb(),d.Wb(7,"div",4),d.Wb(8,"j-form-field",5),d.Rb(9,"j-icon",6),d.Rb(10,"input",7),d.Vb(),d.Vb(),d.Wb(11,"div",8),d.Wb(12,"div",9),d.Wb(13,"div",10),d.Wb(14,"ul",11),d.Oc(15,Ei,3,1,"li",12),d.mc(16,"async"),d.Vb(),d.Oc(17,xi,3,0,"div",13),d.mc(18,"async"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(2),d.sc("alt",d.nc(3,5,"SHARED.CLOSE")),d.Ab(4),d.Rc(t.title),d.Ab(4),d.rc("formControl",t.search),d.Ab(5),d.rc("ngForOf",d.nc(16,7,t.list$)),d.Ab(2),d.rc("ngIf",0===d.nc(18,9,t.list$).length))},directives:[Zt.a,Kt.a,tn.a,an.a,i.c,i.t,i.i,r.t,r.u],pipes:[c.d,r.b],styles:[""],encapsulation:2}),wi),Mi=n("Stn5"),Li=((Ni=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Ni)},Ni.\u0275cmp=d.Kb({type:Ni,selectors:[["j-bic-info"]],decls:15,vars:0,consts:[[1,"p4"]],template:function(e,t){1&e&&(d.Wb(0,"article",0),d.Wb(1,"p"),d.Wb(2,"strong"),d.Qc(3," SWIFT \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 11 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432. \u0415\u0441\u043b\u0438 \u0443\u043a\u0430\u0437\u0430\u043d\u043e 8-\u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432, \u0432 \u043a\u043e\u043d\u0446\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0425\u0425\u0425 "),d.Vb(),d.Vb(),d.Wb(4,"p"),d.Qc(5," \u041f\u0440\u0438\u043c\u0435\u0440: "),d.Rb(6,"br"),d.Qc(7," \u2022 COBADEFFXXX - COMMERZBANK AG "),d.Vb(),d.Wb(8,"p"),d.Wb(9,"strong"),d.Qc(10," BIC \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 9 \u0446\u0438\u0444\u0440 "),d.Vb(),d.Vb(),d.Wb(11,"p"),d.Qc(12," \u041f\u0440\u0438\u043c\u0435\u0440: "),d.Rb(13,"br"),d.Qc(14," \u2022 044525225 - \u0410\u041e \u0421\u0431\u0435\u0440\u0431\u0430\u043d\u043a "),d.Vb(),d.Vb())},styles:[""]}),Ni),Di=((Wi=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Wi)},Wi.\u0275cmp=d.Kb({type:Wi,selectors:[["j-iban-info"]],decls:4,vars:0,consts:[["translate","",1,"p2","font-weight-medium"],["translate","",1,"p4"]],template:function(e,t){1&e&&(d.Wb(0,"p",0),d.Qc(1,"CURRENCY_PAYMENT.RECIPIENT.IBAN_INFO.TITLE"),d.Vb(),d.Wb(2,"p",1),d.Qc(3,"CURRENCY_PAYMENT.RECIPIENT.IBAN_INFO.DESCRIPTION"),d.Vb())},directives:[c.a],styles:[""]}),Wi),Qi=n("quSY"),Fi=n("O/Ur"),Bi=["input"],$i=function(){return{width:"100%",height:"56px","background-color":"#ECEEF1"}};function Ui(e,t){1&e&&(d.Wb(0,"div",7),d.Rb(1,"ngx-skeleton-loader",8),d.Vb()),2&e&&(d.Ab(1),d.rc("theme",d.vc(1,$i)))}function Yi(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div",10),d.ic("click",(function(e){d.Fc(n);var r=t.$implicit;return d.lc(2).onBankSelect(r)})),d.Qc(1),d.Vb()}if(2&e){var r=t.$implicit,i=d.lc(2);d.Ab(1),d.Sc(" ",i.mapBankLabel(r)," ")}}function Ki(e,t){if(1&e&&(d.Wb(0,"div",7),d.Oc(1,Yi,2,1,"div",9),d.Vb()),2&e){var n=d.lc();d.Ab(1),d.rc("ngForOf",n.banks)}}function Hi(e,t){1&e&&(d.Ub(0),d.Rb(1,"j-empty-placeholder",13),d.Tb())}function Gi(e,t){if(1&e&&(d.Qc(0),d.mc(1,"translate")),2&e){var n=d.lc(2);d.Sc(" ",d.nc(1,1,n.placeholderText)," ")}}function zi(e,t){if(1&e&&(d.Wb(0,"div",7),d.Oc(1,Hi,2,0,"ng-container",11),d.Oc(2,Gi,2,3,"ng-template",null,12,d.Pc),d.Vb()),2&e){var n=d.Cc(3),r=d.lc();d.Ab(1),d.rc("ngIf",(null==r.labelControl?null:null==r.labelControl.value?null:r.labelControl.value.length)>0)("ngIfElse",n)}}function qi(e,t){1&e&&d.Rb(0,"j-bic-info")}var Xi,Zi=((Xi=function(){function e(t){_classCallCheck(this,e),this.currencyPaymentService=t,this.labelText="CURRENCY_PAYMENT.RECIPIENT.BIC",this.placeholderText="CURRENCY_PAYMENT.RECIPIENT.NO_BIC_ENTERED",this.isLoading=!1,this.isBicFocused=!1,this.subscription=new Qi.a}return _createClass(e,[{key:"selectByBic",value:function(e){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.retrieveBanks(e);case 2:if(!(n=this.banks.find((function(t){return t.bic==e})))){t.next=5;break}return t.abrupt("return",this.onBankSelect(n));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"ngOnInit",value:function(){this.listenBankSearch()}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"focus",value:function(){var e=this;setTimeout((function(){e.input.nativeElement.focus()}),100)}},{key:"onBicFocus",value:function(e){this.isBicFocused=!0,this.labelControl.setValue(""),this.banks=[]}},{key:"onBicBlur",value:function(e){var t=this;setTimeout((function(){t.isBicFocused=!1}),300)}},{key:"mapBankLabel",value:function(e){return"".concat(e.bic," - ").concat(e.name)}},{key:"onBankSelect",value:function(e){this.labelControl.setValue(this.mapBankLabel(e),{emitEvent:!1}),this.bankControl.setValue(e)}},{key:"listenBankSearch",value:function(){var e,t=this;this.subscription.add(null===(e=this.labelControl)||void 0===e?void 0:e.valueChanges.pipe(Object(me.a)(300)).pipe(Object(Zr.a)()).subscribe((function(e){var n;(null===(n=e)||void 0===n?void 0:n.length)>=1&&t.retrieveBanks(e,t.countryCode)})))}},{key:"retrieveBanks",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return this.isLoading=!0,i=(null===(t=n)||void 0===t?void 0:t.substring(0,2))||null,r.prev=2,r.next=5,this.currencyPaymentService.getBanks(e,i);case 5:this.banks=r.sent,r.next=10;break;case 8:r.prev=8,r.t0=r.catch(2);case 10:return r.prev=10,this.isLoading=!1,r.finish(10);case 13:case"end":return r.stop()}}),r,this,[[2,8,10,13]])})))}}]),e}()).\u0275fac=function(e){return new(e||Xi)(d.Qb(Fi.b))},Xi.\u0275cmp=d.Kb({type:Xi,selectors:[["j-foreign-bank-select"]],viewQuery:function(e,t){var n;1&e&&d.Vc(Bi,!0),2&e&&d.Bc(n=d.jc())&&(t.input=n.first)},inputs:{labelControl:"labelControl",bankControl:"bankControl",countryCode:"countryCode",errorMessages:"errorMessages",labelText:"labelText",placeholderText:"placeholderText"},decls:14,vars:14,consts:[["type","text","jFormInput","","jFocusOnReturn","",1,"form-control","bic-input",3,"formControl","focus","blur"],["input",""],["href","javascript:void(0)","jSuffix","","tooltipClass","tooltip-light tooltip-medium","triggers","mouseenter:mouseleave",1,"mr-1","link-gray",3,"ngbTooltip","inlineSVG"],[3,"control","errorMessages"],[1,"bic-dropdown",3,"hidden"],["class","bic-dropdown-body",4,"ngIf"],["bicInfo",""],[1,"bic-dropdown-body"],["count","4",3,"theme"],["class","j-option-label text-wrap",3,"click",4,"ngFor","ngForOf"],[1,"j-option-label","text-wrap",3,"click"],[4,"ngIf","ngIfElse"],["placeholder",""],["label","SHARED.SEARCH_NOT_FOUND"]],template:function(e,t){if(1&e&&(d.Wb(0,"j-form-field"),d.Wb(1,"j-label"),d.Qc(2),d.mc(3,"translate"),d.Vb(),d.Wb(4,"input",0,1),d.ic("focus",(function(e){return t.onBicFocus(e)}))("blur",(function(e){return t.onBicBlur(e)})),d.Vb(),d.Rb(6,"a",2),d.Rb(7,"j-error",3),d.Vb(),d.Wb(8,"div",4),d.Oc(9,Ui,2,2,"div",5),d.Oc(10,Ki,2,1,"div",5),d.Oc(11,zi,4,2,"div",5),d.Vb(),d.Oc(12,qi,1,0,"ng-template",null,6,d.Pc)),2&e){var n=d.Cc(13);d.Ab(2),d.Rc(d.nc(3,12,t.labelText)),d.Ab(2),d.Hb("has-dropdown",null==t.banks?null:t.banks.length),d.rc("formControl",t.labelControl),d.Ab(2),d.rc("ngbTooltip",n)("inlineSVG","/assets/icons/payments/question.svg"),d.Ab(1),d.rc("control",t.labelControl)("errorMessages",t.errorMessages),d.Ab(1),d.rc("hidden",!t.isBicFocused),d.Ab(1),d.rc("ngIf",t.isLoading),d.Ab(1),d.rc("ngIf",!t.isLoading&&(null==t.banks?null:t.banks.length)),d.Ab(1),d.rc("ngIf",!(t.isLoading||null!=t.banks&&t.banks.length))}},directives:[Zt.a,en.a,an.a,i.c,Ot.a,i.t,i.i,nn.a,a.E,gr.a,on.a,r.u,s.a,r.t,Vn.a,Li],pipes:[c.d],styles:["[_nghost-%COMP%]{display:block;position:relative}.bic-dropdown[_ngcontent-%COMP%]{border-radius:0 8px 8px 0;left:0;right:0;padding:1.5rem;background:#fff;position:absolute;max-height:300px;height:30vh;z-index:1000;box-shadow:0 14px 16px rgba(0,0,0,.05)}.bic-dropdown[_ngcontent-%COMP%]   .j-option-label[_ngcontent-%COMP%]{cursor:pointer}.bic-input.has-dropdown[_ngcontent-%COMP%]{border-radius:8px 0 0 8px}.bic-dropdown-body[_ngcontent-%COMP%]{top:0;right:0;left:0;bottom:0;height:100%;overflow-y:auto;padding-right:.5rem}.bic-dropdown-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.bic-dropdown-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#fff}.bic-dropdown-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#b7bec5;border-radius:10px}"]}),Xi);function Ji(e,t){if(1&e&&(d.Wb(0,"div",32),d.Qc(1),d.Vb()),2&e){var n=d.lc(2);d.Ab(1),d.Rc(n.primaryRecipient.name)}}function eo(e,t){if(1&e&&(d.Wb(0,"div",26),d.Wb(1,"div",27),d.Wb(2,"span",28),d.Qc(3,"CURRENCY_PAYMENT.CONTRACTS.DETAILS.CONTRACT_TYPE"),d.Vb(),d.Qc(4,": "),d.Vb(),d.Wb(5,"div",29),d.Qc(6),d.Vb(),d.Vb()),2&e){var n=d.lc(2);d.Ab(6),d.Sc(" ",n.contract.type.description," ")}}function to(e,t){if(1&e&&(d.Wb(0,"div",26),d.Wb(1,"div",27),d.Wb(2,"span",28),d.Qc(3,"CONTRACTS.DETAILS.UNK"),d.Vb(),d.Qc(4,": "),d.Vb(),d.Wb(5,"div",29),d.Qc(6),d.Vb(),d.Vb()),2&e){var n=d.lc(2);d.Ab(6),d.Sc(" ",n.contract.registrationNumberContract," ")}}function no(e,t){if(1&e&&(d.Wb(0,"div",26),d.Wb(1,"div",27),d.Wb(2,"span",28),d.Qc(3,"CONTRACTS.DETAILS.UNK_DATE"),d.Vb(),d.Qc(4,": "),d.Vb(),d.Wb(5,"div",29),d.Qc(6),d.mc(7,"date"),d.Vb(),d.Vb()),2&e){var n=d.lc(2);d.Ab(6),d.Sc(" ",d.oc(7,1,n.contract.documentDate,"d MMMM yyyy")," ")}}function ro(e,t){1&e&&(d.Wb(0,"span"),d.Qc(1," 1"),d.Vb())}function io(e,t){if(1&e&&(d.Wb(0,"section",20),d.Wb(1,"j-collapsible"),d.Wb(2,"j-collapsible-trigger"),d.Wb(3,"div",21),d.Wb(4,"h5",11),d.Wb(5,"span",28),d.Qc(6,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.TITLE"),d.Vb(),d.Oc(7,ro,2,0,"span",33),d.Vb(),d.Rb(8,"span",23),d.Vb(),d.Vb(),d.Wb(9,"j-collapsible-body"),d.Wb(10,"div",24),d.Wb(11,"div",26),d.Wb(12,"div",27),d.Wb(13,"span",28),d.Qc(14,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.NAME"),d.Vb(),d.Qc(15,": "),d.Vb(),d.Wb(16,"div",29),d.Qc(17),d.Vb(),d.Vb(),d.Wb(18,"div",26),d.Wb(19,"div",27),d.Wb(20,"span",28),d.Qc(21,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.COUNTRY"),d.Vb(),d.Qc(22,": "),d.Vb(),d.Wb(23,"div",29),d.Qc(24),d.Vb(),d.Vb(),d.Wb(25,"div",26),d.Wb(26,"div",27),d.Wb(27,"span",28),d.Qc(28,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.CITY"),d.Vb(),d.Qc(29,": "),d.Vb(),d.Wb(30,"div",29),d.Qc(31),d.Vb(),d.Vb(),d.Wb(32,"div",26),d.Wb(33,"div",27),d.Wb(34,"span",28),d.Qc(35,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.BANK"),d.Vb(),d.Qc(36,": "),d.Vb(),d.Wb(37,"div",29),d.Qc(38),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e){var n=d.lc(2);d.Ab(7),d.rc("ngIf",(null==n.extraRecipients?null:n.extraRecipients.length)>0),d.Ab(10),d.Sc(" ",n.primaryRecipient.name," "),d.Ab(7),d.Sc(" ",n.mapCountry(n.primaryRecipient)," "),d.Ab(7),d.Sc(" ",n.primaryRecipient.cityName||n.primaryRecipient.defaultCityName||"-"," "),d.Ab(7),d.Sc(" ",n.mapBank(n.primaryRecipient)," ")}}function oo(e,t){if(1&e&&(d.Wb(0,"section",20),d.Wb(1,"j-collapsible"),d.Wb(2,"j-collapsible-trigger"),d.Wb(3,"div",21),d.Wb(4,"h5",11),d.Wb(5,"span",28),d.Qc(6,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.TITLE"),d.Vb(),d.Wb(7,"span"),d.Qc(8),d.Vb(),d.Vb(),d.Rb(9,"span",23),d.Vb(),d.Vb(),d.Wb(10,"j-collapsible-body"),d.Wb(11,"div",24),d.Wb(12,"div",26),d.Wb(13,"div",27),d.Wb(14,"span",28),d.Qc(15,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.NAME"),d.Vb(),d.Qc(16,": "),d.Vb(),d.Wb(17,"div",29),d.Qc(18),d.Vb(),d.Vb(),d.Wb(19,"div",26),d.Wb(20,"div",27),d.Wb(21,"span",28),d.Qc(22,"CURRENCY_PAYMENT.CONTRACTS.RECIPIENT.COUNTRY"),d.Vb(),d.Qc(23,": "),d.Vb(),d.Wb(24,"div",29),d.Qc(25),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e){var n=t.$implicit,r=t.index,i=d.lc(2);d.Ab(8),d.Sc(" ",r+2,""),d.Ab(10),d.Sc(" ",n.name," "),d.Ab(7),d.Sc(" ",i.mapCountry(n)," ")}}function ao(e,t){if(1&e){var n=d.Xb();d.Wb(0,"section",1),d.Wb(1,"div",2),d.ic("click",(function(e){return d.Fc(n),d.lc().close()})),d.Vb(),d.Wb(2,"section",3),d.Wb(3,"section",4),d.Wb(4,"article",5),d.Rb(5,"span",6),d.Wb(6,"span",7),d.Qc(7,"CURRENCY_PAYMENT.CONTRACTS.STATUS.REGED"),d.Vb(),d.Vb(),d.Wb(8,"a",8),d.ic("click",(function(e){return d.Fc(n),d.lc().close(e)})),d.Vb(),d.Vb(),d.Wb(9,"section",9),d.Wb(10,"section",10),d.Wb(11,"h3",11),d.Wb(12,"span",12),d.Qc(13,"\u2116"),d.Vb(),d.Qc(14),d.Vb(),d.Oc(15,Ji,2,1,"div",13),d.Wb(16,"div",14),d.Wb(17,"div",15),d.Rb(18,"small",16),d.Wb(19,"div",17),d.Rb(20,"j-money",18),d.Vb(),d.Vb(),d.Wb(21,"div",15),d.Rb(22,"small",19),d.Wb(23,"div",17),d.Rb(24,"j-money",18),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(25,"section",20),d.Wb(26,"j-collapsible"),d.Wb(27,"j-collapsible-trigger"),d.Wb(28,"div",21),d.Wb(29,"h5",22),d.Qc(30,"CURRENCY_PAYMENT.CONTRACTS.DETAILS.TITLE"),d.Vb(),d.Rb(31,"span",23),d.Vb(),d.Vb(),d.Wb(32,"j-collapsible-body"),d.Wb(33,"div",24),d.Oc(34,eo,7,1,"div",25),d.Wb(35,"div",26),d.Wb(36,"div",27),d.Wb(37,"span",28),d.Qc(38,"CURRENCY_PAYMENT.CONTRACTS.DETAILS.DATE_FROM"),d.Vb(),d.Qc(39,": "),d.Vb(),d.Wb(40,"div",29),d.Qc(41),d.mc(42,"date"),d.Vb(),d.Vb(),d.Wb(43,"div",26),d.Wb(44,"div",27),d.Wb(45,"span",28),d.Qc(46,"CURRENCY_PAYMENT.CONTRACTS.DETAILS.DATE_TO"),d.Vb(),d.Qc(47,": "),d.Vb(),d.Wb(48,"div",29),d.Qc(49),d.mc(50,"date"),d.Vb(),d.Vb(),d.Oc(51,to,7,1,"div",25),d.Oc(52,no,8,4,"div",25),d.Wb(53,"div",26),d.Wb(54,"div",27),d.Wb(55,"span",28),d.Qc(56,"CURRENCY_PAYMENT.CONTRACTS.DETAILS.CURRENCIES"),d.Vb(),d.Qc(57,": "),d.Vb(),d.Wb(58,"div",29),d.Qc(59),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Oc(60,io,39,5,"section",30),d.Oc(61,oo,26,3,"section",31),d.Vb(),d.Vb(),d.Vb()}if(2&e){var r=d.lc();d.Hb("is-shown",r.isShown),d.Ab(2),d.Hb("is-shown",r.isShown),d.Ab(3),d.rc("inlineSVG","/assets/icons/counterparty/status.svg"),d.Ab(9),d.Sc(" ",r.contract.contractNumber," "),d.Ab(1),d.rc("ngIf",0==(null==r.extraRecipients?null:r.extraRecipients.length)),d.Ab(5),d.rc("money",r.contract.amount),d.Ab(4),d.rc("money",r.contract.remainder),d.Ab(10),d.rc("ngIf",r.contract.type),d.Ab(7),d.Sc("",d.oc(42,17,r.contract.dateFrom,"d MMMM yyyy")," "),d.Ab(8),d.Sc("",d.oc(50,20,r.contract.dateTo,"d MMMM yyyy")," "),d.Ab(2),d.rc("ngIf",r.contract.registrationNumberContract),d.Ab(1),d.rc("ngIf",r.contract.documentDate),d.Ab(7),d.Sc("",r.contract.permittedCurrencies.join(", ")," "),d.Ab(1),d.rc("ngIf",r.primaryRecipient),d.Ab(1),d.rc("ngForOf",r.extraRecipients)}}var co,so=((co=function(){function e(t,n){_classCallCheck(this,e),this.document=t,this.translateService=n,this.isShown=!1}return _createClass(e,[{key:"mapBank",value:function(e){var t=e.bankBic,n=e.bankName;return"".concat(t).concat(t?n?"- ".concat(n):"":n||"")}},{key:"mapCountry",value:function(e){var t,n,r,i;if(e.country){var o=e.country.code,a="";switch(this.translateService.currentLang){case"ru":default:a=null===(t=e.country)||void 0===t?void 0:t.nameRu;case"kz":a=null===(n=e.country)||void 0===n?void 0:n.nameKk;case"en":a=null===(r=e.country)||void 0===r?void 0:r.nameEn}return"".concat(o," - ").concat(a)}return e.primary&&(null===(i=this.contract.contractor)||void 0===i?void 0:i.country)?"".concat(this.contract.contractor.country.code," - ").concat(this.contract.contractor.country.name):e.countryCode?e.countryCode:"-"}},{key:"ngOnDestroy",value:function(){this.close()}},{key:"show",value:function(){this.document.body.classList.add("overflow-hidden"),this.isShown=!0}},{key:"close",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===(e=t)||void 0===e||e.preventDefault(),this.document.body.classList.remove("overflow-hidden"),this.isShown=!1}},{key:"primaryRecipient",get:function(){var e;return null===(e=this.contract.recipients)||void 0===e?void 0:e.find((function(e){return e.primary}))}},{key:"extraRecipients",get:function(){var e;return null===(e=this.contract.recipients)||void 0===e?void 0:e.filter((function(e){return!e.primary}))}}]),e}()).\u0275fac=function(e){return new(e||co)(d.Qb(r.e),d.Qb(c.e))},co.\u0275cmp=d.Kb({type:co,selectors:[["j-fx-contract-details"]],inputs:{contract:"contract"},decls:1,vars:1,consts:[["class","f-page-wrapper",3,"is-shown",4,"ngIf"],[1,"f-page-wrapper"],[1,"f-page-backdrop",3,"click"],[1,"f-page-content","f-page-content--gray","f-page-content--quarter","fx"],[1,"fx__header"],[1,"fx__status"],[1,"text-success",3,"inlineSVG"],["translate","",1,"text-muted","ml-3","p3"],["href","#","inlineSVG","assets/icons/payments/close.svg",1,"fx__close","ml-auto",3,"click"],[1,"fx__scrollable"],[1,"fx__block","py-3","mt-0"],[1,"mb-0"],[1,"text-light"],["class","p2",4,"ngIf"],[1,"fx__amounts"],[1,"fx__amounts-item"],["translate","CURRENCY_PAYMENT.CONTRACTS.INFO.AMOUNT",1,"text-muted"],[1,"text-dark"],[3,"money"],["translate","CURRENCY_PAYMENT.CONTRACTS.INFO.REMAINDER",1,"text-muted","p4"],[1,"fx__block","fx__block--collapsible"],[1,"fx__collapse","d-flex","align-items-center"],["translate","",1,"mb-0"],["inlineSVG","assets/icons/payments/collapse.svg",1,"ml-auto","text-primary","fx__arrow"],[1,"fx__body","p2"],["class","j-desc-row",4,"ngIf"],[1,"j-desc-row"],[1,"text-muted","j-desc-child"],["translate",""],[1,"text-dark","j-desc-child"],["class","fx__block fx__block--collapsible",4,"ngIf"],["class","fx__block fx__block--collapsible",4,"ngFor","ngForOf"],[1,"p2"],[4,"ngIf"]],template:function(e,t){1&e&&d.Oc(0,ao,62,23,"section",0),2&e&&d.rc("ngIf",t.contract)},directives:[r.u,gr.a,c.a,Sn.a,Wn.a,Pn.a,Nn.a,r.t],pipes:[r.f],styles:[".fx{padding:1rem;width:100%;max-width:425px}.fx__header{-webkit-box-pack:justify;justify-content:space-between;margin-top:.5rem;margin-bottom:1.5rem}.fx__header,.fx__status{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}.fx__status{padding-left:1rem}.fx__scrollable{-webkit-box-flex:1;flex-grow:1;overflow-y:auto}.fx__scrollable::-webkit-scrollbar{width:8px}.fx__scrollable::-webkit-scrollbar-track{background:#fff}.fx__scrollable::-webkit-scrollbar-thumb{background:#d6dadf;border-radius:10px}.fx__collapse{padding:1rem 0}.j-collapsed .fx__body{padding-bottom:1rem}.j-collapsed .fx__collapse .fx__arrow{-webkit-transform:rotate(0deg);transform:rotate(0deg)}.fx__block{background:#fff;border-radius:.5rem;padding:1.5rem 1rem;margin:.75rem 0}.fx__block--collapsible{padding-top:0;padding-bottom:0}.fx__arrow,.fx__block--collapsible{-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.fx__arrow{-webkit-transform:rotate(540deg);transform:rotate(540deg)}.fx__collapse{cursor:pointer;-webkit-box-align:center;align-items:center}.fx__link{color:#1586bb;display:-webkit-box;display:flex;padding-left:1rem;padding-right:1rem;width:100%}.fx__link:hover{color:#ef5630}.fx__icon{margin-right:.5rem;display:block}.fx__amounts{display:-webkit-box;display:flex;border-top:1px solid #eceef1;margin-top:1.5rem;padding-top:1rem}.fx__amounts-item{-webkit-box-flex:1;flex-grow:1}.fx__amounts-item small{display:block;margin-bottom:.25rem}"],encapsulation:2}),co);function lo(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div",4),d.ic("click",(function(e){d.Fc(n);var r=t.$implicit;return d.lc().onSelect(r)})),d.Wb(1,"div",5),d.Rb(2,"span",6),d.Qc(3,": "),d.Rb(4,"span",7),d.mc(5,"highlight"),d.mc(6,"formatIban"),d.Vb(),d.Wb(7,"div",8),d.Rb(8,"span",7),d.mc(9,"highlight"),d.Qc(10,": "),d.Rb(11,"span",7),d.mc(12,"highlight"),d.Vb(),d.Vb()}if(2&e){var r=t.$implicit,i=d.lc();d.Ab(4),d.rc("innerHTML",d.oc(5,3,d.nc(6,6,r.iban),i.searchTerm),d.Gc),d.Ab(4),d.rc("innerHTML",d.oc(9,8,r.bic,i.searchTerm),d.Gc),d.Ab(3),d.rc("innerHTML",d.oc(12,11,r.bankName,i.searchTerm),d.Gc)}}var uo,bo=((uo=function(){function e(t){_classCallCheck(this,e),this.translateService=t,this.selected=new d.n}return _createClass(e,[{key:"onSelect",value:function(e){this.selected.emit({recipient:this.recipient,account:e})}},{key:"countryName",get:function(){var e,t,n,r,i,o;switch(this.translateService.currentLang){case"ru":default:return null===(t=null===(e=this.recipient)||void 0===e?void 0:e.country)||void 0===t?void 0:t.nameRu;case"kz":return null===(r=null===(n=this.recipient)||void 0===n?void 0:n.country)||void 0===r?void 0:r.nameKk;case"en":return null===(o=null===(i=this.recipient)||void 0===i?void 0:i.country)||void 0===o?void 0:o.nameEn}}}]),e}()).\u0275fac=function(e){return new(e||uo)(d.Qb(c.e))},uo.\u0275cmp=d.Kb({type:uo,selectors:[["j-foreign-recipient"]],inputs:{searchTerm:"searchTerm",recipient:"recipient"},outputs:{selected:"selected"},decls:6,vars:9,consts:[[1,"recipient"],[1,"text-dark","p2","recipient__name",3,"innerHTML"],[1,"text-muted","p3","recipient__country",3,"innerHTML"],["class","recipient__account p3",3,"click",4,"ngFor","ngForOf"],[1,"recipient__account","p3",3,"click"],[1,"text-dark"],["translate","CURRENCY_PAYMENT.DICTIONARY.IBAN"],[3,"innerHTML"],[1,"text-muted"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Rb(1,"h5",1),d.mc(2,"highlight"),d.Rb(3,"div",2),d.mc(4,"highlight"),d.Oc(5,lo,13,14,"div",3),d.Vb()),2&e&&(d.Ab(1),d.rc("innerHTML",d.oc(2,3,t.recipient.name,t.searchTerm),d.Gc),d.Ab(2),d.rc("innerHTML",d.oc(4,6,t.countryName,t.searchTerm),d.Gc),d.Ab(2),d.rc("ngForOf",t.recipient.accounts))},directives:[r.t,c.a],pipes:[Wr.a,Er.a],styles:[".dictionary[_ngcontent-%COMP%]{padding:40px 24px;max-height:80vh;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.dictionary__header[_ngcontent-%COMP%]{flex-shrink:0;background:#fff}.dictionary__list[_ngcontent-%COMP%]{overflow-y:auto;-webkit-box-flex:1;flex-grow:1}.dictionary__heading[_ngcontent-%COMP%]{margin-bottom:18px}.dictionary__search[_ngcontent-%COMP%], .recipient[_ngcontent-%COMP%]{padding:16px 0}.recipient__name[_ngcontent-%COMP%]{margin-bottom:4px;line-height:24px}.recipient__country[_ngcontent-%COMP%]{margin-bottom:16px;line-height:18px}.recipient__account[_ngcontent-%COMP%]{padding:8px 16px;background:#f6f7f8;border-radius:8px;line-height:21px;cursor:pointer;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.recipient__account[_ngcontent-%COMP%]:hover{background:#e9ecf1}.recipient__account[_ngcontent-%COMP%] + .recipient__account[_ngcontent-%COMP%]{margin-top:8px}"]}),uo);function mo(e,t){1&e&&d.Rb(0,"j-empty-placeholder",9)}function po(e,t){1&e&&d.Rb(0,"j-empty-placeholder",10)}function fo(e,t){if(1&e){var n=d.Xb();d.Wb(0,"j-foreign-recipient",11),d.ic("selected",(function(e){return d.Fc(n),d.lc().onRecipientSelect(e)})),d.Vb()}if(2&e){var r=t.$implicit,i=d.lc();d.rc("recipient",r)("searchTerm",i.searchTerm)}}var ho,vo=((ho=function(){function e(t,n){_classCallCheck(this,e),this.modal=t,this.recipientsService=n,this.searchTerm="",this.loadRecipients()}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"loadRecipients",value:function(){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.recipientsService.getForeignRecipients();case 2:this.recipients=e.sent,this.filteredRecipients=_toConsumableArray(this.recipients);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"onQueryChange",value:function(e){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.searchTerm=e,t.next=3,this.recipientsService.getForeignRecipients(e);case 3:this.filteredRecipients=t.sent;case 4:case"end":return t.stop()}}),t,this)})))}},{key:"onRecipientSelect",value:function(e){this.modal.close(e)}},{key:"onClose",value:function(){this.modal.dismiss()}}]),e}()).\u0275fac=function(e){return new(e||ho)(d.Qb(a.a),d.Qb(ui.a))},ho.\u0275cmp=d.Kb({type:ho,selectors:[["j-foreign-recipients-dictionary"]],decls:9,vars:4,consts:[[1,"dictionary"],[1,"dictionary__header"],["translate","CURRENCY_PAYMENT.DICTIONARY.TITLE",1,"dictionary__heading"],[1,"dictionary__search"],[3,"placeholder","valueChanged"],["label","CURRENCY_PAYMENT.DICTIONARY.EMPTY",4,"ngIf"],["label","CURRENCY_PAYMENT.DICTIONARY.NOT_FOUND",4,"ngIf"],[1,"dictionary__list"],[3,"recipient","searchTerm","selected",4,"ngFor","ngForOf"],["label","CURRENCY_PAYMENT.DICTIONARY.EMPTY"],["label","CURRENCY_PAYMENT.DICTIONARY.NOT_FOUND"],[3,"recipient","searchTerm","selected"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Rb(2,"h5",2),d.Wb(3,"div",3),d.Wb(4,"j-search-input",4),d.ic("valueChanged",(function(e){return t.onQueryChange(e)})),d.Vb(),d.Vb(),d.Vb(),d.Oc(5,mo,1,0,"j-empty-placeholder",5),d.Oc(6,po,1,0,"j-empty-placeholder",6),d.Wb(7,"div",7),d.Oc(8,fo,1,2,"j-foreign-recipient",8),d.Vb(),d.Vb()),2&e&&(d.Ab(4),d.rc("placeholder","CURRENCY_PAYMENT.DICTIONARY.SEARCH"),d.Ab(1),d.rc("ngIf",0==(null==t.recipients?null:t.recipients.length)),d.Ab(1),d.rc("ngIf",(null==t.recipients?null:t.recipients.length)>0&&0==(null==t.filteredRecipients?null:t.filteredRecipients.length)),d.Ab(2),d.rc("ngForOf",t.filteredRecipients))},directives:[c.a,tr.a,r.u,r.t,Vn.a,bo],styles:[".dictionary[_ngcontent-%COMP%]{padding:40px 24px;max-height:80vh;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.dictionary__header[_ngcontent-%COMP%]{flex-shrink:0;background:#fff}.dictionary__list[_ngcontent-%COMP%]{overflow-y:auto;-webkit-box-flex:1;flex-grow:1}.dictionary__heading[_ngcontent-%COMP%]{margin-bottom:18px}.dictionary__search[_ngcontent-%COMP%], .recipient[_ngcontent-%COMP%]{padding:16px 0}.recipient__name[_ngcontent-%COMP%]{margin-bottom:4px;line-height:24px}.recipient__country[_ngcontent-%COMP%]{margin-bottom:16px;line-height:18px}.recipient__account[_ngcontent-%COMP%]{padding:8px 16px;background:#f6f7f8;border-radius:8px;line-height:21px;cursor:pointer;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.recipient__account[_ngcontent-%COMP%]:hover{background:#e9ecf1}.recipient__account[_ngcontent-%COMP%] + .recipient__account[_ngcontent-%COMP%]{margin-top:8px}"]}),ho),go=n("q46q");function yo(e,t){if(1&e&&(d.Rb(0,"div",3),d.mc(1,"highlight")),2&e){var n=d.lc();d.rc("innerHTML",d.oc(1,1,n.bic,n.searchTerm),d.Gc)}}var Co,ko=((Co=function(){function e(){_classCallCheck(this,e),this.selected=new d.n}return _createClass(e,[{key:"onSelect",value:function(){this.selected.emit(this.recipient)}},{key:"bic",get:function(){if(this.recipient.bankBic&&this.recipient.bankName)return"".concat(this.recipient.bankBic," - ").concat(this.recipient.bankName)}}]),e}()).\u0275fac=function(e){return new(e||Co)},Co.\u0275cmp=d.Kb({type:Co,selectors:[["j-foreign-contracts-recipient"]],inputs:{searchTerm:"searchTerm",recipient:"recipient"},outputs:{selected:"selected"},decls:4,vars:5,consts:[[1,"recipient__account","p3","mt-3","pt-3",3,"click"],[1,"text-dark","p2","recipient__name",3,"innerHTML"],["class","text-muted p3 recipient__country mb-0",3,"innerHTML",4,"ngIf"],[1,"text-muted","p3","recipient__country","mb-0",3,"innerHTML"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.ic("click",(function(e){return t.onSelect()})),d.Rb(1,"h5",1),d.mc(2,"highlight"),d.Oc(3,yo,2,4,"div",2),d.Vb()),2&e&&(d.Ab(1),d.rc("innerHTML",d.oc(2,2,t.recipient.name,t.searchTerm),d.Gc),d.Ab(2),d.rc("ngIf",t.bic))},directives:[r.u],pipes:[Wr.a],styles:[".dictionary[_ngcontent-%COMP%]{padding:40px 24px;max-height:80vh;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.dictionary__header[_ngcontent-%COMP%]{flex-shrink:0;background:#fff}.dictionary__list[_ngcontent-%COMP%]{overflow-y:auto;-webkit-box-flex:1;flex-grow:1}.dictionary__heading[_ngcontent-%COMP%]{margin-bottom:18px}.dictionary__search[_ngcontent-%COMP%], .recipient[_ngcontent-%COMP%]{padding:16px 0}.recipient__name[_ngcontent-%COMP%]{margin-bottom:4px;line-height:24px}.recipient__country[_ngcontent-%COMP%]{margin-bottom:16px;line-height:18px}.recipient__account[_ngcontent-%COMP%]{padding:8px 16px;background:#f6f7f8;border-radius:8px;line-height:21px;cursor:pointer;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.recipient__account[_ngcontent-%COMP%]:hover{background:#e9ecf1}.recipient__account[_ngcontent-%COMP%] + .recipient__account[_ngcontent-%COMP%]{margin-top:8px}"]}),Co);function Ao(e,t){1&e&&d.Rb(0,"j-empty-placeholder",9)}function To(e,t){1&e&&d.Rb(0,"j-empty-placeholder",10)}function Ro(e,t){if(1&e){var n=d.Xb();d.Wb(0,"j-foreign-contracts-recipient",11),d.ic("selected",(function(e){return d.Fc(n),d.lc().onRecipientSelect(e)})),d.Vb()}if(2&e){var r=t.$implicit,i=d.lc();d.rc("recipient",r)("searchTerm",i.searchTerm)}}var _o,So,jo,Oo=((So=function(){function e(t){_classCallCheck(this,e),this.modal=t,this.searchTerm=""}return _createClass(e,[{key:"ngOnInit",value:function(){this.filteredRecipients=_toConsumableArray(this.recipients)}},{key:"onQueryChange",value:function(e){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.searchTerm=e,e||(this.filteredRecipients=_toConsumableArray(this.recipients)),this.filteredRecipients=this.recipients.filter((function(t){return n.includesQuery(t.name,e)||n.includesQuery(t.bankBic,e)}));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"onRecipientSelect",value:function(e){this.modal.close(e)}},{key:"onClose",value:function(){this.modal.dismiss()}},{key:"includesQuery",value:function(e,t){var n,r;return null===(n=e)||void 0===n?void 0:n.toLowerCase().includes(null===(r=t)||void 0===r?void 0:r.toLowerCase())}}]),e}()).\u0275fac=function(e){return new(e||So)(d.Qb(a.a))},So.\u0275cmp=d.Kb({type:So,selectors:[["j-foreign-contracts-recipients-dictionary"]],decls:9,vars:4,consts:[[1,"dictionary"],[1,"dictionary__header"],["translate","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.TITLE",1,"dictionary__heading"],[1,"dictionary__search"],[3,"placeholder","valueChanged"],["label","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.EMPTY",4,"ngIf"],["label","CURRENCY_PAYMENT.DICTIONARY.NOT_FOUND",4,"ngIf"],[1,"dictionary__list"],[3,"recipient","searchTerm","selected",4,"ngFor","ngForOf"],["label","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.EMPTY"],["label","CURRENCY_PAYMENT.DICTIONARY.NOT_FOUND"],[3,"recipient","searchTerm","selected"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Rb(2,"h5",2),d.Wb(3,"div",3),d.Wb(4,"j-search-input",4),d.ic("valueChanged",(function(e){return t.onQueryChange(e)})),d.Vb(),d.Vb(),d.Vb(),d.Oc(5,Ao,1,0,"j-empty-placeholder",5),d.Oc(6,To,1,0,"j-empty-placeholder",6),d.Wb(7,"div",7),d.Oc(8,Ro,1,2,"j-foreign-contracts-recipient",8),d.Vb(),d.Vb()),2&e&&(d.Ab(4),d.rc("placeholder","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.SEARCH"),d.Ab(1),d.rc("ngIf",0==(null==t.recipients?null:t.recipients.length)),d.Ab(1),d.rc("ngIf",(null==t.recipients?null:t.recipients.length)>0&&0==(null==t.filteredRecipients?null:t.filteredRecipients.length)),d.Ab(2),d.rc("ngForOf",t.filteredRecipients))},directives:[c.a,tr.a,r.u,r.t,Vn.a,ko],styles:[".dictionary[_ngcontent-%COMP%]{padding:40px 24px;max-height:80vh;display:-webkit-box;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;flex-direction:column}.dictionary__header[_ngcontent-%COMP%]{flex-shrink:0;background:#fff}.dictionary__list[_ngcontent-%COMP%]{overflow-y:auto;-webkit-box-flex:1;flex-grow:1}.dictionary__heading[_ngcontent-%COMP%]{margin-bottom:18px}.dictionary__search[_ngcontent-%COMP%], .recipient[_ngcontent-%COMP%]{padding:16px 0}.recipient__name[_ngcontent-%COMP%]{margin-bottom:4px;line-height:24px}.recipient__country[_ngcontent-%COMP%]{margin-bottom:16px;line-height:18px}.recipient__account[_ngcontent-%COMP%]{padding:8px 16px;background:#f6f7f8;border-radius:8px;line-height:21px;cursor:pointer;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.recipient__account[_ngcontent-%COMP%]:hover{background:#e9ecf1}.recipient__account[_ngcontent-%COMP%] + .recipient__account[_ngcontent-%COMP%]{margin-top:8px}"]}),So),Io=((_o=function(){function e(t){_classCallCheck(this,e),this.modal=t}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"close",value:function(){this.modal.close()}}]),e}()).\u0275fac=function(e){return new(e||_o)(d.Qb(a.a))},_o.\u0275cmp=d.Kb({type:_o,selectors:[["j-iin-check-error"]],decls:13,vars:3,consts:[[1,"result-modal"],[1,"modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","p-3"],[1,"text-center"],[1,"modal-body","text-center"],[1,"form-group"],[1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(d.Wb(0,"div",0),d.Wb(1,"div",1),d.Wb(2,"button",2),d.ic("click",(function(e){return t.modal.dismiss()})),d.Rb(3,"img",3),d.mc(4,"translate"),d.Vb(),d.Vb(),d.Wb(5,"div",4),d.Wb(6,"div",5),d.Wb(7,"h5"),d.Qc(8,"\u0421\u0435\u0440\u0432\u0438\u0441 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u043e \u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d"),d.Vb(),d.Vb(),d.Vb(),d.Wb(9,"div",6),d.Wb(10,"div",7),d.Wb(11,"button",8),d.ic("click",(function(e){return t.close()})),d.Qc(12,"\u0417\u0430\u043a\u0440\u044b\u0442\u044c "),d.Vb(),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(3),d.sc("alt",d.nc(4,1,"SHARED.CLOSE")))},pipes:[c.d],styles:[""]}),_o),Vo=n("CVrE"),Eo=n("CqXF"),xo=n("w1tV"),wo=n("wd/R"),Wo=n("E+oP"),No=n.n(Wo),Po=["formDirective"],Mo=((jo=function(){function e(t,n,r,i,o,a,c,s,l,u){_classCallCheck(this,e),this.form=t,this.api=n,this.route=r,this.router=i,this.companyService=o,this.paymentsService=a,this.maskService=c,this.modals=s,this.dictionaries=l,this.pipeline=u,this.PAYMENT_STATUS=ii.h,this.SPINNER="BasePaymentContainer",this.restoredData={},this.amountMessage$=new Hr.a(""),this.periodMessage$=new Hr.a(""),this.commission$=new Hr.a(null),this.vat$=new Hr.a(0),this.total$=new Hr.a(0),this.purposeMessage$=new Hr.a(""),this.dateMessage$=new Hr.a(""),this.purposeLength$=new Hr.a(0),this.workingDays$=new Hr.a([]),this.processingPayment$=new Hr.a(null),this.isImported=!1,this.subs=new Qi.a,this.errors=this.paymentsService.errors,this.rules=this.paymentsService.rules,this.ugdStore=this.dictionaries.UGDictionary,this.knpStore=this.dictionaries.KNPDictionary,this.kbkStore=this.dictionaries.KBKDictionary}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.listenRouterParams(),this.createControlsStream(this.form),this.combineUrgentStream(),this.subs.add(this.processingPayment$.pipe(Object(Zr.a)(),Object(ei.a)(0)).subscribe((function(t){t?e.paymentsService.spinner.show(e.SPINNER):e.paymentsService.spinner.hide(e.SPINNER)})))}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe(),this.paymentsService.spinner.hide(this.SPINNER)}},{key:"onSenderAccountSelect",value:function(e){this.form.controls.senderAccount.setValue(e)}},{key:"hasError",value:function(e,t){var n,r;return t.invalid&&(t.dirty&&!(null===(n=e)||void 0===n?void 0:n.isFocused)||(null===(r=this.formDirective)||void 0===r?void 0:r.submitted)&&t.touched)}},{key:"sendPayment",value:function(e){var t,n=this;this.formDirective.form.markAsPristine();var r=this.paymentsService.paymentNumber,i=e||Object.assign(Object.assign({},this.form.value),{purpose:[this.form.value.purpose,this.purposeMessage$.getValue()].filter((function(e){return!!e})).join(". ")});return this.processingPayment$.next(i),this.paymentsService.paymentNumber.entity=null,this.pipeline.processPayment({paymentId:this.paymentId,total:this.total$.getValue()-this.commission$.getValue(),commission:this.commission$.getValue(),status:null===(t=this.restoredData)||void 0===t?void 0:t.status,userPurpose:this.form.value.purpose,rawBody:i}).then((function(e){e?n.restoredData={status:e.status.code,signatures:e.signatures,companyId:e.companyId}:(n.restoredData=null,r.entity||r.fetching||(r.entity=i.number))})).catch((function(e){})).finally((function(){n.processingPayment$.next(null)}))}},{key:"onSubmit",value:function(e){var t=this;e&&e.preventDefault();try{if(this.form.valid){var n=this.form.getRawValue(),r=n.date;this.processingPayment$.next(n),this.api.checkWorkingTime(r).then((function(){t.sendPayment()}))}else this.form.markAllAsTouched()}catch(i){}}},{key:"openKnpDictionary",value:function(e,t){var n=this;e.close(),e.blur(),setTimeout((function(){var e=n.modals.open(ki,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});e.componentInstance.paymentType=n.paymentType,e.result.then((function(e){n.form.controls.knp.patchValue(e.code)})).catch((function(){}))}),0)}},{key:"knpComparator",value:function(e,t){return e.code===t}},{key:"combineUrgentStream",value:function(){var e,t=this,n=this.controlsStream,r=n.date,i=n.bankAccount,o=n.bankReceiver,a=this.form.controls.urgent;if(a){var c=new Date,s=Object(Oe.getTimeZoneOffset)(new Date,"Asia/Almaty");c.setHours(c.getHours()+-s/60);var l=new Date(c);l.setHours(9,0,0);var u,b=new Date(c);b.setHours(16,0,0);var d,m=!0;u=(u=c>=l&&c<=b?Object(E.a)(+b-+c).pipe(Object(Eo.a)(!1)):c<l?Object(E.a)(+l-+c).pipe(Object(Eo.a)(m=!m)):Object(E.a)(l.setDate(l.getDate()+1)-+c).pipe(Object(Eo.a)(m=!m))).pipe(Object(ri.a)(1),Object(be.a)(m)),o?d=Object(Gr.a)([i,o,this.dictionaries.bankDictionary.entities$]).pipe(Object(fe.a)((function(e){var t,n=_slicedToArray(e,3),r=n[0],i=n[1],o=n[2];return i&&(t=o[i])&&t.salaryTransitIban?t.salaryTransitIban:t&&!t.salaryTransitIban&&r?Object(Oe.ibanPrefix)(r,oi.a.KZT):""}))):i&&(d=i.pipe(Object(fe.a)((function(e){return Object(Oe.ibanPrefix)(e,oi.a.KZT)})))),d=(null===(e=d)||void 0===e?void 0:e.pipe(Object(fe.a)((function(e){return t.paymentsService.bankFromAccount.transform(e)}))))||Object(qr.a)(""),this.subs.add(Object(Gr.a)([r.pipe(Object(fe.a)((function(e){return!e}))),d.pipe(Object(me.a)(300),Object(fe.a)((function(e){return"TSESKZKA"!==e}))),u]).pipe(Object(fe.a)((function(e){return e.every((function(e){return e}))}))).subscribe((function(e){e&&a.disabled?a.enable():!e&&a.enabled&&(a.disable(),a.setValue(!1))})))}}},{key:"listenRouterParams",value:function(){var e=this;this.subs.add(this.route.params.pipe(Object(fe.a)((function(t){return{state:window.history.state,params:t,route:e.route}})),Object(me.a)(0),Object(ti.a)((function(t){var n,r,i,o=t.params,a=t.state;if(null===(n=a)||void 0===n?void 0:n.silent)return e.restoredData.status===ii.h.DRAFT?e.paymentsService.rootTitle=Yr.b.EDIT_DRAFT:e.restoredData.status===ii.h.CREATED&&(e.paymentsService.rootTitle=Yr.b.EDIT_PAYMENT),zr.a;if(null===(r=a)||void 0===r?void 0:r.resolvedPayment)return Object(qr.a)(a.resolvedPayment);if(o.paymentId||(null===(i=a)||void 0===i?void 0:i.repeatPaymentId)){var c=o.paymentId||a.repeatPaymentId;return Object(Xr.a)(e.api.getPaymentById(c)).pipe(Object(ni.a)((function(t){return e.router.navigate([e.router.url.replace("/"+c,"")]),zr.a})))}return e.setAutoNumeration(),e.paymentsService.rootTitle=Yr.b.NEW,zr.a}))).subscribe((function(t){e.restorePayment(t)})))}},{key:"getMaskConfig",value:function(){var e=this;Object.entries(this.masks).forEach((function(t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return e.masks[r]=e.maskService.getConfig(i)}))}},{key:"checkPersonalAccounts",value:function(e){0!==e.length?e.every((function(e){return e.isClosed||e.isLocked}))?this.paymentsService.infoMessage.entity={type:Yr.a.info,message:Yr.d.allLocked}:(1===e.length&&(this.form.patchValue({senderAccount:e[0]}),this.form.markAsPristine()),this.paymentsService.infoMessage.entity=null):this.paymentsService.infoMessage.entity={type:Yr.a.info,message:Yr.d.noAccounts}}},{key:"createControlsStream",value:function(e){this.controlsStream=Object.entries(e.controls).reduce((function(e,t,n,r){var i=_slicedToArray(t,2),o=i[0],a=i[1];return e[o]=a.valueChanges.pipe(Object(be.a)(a.value)),e}),{})}},{key:"listenCommission",value:function(){var e=this,t=this.controlsStream,n=t.amount,r=t.date,i=t.urgent,o=t.kbk,a=t.knp,c=t.senderAccount;this.subs.add(Object(Gr.a)([Object(Gr.a)(Object.entries({amount:n,date:r,urgent:i,kbk:o,knp:a,senderAccount:c}).filter((function(e){var t=_slicedToArray(e,2);return t[0],!!t[1]})).map((function(e){var t=_slicedToArray(e,2),n=t[0];return t[1].pipe(Object(Zr.a)(),Object(fe.a)((function(e){return[n,e]})))}))),this.controlsStream.type.pipe(Object(Zr.a)()),this.companyService.currentCompany$.pipe(Object(pe.a)((function(e){return!!e})),Object(Zr.a)())]).pipe(Object(me.a)(300),Object(pe.a)((function(t){return _slicedToArray(t,1)[0].every((function(t){var n=_slicedToArray(t,2),r=n[0];return!n[1]||!e.form.controls[r]||e.form.controls[r].valid}))})),Object(ti.a)((function(t){var n=_slicedToArray(t,3),r=n[0],i=n[1],o=n[2],a=r.reduce((function(e,t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return e[r]=i,e}),{}),c=a.amount,s=a.date,l=a.kbk,u=a.knp,b=a.urgent,d=a.senderAccount,m={amount:e.maskService.getNumberedAmount(c),date:s,urgent:b,currency:oi.a.KZT,category:ii.g.DOMESTIC,type:i,companyId:o.id,kbk:l,knp:u,senderAccount:d};return e.paymentsService.calculateCommission$(m).pipe(Object(ni.a)((function(e){return Object(qr.a)(null)})))}))).subscribe(this.commission$))}},{key:"listenVAT",value:function(){var e=this;this.controlsStream.vat&&this.controlsStream.amount&&this.subs.add(Object(Gr.a)([this.controlsStream.vat,this.controlsStream.amount]).pipe(Object(fe.a)((function(t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return r?12*e.maskService.getNumberedAmount(i)/112:0}))).subscribe(this.vat$))}},{key:"listenTotal",value:function(){var e=this;this.form.controls.amount&&this.subs.add(Object(Gr.a)(this.commission$,this.controlsStream.amount).pipe(Object(fe.a)((function(t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return r+e.maskService.getNumberedAmount(i)}))).subscribe(this.total$))}},{key:"combineEmployeesAmount",value:function(){var e=this;this.subs.add(this.controlsStream.employees.pipe(Object(me.a)(100),Object(fe.a)((function(e){return(e||[]).reduce((function(e,t){return e+t.amount}),0)}))).subscribe((function(t){e.form.controls.amount.patchValue(t)})))}},{key:"combineKNP",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[function(t){return e.dictionaries.selectByPaymentType(t,{type:e.paymentType,sortFavourite:!0})}],n=arguments.length>1?arguments[1]:void 0,r=[this.knpStore.items$];return n&&r.push.apply(r,_toConsumableArray(n)),Object(Gr.a)(r).pipe(Object(fe.a)((function(e){return t.reduce((function(t,n){return n(t,e.slice(1))}),e[0])})),Object(xo.a)())}},{key:"combineKBK",value:function(e){var t=this;this.kbk$=this.kbkStore.items$,Object(Gr.a)([this.kbkStore.items$.pipe(Object(fe.a)((function(n){return t.dictionaries.selectByPaymentType(n,{type:e,sortFavourite:!0})})))]).pipe(Object(fe.a)((function(e){return _slicedToArray(e,1)[0]})))}},{key:"saveToDraft",value:function(e){var t=this;this.formDirective.submitted=!0,this.formDirective.form.markAsPristine();var n=this.paymentsService.paymentNumber,r=e||Object.assign(Object.assign({},this.form.value),{purpose:[this.form.value.purpose,this.purposeMessage$.getValue()].filter((function(e){return!!e})).join("; ")});n.entity=null,this.processingPayment$.next(Object.assign({id:this.paymentId},r)),this.pipeline.saveToDrafts(r,{paymentId:this.paymentId,type:this.paymentType,commission:this.commission$.value,userPurpose:this.form.value.purpose,category:ii.g.DOMESTIC}).then((function(e){e.id!==t.paymentId&&(e&&(t.restoredData={status:e.status,signatures:e.signatures,companyId:e.companyId}),t.router.navigate([t.route.snapshot.params.paymentId?"../":".",e.id],{relativeTo:t.route,state:{silent:!0}}))})).catch((function(e){n.entity||n.fetching||(n.entity=r.number)})).finally((function(){return t.processingPayment$.next(null)}))}},{key:"setAutoNumeration",value:function(){var e=this;this.subs.add(this.paymentsService.paymentNumber$.pipe(Object(Jr.a)(this.controlsStream.number)).subscribe((function(t){var n=_slicedToArray(t,2),r=n[0];n[1]||e.form.controls.number.setValue(r)})))}},{key:"provideAmountMessage",value:function(){var e=this;if(this.form.controls.amount){var t=this.controlsStream,n=t.senderAccount,r=t.date;this.subs.add(Object(Gr.a)([this.companyService.authorityLevel$,this.total$,n.pipe(Object(pe.a)((function(e){return!!e}))),r]).pipe(Object(fe.a)((function(t){var n=_slicedToArray(t,4),r=n[0],i=n[1],o=n[2],a=n[3];if(r!==ii.a.PRIMARY_SIGNATURE)return"";var c=o.balance.amount-i;if(c<0){var s=e.maskService.formatAmount(Math.abs(c));return a?function(e,t,n){return"\u041d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 ".concat(e,' \u20b8 \u043d\u0430 \u0441\u0447\u0435\u0442\u0435 \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0442\u0435\u0436\u0430, \u043f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0431\u0430\u043b\u0430\u043d\u0441 \u043d\u0435 \u043f\u043e\u0437\u0434\u043d\u0435\u0435 <span class="text-danger">').concat(Object(Oe.formatNgbDate)(t,"g")," ").concat(n,"</span> \u0434\u043b\u044f \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0442\u0435\u0436\u0430 \u0411\u0430\u043d\u043a\u043e\u043c")}(s,a,Oe.edgeTimeLabel):"\u041d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 ".concat(s," \u20b8 \u043d\u0430 \u0441\u0447\u0435\u0442\u0435 \u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0442\u0435\u0436\u0430, \u043f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0431\u0430\u043b\u0430\u043d\u0441 \u0434\u043b\u044f \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f  \u043f\u043b\u0430\u0442\u0435\u0436\u0430 \u0411\u0430\u043d\u043a\u043e\u043c")}}))).subscribe(this.amountMessage$))}}},{key:"listenWorkingDays",value:function(){var e=this;this.subs.add(this.dictionaries.workingDays.entity$.pipe(Object(fe.a)((function(t){return e.dictionaries.selectDaysTimeline(wo(Object(Oe.ngbDateToDate)(e.dateLimit.minDate)).format(Oe.ISO_8061),wo(Object(Oe.ngbDateToDate)(e.dateLimit.maxDate)).format(Oe.ISO_8061),t)}))).subscribe(this.workingDays$))}},{key:"listenDateMessageStream",value:function(){this.subs.add(Object(Gr.a)([this.companyService.authorityLevel$,this.controlsStream.date,this.controlsStream.senderAccount.pipe(Object(pe.a)((function(e){return!!e})))]).pipe(Object(fe.a)((function(e){var t=_slicedToArray(e,3),n=t[0],r=t[1];return t[2],n===ii.a.PRIMARY_SIGNATURE?"\u041f\u0440\u0438 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e\u043c \u0431\u0430\u043b\u0430\u043d\u0441\u0435 \u043f\u043b\u0430\u0442\u0435\u0436 \u0441\u0440\u0430\u0437\u0443 \u0443\u0439\u0434\u0435\u0442 \u0432 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443":r?"\u041f\u0440\u0438 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e\u043c \u0431\u0430\u043b\u0430\u043d\u0441\u0435 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u0432\u0441\u0435\u0445 \u043f\u043e\u0434\u043f\u0438\u0441\u0435\u0439 \u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0438\u0437\u043e\u0439\u0434\u0451\u0442 \u0440\u0430\u043d\u044c\u0448\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0439 \u0434\u0430\u0442\u044b":"\u041f\u0440\u0438 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e\u043c \u0431\u0430\u043b\u0430\u043d\u0441\u0435 \u0438 \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u0432\u0441\u0435\u0445 \u043f\u043e\u0434\u043f\u0438\u0441\u0435\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 \u0441\u0440\u0430\u0437\u0443 \u0443\u0439\u0434\u0435\u0442 \u0432 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443"}))).subscribe(this.dateMessage$))}},{key:"listenPurposeMessageStream",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["vat","kbk","knp"],r={vat:function(t){return t?"\u0412\u043a\u043b\u044e\u0447\u0430\u044f \u041d\u0414\u0421 = ".concat(e.maskService.formatAmount(t)," \u20b8."):""},kbk:function(t){var n;return t&&(n=e.kbkStore.items.find((function(e){return e.code===t})))?"".concat(n.name,"."):""},knp:function(t){var n;return t&&(n=e.knpStore.items.find((function(e){return e.code===t})))?"".concat(n.name,"."):""}},i=[];i.push((this.controlsStream.vat&&this.vat$||Object(qr.a)(0)).pipe(Object(fe.a)((function(e){return["vat",e]}))),this.controlsStream.knp.pipe(Object(fe.a)((function(e){return["knp",e]})))),this.controlsStream.kbk&&i.push(this.controlsStream.kbk.pipe(Object(fe.a)((function(e){return["kbk",e]})))),i.push.apply(i,_toConsumableArray(t)),this.subs.add(Object(Gr.a)(i).pipe(Object(me.a)(100),Object(fe.a)((function(e){return e.reduce((function(e,t){return e[t[0]]=t[1],e}),{})})),Object(fe.a)((function(e){return n.reduce((function(t,n){return Array.isArray(n)?t.push(n[1](e[n[0]],e)):t.push(r[n]?r[n](e[n],e):e[n]),t}),[]).filter((function(e){return!!e})).join(" ")})),Object(de.a)((function(t){e.form.controls.purpose.patchValue(e.form.controls.purpose.value),t&&e.form.controls.purpose.markAllAsTouched()}))).subscribe(this.purposeMessage$)),this.subs.add(Object(Gr.a)(this.purposeMessage$,this.controlsStream.purpose).pipe(Object(fe.a)((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return(n||"").length+(r||"").length}))).subscribe(this.purposeLength$)),this.validatePurpose()}},{key:"validatePurpose",value:function(){var e=this;this.subs.add(Object(Gr.a)(this.purposeMessage$,this.controlsStream.purpose).subscribe((function(t){var n=_slicedToArray(t,2),r=n[0],i=(n[1]||"").length+(r||"").length,o=e.form.touched?e.form.controls.purpose.errors:{};o&&i>e.rules.purposeLength&&(o.maxlength=i),e.form.controls.purpose.setErrors(No()(o)?null:o,{emitEvent:!0})})))}},{key:"restorePayment",value:function(e){var t=this;this.subs.add(Object(Gr.a)([this.knpStore.fetched$,this.kbkStore.fetched$,this.ugdStore.fetched$,this.dictionaries.bankDictionary.fetched$,this.accountStore.fetched$]).pipe(Object(pe.a)((function(e){return e.every((function(e){return e}))})),Object(de.a)((function(){var n,r,i,o;try{o=t.pipeline.flattenPaymentToModel(e)}catch(a){o={}}t.restoredData={companyId:e.companyId,status:null===(n=e.status)||void 0===n?void 0:n.code,signatures:e.signatures},e.id&&!t.paymentId?(o.number="",o.date=null,t.restoredData.status=null,t.paymentsService.rootTitle=Yr.b.NEW):t.paymentsService.rootTitle=t.restoredData.status===ii.h.DRAFT?Yr.b.EDIT_DRAFT:Yr.b.EDIT_PAYMENT,o.emailOnSuccess&&(o.notify=!0),t.form.patchValue(Object.assign(Object.assign({},o),{purpose:null===(i=null===(r=e.details.associatedField)||void 0===r?void 0:r.parameters)||void 0===i?void 0:i.paymentPurpose})),t.isImported=e.imported,o.number||t.setAutoNumeration()})),Object(me.a)(10),Object(ri.a)(1)).subscribe())}},{key:"paymentId",get:function(){return this.route.snapshot.params.paymentId}},{key:"dateHelper",get:function(){return this.form.controls.date.value?"":"\u041f\u0440\u0438 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e\u043c \u0431\u0430\u043b\u0430\u043d\u0441\u0435 \u043f\u043b\u0430\u0442\u0435\u0436 \u0441\u0440\u0430\u0437\u0443 \u0443\u0439\u0434\u0435\u0442 \u0432 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443"}},{key:"senderAccountLabel",get:function(){return this.form.controls.senderAccount?"\u0421\u0447\u0435\u0442 \u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f":"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0447\u0435\u0442 \u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f"}},{key:"submitLabel",get:function(){return"SHARED."+(this.paymentsService.isSignatureRequired?"TO_SIGN":"FOR_SIGN")}},{key:"paymentType",get:function(){return this.form.controls.type.value},set:function(e){this.form.controls.type.patchValue(e)}}]),e}()).\u0275fac=function(e){d.hc()},jo.\u0275dir=d.Lb({type:jo,viewQuery:function(e,t){var n;1&e&&d.Vc(Po,!0),2&e&&d.Bc(n=d.jc())&&(t.formDirective=n.first)}}),jo),Lo=n("mR7B"),Do=n("7rOj"),Qo=n("FSKB"),Fo=n("YjsB"),Bo=n("hsBV"),$o=["emailOnSuccess"],Uo=["senderAccountDropdown"],Yo=["contractsSelect"],Ko=["contractDetails"],Ho=["bankDropdown"],Go=["intermediaryBankDropdown"],zo=["commissionAccountDropdown"],qo=["rubNonRussiaBankDropdown"],Xo=["rubNonRussiaCorrespondentBankDropdown"],Zo=["rubNonRussiaCorrespondentIbanInput"];function Jo(e,t){if(1&e&&(d.Wb(0,"div",70),d.Rb(1,"small",71),d.mc(2,"translate"),d.Vb()),2&e){var n=d.lc();d.Hb("is-loading",n.isContractsDescriptionLoading),d.rc("jLoading",n.isContractsDescriptionLoading)("jLoadingInverted",!0),d.Ab(1),d.rc("innerHTML",d.oc(2,5,"CURRENCY_PAYMENT.CONTRACTS.SWITCH.DESCRIPTION",n.contractsSwitchDescriptionParams),d.Gc)}}function ea(e,t){if(1&e){var n=d.Xb();d.Wb(0,"button",81),d.ic("click",(function(e){return d.Fc(n),d.lc(4).openContractsAddingModal()})),d.Wb(1,"span",10),d.Qc(2," CURRENCY_PAYMENT.CONTRACTS.ADD_NEW "),d.Vb(),d.Vb()}}function ta(e,t){if(1&e&&(d.Wb(0,"div",79),d.Oc(1,ea,3,0,"button",80),d.Wb(2,"h6",10),d.Qc(3,"CURRENCY_PAYMENT.CONTRACTS.TITLE"),d.Vb(),d.Vb()),2&e){var n=d.lc(3);d.Ab(1),d.rc("ngIf",n.filteredContracts.length>0)}}function na(e,t){if(1&e&&d.Oc(0,ta,4,1,"div",78),2&e){var n=t.searchTerm,r=d.lc(2);d.rc("ngIf",!n&&!r.isContractsLoading)}}function ra(e,t){if(1&e&&(d.Wb(0,"div",82),d.Wb(1,"div",83),d.Wb(2,"span"),d.Qc(3),d.Vb(),d.Rb(4,"j-money",84),d.Vb(),d.Wb(5,"div",85),d.Wb(6,"span"),d.Qc(7),d.Vb(),d.Wb(8,"div"),d.Rb(9,"span",86),d.Qc(10,"\xa0 "),d.Rb(11,"j-money",84),d.Vb(),d.Vb(),d.Vb()),2&e){var n=t.item;d.Ab(3),d.Rc(n.contractor.name),d.Ab(1),d.rc("money",n.amount),d.Ab(3),d.Rc(n.contractNumber),d.Ab(4),d.rc("money",n.remainder)}}function ia(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"div",87),d.Rb(2,"img",88),d.Rb(3,"div",89),d.mc(4,"translate"),d.Wb(5,"a",90),d.ic("click",(function(e){return d.Fc(n),d.lc(3).openContractsAddingModal(e)})),d.Qc(6),d.mc(7,"translate"),d.Vb(),d.Vb(),d.Tb()}2&e&&(d.Ab(3),d.rc("innerHTML",d.nc(4,2,"CURRENCY_PAYMENT.CONTRACTS.EMPTY_STATE"),d.Gc),d.Ab(3),d.Sc(" ",d.nc(7,4,"CURRENCY_PAYMENT.CONTRACTS.ADD_NEW")," "))}function oa(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Rb(1,"j-empty-placeholder",91),d.Wb(2,"div",92),d.Wb(3,"a",93),d.ic("click",(function(e){return d.Fc(n),d.lc(3).openContractsAddingModal(e)})),d.Qc(4),d.mc(5,"translate"),d.Vb(),d.Vb(),d.Tb()}2&e&&(d.Ab(4),d.Sc(" ",d.nc(5,1,"CURRENCY_PAYMENT.CONTRACTS.ADD_NEW")," "))}function aa(e,t){if(1&e&&(d.Oc(0,ia,8,6,"ng-container",12),d.Oc(1,oa,6,3,"ng-container",12)),2&e){var n=d.lc(2);d.rc("ngIf",0==n.contracts.length),d.Ab(1),d.rc("ngIf",n.contracts.length>0)}}function ca(e,t){if(1&e&&d.Qc(0),2&e){var n=t.item,r=d.lc(2);d.Sc(" ",r.mapContractLabel(n||r.form.controls.contract.value)," ")}}function sa(e,t){if(1&e){var n=d.Xb();d.Wb(0,"a",94),d.ic("click",(function(e){return d.Fc(n),d.lc(2).showContractDetails(e)})),d.Qc(1,"CURRENCY_PAYMENT.CONTRACTS.SHOW_DETAILS"),d.Vb()}}function la(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"div",72),d.Wb(2,"j-form-field",null,73),d.Wb(4,"j-label",10),d.Qc(5,"CURRENCY_PAYMENT.RECIPIENT.CONTRACT"),d.Vb(),d.Wb(6,"j-select",74,75),d.ic("change",(function(e){return d.Fc(n),d.lc().onContractSelect(e)})),d.Oc(8,na,1,1,"ng-template",37),d.Oc(9,ra,12,4,"ng-template",24),d.Oc(10,aa,2,2,"ng-template",76),d.Oc(11,ca,1,1,"ng-template",25),d.Vb(),d.Oc(12,sa,2,0,"a",77),d.Rb(13,"j-error",26),d.Vb(),d.Vb(),d.Tb()}if(2&e){var r=d.Cc(3),i=d.Cc(7),o=d.lc();d.Ab(6),d.rc("loading",o.isContractsLoading)("appendTo",r.elementRef.nativeElement)("jFocusOnReturn",i)("formControl",o.form.controls.contractId)("clearable",!1)("searchFn",o.contractComparator)("items",o.filteredContracts),d.Ab(6),d.rc("ngIf",o.isContractSelected),d.Ab(1),d.rc("control",o.form.controls.contractId)("errorMessages",o.errors.contractId)}}function ua(e,t){if(1&e){var n=d.Xb();d.Wb(0,"button",95),d.ic("click",(function(e){return d.Fc(n),d.lc().openForeignContractsRecipientsDictionary()})),d.Vb()}}function ba(e,t){if(1&e){var n=d.Xb();d.Wb(0,"button",96),d.ic("click",(function(e){return d.Fc(n),d.lc().openForeignRecipientsDictionary()})),d.Vb()}}function da(e,t){if(1&e&&(d.Wb(0,"div",97),d.Qc(1),d.Vb()),2&e){var n=t.item,r=d.lc();d.Ab(1),d.Sc(" ",r.mapCountryLabel(n)," ")}}function ma(e,t){if(1&e&&d.Qc(0),2&e){var n=t.item,r=d.lc(),i=d.Cc(32);d.Sc(" ",i.focused?"":r.mapCountryLabel(n)," ")}}function pa(e,t){if(1&e&&(d.Wb(0,"div",18),d.Wb(1,"j-form-field"),d.Wb(2,"j-label"),d.Qc(3),d.mc(4,"translate"),d.mc(5,"async"),d.Vb(),d.Rb(6,"input",98),d.Rb(7,"j-error",26),d.Vb(),d.Vb()),2&e){var n=d.lc();d.Ab(3),d.Rc(d.nc(4,7,d.nc(5,9,n.cityPlaceholder$))),d.Ab(3),d.rc("mask",n.masks.cityName.mask)("dropSpecialCharacters",!1)("maxlength",n.cityMaxLength)("formControl",n.form.controls.cityName),d.Ab(1),d.rc("control",n.form.controls.cityName)("errorMessages",n.errors.purpose)}}function fa(e,t){if(1&e&&(d.Ub(0),d.Wb(1,"div",99),d.Wb(2,"div",18),d.Wb(3,"j-form-field"),d.Wb(4,"j-label",10),d.Qc(5,"CURRENCY_PAYMENT.AUD.INDEX"),d.Vb(),d.Rb(6,"input",100),d.Vb(),d.Vb(),d.Wb(7,"div",18),d.Wb(8,"j-form-field"),d.Wb(9,"j-label",10),d.Qc(10,"CURRENCY_PAYMENT.AUD.STATE"),d.Vb(),d.Rb(11,"input",101),d.Vb(),d.Vb(),d.Vb(),d.Wb(12,"div",99),d.Wb(13,"div",18),d.Wb(14,"j-form-field"),d.Wb(15,"j-label",10),d.Qc(16,"CURRENCY_PAYMENT.AUD.BUILDING_NUMBER"),d.Vb(),d.Rb(17,"input",102),d.Vb(),d.Vb(),d.Wb(18,"div",18),d.Wb(19,"j-form-field"),d.Wb(20,"j-label",10),d.Qc(21,"CURRENCY_PAYMENT.AUD.STREET"),d.Vb(),d.Rb(22,"input",103),d.Vb(),d.Vb(),d.Vb(),d.Rb(23,"hr",104),d.Tb()),2&e){var n=d.lc();d.Ab(6),d.rc("formControl",n.form.controls.audIndex),d.Ab(5),d.rc("formControl",n.form.controls.audState),d.Ab(6),d.rc("formControl",n.form.controls.audBuildingNumber),d.Ab(5),d.rc("formControl",n.form.controls.audStreet)}}function ha(e,t){if(1&e&&(d.Ub(0),d.Wb(1,"div",18),d.Wb(2,"j-form-field"),d.Wb(3,"j-label",10),d.Qc(4,"CURRENCY_PAYMENT.AUD.ADDRESS"),d.Vb(),d.Rb(5,"input",105),d.Vb(),d.Vb(),d.Tb()),2&e){var n=d.lc();d.Ab(5),d.rc("formControl",n.form.controls.audAddress)}}function va(e,t){if(1&e&&(d.Ub(0),d.Wb(1,"div",18),d.Rb(2,"j-foreign-bank-select",106,107),d.Vb(),d.Wb(4,"div",18),d.Wb(5,"j-form-field",19),d.Wb(6,"j-label",10),d.Qc(7,"CURRENCY_PAYMENT.RECIPIENT.CORRESPONDENT_IBAN"),d.Vb(),d.Rb(8,"input",108,109),d.Rb(10,"j-error",26),d.Vb(),d.Vb(),d.Tb()),2&e){var n=d.lc();d.Ab(2),d.rc("labelText","CURRENCY_PAYMENT.RECIPIENT.CORRESPONDENT_BIC")("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_CORRESPONDENT_BIC_ENTERED")("labelControl",n.form.controls.rubNonRussiaCorrespondentBankLabel)("errorMessages",n.errors.bankSelect)("bankControl",n.form.controls.rubNonRussiaCorrespondentBank),d.Ab(6),d.rc("validation",!1)("mask",n.masks.rubNonRussiaCorrespondentIban.mask)("formControl",n.form.controls.rubNonRussiaCorrespondentIban),d.Ab(2),d.rc("control",n.form.controls.rubNonRussiaCorrespondentIban)("errorMessages",n.errors.bankAccount)}}function ga(e,t){if(1&e&&(d.Wb(0,"div",18),d.Wb(1,"j-form-field",19),d.Wb(2,"j-label",10),d.Qc(3,"CURRENCY_PAYMENT.RECIPIENT.KBE"),d.Vb(),d.Rb(4,"input",110),d.Rb(5,"a",111),d.Rb(6,"j-error",26),d.Vb(),d.Vb()),2&e){var n=d.lc(),r=d.Cc(143);d.Ab(4),d.rc("mask",n.masks.kbeCode.mask)("jShadow",n.masks.kbeCode.shadow)("dropSpecialCharacters",!0)("formControl",n.form.controls.kbeCode),d.Ab(1),d.rc("ngbTooltip",r)("inlineSVG","/assets/icons/payments/question.svg"),d.Ab(1),d.rc("control",n.form.controls.kbeCode)("errorMessages",n.errors.kbeCode)}}function ya(e,t){if(1&e&&(d.Ub(0),d.Wb(1,"div",18),d.Rb(2,"j-foreign-bank-select",106,112),d.Vb(),d.Wb(4,"div",18),d.Wb(5,"j-form-field"),d.Wb(6,"j-label"),d.Qc(7),d.mc(8,"translate"),d.mc(9,"async"),d.Vb(),d.Rb(10,"input",98),d.Vb(),d.Vb(),d.Tb()),2&e){var n=d.lc();d.Ab(2),d.rc("labelText","CURRENCY_PAYMENT.RECIPIENT.BANK")("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_BIC_ENTERED")("labelControl",n.form.controls.rubNonRussiaBankLabel)("errorMessages",n.errors.bankSelect)("bankControl",n.form.controls.rubNonRussiaBank),d.Ab(5),d.Rc(d.nc(8,10,d.nc(9,12,n.cityPlaceholder$))),d.Ab(3),d.rc("mask",n.masks.cityName.mask)("dropSpecialCharacters",!1)("maxlength",n.cityMaxLength)("formControl",n.form.controls.cityName)}}function Ca(e,t){1&e&&(d.Wb(0,"div",43),d.Qc(1," CURRENCY_PAYMENT.RECIPIENT.BIC_DESCRIPTION "),d.Vb())}function ka(e,t){if(1&e&&(d.Ub(0),d.Wb(1,"div",18),d.Rb(2,"j-foreign-bank-select",113,114),d.Oc(4,Ca,2,0,"div",115),d.Vb(),d.Tb()),2&e){var n=d.lc();d.Ab(2),d.rc("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_BIC_ENTERED")("labelControl",n.form.controls.bankLabel)("errorMessages",n.errors.bankSelect)("bankControl",n.form.controls.bank),d.Ab(2),d.rc("ngIf",!n.isBicRequired)}}function Aa(e,t){if(1&e&&d.Rb(0,"j-foreign-bank-select",119,120),2&e){var n=d.lc(2);d.rc("placeholderText","CURRENCY_PAYMENT.RECIPIENT.NO_INTERMEDIARY_BIC_ENTERED")("labelControl",n.form.controls.intermediaryBankLabel)("bankControl",n.form.controls.intermediaryBank)("errorMessages",n.errors.bankSelect)}}function Ta(e,t){if(1&e&&(d.Wb(0,"div",7),d.Rb(1,"j-switch",8),d.Wb(2,"div",116),d.Wb(3,"strong",10),d.Qc(4,"CURRENCY_PAYMENT.RECIPIENT.SWITCH.TITLE"),d.Vb(),d.Oc(5,Aa,2,4,"j-foreign-bank-select",117),d.Wb(6,"small",118),d.Qc(7,"CURRENCY_PAYMENT.RECIPIENT.SWITCH.DESCRIPTION"),d.Vb(),d.Vb(),d.Vb()),2&e){var n=d.lc();d.Ab(1),d.rc("formControl",n.form.controls.hasIntermediaryBank),d.Ab(4),d.rc("ngIf",n.hasIntermediaryBank)}}function Ra(e,t){if(1&e&&(d.Wb(0,"div",18),d.Wb(1,"j-form-field",19),d.Wb(2,"j-label",10),d.Qc(3,"CURRENCY_PAYMENT.RECIPIENT.KIO"),d.Vb(),d.Rb(4,"input",121),d.Rb(5,"j-error",26),d.Vb(),d.Vb()),2&e){var n=d.lc();d.Ab(4),d.rc("mask",n.masks.kio.mask)("dropSpecialCharacters",!1)("formControl",n.form.controls.kio),d.Ab(1),d.rc("control",n.form.controls.kio)("errorMessages",n.errors.kio)}}function _a(e,t){if(1&e&&(d.Wb(0,"div",18),d.Wb(1,"j-form-field",19),d.Wb(2,"j-label",10),d.Qc(3,"CURRENCY_PAYMENT.RECIPIENT.KPP"),d.Vb(),d.Rb(4,"input",122),d.Rb(5,"a",111),d.Vb(),d.Wb(6,"div",43),d.Qc(7," CURRENCY_PAYMENT.RECIPIENT.KPP_DESCRIPTION "),d.Vb(),d.Vb()),2&e){var n=d.lc(),r=d.Cc(145);d.Ab(4),d.rc("mask",n.masks.kpp.mask)("jShadow",n.masks.kpp.shadow)("validation",!1)("formControl",n.form.controls.kpp),d.Ab(1),d.rc("ngbTooltip",r)("inlineSVG","/assets/icons/payments/question.svg")}}function Sa(e,t){if(1&e&&(d.Wb(0,"div",128),d.Wb(1,"j-form-field",19),d.Wb(2,"j-label",10),d.Qc(3,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.KIO"),d.Vb(),d.Rb(4,"input",140),d.Rb(5,"j-error",26),d.Vb(),d.Wb(6,"j-form-field",19),d.Wb(7,"j-label",10),d.Qc(8,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.KPP"),d.Vb(),d.Rb(9,"input",133),d.Rb(10,"a",111),d.Vb(),d.Vb()),2&e){var n=d.lc(2),r=d.Cc(145);d.Ab(4),d.rc("formControl",n.form.controls.payerInn),d.Ab(1),d.rc("control",n.form.controls.payerInn)("errorMessages",n.errors.payerInn),d.Ab(4),d.rc("mask",n.masks.kpp.mask)("jShadow",n.masks.kpp.shadow)("formControl",n.form.controls.payerKpp),d.Ab(1),d.rc("ngbTooltip",r)("inlineSVG","/assets/icons/payments/question.svg")}}function ja(e,t){if(1&e&&(d.Wb(0,"div",82),d.Wb(1,"strong"),d.Qc(2),d.Vb(),d.Wb(3,"span"),d.Qc(4," - "),d.Vb(),d.Wb(5,"span"),d.Qc(6),d.Vb(),d.Vb()),2&e){var n=t.item;d.Ab(2),d.Rc(n.code),d.Ab(4),d.Rc(n.description)}}function Oa(e,t){1&e&&d.Rb(0,"j-empty-placeholder",141)}function Ia(e,t){if(1&e&&d.Qc(0),2&e){var n=t.item;d.lc();var r=d.Cc(17);d.Sc(" ",r.focused?"":n.code+" - "+n.description," ")}}function Va(e,t){if(1&e&&(d.Wb(0,"div",82),d.Wb(1,"strong"),d.Qc(2),d.Vb(),d.Wb(3,"span"),d.Qc(4," - "),d.Vb(),d.Wb(5,"span"),d.Qc(6),d.Vb(),d.Vb()),2&e){var n=t.item;d.Ab(2),d.Rc(n.code),d.Ab(4),d.Rc(n.description)}}function Ea(e,t){1&e&&d.Rb(0,"j-empty-placeholder",142)}function xa(e,t){if(1&e&&d.Qc(0),2&e){var n=t.item;d.lc();var r=d.Cc(32);d.Sc(" ",r.focused?"":n.code+" - "+n.description," ")}}function wa(e,t){if(1&e&&(d.Ub(0),d.Wb(1,"div",18),d.Wb(2,"j-form-field",19),d.Wb(3,"j-label",10),d.Qc(4,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PURPOSE"),d.Vb(),d.Rb(5,"input",133),d.Rb(6,"a",111),d.Vb(),d.Vb(),d.Wb(7,"div",18),d.Wb(8,"j-form-field",19),d.Wb(9,"j-label",10),d.Qc(10,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.TAX_NUMBER"),d.Vb(),d.Rb(11,"input",133),d.Vb(),d.Vb(),d.Wb(12,"div",128),d.Wb(13,"div"),d.Wb(14,"j-form-field",19),d.Wb(15,"j-label",10),d.Qc(16,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PERIOD"),d.Vb(),d.Rb(17,"input",143),d.Rb(18,"a",111),d.Vb(),d.Wb(19,"div",43),d.Qc(20,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PERIOD_DESCRIPTION "),d.Vb(),d.Vb(),d.Wb(21,"j-form-field",19),d.Wb(22,"j-label",10),d.Qc(23,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.UIP"),d.Vb(),d.Rb(24,"input",144),d.Vb(),d.Vb(),d.Tb()),2&e){var n=d.lc(2),r=d.Cc(149),i=d.Cc(151);d.Ab(5),d.rc("mask",n.masks.paymentBasis.mask)("jShadow",n.masks.paymentBasis.shadow)("formControl",n.form.controls.paymentBasis),d.Ab(1),d.rc("ngbTooltip",r)("inlineSVG","/assets/icons/payments/question.svg"),d.Ab(5),d.rc("mask",n.masks.budgetDocNumber.mask)("jShadow",n.masks.budgetDocNumber.shadow)("formControl",n.form.controls.budgetDocNumber),d.Ab(6),d.rc("mask",n.masks.budgetPeriod.mask)("jShadow",n.masks.budgetPeriod.shadow)("dropSpecialCharacters",!1)("formControl",n.form.controls.budgetPeriod),d.Ab(1),d.rc("ngbTooltip",i)("inlineSVG","/assets/icons/payments/question.svg"),d.Ab(6),d.rc("formControl",n.form.controls.uip)}}function Wa(e,t){if(1&e&&(d.Ub(0),d.Wb(1,"fieldset",13),d.Wb(2,"h5",4),d.Qc(3,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.TITLE"),d.Vb(),d.Wb(4,"div",18),d.Wb(5,"div",123),d.Rb(6,"input",124),d.Wb(7,"label",125),d.Rb(8,"span",126),d.Vb(),d.Vb(),d.Vb(),d.Oc(9,Sa,11,8,"div",127),d.Wb(10,"div",128,129),d.Wb(12,"j-form-field",null,130),d.Wb(14,"j-label",10),d.Qc(15,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.KBK"),d.Vb(),d.Wb(16,"j-select",131,132),d.Oc(18,ja,7,2,"ng-template",24),d.Oc(19,Oa,1,0,"ng-template",76),d.Oc(20,Ia,1,1,"ng-template",25),d.Vb(),d.Vb(),d.Wb(21,"j-form-field",19),d.Wb(22,"j-label",10),d.Qc(23,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.OKTMO"),d.Vb(),d.Rb(24,"input",133),d.Rb(25,"a",111),d.Vb(),d.Vb(),d.Wb(26,"div",18),d.Wb(27,"j-form-field",null,134),d.Wb(29,"j-label",10),d.Qc(30,"CURRENCY_PAYMENT.RUSSIAN_BUDGET.PAYER_STATUS"),d.Vb(),d.Wb(31,"j-select",135,136),d.Oc(33,Va,7,2,"ng-template",24),d.Oc(34,Ea,1,0,"ng-template",76),d.Oc(35,xa,1,1,"ng-template",25),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(36,"fieldset",13),d.Wb(37,"div",18),d.Wb(38,"div",123),d.Rb(39,"input",137),d.Wb(40,"label",138),d.Rb(41,"span",139),d.Vb(),d.Vb(),d.Vb(),d.Oc(42,wa,25,15,"ng-container",12),d.Vb(),d.Tb()),2&e){var n=d.Cc(11),r=d.Cc(17),i=d.Cc(28),o=d.Cc(32),a=d.lc(),c=d.Cc(147);d.Ab(6),d.rc("formControl",a.form.controls.isRussianTaxPayer),d.Ab(3),d.rc("ngIf",a.isRussianTaxpayer),d.Ab(7),d.rc("loading",a.isKbkLoading)("appendTo",n)("jFocusOnReturn",r)("formControl",a.form.controls.kbk)("clearable",!1)("searchFn",a.kbkComparator)("items",a.kbkList),d.Ab(8),d.rc("mask",a.masks.oktmo.mask)("jShadow",a.masks.oktmo.shadow)("formControl",a.form.controls.oktmo),d.Ab(1),d.rc("ngbTooltip",c)("inlineSVG","/assets/icons/payments/question.svg"),d.Ab(6),d.rc("loading",a.isStatusesLoading)("appendTo",i.elementRef.nativeElement)("jFocusOnReturn",o)("formControl",a.form.controls.payerStatus)("clearable",!1)("searchFn",a.statusComparator)("items",a.statuses),d.Ab(8),d.rc("formControl",a.form.controls.hasRussianBudgetExtras),d.Ab(3),d.rc("ngIf",a.hasRussianBudgetExtras)}}function Na(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div"),d.Wb(1,"button",81),d.ic("click",(function(e){d.Fc(n);var t=d.lc(2),r=d.Cc(85);return t.openKnpDictionary(r,e)})),d.Rb(2,"span",145),d.Wb(3,"span",10),d.Qc(4," CURRENCY_PAYMENT.DETAILS.KNP.DICTIONARY "),d.Vb(),d.Vb(),d.Wb(5,"p",146),d.Qc(6,"CURRENCY_PAYMENT.DETAILS.KNP.FREQUENT"),d.Vb(),d.Wb(7,"p",147),d.Qc(8,"CURRENCY_PAYMENT.DETAILS.KNP.DESCRIPTION"),d.Vb(),d.Vb()}2&e&&(d.Ab(2),d.rc("inlineSVG","/assets/icons/payments/list.svg"))}function Pa(e,t){1&e&&d.Oc(0,Na,9,1,"div",12),2&e&&d.rc("ngIf",!t.searchTerm)}function Ma(e,t){if(1&e&&(d.Wb(0,"div",18),d.Wb(1,"j-form-field"),d.Wb(2,"j-label",10),d.Qc(3,"CURRENCY_PAYMENT.DETAILS.KVO"),d.Vb(),d.Rb(4,"input",31),d.Vb(),d.Vb()),2&e){var n=d.lc();d.Ab(4),d.rc("mask",n.masks.kvo.mask)("formControl",n.form.controls.kvo)}}function La(e,t){if(1&e&&(d.Wb(0,"div",82),d.Qc(1),d.Vb()),2&e){var n=t.item,r=d.lc(2);d.Ab(1),d.Sc(" ",r.mapCodeWordLabel(n)," ")}}function Da(e,t){if(1&e&&d.Qc(0),2&e){var n=t.item;d.lc();var r=d.Cc(8),i=d.lc();d.Sc(" ",r.focused?"":i.mapCodeWordLabel(n||(null==i.form.controls.codeWord?null:i.form.controls.codeWord.value))," ")}}function Qa(e,t){if(1&e&&(d.Wb(0,"div",18),d.Wb(1,"j-form-field",null,148),d.Wb(3,"j-label"),d.Qc(4),d.mc(5,"translate"),d.mc(6,"async"),d.Vb(),d.Wb(7,"j-select",131,149),d.Oc(9,La,2,1,"ng-template",24),d.Oc(10,Da,1,1,"ng-template",25),d.Vb(),d.Vb(),d.Vb()),2&e){var n=d.Cc(2),r=d.Cc(8),i=d.lc();d.Ab(4),d.Rc(d.nc(5,8,d.nc(6,10,i.codeWordLabel$))),d.Ab(3),d.rc("loading",i.isCodeWordsLoading)("appendTo",n.elementRef.nativeElement)("jFocusOnReturn",r)("formControl",i.form.controls.codeWord)("clearable",!1)("searchFn",i.codeWordComparator)("items",i.codeWords)}}function Fa(e,t){if(1&e&&(d.Wb(0,"div",150),d.Wb(1,"div",151),d.Qc(2),d.Vb(),d.Vb()),2&e){var n=t.ngIf;d.Ab(2),d.Sc(" ",n," ")}}function Ba(e,t){if(1&e&&(d.Wb(0,"div",152),d.Rb(1,"span",153),d.Vb()),2&e){var n=d.lc();d.Ab(1),d.rc("innerHTML",n.comissionMessage,d.Gc)}}function $a(e,t){if(1&e&&(d.Wb(0,"div",154),d.Rb(1,"span",153),d.Vb()),2&e){var n=d.lc();d.Ab(1),d.rc("innerHTML",n.amountMessage,d.Gc)}}var Ua=function(e){return{amount:e}};function Ya(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div",154),d.Rb(1,"span",155),d.mc(2,"moneyPipe"),d.Wb(3,"a",156),d.ic("click",(function(e){return d.Fc(n),d.lc().scrollToContracts(e)})),d.Qc(4),d.mc(5,"translate"),d.Vb(),d.Vb()}if(2&e){var r=d.lc();d.Ab(1),d.rc("translate","ERRORS.CURRENCY_PAYMENT.MUST_INCLUDE_CONTRACT")("translateParams",d.wc(7,Ua,d.nc(2,3,r.contractMaxAmount))),d.Ab(3),d.Rc(d.nc(5,5,"ERRORS.CURRENCY_PAYMENT.MUST_INCLUDE_CONTRACT_LINK"))}}function Ka(e,t){if(1&e&&(d.Wb(0,"div",154),d.Rb(1,"span",153),d.Vb()),2&e){var n=d.lc();d.Ab(1),d.rc("innerHTML",n.comissionMessage,d.Gc)}}function Ha(e,t){1&e&&(d.Ub(0),d.Qc(1),d.mc(2,"translate"),d.Tb()),2&e&&(d.Ab(1),d.Sc(" ",d.nc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function Ga(e,t){if(1&e&&(d.Qc(0),d.mc(1,"translate"),d.Rb(2,"j-money",84)),2&e){var n=d.lc();d.Sc(" ",d.nc(1,2,"PAYMENTS.COMMISSION"),": "),d.Ab(2),d.rc("money",n.commissionBalance)}}function za(e,t){1&e&&d.Rb(0,"div",157)}function qa(e,t){if(1&e&&(d.Wb(0,"li",57),d.Rb(1,"j-switch",8),d.Wb(2,"span",9),d.Wb(3,"strong",10),d.Qc(4,"CURRENCY_PAYMENT.AGENT.TITLE"),d.Vb(),d.Rb(5,"br"),d.Wb(6,"small",158),d.Qc(7,"CURRENCY_PAYMENT.AGENT.DESCRIPTION"),d.Vb(),d.Vb(),d.Vb()),2&e){var n=d.lc();d.Ab(1),d.rc("formControl",n.form.controls.payComission)}}function Xa(e,t){1&e&&(d.Wb(0,"div"),d.Wb(1,"small",159),d.Qc(2,"\u041d\u0430 \u043f\u043e\u0447\u0442\u0443 \u043f\u0440\u0438\u0434\u0435\u0442 \u043a\u0432\u0438\u0442\u0430\u043d\u0446\u0438\u044f \u043e\u0431 \u043e\u043f\u043b\u0430\u0442\u0435"),d.Vb(),d.Vb())}function Za(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div",160),d.Wb(1,"j-form-field"),d.Wb(2,"j-label"),d.Qc(3,"Email \u0430\u0434\u0440\u0435\u0441"),d.Vb(),d.Wb(4,"input",161,162),d.ic("focus",(function(e){return d.Fc(n),d.lc().onEmailOnSuccessFocus(e)})),d.Vb(),d.Rb(6,"j-error",26),d.Vb(),d.Wb(7,"small",159),d.Qc(8,"\u0418\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 email \u0430\u0434\u0440\u0435\u0441 "),d.Vb(),d.Vb()}if(2&e){var r=d.lc();d.Ab(4),d.rc("ngbTypeahead",r.search)("formControl",r.form.controls.emailOnSuccess),d.Ab(2),d.rc("control",r.form.controls.emailOnSuccess)("errorMessages",r.errors.email)}}function Ja(e,t){if(1&e&&(d.Rb(0,"p",163),d.mc(1,"translate")),2&e){var n=d.lc();d.rc("innerHTML",d.nc(1,1,n.agreementText),d.Gc)}}function ec(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"button",164),d.ic("click",(function(e){return d.Fc(n),d.lc().saveToDraft()})),d.Wb(2,"strong",10),d.Qc(3,"SHARED.SAVE"),d.Vb(),d.Vb(),d.Wb(4,"button",165),d.Qc(5),d.mc(6,"translate"),d.Vb(),d.Tb()}if(2&e){var r=d.lc();d.Ab(5),d.Sc("",d.nc(6,1,r.submitLabel)," ")}}function tc(e,t){1&e&&(d.Ub(0),d.Wb(1,"button",166),d.Qc(2,"SHARED.SAVE_EDITING"),d.Vb(),d.Tb())}function nc(e,t){if(1&e&&d.Rb(0,"j-fx-contract-details",167,168),2&e){var n=d.lc();d.rc("contract",n.form.controls.contract.value)}}function rc(e,t){}function ic(e,t){1&e&&d.Rb(0,"j-kbe-info")}function oc(e,t){1&e&&(d.Wb(0,"p",169),d.Qc(1,"\u041a\u041f\u041f - \u043a\u043e\u0434 \u043f\u0440\u0438\u0447\u0438\u043d\u044b \u043f\u043e\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043d\u0430 \u0443\u0447\u0435\u0442 \u043d\u0430\u043b\u043e\u0433\u043e\u043f\u043b\u0430\u0442\u0435\u043b\u044c\u0449\u0438\u043a\u0430"),d.Vb(),d.Wb(2,"p",169),d.Qc(3,"\u041a\u041f\u041f \u0441\u043e\u0441\u0442\u043e\u0438\u0442 \u0438\u0437 9 \u0437\u043d\u0430\u043a\u043e\u0432 (\u0446\u0438\u0444\u0440)"),d.Vb())}function ac(e,t){1&e&&(d.Wb(0,"p",169),d.Qc(1,"\u041e\u041a\u0422\u041c\u041e (\u041e\u0431\u0449\u0435\u0440\u043e\u0441\u0441\u0438\u0439\u0441\u043a\u0438\u0439 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0439 \u043c\u0443\u043d\u0438\u0446\u0438\u043f\u0430\u043b\u044c\u043d\u044b\u0445 \u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u0439) - \u044d\u0442\u043e \u043a\u043e\u0434, \u043f\u0440\u0438\u0441\u0432\u043e\u0435\u043d\u043d\u044b\u0439 \u0442\u0435\u0440\u0440\u0438\u0442\u043e\u0440\u0438\u0438 \u043c\u0443\u043d\u0438\u0446\u0438\u043f\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0438\u043b\u0438 \u043d\u0430\u0441\u0435\u043b\u0435\u043d\u043d\u043e\u043c\u0443 \u043f\u0443\u043d\u043a\u0442\u0443, \u0432\u0445\u043e\u0434\u044f\u0449\u0435\u043c\u0443 \u0432 \u0435\u0433\u043e \u0441\u043e\u0441\u0442\u0430\u0432"),d.Vb())}function cc(e,t){1&e&&(d.Wb(0,"p",169),d.Qc(1,"2 \u0437\u0430\u0433\u043b\u0430\u0432\u043d\u044b\u0435 \u0431\u0443\u043a\u0432\u044b \u043d\u0430 \u043a\u0438\u0440\u0438\u043b\u043b\u0438\u0446\u0435"),d.Vb())}function sc(e,t){1&e&&(d.Wb(0,"p",169),d.Qc(1," \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u044f \u043d\u0430\u043b\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u043f\u0435\u0440\u0438\u043e\u0434\u0430 \u0438\u043c\u0435\u0435\u0442 10 \u0437\u043d\u0430\u043a\u043e\u0432 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0414\u0414.\u041c\u041c.\u0413\u0413\u0413\u0413 "),d.Vb(),d.Wb(2,"p",169),d.Qc(3," \xab\u0414\u0414\xbb \u2013 \u043f\u0435\u0440\u0438\u043e\u0434\u0438\u0447\u043d\u043e\u0441\u0442\u044c \u0443\u043f\u043b\u0430\u0442\u044b; "),d.Rb(4,"br"),d.Qc(5," \xab\u041c\u0421\xbb - \u043c\u0435\u0441\u044f\u0447\u043d\u044b\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0438;"),d.Rb(6,"br"),d.Qc(7," \xab\u041a\u0412\xbb - \u043a\u0432\u0430\u0440\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0438;"),d.Rb(8,"br"),d.Qc(9," \xab\u041f\u041b\xbb - \u043f\u043e\u043b\u0443\u0433\u043e\u0434\u043e\u0432\u044b\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0438;"),d.Rb(10,"br"),d.Qc(11," \xab\u0413\u0414\xbb - \u0433\u043e\u0434\u043e\u0432\u044b\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0438; "),d.Vb(),d.Wb(12,"p",169),d.Qc(13," \xab01\xbb - \xab31\xbb - \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u043d\u044b\u0439 \u0434\u0435\u043d\u044c."),d.Rb(14,"br"),d.Qc(15," \xab\u041c\u041c\xbb \u2013 \u043c\u0435\u0441\u044f\u0446/\u043a\u0432\u0430\u0440\u0442\u0430\u043b/\u043f\u043e\u043b\u0443\u0433\u043e\u0434\u0438\u0435 \u043e\u0442\u0447\u0435\u0442\u043d\u043e\u0433\u043e \u0433\u043e\u0434\u0430."),d.Rb(16,"br"),d.Qc(17," \xab\u0413\u0413\u0413\u0413\xbb \u2013 \u0413\u043e\u0434, \u0437\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0441\u044f \u043e\u043f\u043b\u0430\u0442\u0430. "),d.Vb(),d.Wb(18,"p",169),d.Qc(19," \u041d\u043e\u043c\u0435\u0440 \u043c\u0435\u0441\u044f\u0446\u0430 \u2013 \u043e\u0442 01 \u0434\u043e 12 "),d.Rb(20,"br"),d.Qc(21," \u041d\u043e\u043c\u0435\u0440 \u043a\u0432\u0430\u0440\u0442\u0430\u043b\u0430 - \u043e\u0442 01 \u0434\u043e 04"),d.Rb(22,"br"),d.Qc(23," \u041d\u043e\u043c\u0435\u0440 \u043f\u043e\u043b\u0443\u0433\u043e\u0434\u0438\u044f - 01 \u0438\u043b\u0438 02"),d.Rb(24,"br"),d.Qc(25," \u0413\u043e\u0434\u043e\u0432\u043e\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 \u2013 00 "),d.Vb())}var lc,uc,bc,dc,mc=function(e){return e.JYSAN="TSESKZKA",e}({}),pc=oi.a.JPY,fc=new RegExp(/(([a-zA-Z]{1}[a-zA-Z0-9\/\-?:().,\'+\ ]+)|([a-zA-Z]{1}))+/g),hc=function(e){return!!e&&"810"!=e.substring(5,8)},vc=function(e){return!!e&&["000","001","002"].includes(e.substring(6,9))},gc=function(e){return!!e&&"0"==e[0]},yc=function(e){var t,n,r;return e.value&&5!=(null===(t=e.value)||void 0===t?void 0:t.length)&&10!=(null===(n=e.value)||void 0===n?void 0:n.length)&&12!=(null===(r=e.value)||void 0===r?void 0:r.length)?{lengthMismatch:!0}:null},Cc=function(e){var t=new RegExp("^[0-9]+$");return e.value&&!e.value.match(t)?{rubInvalidNumbers:!0}:e.value&&e.value.length>8&&!gc(e.value)&&hc(e.value)?{rubInvalid:!0}:e.value&&20!=e.value.length?{rubLength:!0}:null},kc=((lc=function(e){function t(e,n,r,i,o,a,c,s,l,u,b,d,m,p,f,h,v,g,y){var C;return _classCallCheck(this,t),(C=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,b.createCurrencyForm(),a,i,o,e,n,r,l,c,u))).companyService=e,C.paymentsService=n,C.maskService=r,C.route=i,C.router=o,C.api=a,C.dictionaries=c,C.accountsService=s,C.modalService=l,C.pipelines=u,C.paymentsFormsFactory=b,C.recipientsService=d,C.currencyPaymentService=m,C.translateService=p,C.curSymbolPipe=f,C.maskPipe=h,C.conversionService=v,C.featureFlagsService=g,C.contractsModalsService=y,C.nameMaxLength=103,C.cityMaxLength=32,C.paymentCategory=ii.g.FOREIGN,C.isCounterPartyLoading$=new Hr.a(null),C.masks={iinOrBin:"iin",bankAccount:"foreignAccount",kbeCode:"kbe",knp:"knp",number:"paymentNum",amount:"amount",name:"foreignLatin",cityName:"foreignLatin",purpose:"foreignLatin",kvo:"kvo",kio:"kio",kpp:"kpp",oktmo:"oktmo",paymentBasis:"basis",budgetDocNumber:"budgetDocNumber",budgetPeriod:"budgetPeriod",rubNonRussiaCorrespondentIban:"russianAccount"},C.focusEmail$=new A.a,C.prevEmails$=new Hr.a([]),C.fetchingEmailsFor$=new Hr.a(null),C.accounts=[],C.isAccountsLoading=!0,C.contracts=[],C.filteredContracts=[],C.isContractsLoading=!1,C.isContractSelected=!1,C.withinContract=!1,C.isContractsDescriptionShown=!1,C.isContractsAgreementShown=!1,C.isContractsDescriptionLoading=!1,C.contractMaxAmount={amount:1e4,currency:oi.a.USD},C.countries=[],C.countries$=new Hr.a([]),C.hasDefaultCity=!1,C.isCityShown=!1,C.cityPlaceholder$=new Hr.a("CURRENCY_PAYMENT.RECIPIENT.CITY"),C.isBicRequired=!0,C.isIntermediaryBankSwitchable=!1,C.hasIntermediaryBank=!1,C.ibanMaxLength=34,C.amountMask="separator.2",C.amountPlaceholder="0,00",C.amountSuffix=" ",C.isCommissionAccountSelectable=!0,C.isOurComission=!1,C.canPayCommission=!0,C.commissionBalance=null,C.isKppEnabled$=new Hr.a(!1),C.isKioEnabled$=new Hr.a(!1),C.isKvoEnabled$=new Hr.a(!1),C.codeWordLabel$=new Hr.a("CURRENCY_PAYMENT.RECIPIENT.CODEWORD"),C.isCodeWordEnabled$=new Hr.a(!1),C.isRubNonRussia$=new Hr.a(!1),C.isRubToRussia$=new Hr.a(!1),C.isRussianBudgetDisabled=!1,C.isRussianBudget$=new Hr.a(!1),C.isRussianTaxpayer=!1,C.kbkList=[],C.isKbkLoading=!1,C.statuses=[],C.isStatusesLoading=!1,C.hasRussianBudgetExtras=!1,C.isAustraliaAud$=new Hr.a(!1),C.isAustraliaNonAud$=new Hr.a(!1),C.rules.purposeLength=335,C.featureFlagsService.checkFeatureRoute(bi.a.FOREIGN_PAYMENT).then((function(){C.isRussianBudgetDisabled=C.featureFlagsService.isDisabled(bi.a.RUB_BUDGET_PAYMENT)})),C}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){_get(_getPrototypeOf(t.prototype),"ngOnInit",this).call(this),this.accountStore=this.accountsService.store,this.dateLimit=this.paymentsService.stdDateRangeNgb,this.retrieveKnps(),this.retrieveAccounts(),this.retrieveCountries(),this.retrieveContracts(),this.retrieveCodeWords(),this.retrieveKbks(),this.retrieveStatuses(),this.createControlsStream(this.form),this.getMaskConfig(),this.listenCommission(),this.listenCountrySelect(),this.listenWithinContractSwitch(),this.listenContractsSwitchDescription(),this.listenContractSelect(),this.listenEmailSearch(),this.listenWorkingDays(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.listenPurpose(),this.listenPayComission(),this.listenIntermediaryBankSwitch(),this.listenIntermediaryBankSwitchable(),this.listenAmount(),this.applyAmountValidation(),this.listenAmountMessage(),this.setAutoNumeration(),this.listenCompanyType(),this.listenIsRussianBudget(),this.listenIsRussianTaxpayer(),this.listenHasRussianBudgetExtras(),this.listenRouterParams(),this.listenKvo(),this.listenKio(),this.listenCodeWordEnabling(),this.listenCodeWord(),this.listenCodeWordsList(),this.listenRubToNonRussia(),this.listenRubNonRussiaCorrespondentBank(),this.listenAudToAustralia(),this.listenAudNonAustralia(),this.listenMaxLengths(),this.applyKbeRules(),this.applyNameRules(),this.applyCountryRules(),this.applyIbanRules()}},{key:"applyKbeRules",value:function(){var e=this;this.subs.add(this.controlsStream.withinContract.subscribe((function(t){t?e.clearValidation([e.form.controls.kbeCode]):e.setValidation([e.form.controls.kbeCode],[i.H.required,ci.a.kbe])})))}},{key:"applyNameRules",value:function(){var e=this,t=this.form.controls.name,n=this.controlsStream,r=n.withinContract,o=n.senderAccount;this.subs.add(Object(Gr.a)([r,o]).pipe(Object(Zr.a)()).subscribe((function(n){var r,o,a=_slicedToArray(n,2),c=a[0],s=null===(o=null===(r=a[1])||void 0===r?void 0:r.balance)||void 0===o?void 0:o.currency,l=t.pristine;c?(t.disable(),e.clearValidation([t]),e.masks.name={mask:null}):(t.enable(),e.setValidation([t],[i.H.required]),e.masks.name=s==oi.a.RUB?ai.a.foreignCyrillic:ai.a.foreignLatin),setTimeout((function(){l&&t.markAsPristine()}),0)})))}},{key:"onNamePaste",value:function(e){e.preventDefault();var t=(e.clipboardData||window.clipboardData).getData("text").substring(0,this.nameMaxLength);this.form.controls.name.setValue(t)}},{key:"applyCountryRules",value:function(){var e=this,t=this.form.controls.countryCode,n=this.controlsStream,r=n.withinContract,o=n.senderAccount,a=n.contract;this.subs.add(Object(Gr.a)([r,o,a]).pipe(Object(Zr.a)()).subscribe((function(n){var r,o,a=_slicedToArray(n,2),c=a[0],s=null===(o=null===(r=a[1])||void 0===r?void 0:r.balance)||void 0===o?void 0:o.currency,l=t.pristine;if(c)t.disable(),e.clearValidation([t]);else{t.enable();var u=[i.H.required];s===oi.a.CNY&&u.push((function(e){return e.value!=Vo.a.CN?{cnyOnlyToChina:!0}:null})),e.setValidation([t],u)}setTimeout((function(){l&&t.markAsPristine()}),0)})))}},{key:"onCountrySearch",value:function(e){var t=this,n=e.term;if(n){var r=this.countries.filter((function(e){return e.code.toLowerCase().includes(n.toLowerCase())||e.nameEn.toLowerCase().includes(n.toLowerCase())||e.nameKk.toLowerCase().includes(n.toLowerCase())||e.nameRu.toLowerCase().includes(n.toLowerCase())})).sort((function(e,r){return t.countrySorter(e,r,n)}));this.countries$.next(r)}else this.countries$.next(this.countries)}},{key:"onCountryFocus",value:function(){this.form.controls.senderAccount.value||(this.senderAccountDropdown.hasError=!0)}},{key:"onCountrySelect",value:function(e){this.hasDefaultCity=!!e.defaultCityName,this.form.controls.country.setValue(e)}},{key:"countrySorter",value:function(e,t,n){if(e.code.toLowerCase()===n.toLowerCase())return-1;if(t.code.toLowerCase()===n.toLowerCase())return 1;if(e.code.toLowerCase().includes(n.toLowerCase()))return-1;if(t.code.toLowerCase().includes(n.toLowerCase()))return 1;switch(this.translateService.currentLang){case"ru":return e.nameRu<t.nameRu?-1:1;case"en":return e.nameEn<t.nameEn?-1:1;case"kz":return e.nameKk<t.nameKk?-1:1;default:return 0}}},{key:"countryComparator",value:function(e,t){return!0}},{key:"mapCountryLabel",value:function(e){var t;switch(this.translateService.currentLang){case"ru":default:t=e.nameRu;break;case"kz":t=e.nameKk;break;case"en":t=e.nameEn}return"".concat(e.code," - ").concat(t||e.name)}},{key:"retrieveCountries",value:function(){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.currencyPaymentService.getCountries();case 2:this.countries=e.sent,this.countries$.next(this.countries);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"applyIbanRules",value:function(){var e=this,t=this.controlsStream,n=t.senderAccount,r=t.country,o=t.countryCode,a=t.contract,c=t.contractId,s=t.bank,l=t.rubNonRussiaBank,u=t.withinContract;this.subs.add(Object(Gr.a)([n,s,l,r,o,a,c,u,this.countries$]).subscribe((function(t){var n,r,o,a=_slicedToArray(t,3),c=a[0],s=a[1],l=a[2],u=[i.H.required],b=null===(r=null===(n=c)||void 0===n?void 0:n.balance)||void 0===r?void 0:r.currency,d=e.form.controls.bankAccount.pristine;if(b===oi.a.RUB&&e.currentCountryCode==Vo.a.RU)e.masks.bankAccount=ai.a.russianAccount,u.push((function(e){var t;return function(e,t){var n=new RegExp("^[0-9]+$");return e.value&&!e.value.match(n)?{rubInvalidNumbers:!0}:e.value&&t&&!gc(e.value)&&vc(t)?{rubInvalidBudget:!0}:e.value&&t&&e.value.length>8&&!gc(e.value)&&hc(e.value)?{rubInvalid:!0}:e.value&&20!=e.value.length?{rubLength:!0}:null}(e,null===(t=s)||void 0===t?void 0:t.bic)}));else{var m=b===oi.a.RUB?l:s,p=null===(o=e.countries.find((function(e){var t;return e.id===(null===(t=m)||void 0===t?void 0:t.countryId)})))||void 0===o?void 0:o.code;e.masks.bankAccount=ai.a.foreignAccount,u.push((function(e){return function(e,t){var n,r,i,o=null===(n=e.value)||void 0===n?void 0:n.substring(0,2).match(/[A-Za-z]{2}/);return t&&o&&(null===(r=e.value)||void 0===r?void 0:r.substring(0,2).toUpperCase())!=(null===(i=t)||void 0===i?void 0:i.substring(0,2).toUpperCase())?{currencyMismatch:!0}:null}(e,p)})),u.push(i.H.maxLength(e.ibanMaxLength))}e.setValidation([e.form.controls.bankAccount],u),setTimeout((function(){d&&e.form.controls.bankAccount.markAsPristine()}),0)})))}},{key:"mapContractLabel",value:function(e){var t,n,r,i,o,a=this.form.getRawValue().contract;return(null===(t=e)||void 0===t?void 0:t.contractNumber)||(null===(r=null===(n=e)||void 0===n?void 0:n.contractor)||void 0===r?void 0:r.name)?"".concat(e.contractNumber," - ").concat(null===(i=e.contractor)||void 0===i?void 0:i.name):a?"".concat(a.contractNumber," - ").concat(null===(o=a.contractor)||void 0===o?void 0:o.name):""}},{key:"openForeignContractsRecipientsDictionary",value:function(){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.modals.open(Oo,{backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",centered:!0}),n=this.form.getRawValue(),r=n.contract,t.componentInstance.recipients=r.recipients,e.prev=2,e.next=5,t.result;case 5:i=e.sent,this.selectContractRecipient(i),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:case"end":return e.stop()}}),e,this,[[2,9]])})))}},{key:"selectContractRecipient",value:function(e){var t,n,r,i,o=this.form.controls,a=o.name,c=o.country,s=o.countryCode,l=o.bankAccount,u=o.bank,b=o.cityName,d=o.fxContractRecipient,m=o.fxContractRecipientId;d.setValue(e),m.setValue(e.id),a.setValue(e.name||""),(null===(t=e.country)||void 0===t?void 0:t.code)&&!this.countries.find((function(t){var n;return t.code==(null===(n=e.country)||void 0===n?void 0:n.code)}))&&this.countries$.next([].concat(_toConsumableArray(this.countries),[e.country])),c.setValue(e.country),s.setValue((null===(n=e.country)||void 0===n?void 0:n.code)||e.countryCode),(e.cityName||e.defaultCityName)&&b.setValue(e.cityName||e.defaultCityName||""),e.iban&&l.setValue(e.iban),e.bankBic&&(u.setValue({code:e.bankBic,name:e.bankName}),null===(r=this.bankDropdown)||void 0===r||r.selectByBic(e.bankBic),null===(i=this.rubNonRussiaBankDropdown)||void 0===i||i.selectByBic(e.bankBic))}},{key:"showContractDetails",value:function(e){e.preventDefault(),e.stopPropagation(),this.contractDetails.show()}},{key:"onContractSelect",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,o,a,c,s,l,u,b,d,m;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=this.form.controls,o=i.contract,a=i.kio,c=i.contractId,r.next=6,this.currencyPaymentService.getContractById(e.id);case 6:if(s=r.sent,Object.assign(e,s),o.setValue(e),c.setValue(e.id),e.contractor.iinOrBin&&!n&&(null===(t=a)||void 0===t||t.setValue(e.contractor.iinOrBin)),l=e.recipients.find((function(e){return e.primary})),u=this.form.getRawValue(),b=u.fxContractRecipient,d=u.fxContractRecipientId,b||d){r.next=12;break}return r.abrupt("return",void this.selectContractRecipient(l));case 12:(m=e.recipients.find((function(e){var t;return(null===(t=b)||void 0===t?void 0:t.id)===e.id||d===e.id})))&&(l=m),this.selectContractRecipient(l);case 14:case"end":return r.stop()}}),r,this)})))}},{key:"contractComparator",value:function(e,t){if(!e)return!0;var n=t.contractor.name.toLowerCase().includes(e.toLowerCase()),r=t.contractNumber.toLowerCase().includes(e.toLowerCase());return n||r}},{key:"onEmailOnSuccessFocus",value:function(e){this.focusEmail$.next(e.target.value)}},{key:"onSenderAccountSelect",value:function(e){e&&(this.form.controls.senderAccount.setValue(e),this.form.controls.senderAccount.markAsDirty(),this.senderAccountDropdown.hasError=!1)}},{key:"onCommissionAccountSelect",value:function(e){this.form.controls.commissionAccount.setValue(e)}},{key:"codeWordComparator",value:function(e,t){return!e||t.name.toLowerCase().includes(e.toLowerCase())||t.code.toLowerCase().includes(e.toLowerCase())}},{key:"kbkComparator",value:function(e,t){return!e||t.code.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase())}},{key:"statusComparator",value:function(e,t){return!e||t.code.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase())}},{key:"scrollToContracts",value:function(e){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.next=3,this.form.controls.withinContract.setValue(!0);case 3:setTimeout((function(){document.getElementById("contractGroup").scrollIntoView({behavior:"smooth"}),n.contractsSelect.focus(),n.contractsSelect.open()}),100);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"onAmountPaste",value:function(e){var t,n;e.preventDefault();var r=this.form.getRawValue(),i=(e.clipboardData||window.clipboardData).getData("text"),o=this.maskService.getNumberedAmount(i);(null===(n=null===(t=r.senderAccount)||void 0===t?void 0:t.balance)||void 0===n?void 0:n.currency)==pc&&(o=Math.trunc(o)),this.form.controls.amount.setValue(o)}},{key:"mapCodeWordLabel",value:function(e){if(e)return"".concat(e.code," - ").concat(e.name)}},{key:"listenMaxLengths",value:function(){var e=this;this.subs.add(Object(Gr.a)([this.isAustraliaAud$,this.isAustraliaNonAud$,this.isRubNonRussia$,this.isRubToRussia$,this.controlsStream.name,this.controlsStream.purpose,this.purposeMessage$,this.controlsStream.countryCode]).subscribe((function(t){var n,r,o=_slicedToArray(t,8),a=o[0],c=o[1],s=o[2],l=o[3],u=o[4],b=o[5],d=o[6],m=o[7];if(u=u||"",b=b||"",d=d||"",a?(e.nameMaxLength=35,e.cityMaxLength=26):c?(e.nameMaxLength=35,e.cityMaxLength=31):s?(e.nameMaxLength=35,e.cityMaxLength=32):(e.nameMaxLength=103,e.cityMaxLength=32),l||s){e.rules.purposeLength=203;var p=u.match(fc);(null===(n=p)||void 0===n?void 0:n.length)>0&&(e.nameMaxLength-=2*p.length);var f=b.match(fc);(null===(r=f)||void 0===r?void 0:r.length)>0&&(e.rules.purposeLength-=2*f.length)}else e.rules.purposeLength=m==Vo.a.CN?300:335;e.setValidation([e.form.controls.purpose],[i.H.maxLength(m===Vo.a.CN?e.rules.purposeLength:e.rules.purposeLength-d.length)],!1)})))}},{key:"listenAudToAustralia",value:function(){var e=this;this.subs.add(this.isAustraliaAud$.subscribe((function(t){var n=e.form.controls,r=n.audIndex,o=n.audState,a=n.audStreet,c=n.audBuildingNumber;t?e.setValidation([r,o,a,c],[i.H.required]):e.clearValidation([r,o,a,c])})))}},{key:"listenAudNonAustralia",value:function(){var e=this;this.subs.add(this.isAustraliaNonAud$.subscribe((function(t){var n=e.form.controls.audAddress;t?e.setValidation([n],[i.H.required]):e.clearValidation([n])})))}},{key:"listenCompanyType",value:function(){var e=this;this.subs.add(this.companyService.refresh$.subscribe((function(t){e.companyService.currentCompany.type==si.b.CORPORATE?(e.agreementText="CURRENCY_PAYMENT.AGREEMENT.CORPORATE",e.isContractsAgreementShown=!1,e.isContractsDescriptionShown=!0):(e.agreementText="CURRENCY_PAYMENT.AGREEMENT.ENTREPRENEUR",e.isContractsAgreementShown=!0,e.isContractsDescriptionShown=!1)})))}},{key:"retrieveKnps",value:function(){var e=this;this.knp$=this.combineKNP([function(t){return e.dictionaries.selectByPaymentType(t,{type:ii.i.FOREIGN,sortFavourite:!1})}])}},{key:"retrieveAccounts",value:function(){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isAccountsLoading=!0,e.prev=1,e.next=4,this.accountsService.getAccounts(this.companyService.currentId);case 4:t=e.sent,this.accounts=t.filter((function(e){return e.balance.currency&&e.accountType==l.a.ACCOUNT})).sort(this.sortAccounts),this.selectDefaultSenderAccount(),this.listenCommissionAccount(),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:return e.prev=10,this.isAccountsLoading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,8,10,13]])})))}},{key:"selectDefaultSenderAccount",value:function(){try{1==this.senderAccountsList.length&&(this.senderAccountDropdown.selectAccount(this.senderAccountsList[0]),this.onSenderAccountSelect(this.senderAccountsList[0]),this.senderAccountDropdown.isDisabled=!0)}catch(e){}}},{key:"retrieveContracts",value:function(){var e,t;return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.isContractsLoading=!0,n.prev=1,n.next=4,this.currencyPaymentService.getContracts();case 4:r=n.sent,this.contracts=r.filter((function(e){return e.status===ii.c.REGED})),i=null===(t=null===(e=this.formValue.senderAccount)||void 0===e?void 0:e.balance)||void 0===t?void 0:t.currency,this.filteredContracts=i?this.contracts.filter((function(e){return e.permittedCurrencies.includes(i)})):_toConsumableArray(this.contracts),n.next=12;break;case 10:n.prev=10,n.t0=n.catch(1);case 12:return n.prev=12,this.isContractsLoading=!1,n.finish(12);case 15:case"end":return n.stop()}}),n,this,[[1,10,12,15]])})))}},{key:"retrieveKbks",value:function(){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isKbkLoading=!0,e.prev=1,e.next=4,this.currencyPaymentService.getKbkList();case 4:this.kbkList=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:return e.prev=9,this.isKbkLoading=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[1,7,9,12]])})))}},{key:"retrieveStatuses",value:function(){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isStatusesLoading=!0,e.prev=1,e.next=4,this.currencyPaymentService.getStatuses();case 4:this.statuses=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:return e.prev=9,this.isStatusesLoading=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[1,7,9,12]])})))}},{key:"retrieveCodeWords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentCountryCode;return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isCodeWordsLoading){t.next=16;break}if(this.isCodeWordsLoading=!0,t.prev=2,!e){t.next=9;break}return t.next=6,this.currencyPaymentService.getCodeWords(e);case 6:this.codeWords=t.sent,n=this.form.controls.codeWord.value,this.codeWords.find((function(e){return n.code===e.code&&n.countryCode===e.countryCode}))||this.form.controls.codeWord.setValue("");case 9:t.next=13;break;case 11:t.prev=11,t.t0=t.catch(2);case 13:return t.prev=13,this.isCodeWordsLoading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[2,11,13,16]])})))}},{key:"listenCountrySelect",value:function(){var e=this,t=this.controlsStream,n=t.countryCode,r=t.senderAccount,o=t.country;this.subs.add(Object(Gr.a)([n,r,o]).pipe(Object(Zr.a)()).subscribe((function(t){var n,r,o=_slicedToArray(t,2),a=o[0],c=o[1];a&&(e.form.controls.bankLabel.setValue(""),e.form.controls.bank.setValue(null),(null===(r=null===(n=c)||void 0===n?void 0:n.balance)||void 0===r?void 0:r.currency)==oi.a.RUB||e.hasDefaultCity?(e.isCityShown=!1,e.clearValidation([e.form.controls.cityName])):(e.isCityShown=!0,e.setValidation([e.form.controls.cityName],[i.H.required])))})))}},{key:"listenContractsSwitchDescription",value:function(){var e=this;this.subs.add(this.controlsStream.senderAccount.subscribe((function(t){var n,r,i,o,a,c;e.filteredContracts=e.contracts.filter((function(e){var n,r,i;return null===(n=e.permittedCurrencies)||void 0===n?void 0:n.includes(null===(i=null===(r=t)||void 0===r?void 0:r.balance)||void 0===i?void 0:i.currency)})),(null===(r=null===(n=e.formValue.contract)||void 0===n?void 0:n.amount)||void 0===r?void 0:r.currency)!==(null===(o=null===(i=t)||void 0===i?void 0:i.balance)||void 0===o?void 0:o.currency)&&(e.form.controls.contract.setValue(null),e.form.controls.contractId.setValue("")),e.updateContractsSwitchDescriptionParams((null===(c=null===(a=t)||void 0===a?void 0:a.balance)||void 0===c?void 0:c.currency)||null)})))}},{key:"listenIsRussianBudget",value:function(){var e=this;this.subs.add(Object(Gr.a)([this.controlsStream.senderAccount,this.controlsStream.bankAccount,this.controlsStream.bank,this.controlsStream.withinContract,this.controlsStream.contract,this.controlsStream.country]).subscribe((function(t){var n,r,i,o=_slicedToArray(t,3),a=o[0],c=o[1],s=o[2],l=gc(c)&&vc(null===(n=s)||void 0===n?void 0:n.bic);e.currentCountryCode==Vo.a.RU&&(null===(i=null===(r=a)||void 0===r?void 0:r.balance)||void 0===i?void 0:i.currency)===oi.a.RUB&&l&&!e.featureFlagsService.isDisabled(bi.a.RUB_BUDGET_PAYMENT)?(e.isRussianBudget$.next(!0),e.form.controls.isRussianBudget.setValue(!0)):(e.isRussianBudget$.next(!1),e.form.controls.isRussianBudget.setValue(!1))})))}},{key:"listenWithinContractSwitch",value:function(){var e=this,t=this.controlsStream,n=t.withinContract,r=t.senderAccount,o=t.contract,a=t.country;this.subs.add(Object(Gr.a)([n,r,o,a]).pipe(Object(Zr.a)()).subscribe((function(t){var n,r,o,a=_slicedToArray(t,4),c=a[0],s=a[1],l=a[2];a[3],e.withinContract=c;var u=null===(r=null===(n=s)||void 0===n?void 0:n.balance)||void 0===r?void 0:r.currency,b=e.form.controls,d=[b.bank,b.bankLabel];if(e.currentCountryCode===Vo.a.US?(e.cityPlaceholder$.next("CURRENCY_PAYMENT.RECIPIENT.CITY_STATE"),e.clearValidation([e.form.controls.bankLabel,e.form.controls.bank])):e.cityPlaceholder$.next(e.formValue.isRubNonRussia?"CURRENCY_PAYMENT.RECIPIENT.CITY_BANK":"CURRENCY_PAYMENT.RECIPIENT.CITY"),c){var m=u===oi.a.RUB;!(null===(o=l)||void 0===o?void 0:o.contractor.iinOrBin)&&m?e.isKioEnabled$.next(!0):e.isKioEnabled$.next(!1),e.clearValidation(d),e.setValidation([e.form.controls.contractId],[function(t){return e.currentCountryCode!=Vo.a.CN&&u==oi.a.CNY?{cnyOnlyToChina:!0}:null},i.H.required],!1);var p=u===oi.a.AUD,f=e.currentCountryCode===Vo.a.AU;e.isAustraliaAud$.next(p&&f),e.isAustraliaNonAud$.next(!p&&f),e.currentCountryCode&&u==oi.a.RUB&&(e.rubNonRussiaWithinContractCountry=l.contractor.country.code,e.applyRubPaymentRules(e.rubNonRussiaWithinContractCountry))}else{e.form.controls.contract.setValue(null,{emitEvent:!1}),e.form.controls.contractId.setValue(null),e.clearValidation([e.form.controls.contractId]),e.setValidation(d,[i.H.required]);var h=u===oi.a.AUD,v=e.currentCountryCode===Vo.a.AU;e.isAustraliaAud$.next(h&&v),e.isAustraliaNonAud$.next(!h&&v),u===oi.a.RUB?e.applyRubPaymentRules(e.currentCountryCode):u===oi.a.CNY?(e.form.controls.codeWord.setValue(""),e.applyChinaPaymentRules(e.currentCountryCode)):e.applyDefaultPaymentRules()}})))}},{key:"listenCodeWordEnabling",value:function(){var e=this,t=this.controlsStream,n=t.withinContract,r=t.contract,i=t.country;this.subs.add(Object(Gr.a)([n,r,i]).subscribe((function(t){e.currentCountryCode===Vo.a.AE?(e.isCodeWordEnabled$.next(!0),e.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD_AE")):e.currentCountryCode===Vo.a.CN?(e.isCodeWordEnabled$.next(!0),e.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD")):(e.isCodeWordEnabled$.next(!1),e.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD"))})))}},{key:"listenContractSelect",value:function(){var e=this;this.subs.add(this.controlsStream.contractId.pipe(Object(Zr.a)()).subscribe((function(t){e.isContractSelected=!!t})))}},{key:"updateContractsSwitchDescriptionParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oi.a.USD;return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,i,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e||e===oi.a.USD){t.next=18;break}return this.isContractsDescriptionLoading=!0,n={currencyFrom:e,currencyTo:oi.a.USD,sum:{amount:1e4,currency:oi.a.USD}},t.prev=3,t.next=6,this.conversionService.getRate(n);case 6:r=t.sent,this.contractMaxAmount={amount:r.calculatedSum,currency:e},t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),this.contractMaxAmount={amount:1e4,currency:oi.a.USD};case 13:return t.prev=13,this.isContractsDescriptionLoading=!1,t.finish(13);case 16:t.next=19;break;case 18:this.contractMaxAmount={amount:1e4,currency:oi.a.USD};case 19:i=(i=this.maskService.getMaskedAmount(this.contractMaxAmount.amount)).split(",").filter((function(e){return parseInt(e)>0})).map((function(e,t){return 1==t&&e.length<2?"".concat(e,"0"):e})).join(","),o=this.curSymbolPipe.transform(this.contractMaxAmount.currency),this.contractsSwitchDescriptionParams={amount:"".concat(i," ").concat(o)};case 23:case"end":return t.stop()}}),t,this,[[3,10,13,16]])})))}},{key:"openForeignRecipientsDictionary",value:function(){var e,t;return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,o,a,c,s,l,u,b,d,m,p;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.modals.open(vo,{backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",centered:!0}),n.prev=1,n.next=4,r.result;case 4:i=n.sent,o=this.form.controls,a=o.countryCode,c=o.cityName,s=o.name,l=o.bankAccount,u=o.kbeCode,b=o.bank,d=o.kio,m=i.recipient,p=i.account,a.setValue(m.countryCode),c.setValue(m.cityName||""),s.setValue(m.name||""),l.setValue(p.iban),u.setValue(m.kbe.code),b.setValue({bic:p.bic,name:p.bankName}),this.bankDropdown.selectByBic(p.bic),null===(e=this.rubNonRussiaBankDropdown)||void 0===e||e.selectByBic(p.bic),null===(t=d)||void 0===t||t.setValue(m.iinOrBin),n.next=20;break;case 18:n.prev=18,n.t0=n.catch(1);case 20:case"end":return n.stop()}}),n,this,[[1,18]])})))}},{key:"applyAmountValidation",value:function(){var e=this;this.subs.add(Object(Gr.a)([this.controlsStream.senderAccount,this.controlsStream.contractId]).subscribe((function(t){var n=_slicedToArray(t,2),r=(n[0],n[1],[i.H.required,i.H.min(e.paymentsService.rules.minAmount),i.H.max(e.paymentsService.rules.maxAmount),function(e){var t;return 0==(null===(t=e)||void 0===t?void 0:t.value)?{cantBeZero:!0}:null}]);e.setValidation([e.form.controls.amount],r,!1)})))}},{key:"setValidation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e.forEach((function(e){var r=e.pristine;e.setValidators(t),e.updateValueAndValidity({emitEvent:n}),setTimeout((function(){r&&e.markAsPristine()}),0)}))}},{key:"clearValidation",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.forEach((function(e){var n=e.pristine;e.clearValidators(),e.updateValueAndValidity({emitEvent:t}),setTimeout((function(){n&&e.markAsPristine()}),0)}))}},{key:"listenPayComission",value:function(){var e=this;this.subs.add(this.controlsStream.payComission.pipe(Object(Zr.a)()).subscribe((function(t){e.isOurComission=t})))}},{key:"listenIntermediaryBankSwitchable",value:function(){var e=this,t=this.controlsStream,n=t.senderAccount,r=t.country,i=t.bank;this.subs.add(Object(Gr.a)([n,r,i]).subscribe((function(t){var n,r,i,o=_slicedToArray(t,3),a=o[0],c=(o[1],o[2]),s=null===(r=null===(n=a)||void 0===n?void 0:n.balance)||void 0===r?void 0:r.currency,l=null===(i=c)||void 0===i?void 0:i.bic;(s==oi.a.EUR||s==oi.a.USD&&e.currentCountryCode!=Vo.a.US)&&l!=mc.JYSAN?(e.isIntermediaryBankSwitchable=!0,e.setValidation([e.form.controls.intermediaryBankLabel],[function(t){var n=e.form.getRawValue();return t.value&&t.value===n.bankLabel?{equalBanks:!0}:null}])):(e.clearValidation([e.form.controls.intermediaryBankLabel]),e.isIntermediaryBankSwitchable=!1)})))}},{key:"listenIntermediaryBankSwitch",value:function(){var e=this;this.subs.add(this.controlsStream.hasIntermediaryBank.pipe(Object(Zr.a)()).subscribe((function(t){e.hasIntermediaryBank=t,t||(e.form.controls.intermediaryBankLabel.setValue(""),e.form.controls.intermediaryBank.setValue(null))})))}},{key:"listenEmailSearch",value:function(){var e=this,t=this.form.controls.emailOnSuccess;this.subs.add(this.controlsStream.notify.pipe(Object(me.a)(100)).subscribe((function(e){return e?t.enable():t.disable()}))),this.search=function(t){return Object(Gr.a)([e.prevEmails$.pipe(Object(fe.a)((function(e){return e.map((function(e){return e.email}))}))),t.pipe(Object(me.a)(200),Object(Zr.a)(),Object(be.a)("")),e.focusEmail$]).pipe(Object(fe.a)((function(e){var t=_slicedToArray(e,3),n=t[0],r=t[1];return t[2],r?n.filter((function(e){return e.toLowerCase().indexOf(r.toLowerCase())>-1})).slice(0,3):n.slice(0,3)})))}}},{key:"setAutoNumeration",value:function(){var e=this;this.subs.add(this.paymentsService.foreignPaymentNumber$.pipe(Object(Jr.a)(this.controlsStream.number)).subscribe((function(t){var n=_slicedToArray(t,2),r=n[0];n[1]||e.form.controls.number.setValue(r)})))}},{key:"listenCommission",value:function(){var e=this,t=this.controlsStream,n=t.senderAccount,r=t.date,i=t.commissionAccount,o=t.amount,a=t.payComission;Object(Gr.a)([n,r,i,o,a]).pipe(Object(me.a)(300)).subscribe((function(t){e.updateComission()}))}},{key:"updateComission",value:function(){var e,t,n,r,i,o,a,c,s,l,u,b;return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function d(){var m,p,f,h,v,g,y,C,k,A,T;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(m=this.form.controls,p=m.senderAccount,f=m.date,h=m.commissionAccount,v=m.amount,g=m.payComission,y=!0,[p,f,h,v,g].forEach((function(e){e.invalid&&(y=!1)})),y){d.next=4;break}return d.abrupt("return");case 4:return C=this.form.getRawValue(),d.prev=5,k=C.date?Object(Oe.ngbStructToISO)(C.date):null,A=this.maskService.getNumberedAmount(C.amount),T={companyId:this.companyService.currentId,category:ii.g.FOREIGN,type:ii.i.FOREIGN,details:{valueDate:k,paymentAmount:{amount:A,currency:null===(t=null===(e=C.senderAccount)||void 0===e?void 0:e.balance)||void 0===t?void 0:t.currency},foreignPaymentDetails:{type:C.payComission?"OUR":"SHA"},urgent:!1,payerIban:C.senderAccount.iban}},d.next=9,this.api.getCommissionWithCurrency(T);case 9:this.commissionBalance=d.sent,this.form.controls.comission.setValue((null===(n=this.commissionBalance)||void 0===n?void 0:n.amount)||0),this.form.controls.comissionCurrency.setValue(this.commissionBalance.currency),this.comissionMessage=(null===(i=null===(r=C.commissionAccount)||void 0===r?void 0:r.balance)||void 0===i?void 0:i.amount)<(null===(o=this.commissionBalance)||void 0===o?void 0:o.amount)&&(null===(c=null===(a=C.commissionAccount)||void 0===a?void 0:a.balance)||void 0===c?void 0:c.currency)===(null===(s=this.commissionBalance)||void 0===s?void 0:s.currency)?this.mapCommissionMessage({amount:(null===(l=this.commissionBalance)||void 0===l?void 0:l.amount)-(null===(b=null===(u=C.commissionAccount)||void 0===u?void 0:u.balance)||void 0===b?void 0:b.amount),currency:this.commissionBalance.currency}):null,d.next=18;break;case 15:d.prev=15,d.t0=d.catch(5),this.commission$.next(null),this.comissionMessage=null;case 18:case"end":return d.stop()}}),d,this,[[5,15]])})))}},{key:"mapCommissionMessage",value:function(e){var t=this.form.getRawValue().date,n="\u041d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 ".concat(this.maskService.formatAmount(e.amount)," ").concat(this.curSymbolPipe.transform(e.currency)," \u043d\u0430 \u0441\u0447\u0435\u0442\u0435 \u0434\u043b\u044f \u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f \u043a\u043e\u043c\u0438\u0441\u0441\u0438\u0438. \u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0431\u0430\u043b\u0430\u043d\u0441 ");return t&&(n+='\u043d\u0435 \u043f\u043e\u0437\u0434\u043d\u0435\u0435 <span class="text-danger">'.concat(Object(Oe.formatNgbDate)(t,"g")," ").concat(Oe.edgeTimeLabel,"</span> ")),n+="\u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0442\u0435\u0436\u0430 \u0411\u0430\u043d\u043a\u043e\u043c"}},{key:"mapAmountMessage",value:function(e){var t=this.form.getRawValue().date,n="\u041d\u0435 \u0445\u0432\u0430\u0442\u0430\u0435\u0442 ".concat(this.maskService.formatAmount(e.amount)," ").concat(this.curSymbolPipe.transform(e.currency)," \u043d\u0430 \u0441\u0447\u0435\u0442\u0435. \u041f\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0431\u0430\u043b\u0430\u043d\u0441 ");return t&&(n+='\u043d\u0435 \u043f\u043e\u0437\u0434\u043d\u0435\u0435 <span class="text-danger">'.concat(Object(Oe.formatNgbDate)(t,"g")," ").concat(Oe.edgeTimeLabel,"</span> ")),n+="\u0434\u043b\u044f \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0442\u0435\u0436\u0430 \u0411\u0430\u043d\u043a\u043e\u043c"}},{key:"sortAccounts",value:function(e,t){return e.balance.currency===t.balance.currency?0:e.balance.currency===oi.a.USD?-1:1}},{key:"listenAmount",value:function(){var e=this,t=this.form.controls.amount;this.subs.add(this.controlsStream.senderAccount.pipe(Object(Zr.a)(),Object(fe.a)((function(n){var r,i,o=null===(i=null===(r=n)||void 0===r?void 0:r.balance)||void 0===i?void 0:i.currency,a=t.pristine;return e.amountSuffix=" ".concat(e.curSymbolPipe.transform(o)||o||e.curSymbolPipe.transform(oi.a.KZT)),o==pc?(e.amountMask="separator.0",e.amountPlaceholder="0"):(e.amountMask="separator.2",e.amountPlaceholder="0,00"),a})),Object(ei.a)(0)).subscribe((function(e){e&&e!==t.pristine&&t.markAsPristine()})))}},{key:"listenAmountMessage",value:function(){var e=this,t=this.controlsStream,n=t.senderAccount,r=t.date,i=t.amount,o=t.contractId;Object(Gr.a)([n,r,i,o]).pipe(Object(Zr.a)()).subscribe((function(t){var n,r,i,o,a=_slicedToArray(t,3),c=a[0],s=(a[1],a[2]),l=e.maskService.getNumberedAmount(s),u=(null===(r=null===(n=c)||void 0===n?void 0:n.balance)||void 0===r?void 0:r.amount)<l&&!e.shouldBindContract;e.amountMessage=u?e.mapAmountMessage({amount:l-(null===(o=null===(i=c)||void 0===i?void 0:i.balance)||void 0===o?void 0:o.amount),currency:c.balance.currency}):null}))}},{key:"listenCommissionAccount",value:function(){var e=this;this.subs.add(this.controlsStream.senderAccount.pipe(Object(Zr.a)()).subscribe((function(t){var n,r,i,o,a,c,s,l,u=e.form.getRawValue().commissionAccount;if(u&&(null===(r=null===(n=u)||void 0===n?void 0:n.balance)||void 0===r?void 0:r.currency)!=(null===(o=null===(i=t)||void 0===i?void 0:i.balance)||void 0===o?void 0:o.currency)&&(e.commissionAccountDropdown.clearSelected(),e.onCommissionAccountSelect(null)),1==e.commissionAccountsList.length){var b=e.commissionAccountsList[0];null===(a=e.commissionAccountDropdown)||void 0===a||a.selectAccount(b),e.onCommissionAccountSelect(b),e.isCommissionAccountSelectable=!1}else e.isCommissionAccountSelectable=!0;var d=e.commissionAccountsList.filter((function(e){return e.balance.currency===oi.a.KZT}));1==(null===(c=d)||void 0===c?void 0:c.length)?(null===(s=e.commissionAccountDropdown)||void 0===s||s.selectAccount(d[0]),e.onCommissionAccountSelect(d[0])):0===d.length&&t&&(null===(l=e.commissionAccountDropdown)||void 0===l||l.selectAccount(t),e.onCommissionAccountSelect(t))})))}},{key:"saveToDraft",value:function(e){var t,n=this;this.formDirective.submitted=!0,this.formDirective.form.markAsPristine();var r=this.paymentsService.foreignPaymentNumber,i=e||Object.assign({},this.form.value);r.entity=null,this.processingPayment$.next(Object.assign({id:this.paymentId},i)),this.pipeline.saveToDrafts(i,{paymentId:this.paymentId,type:ii.i.FOREIGN,commission:null===(t=this.commissionBalance)||void 0===t?void 0:t.amount,userPurpose:this.form.value.purpose,category:ii.g.FOREIGN}).then((function(e){e.id!==n.paymentId&&(e&&(n.restoredData={status:e.status,signatures:e.signatures,companyId:e.companyId}),n.router.navigate([n.route.snapshot.params.paymentId?"../":".",e.id],{relativeTo:n.route,state:{silent:!0,resolvedPayment:n.currencyPaymentService.mapForm(n.form.getRawValue())}}))})).catch((function(e){r.entity||r.fetching||(r.entity=i.number)})).finally((function(){n.processingPayment$.next(null)}))}},{key:"listenRouterParams",value:function(){var e=this;this.subs.add(this.route.params.pipe(Object(fe.a)((function(t){return{state:window.history.state,params:t,route:e.route}})),Object(me.a)(0),Object(ti.a)((function(t){var n,r,i,o=t.params,a=t.state;if(null===(n=a)||void 0===n?void 0:n.silent)return e.restoredData.status===ii.h.DRAFT?e.paymentsService.rootTitle=Vo.d.EDIT_DRAFT:e.restoredData.status===ii.h.CREATED&&(e.paymentsService.rootTitle=Vo.d.EDIT_PAYMENT),zr.a;if(null===(r=a)||void 0===r?void 0:r.resolvedPayment)return Object(qr.a)(a.resolvedPayment);if(o.paymentId||(null===(i=a)||void 0===i?void 0:i.repeatPaymentId)){var c=o.paymentId||a.repeatPaymentId;return Object(Xr.a)(e.api.getPaymentById(c)).pipe(Object(ni.a)((function(t){return e.router.navigate([e.router.url.replace("/"+c,"")]),zr.a})))}return e.setAutoNumeration(),e.paymentsService.rootTitle=Vo.d.NEW,zr.a}))).subscribe((function(t){e.restorePayment(t)})))}},{key:"restorePayment",value:function(e){var t=this;this.subs.add(Object(Gr.a)([this.knpStore.fetched$]).pipe(Object(pe.a)((function(e){return e.every((function(e){return e}))})),Object(de.a)((function(){var n,r;try{r=t.pipeline.flattenPaymentToModel(e)}catch(i){r={}}t.restoredData={companyId:e.companyId,status:null===(n=e.status)||void 0===n?void 0:n.code,signatures:e.signatures},e.isNewPayment||e.id&&!t.paymentId?(r.number="",r.date=null,t.restoredData.status=null,t.paymentsService.rootTitle=Vo.d.NEW):t.paymentsService.rootTitle=t.restoredData.status===ii.h.DRAFT?Vo.d.EDIT_DRAFT:Vo.d.EDIT_PAYMENT,r.emailOnSuccess&&(r.notify=!0),t.form.patchValue(Object.assign({},r)),t.restoreAsyncData(e),t.isImported=e.imported,r.number||t.setAutoNumeration()})),Object(me.a)(10),Object(ri.a)(1)).subscribe())}},{key:"sendPayment",value:function(e){var t,n,r=this;this.formDirective.form.markAsPristine();var i=this.paymentsService.paymentNumber,o=e||Object.assign({},this.form.value);return this.processingPayment$.next(o),this.paymentsService.paymentNumber.entity=null,this.pipeline.processPayment({paymentId:this.paymentId,total:o.amount,commission:null===(t=this.commissionBalance)||void 0===t?void 0:t.amount,status:null===(n=this.restoredData)||void 0===n?void 0:n.status,userPurpose:this.form.value.purpose,rawBody:o}).then((function(e){e?r.restoredData={status:e.status.code,signatures:e.signatures,companyId:e.companyId}:(r.restoredData=null,i.entity||i.fetching||(i.entity=o.number))})).catch((function(e){})).finally((function(){r.processingPayment$.next(null)}))}},{key:"onSubmit",value:function(e){var t=this;if(e&&e.preventDefault(),this.form.valid){var n=this.form.getRawValue();this.api.checkWorkingTime(n.date).then((function(){t.sendPayment()}))}else this.form.markAllAsTouched()}},{key:"openContractsAddingModal",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===(e=t)||void 0===e||e.preventDefault(),this.contractsModalsService.showAddContractModal(!1)}},{key:"openKnpDictionary",value:function(e,t){var n=this;e.close(),e.blur(),setTimeout((function(){n.modals.open(ki,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then((function(e){n.form.controls.knp.patchValue(e),n.form.controls.knpObject.patchValue(e)})).catch((function(){}))}),0)}},{key:"restoreAsyncData",value:function(e){var t,n,r,o,a,c,s,l,u,b,d,m,p,f,h,v,g;return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function y(){var C,k,A,T=this;return regeneratorRuntime.wrap((function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.retrieveAccounts();case 2:if(this.senderAccountDropdown.selectByIban(null===(t=e.details)||void 0===t?void 0:t.payerIban),C=null===(o=null===(r=null===(n=e)||void 0===n?void 0:n.paymentRecipient)||void 0===r?void 0:r.recipientAccount)||void 0===o?void 0:o.bic,k=null===(s=null===(c=null===(a=e)||void 0===a?void 0:a.details)||void 0===c?void 0:c.foreignPaymentDetails)||void 0===s?void 0:s.intermediaryBankBic,A=null===(b=null===(u=null===(l=e)||void 0===l?void 0:l.details)||void 0===u?void 0:u.foreignPaymentDetails)||void 0===b?void 0:b.intermediaryBankIban,(null===(d=this.formValue.senderAccount)||void 0===d?void 0:d.balance.currency)==oi.a.RUB&&this.currentCountryCode!=Vo.a.RU&&this.isRubNonRussia$.next(!0),C&&setTimeout((function(){var e,t;T.formValue.isRubNonRussia?null===(e=T.rubNonRussiaBankDropdown)||void 0===e||e.selectByBic(C):null===(t=T.bankDropdown)||void 0===t||t.selectByBic(C)}),100),k&&setTimeout((function(){var e;T.formValue.isRubNonRussia?T.rubNonRussiaCorrespondentBankDropdown.selectByBic(k):null===(e=T.intermediaryBankDropdown)||void 0===e||e.selectByBic(k)}),100),A&&this.formValue.isRubNonRussia&&this.form.controls.rubNonRussiaCorrespondentIban.setValue(A),this.withinContract&&this.onContractSelect(this.formValue.contract,!0),y.t0=null===(m=e.details)||void 0===m?void 0:m.foreignPaymentDetails.codeWord,!y.t0){y.next=14;break}return y.next=13,this.retrieveCodeWords();case 13:this.form.controls.codeWord.setValue(e.details.foreignPaymentDetails.codeWord);case 14:this.commissionAccountDropdown.selectByIban(e.details.foreignPaymentDetails.commissionWithdrawalIban),this.hasDefaultCity=!!(null===(f=null===(p=e.paymentRecipient)||void 0===p?void 0:p.country)||void 0===f?void 0:f.defaultCityName),(null===(g=null===(v=null===(h=e)||void 0===h?void 0:h.details)||void 0===v?void 0:v.paymentAmount)||void 0===g?void 0:g.currency)==oi.a.RUB||this.hasDefaultCity?(this.isCityShown=!1,this.clearValidation([this.form.controls.cityName])):(this.isCityShown=!0,this.setValidation([this.form.controls.cityName],[i.H.required]));case 17:case"end":return y.stop()}}),y,this)})))}},{key:"listenPurposeMessageStream",value:function(){this.subs.add(Object(Gr.a)([this.purposeMessage$,this.controlsStream.purpose,this.controlsStream.countryCode]).pipe(Object(fe.a)((function(e){var t=_slicedToArray(e,3),n=t[0],r=t[1];return t[2]==Vo.a.CN?(r||"").length:(n||"").length+(r||"").length}))).subscribe(this.purposeLength$)),this.validatePurpose()}},{key:"listenIsRussianTaxpayer",value:function(){var e=this;this.subs.add(this.controlsStream.isRussianTaxPayer.subscribe((function(t){t?(e.isRussianTaxpayer=!0,e.setValidation([e.form.controls.payerInn],[i.H.required,yc])):(e.isRussianTaxpayer=!1,e.clearValidation([e.form.controls.payerInn]))})))}},{key:"listenHasRussianBudgetExtras",value:function(){var e=this;this.subs.add(this.controlsStream.hasRussianBudgetExtras.subscribe((function(t){e.hasRussianBudgetExtras=!!t})))}},{key:"listenKvo",value:function(){var e=this;this.subs.add(this.isKvoEnabled$.pipe(Object(Zr.a)()).subscribe((function(t){t?e.setValidation([e.form.controls.kvo],[i.H.required]):e.clearValidation([e.form.controls.kvo])})))}},{key:"listenPurpose",value:function(){var e=this;this.subs.add(Object(Gr.a)([this.isKvoEnabled$.pipe(Object(Zr.a)()),this.controlsStream.kvo.pipe(Object(Zr.a)()),this.controlsStream.isRubNonRussia.pipe(Object(Zr.a)()),this.controlsStream.name.pipe(Object(Zr.a)()),this.controlsStream.withinContract.pipe(Object(Zr.a)()),this.controlsStream.bankAccount,this.controlsStream.country,this.controlsStream.countryCode,this.controlsStream.codeWord]).subscribe((function(t){var n,r=_slicedToArray(t,9),i=r[0],o=r[1],a=r[2],c=r[3],s=r[4],l=r[5],u=(r[6],r[7]),b=r[8],d="";i&&(d+="'(VO".concat(o||"",")'")),a&&!s&&(d+=" \u0434\u043b\u044f ".concat(c||""," \u0441\u0447\u0451\u0442 '").concat(l||"","'")),u==Vo.a.CN&&(d+="//".concat((null===(n=b)||void 0===n?void 0:n.code)||"")),e.purposeMessage$.next(d)})))}},{key:"listenKio",value:function(){var e=this;this.subs.add(Object(Gr.a)([this.isKioEnabled$,this.isRussianBudget$]).pipe(Object(Zr.a)()).subscribe((function(t){var n,r=_slicedToArray(t,2),o=r[0],a=r[1];o?(n=a?[yc,i.H.required]:[yc],e.setValidation([e.form.controls.kio],n)):e.clearValidation([e.form.controls.kio])})))}},{key:"listenCodeWordsList",value:function(){var e=this,t=this.controlsStream,n=t.country,r=t.countryCode,i=t.contract,o=t.withinContract;this.subs.add(Object(Gr.a)([n,r,i,o]).subscribe((function(t){e.retrieveCodeWords()})))}},{key:"listenCodeWord",value:function(){var e=this;this.subs.add(this.isCodeWordEnabled$.pipe(Object(Zr.a)()).subscribe((function(t){t?e.setValidation([e.form.controls.codeWord],[i.H.required]):e.clearValidation([e.form.controls.codeWord])})))}},{key:"listenRubToNonRussia",value:function(){var e=this;this.subs.add(Object(Gr.a)([this.isRussianBudget$,this.isRubToRussia$,this.isRubNonRussia$,this.controlsStream.senderAccount,this.controlsStream.contract,this.controlsStream.withinContract,this.controlsStream.bankAccount,this.controlsStream.bank]).subscribe((function(t){var n,r=_slicedToArray(t,8),o=(r[0],r[1],r[2]),a=r[3],c=r[4],s=r[5],l=r[6],u=r[7];e.form.controls.isRubNonRussia.setValue(o);var b=null===(n=c)||void 0===n?void 0:n.contractor.bankCountryCode;o?(b&&b==Vo.a.RU?setTimeout((function(){e.rubNonRussiaCorrespondentBankDropdown.selectByBic(c.contractor.bank.code)}),100):b&&b!=Vo.a.RU&&setTimeout((function(){var t;e.rubNonRussiaBankDropdown.selectByBic(null===(t=e.formValue.contract)||void 0===t?void 0:t.contractor.bank.code)}),100),e.clearValidation([e.form.controls.bank,e.form.controls.bankLabel],!1),e.setValidation([e.form.controls.rubNonRussiaCorrespondentBankLabel],[i.H.required]),e.setValidation([e.form.controls.rubNonRussiaCorrespondentIban],[i.H.required,Cc])):(s?e.clearValidation([e.form.controls.bank,e.form.controls.bankLabel],!1):(e.setValidation([e.form.controls.bank],[i.H.required],!1),e.setValidation([e.form.controls.bankLabel],[i.H.required,function(t){var n,r,i,o,c,s;return e.currentCountryCode==Vo.a.RU&&(null===(r=null===(n=a)||void 0===n?void 0:n.balance)||void 0===r?void 0:r.currency)===oi.a.RUB&&gc(l)&&vc(null===(i=u)||void 0===i?void 0:i.bic)&&e.isRussianBudgetDisabled?{rubBudgetDisabled:!0}:e.currentCountryCode==Vo.a.RU&&(null===(c=null===(o=a)||void 0===o?void 0:o.balance)||void 0===c?void 0:c.currency)===oi.a.RUB&&gc(l)&&!vc(null===(s=u)||void 0===s?void 0:s.bic)?{rubBudgetWrongBic:!0}:null}])),e.clearValidation([e.form.controls.rubNonRussiaCorrespondentBankLabel,e.form.controls.rubNonRussiaCorrespondentIban]))})))}},{key:"listenRubNonRussiaCorrespondentBank",value:function(){var e=this;this.subs.add(this.controlsStream.rubNonRussiaBank.subscribe((function(t){var n;(null===(n=t)||void 0===n?void 0:n.cityName)&&e.form.controls.cityName.setValue(t.cityName)})))}},{key:"applyRubPaymentRules",value:function(e){e&&(this.applyRubPurposeRules(),e==Vo.a.RU?(this.isRubNonRussia$.next(!1),this.isRubToRussia$.next(!0),this.applyRubToRussiaKvoAndKioRules(),this.applyRubToRussiaPayCommissionRules()):(this.isRubNonRussia$.next(!0),this.isRubToRussia$.next(!1),this.applyRubToNonRussiaCorrespondentRules(),this.applyRubToNonRussiaKvoAndKioRules()))}},{key:"applyRubPurposeRules",value:function(){this.masks.purpose=ai.a.foreignCyrillic}},{key:"applyRubToRussiaKvoAndKioRules",value:function(){this.isKvoEnabled$.next(!0),this.isKioEnabled$.next(!0),this.isKppEnabled$.next(!0)}},{key:"applyRubToRussiaPayCommissionRules",value:function(){this.canPayCommission=!1,this.form.controls.payComission.setValue(!1)}},{key:"applyRubToNonRussiaCorrespondentRules",value:function(){this.cityPlaceholder$.next("CURRENCY_PAYMENT.RECIPIENT.CITY_BANK")}},{key:"applyRubToNonRussiaKvoAndKioRules",value:function(){this.isKvoEnabled$.next(!0),this.isKioEnabled$.next(!1),this.isKppEnabled$.next(!1)}},{key:"applyDefaultPaymentRules",value:function(){this.isRubNonRussia$.next(!1),this.applyDefaultPaymentPurposeRules(),this.applyDefaultPaymentKvoAndKioRules(),this.applyDefaultPaymentPayCommissionRules(),this.applyDefaultPaymentCodeWordRules()}},{key:"applyDefaultPaymentPayCommissionRules",value:function(){this.canPayCommission=!0}},{key:"applyDefaultPaymentPurposeRules",value:function(){this.masks.purpose=ai.a.foreignLatin}},{key:"applyDefaultPaymentKvoAndKioRules",value:function(){this.isKioEnabled$.next(!1),this.isKvoEnabled$.next(!1),this.isKppEnabled$.next(!1)}},{key:"applyDefaultPaymentCodeWordRules",value:function(){this.isCodeWordEnabled$.next(!1)}},{key:"applyChinaPaymentRules",value:function(e){e||(this.form.controls.countryCode.setValue(Vo.a.CN),this.hasDefaultCity=!1,this.retrieveCodeWords(Vo.a.CN)),this.isCodeWordEnabled$.next(!0),this.codeWordLabel$.next("CURRENCY_PAYMENT.RECIPIENT.CODEWORD")}},{key:"currentCountryCode",get:function(){var e,t,n,r=(null===(n=null===(t=null===(e=this.formValue.contract)||void 0===e?void 0:e.contractor)||void 0===t?void 0:t.country)||void 0===n?void 0:n.code)||null;return this.formValue.withinContract&&r?r.substring(0,2):!this.formValue.withinContract&&this.formValue.countryCode?this.formValue.countryCode.substring(0,2):null}},{key:"senderAccountsList",get:function(){return this.accounts.filter((function(e){return e.balance.currency!=oi.a.KZT}))}},{key:"commissionAccountsList",get:function(){var e=this.form.getRawValue().senderAccount;return this.accounts.filter((function(t){var n,r;return t.balance.currency==oi.a.KZT||t.balance.currency==(null===(r=null===(n=e)||void 0===n?void 0:n.balance)||void 0===r?void 0:r.currency)}))}},{key:"formValue",get:function(){return this.form.getRawValue()}},{key:"shouldBindContract",get:function(){return!1}}]),t}(Mo)).\u0275fac=function(e){return new(e||lc)(d.Qb(li.a),d.Qb(Vo.g),d.Qb(Lo.a),d.Qb(Fr.a),d.Qb(Fr.c),d.Qb(Vo.c),d.Qb(vi.a),d.Qb(l.c),d.Qb(a.q),d.Qb(Vo.f),d.Qb(Vo.e),d.Qb(ui.a),d.Qb(Vo.b),d.Qb(c.e),d.Qb(Do.c),d.Qb(o.b),d.Qb(Qo.a),d.Qb(bi.b),d.Qb(Fo.a))},lc.\u0275cmp=d.Kb({type:lc,selectors:[["j-currency-payment"]],viewQuery:function(e,t){var n;1&e&&(d.Lc($o,!0),d.Vc(Uo,!0),d.Vc(Yo,!0),d.Vc(Ko,!0),d.Vc(Ho,!0),d.Vc(Go,!0),d.Vc(zo,!0),d.Vc(qo,!0),d.Vc(Xo,!0),d.Vc(Zo,!0)),2&e&&(d.Bc(n=d.jc())&&(t.emailOnSuccess=n.first),d.Bc(n=d.jc())&&(t.senderAccountDropdown=n.first),d.Bc(n=d.jc())&&(t.contractsSelect=n.first),d.Bc(n=d.jc())&&(t.contractDetails=n.first),d.Bc(n=d.jc())&&(t.bankDropdown=n.first),d.Bc(n=d.jc())&&(t.intermediaryBankDropdown=n.first),d.Bc(n=d.jc())&&(t.commissionAccountDropdown=n.first),d.Bc(n=d.jc())&&(t.rubNonRussiaBankDropdown=n.first),d.Bc(n=d.jc())&&(t.rubNonRussiaCorrespondentBankDropdown=n.first),d.Bc(n=d.jc())&&(t.rubNonRussiaCorrespondentIbanInput=n.first))},features:[d.zb([{provide:Me.a,useClass:Me.b}]),d.xb],decls:152,vars:136,consts:[[1,"payment-section"],["autocomplete","off","jInvalidControlScroll","","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"mb-4"],["translate","",1,"mb-4"],[3,"isLoading","isDisabledSelectable","label","hasError","accounts","selected"],["senderAccountDropdown",""],[1,"j-switch-wrap","form-group"],[3,"formControl"],[1,"ml-3"],["translate",""],["class","contracts-description",3,"jLoading","jLoadingInverted","is-loading",4,"ngIf"],[4,"ngIf"],[1,"form-section"],[1,"recipient-title","mb-4"],["translate","",1,"m-0"],["class","btn btn-link p-0 p3","type","button","translate","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.OPEN",3,"click",4,"ngIf"],["class","btn btn-link p-0 p3","type","button","translate","CURRENCY_PAYMENT.DICTIONARY.OPEN",3,"click",4,"ngIf"],[1,"form-group"],["clearable","true"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","dropSpecialCharacters","maxlength","formControl","paste"],["countryWrapper",""],["bindValue","code",3,"appendTo","jFocusOnReturn","formControl","readonly","clearable","searchFn","items","change","focus","search"],["countrySelect",""],["j-option-tmp",""],["j-label-tmp",""],[3,"control","errorMessages"],["class","form-group",4,"ngIf"],["type","text","jFormInput","","jFocusOnReturn","","jUppercase","",1,"form-control",3,"mask","formControl"],["accountInput","jFormInput"],["class","j-switch-wrap form-group",4,"ngIf"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","formControl"],["allowAuto","true",3,"datesEnabled","formControl","formatValue","jFocusOnReturn","label","minDate","maxDate","helperText"],["datePicker",""],["knpWrapper",""],["bindLabel","label","bindValue","code",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","compareWith","items"],["knpSelect",""],["j-header-tmp",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl","mask","dropSpecialCharacters"],["purpose",""],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],["translate","",1,"j-input-helper","text-muted","mt-1","mb-0","p3"],[3,"hidden"],[3,"isLoading","accounts","isDisabledSelectable","hasError","label","selected"],["commissionAccountDropdown",""],["class","j-input-helper text-muted comission-message p3",4,"ngIf"],["clearable","true",3,"floatLabel"],["jFocusOnReturn","","jFormInput","","jCursorBound","","jReplaceDot","","thousandSeparator"," ","decimalMarker",",","maxlength","29",1,"form-control",3,"suffix","placeholder","mask","dropSpecialCharacters","formControl","paste"],["class","j-input-helper text-muted mt-1 p3",4,"ngIf"],[1,"j-input-helper","text-muted","mt-2","p3","position-relative"],[4,"ngIf","ngIfElse"],["commission",""],["class","mt-2","translate","CURRENCY_PAYMENT.COMISSION.DESCRIPTION",4,"ngIf"],[1,"list-group"],["class","list-group-item d-flex align-items-center",4,"ngIf"],[1,"list-group-item","d-flex","align-items-center"],[1,"ml-3","flex-grow-1"],["class","mt-1",4,"ngIf"],["class","my-3 p3 text-muted",3,"innerHTML",4,"ngIf"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],[3,"contract",4,"ngIf"],["amountInfo",""],["kbeInfo",""],["kppInfo",""],["oktmoInfo",""],["basisInfo",""],["budgetPeriodInfo",""],[1,"contracts-description",3,"jLoading","jLoadingInverted"],[1,"text-gray",3,"innerHTML"],["id","contractGroup",1,"form-group","mt-4"],["contractsWrapper",""],["bindValue","id",3,"loading","appendTo","jFocusOnReturn","formControl","clearable","searchFn","items","change"],["contractsSelect",""],["j-notfound-tmp",""],["href","#","jSuffix","","class","mr-1 p3","translate","",3,"click",4,"ngIf"],["class","mb-3",4,"ngIf"],[1,"mb-3"],["type","button","class","list-dictionary form-section--action btn btn-xs btn-link float-right",3,"click",4,"ngIf"],["type","button",1,"list-dictionary","form-section--action","btn","btn-xs","btn-link","float-right",3,"click"],[1,"j-option-label","text-wrap","p3"],[1,"text-dark","contract-row"],[3,"money"],[1,"text-muted","contract-row"],["translate","CURRENCY_PAYMENT.CONTRACTS.SELECT.REMAINDER"],[1,"contracts__empty"],["src","assets/img/payments/no_contract.svg"],[1,"mx-auto","mt-3","p2","text-muted",3,"innerHTML"],["href","#",1,"link","d-inline-block","mt-3",3,"click"],["label","CURRENCY_PAYMENT.CONTRACTS.NOT_FOUND"],[1,"text-center","my-2"],["href","#",1,"link","d-inline-block",3,"click"],["href","#","jSuffix","","translate","",1,"mr-1","p3",3,"click"],["type","button","translate","CURRENCY_PAYMENT.CONTRACTS_DICTIONARY.OPEN",1,"btn","btn-link","p-0","p3",3,"click"],["type","button","translate","CURRENCY_PAYMENT.DICTIONARY.OPEN",1,"btn","btn-link","p-0","p3",3,"click"],[1,"j-option-label","text-wrap"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","dropSpecialCharacters","maxlength","formControl"],[1,"kbe-account-row"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","4",1,"form-control",3,"formControl"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","28",1,"form-control",3,"formControl"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","10",1,"form-control",3,"formControl"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","25",1,"form-control",3,"formControl"],[1,"mt-0"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","70",1,"form-control",3,"formControl"],[3,"labelText","placeholderText","labelControl","errorMessages","bankControl"],["rubNonRussiaCorrespondentBankDropdown",""],["type","text","jFormInput","","jFocusOnReturn","","jUppercase","",1,"form-control",3,"validation","mask","formControl"],["rubNonRussiaCorrespondentIbanInput","jFormInput"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","jShadow","dropSpecialCharacters","formControl"],["href","javascript:void(0)","jSuffix","","tooltipClass","tooltip-light tooltip-large","triggers","mouseenter:mouseleave",1,"mr-1","link-gray",3,"ngbTooltip","inlineSVG"],["rubNonRussiaBankDropdown",""],[3,"placeholderText","labelControl","errorMessages","bankControl"],["bankDropdown",""],["class","j-input-helper text-muted mt-1 mb-0 p3","translate","",4,"ngIf"],[1,"intermediatory-content","ml-3"],["class","intermediatory-input",3,"placeholderText","labelControl","bankControl","errorMessages",4,"ngIf"],["translate","",1,"d-block","text-gray"],[1,"intermediatory-input",3,"placeholderText","labelControl","bankControl","errorMessages"],["intermediaryBankDropdown",""],["type","text","jFocusOnReturn","","jFormInput","","maxlength","12",1,"form-control",3,"mask","dropSpecialCharacters","formControl"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","jShadow","validation","formControl"],[1,"custom-control","custom-checkbox"],["type","checkbox","id","isRussianTaxPayer",1,"custom-control-input",3,"formControl"],["for","isRussianTaxPayer",1,"custom-control-label"],["translate","CURRENCY_PAYMENT.RUSSIAN_BUDGET.IS_TAXPAYER",1,"p3","text-muted"],["class","russian-row",4,"ngIf"],[1,"russian-row"],["kbkRowWrapper",""],["kbkWrapper",""],[3,"loading","appendTo","jFocusOnReturn","formControl","clearable","searchFn","items"],["kbkSelect",""],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","jShadow","formControl"],["payerStatusWrap",""],["bindValue","code",3,"loading","appendTo","jFocusOnReturn","formControl","clearable","searchFn","items"],["payerStatusSelect",""],["type","checkbox","id","hasRussianBudgetExtras",1,"custom-control-input",3,"formControl"],["for","hasRussianBudgetExtras",1,"custom-control-label"],["translate","CURRENCY_PAYMENT.RUSSIAN_BUDGET.EXTRAS",1,"p3","text-muted"],["type","text","jFocusOnReturn","","jFormInput","","maxlength","12",1,"form-control",3,"formControl"],["label","CURRENCY_PAYMENT.RUSSIAN_BUDGET.KBK_NOT_FOUND"],["label","CURRENCY_PAYMENT.RUSSIAN_BUDGET.STATUS_NOT_FOUND"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"mask","jShadow","dropSpecialCharacters","formControl"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"formControl"],[1,"mr-2",3,"inlineSVG"],["translate","",1,"p2","m-0"],["translate","",1,"p3","text-gray"],["codeWordsWrapper",""],["codeWordsSelect",""],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"j-input-helper","text-muted","comission-message","p3"],[3,"innerHTML"],[1,"j-input-helper","text-muted","mt-1","p3"],[1,"text-danger","mr-1",3,"translate","translateParams"],["href","#",1,"link-blue","contracts-scroll-link",3,"click"],["translate","CURRENCY_PAYMENT.COMISSION.DESCRIPTION",1,"mt-2"],["translate","",1,"text-gray"],[1,"text-gray"],[1,"mt-1"],["type","email","jFormInput","","jFocusOnReturn","","autocomplete","off",1,"form-control",3,"ngbTypeahead","formControl","focus"],["emailOnSuccess","ngbTypeahead"],[1,"my-3","p3","text-muted",3,"innerHTML"],["type","button",1,"btn","btn-link","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit","translate","",1,"btn","btn-outline-primary","btn-static"],[3,"contract"],["contractDetails",""],[1,"p4"]],template:function(e,t){if(1&e&&(d.Wb(0,"div",0),d.Wb(1,"form",1,2),d.ic("submit",(function(e){return t.onSubmit(e)})),d.Wb(3,"fieldset",3),d.Wb(4,"h5",4),d.Qc(5,"CURRENCY_PAYMENT.DEBIT_ACCOUNT"),d.Vb(),d.Wb(6,"j-account-dropdown",5,6),d.ic("selected",(function(e){return t.onSenderAccountSelect(e)})),d.Vb(),d.Wb(8,"div",7),d.Rb(9,"j-switch",8),d.Wb(10,"div",9),d.Wb(11,"strong",10),d.Qc(12,"CURRENCY_PAYMENT.CONTRACTS.SWITCH.TITLE"),d.Vb(),d.Oc(13,Jo,3,8,"div",11),d.Vb(),d.Vb(),d.Oc(14,la,14,10,"ng-container",12),d.Vb(),d.Wb(15,"fieldset",13),d.Wb(16,"div",14),d.Wb(17,"h5",15),d.Qc(18,"CURRENCY_PAYMENT.RECIPIENT.TITLE"),d.Vb(),d.Oc(19,ua,1,0,"button",16),d.Oc(20,ba,1,0,"button",17),d.Vb(),d.Wb(21,"div",18),d.Wb(22,"j-form-field",19),d.Wb(23,"j-label",10),d.Qc(24,"CURRENCY_PAYMENT.RECIPIENT.NAME"),d.Vb(),d.Wb(25,"input",20),d.ic("paste",(function(e){return t.onNamePaste(e)})),d.Vb(),d.Vb(),d.Vb(),d.Wb(26,"div",18),d.Wb(27,"j-form-field",null,21),d.Wb(29,"j-label",10),d.Qc(30,"CURRENCY_PAYMENT.RECIPIENT.COUNTRY"),d.Vb(),d.Wb(31,"j-select",22,23),d.ic("change",(function(e){return t.onCountrySelect(e)}))("focus",(function(e){return t.onCountryFocus()}))("search",(function(e){return t.onCountrySearch(e)})),d.mc(33,"async"),d.Oc(34,da,2,1,"ng-template",24),d.Oc(35,ma,1,1,"ng-template",25),d.Vb(),d.Rb(36,"j-error",26),d.Vb(),d.Vb(),d.Oc(37,pa,8,11,"div",27),d.Oc(38,fa,24,4,"ng-container",12),d.mc(39,"async"),d.Oc(40,ha,6,1,"ng-container",12),d.mc(41,"async"),d.Oc(42,va,11,10,"ng-container",12),d.mc(43,"async"),d.Wb(44,"div"),d.mc(45,"async"),d.Oc(46,ga,7,8,"div",27),d.Oc(47,ya,11,14,"ng-container",12),d.mc(48,"async"),d.Wb(49,"div",18),d.Wb(50,"j-form-field",19),d.Wb(51,"j-label",10),d.Qc(52,"CURRENCY_PAYMENT.RECIPIENT.IBAN"),d.Vb(),d.Rb(53,"input",28,29),d.Rb(55,"j-error",26),d.Vb(),d.Vb(),d.Vb(),d.Oc(56,ka,5,5,"ng-container",12),d.mc(57,"async"),d.Oc(58,Ta,8,2,"div",30),d.Oc(59,Ra,6,5,"div",27),d.mc(60,"async"),d.Oc(61,_a,8,6,"div",27),d.mc(62,"async"),d.Vb(),d.Oc(63,Wa,43,23,"ng-container",12),d.mc(64,"async"),d.Wb(65,"fieldset",13),d.Wb(66,"h5",4),d.Qc(67,"CURRENCY_PAYMENT.DETAILS.TITLE"),d.Vb(),d.Wb(68,"div",18),d.Wb(69,"j-form-field"),d.Wb(70,"j-label",10),d.Qc(71,"CURRENCY_PAYMENT.DETAILS.DOCUMENT_NUMBER"),d.Vb(),d.Rb(72,"input",31),d.Vb(),d.Vb(),d.Wb(73,"div",18),d.Rb(74,"j-date-picker",32,33),d.mc(76,"async"),d.mc(77,"translate"),d.mc(78,"async"),d.Vb(),d.Wb(79,"div",18),d.Wb(80,"j-form-field",null,34),d.Wb(82,"j-label",10),d.Qc(83,"CURRENCY_PAYMENT.DETAILS.KNP.TITLE"),d.Vb(),d.Wb(84,"j-select",35,36),d.mc(86,"async"),d.Oc(87,Pa,1,1,"ng-template",37),d.Vb(),d.Vb(),d.Vb(),d.Oc(88,Ma,5,2,"div",27),d.mc(89,"async"),d.Oc(90,Qa,11,12,"div",27),d.mc(91,"async"),d.Wb(92,"div",38),d.Wb(93,"span",39),d.Qc(94),d.mc(95,"async"),d.Vb(),d.Wb(96,"j-form-field"),d.Wb(97,"j-label",10),d.Qc(98,"CURRENCY_PAYMENT.DETAILS.PURPOSE"),d.Vb(),d.Rb(99,"textarea",40,41),d.Rb(101,"j-error",26),d.Oc(102,Fa,3,1,"div",42),d.mc(103,"async"),d.Vb(),d.Wb(104,"div",43),d.Qc(105," CURRENCY_PAYMENT.DETAILS.PURPOSE_DESCRIPTION "),d.Vb(),d.Vb(),d.Vb(),d.Wb(106,"fieldset",13),d.Wb(107,"div",44),d.Wb(108,"j-account-dropdown",45,46),d.ic("selected",(function(e){return t.onCommissionAccountSelect(e)})),d.Vb(),d.Oc(110,Ba,2,1,"div",47),d.Vb(),d.Wb(111,"div",18),d.Wb(112,"j-form-field",48),d.Wb(113,"j-label",10),d.Qc(114,"CURRENCY_PAYMENT.AMOUNT.TITLE"),d.Vb(),d.Wb(115,"input",49),d.ic("paste",(function(e){return t.onAmountPaste(e)})),d.Vb(),d.Vb(),d.Oc(116,$a,2,1,"div",50),d.Oc(117,Ya,6,9,"div",50),d.Oc(118,Ka,2,1,"div",50),d.Wb(119,"div",51),d.Oc(120,Ha,3,3,"ng-container",52),d.Oc(121,Ga,3,4,"ng-template",null,53,d.Pc),d.Oc(123,za,1,0,"div",54),d.Vb(),d.Vb(),d.Wb(124,"ul",55),d.Oc(125,qa,8,1,"li",56),d.Wb(126,"li",57),d.Rb(127,"j-switch",8),d.Wb(128,"div",58),d.Wb(129,"strong"),d.Qc(130,"\u0421\u043e\u043e\u0431\u0449\u0438\u0442\u044c \u043e\u0431 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0438"),d.Vb(),d.Rb(131,"br"),d.Oc(132,Xa,3,0,"div",12),d.Oc(133,Za,9,4,"div",59),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Oc(134,Ja,2,3,"p",60),d.Wb(135,"div",61),d.Oc(136,ec,7,3,"ng-container",12),d.Oc(137,tc,3,0,"ng-container",12),d.Vb(),d.Rb(138,"ngx-spinner",62),d.Vb(),d.Vb(),d.Oc(139,nc,2,1,"j-fx-contract-details",63),d.Oc(140,rc,0,0,"ng-template",null,64,d.Pc),d.Oc(142,ic,1,0,"ng-template",null,65,d.Pc),d.Oc(144,oc,4,0,"ng-template",null,66,d.Pc),d.Oc(146,ac,2,0,"ng-template",null,67,d.Pc),d.Oc(148,cc,2,0,"ng-template",null,68,d.Pc),d.Oc(150,sc,26,0,"ng-template",null,69,d.Pc)),2&e){var n=d.Cc(28),r=d.Cc(32),i=d.Cc(75),o=d.Cc(81),a=d.Cc(85),c=d.Cc(122);d.Ab(1),d.rc("formGroup",t.form),d.Ab(5),d.rc("isLoading",t.isAccountsLoading)("isDisabledSelectable",!0)("label","CURRENCY_PAYMENT.DEBIT_ACCOUNT")("hasError",t.form.controls.senderAccount.touched&&t.form.controls.senderAccount.errors)("accounts",t.senderAccountsList),d.Ab(3),d.rc("formControl",t.form.controls.withinContract),d.Ab(4),d.rc("ngIf",t.isContractsDescriptionShown),d.Ab(1),d.rc("ngIf",t.withinContract),d.Ab(5),d.rc("ngIf",t.withinContract&&(null==t.form.controls.contract?null:null==t.form.controls.contract.value?null:null==t.form.controls.contract.value.recipients?null:t.form.controls.contract.value.recipients.length)>1),d.Ab(1),d.rc("ngIf",!t.withinContract),d.Ab(5),d.rc("mask",t.masks.name.mask)("dropSpecialCharacters",!1)("maxlength",t.withinContract?null:t.nameMaxLength)("formControl",t.form.controls.name),d.Ab(6),d.rc("appendTo",n.elementRef.nativeElement)("jFocusOnReturn",r)("formControl",t.form.controls.countryCode)("readonly",t.form.controls.countryCode.disabled)("clearable",!1)("searchFn",t.countryComparator)("items",d.nc(33,100,t.countries$)),d.Ab(5),d.rc("control",t.form.controls.countryCode)("errorMessages",t.errors.country),d.Ab(1),d.rc("ngIf",t.isCityShown),d.Ab(1),d.rc("ngIf",d.nc(39,102,t.isAustraliaAud$)),d.Ab(2),d.rc("ngIf",d.nc(41,104,t.isAustraliaNonAud$)),d.Ab(2),d.rc("ngIf",d.nc(43,106,t.isRubNonRussia$)),d.Ab(2),d.Hb("kbe-account-row",!(d.nc(45,108,t.isRubNonRussia$)||t.withinContract)),d.Ab(2),d.rc("ngIf",!t.withinContract),d.Ab(1),d.rc("ngIf",d.nc(48,110,t.isRubNonRussia$)),d.Ab(2),d.Hb("mb-3",t.withinContract),d.Ab(4),d.rc("mask",t.masks.bankAccount.mask)("formControl",t.form.controls.bankAccount),d.Ab(2),d.rc("control",t.form.controls.bankAccount)("errorMessages",t.errors.bankAccount),d.Ab(1),d.rc("ngIf",!d.nc(57,112,t.isRubNonRussia$)),d.Ab(2),d.rc("ngIf",t.isIntermediaryBankSwitchable),d.Ab(1),d.rc("ngIf",d.nc(60,114,t.isKioEnabled$)),d.Ab(2),d.rc("ngIf",d.nc(62,116,t.isKppEnabled$)),d.Ab(2),d.rc("ngIf",d.nc(64,118,t.isRussianBudget$)),d.Ab(9),d.rc("mask",t.masks.number.mask)("formControl",t.form.controls.number),d.Ab(2),d.rc("datesEnabled",d.nc(76,120,t.workingDays$))("formControl",t.form.controls.date)("formatValue",!0)("jFocusOnReturn",i)("label",d.nc(77,122,"CURRENCY_PAYMENT.DETAILS.VALUE_DATE"))("minDate",t.dateLimit.minDate)("maxDate",t.dateLimit.maxDate)("helperText",d.nc(78,124,t.dateMessage$)),d.Ab(10),d.rc("jFocusOnReturn",a)("appendTo",o.elementRef.nativeElement)("formControl",t.form.controls.knp)("clearable",!1)("searchMask",t.masks.knp.mask)("shadow",t.masks.knp.shadow)("compareWith",t.knpComparator)("items",d.nc(86,126,t.knp$)),d.Ab(4),d.rc("ngIf",d.nc(89,128,t.isKvoEnabled$)),d.Ab(2),d.rc("ngIf",d.nc(91,130,t.isCodeWordEnabled$)),d.Ab(4),d.Tc(" ",d.nc(95,132,t.purposeLength$),"/",t.rules.purposeLength,""),d.Ab(5),d.rc("formControl",t.form.controls.purpose)("mask",t.masks.purpose.mask)("dropSpecialCharacters",!1),d.Ab(2),d.rc("control",t.form.controls.purpose)("errorMessages",t.errors.purpose),d.Ab(1),d.rc("ngIf",d.nc(103,134,t.purposeMessage$)),d.Ab(5),d.rc("hidden",!t.isCommissionAccountSelectable),d.Ab(1),d.rc("isLoading",t.isAccountsLoading)("accounts",t.commissionAccountsList)("isDisabledSelectable",!0)("hasError",t.form.controls.commissionAccount.touched&&t.form.controls.commissionAccount.errors)("label","CURRENCY_PAYMENT.COMISSION.ACCOUNT"),d.Ab(2),d.rc("ngIf",t.comissionMessage),d.Ab(2),d.rc("floatLabel","always"),d.Ab(3),d.rc("suffix",t.amountSuffix)("placeholder",t.amountPlaceholder)("mask",t.amountMask)("dropSpecialCharacters",!0)("formControl",t.form.controls.amount),d.Ab(1),d.rc("ngIf",t.amountMessage),d.Ab(1),d.rc("ngIf",t.shouldBindContract),d.Ab(1),d.rc("ngIf",t.comissionMessage&&!t.isCommissionAccountSelectable),d.Ab(2),d.rc("ngIf",null===t.commissionBalance)("ngIfElse",c),d.Ab(3),d.rc("ngIf",0==t.isOurComission),d.Ab(2),d.rc("ngIf",t.canPayCommission),d.Ab(2),d.rc("formControl",t.form.controls.notify),d.Ab(5),d.rc("ngIf",!t.form.controls.notify.value),d.Ab(1),d.rc("ngIf",t.form.controls.notify.value),d.Ab(1),d.rc("ngIf",t.isContractsAgreementShown),d.Ab(2),d.rc("ngIf",t.restoredData.status!==t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("ngIf",t.restoredData.status===t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("name",t.SPINNER)("fullScreen",!1),d.Ab(1),d.rc("ngIf",t.form.controls.contract.value)}},directives:[i.J,i.u,Pt.b,Ot.b,i.l,c.a,Bo.a,Rn.a,i.t,i.i,r.u,Zt.a,en.a,an.a,i.c,Ot.a,o.a,i.o,kt,ve,ye,on.a,Wt.a,qt.a,ke,It.a,Et.a,fr.a,Gt.a,Te,Sn.a,Vn.a,nn.a,Zi,Nt.a,a.E,gr.a,i.a,rn.a,a.G,so,Mn.a],pipes:[r.b,c.d,Nr.a],styles:[".payments__header{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:1.5rem}.payment-section--submit{text-align:right}.payment-section{max-width:582px}.payment-section--purpose-length{position:absolute;right:.8rem;top:.4rem;z-index:1}.payment-section--summary .payment-section--amount-warn{color:#666c72}@media(min-width:960px){.payment-section--summary .payment-section--amount-warn{width:70%;text-align:right;margin-left:auto}}.kbe-account-row{margin-bottom:1rem}@media(min-width:960px){.kbe-account-row{display:grid;-webkit-column-gap:12px;-moz-column-gap:12px;column-gap:12px;grid-template-columns:130px 1fr}}@media(min-width:960px){.kbe-account-row .form-group{margin-bottom:0}}.intermediatory-content{width:100%}.intermediatory-input{margin-top:.5rem;position:relative;margin-bottom:.25rem}.intermediatory-input .bic-dropdown{left:0;right:0}.contract-row{display:-webkit-box;display:flex;width:100%;-webkit-box-pack:justify;justify-content:space-between}.contract-row>:first-child{padding-right:1rem}.list-dictionary{display:-webkit-inline-box;display:inline-flex;-webkit-box-align:center;align-items:center;line-height:1}.list-dictionary span{display:block}.comission-message{margin-top:-12px}.j-select .j-spinner-loader{top:19px}.contracts__empty{text-align:center;max-width:312px;margin:0 auto}.russian-row{position:relative;display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:1rem}.russian-row>*{width:100%;max-width:calc(50% - 6px)}.contracts-description{position:relative}.contracts-description.is-loading small{opacity:.5}.contracts-scroll-link{border-bottom:1px dashed #1586bb}.contracts-scroll-link:hover{border-color:#ef5630}.recipient-title{display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;-webkit-box-align:center;align-items:center}"],encapsulation:2}),lc),Ac=["paymentComponent"],Tc=((uc=function(){function e(t,n){_classCallCheck(this,e),this.router=t,this.paymentsService=n}return _createClass(e,[{key:"ngOnInit",value:function(){this.title$=this.paymentsService.rootTitle$.pipe(Object(fe.a)((function(e){return"CURRENCY_PAYMENT.".concat(e)})))}},{key:"onClose",value:function(){this.router.navigate(["/"])}},{key:"ngAfterViewInit",value:function(){this.formDirective=this.paymentComponent.formDirective,this.form=this.paymentComponent.form}}]),e}()).\u0275fac=function(e){return new(e||uc)(d.Qb(Fr.c),d.Qb(Yr.c))},uc.\u0275cmp=d.Kb({type:uc,selectors:[["j-currency-payments"]],viewQuery:function(e,t){var n;1&e&&d.Vc(Ac,!0),2&e&&d.Bc(n=d.jc())&&(t.paymentComponent=n.first)},features:[d.zb([{provide:Me.a,useClass:Me.b}])],decls:9,vars:5,consts:[[3,"closed"],[1,"f-page-title"],["paymentComponent",""]],template:function(e,t){1&e&&(d.Wb(0,"f-page",0),d.ic("closed",(function(e){return t.onClose()})),d.Wb(1,"f-page-header"),d.Wb(2,"h1",1),d.Qc(3),d.mc(4,"translate"),d.mc(5,"async"),d.Vb(),d.Vb(),d.Wb(6,"f-page-body"),d.Rb(7,"j-currency-payment",null,2),d.Vb(),d.Vb()),2&e&&(d.Ab(3),d.Sc(" ",d.nc(4,1,d.nc(5,3,t.title$))," "))},directives:[pn.a,fn.a,hn.a,kc],pipes:[c.d,r.b],styles:[""]}),uc),Rc=n("aDQ/"),_c=n("7o/Q"),Sc=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new jc(e))}}]),e}(),jc=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))).hasPrev=!1,n}return _inherits(t,e),_createClass(t,[{key:"_next",value:function(e){var t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)}}]),t}(_c.a),Oc=((bc=function(){function e(){_classCallCheck(this,e),this.subs=new Qi.a,this.itemChanges$=new Hr.a(0),this.routerTrigger$=this.itemChanges$.pipe(Object(be.a)(this.itemChanges$.getValue()),(function(e){return e.lift(new Sc)}),Object(fe.a)((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1],i={offsetEnterX:0,offsetLeaveX:0};return 0!==n&&(i.offsetEnterX=n>r?-100:100,i.offsetLeaveX=n>r?100:-100),{value:r,params:i}})),Object(xo.a)())}return _createClass(e,[{key:"ngOnInit",value:function(){this.subs.add(this.routerTrigger$.subscribe())}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"onActivate",value:function(e,t){t.activatedRouteData&&t.activatedRouteData.animation&&t.activatedRouteData.index!==this.itemChanges$.getValue()&&this.itemChanges$.next(t.activatedRouteData.index)}}]),e}()).\u0275fac=function(e){return new(e||bc)},bc.\u0275dir=d.Lb({type:bc}),bc),Ic=function(e){return[e]},Vc=((dc=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).router=e,r.paymentsService=n,r.routes=Br.a,r}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){_get(_getPrototypeOf(t.prototype),"ngOnInit",this).call(this),this.title$=this.paymentsService.rootTitle$.pipe(Object(fe.a)((function(e){return"PAYMENTS.".concat(e)})))}},{key:"onClose",value:function(){this.router.navigate(["/"])}}]),t}(Oc)).\u0275fac=function(e){return new(e||dc)(d.Qb(Fr.c),d.Qb(Yr.c))},dc.\u0275cmp=d.Kb({type:dc,selectors:[["j-tenge-payments"]],features:[d.zb([{provide:Me.a,useClass:Me.b}]),d.xb],decls:20,vars:14,consts:[[3,"closed"],[1,"f-page-title"],[1,"f-page-tabs-wrap"],[1,"f-page-tabs"],["routerLinkActive","active",3,"routerLink"],[1,"outlet-animation-wrapper"],["outlet","outlet"]],template:function(e,t){1&e&&(d.Wb(0,"f-page",0),d.ic("closed",(function(e){return t.onClose()})),d.Wb(1,"f-page-header"),d.Wb(2,"h1",1),d.Qc(3),d.mc(4,"translate"),d.mc(5,"async"),d.Vb(),d.Wb(6,"div",2),d.Wb(7,"nav",3),d.Wb(8,"a",4),d.Wb(9,"span"),d.Qc(10,"\u041f\u043b\u0430\u0442\u0435\u0436\u043d\u043e\u0435 \u043f\u043e\u0440\u0443\u0447\u0435\u043d\u0438\u0435"),d.Vb(),d.Vb(),d.Wb(11,"a",4),d.Wb(12,"span"),d.Qc(13,"\u0412 \u0431\u044e\u0434\u0436\u0435\u0442"),d.Vb(),d.Vb(),d.Wb(14,"a",4),d.Qc(15," \u0417\u0430\u0440\u043f\u043b\u0430\u0442\u043d\u044b\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 "),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(16,"f-page-body"),d.Wb(17,"div",5),d.Rb(18,"router-outlet",null,6),d.Vb(),d.Vb(),d.Vb()),2&e&&(d.Ab(3),d.Sc(" ",d.nc(4,4,d.nc(5,6,t.title$))," "),d.Ab(5),d.rc("routerLink",d.wc(8,Ic,t.routes.tenge.order)),d.Ab(3),d.rc("routerLink",d.wc(10,Ic,t.routes.tenge.state.root)),d.Ab(3),d.rc("routerLink",d.wc(12,Ic,t.routes.tenge.salary)))},directives:[pn.a,fn.a,Fr.f,Fr.e,hn.a,Fr.h],pipes:[c.d,r.b],styles:[".payment-section--submit{text-align:right}.payment-section{max-width:582px}.payment-section--purpose-length{position:absolute;right:.8rem;top:.4rem;z-index:1}.payment-section--summary .payment-section--amount-warn{color:#666c72}"],encapsulation:2,data:{animation:[Rc.c]}}),dc),Ec=n("gcYM"),xc=n("+BgI"),wc=n("wtV8"),Wc=n("kFTB"),Nc=["vinTpl"],Pc=["protocolNumberTpl"];function Mc(e,t){if(1&e&&(d.Wb(0,"div",49),d.Wb(1,"p",50),d.Qc(2),d.Vb(),d.Wb(3,"p",51),d.Qc(4),d.Vb(),d.Vb()),2&e){var n=t.item;d.Ab(2),d.Rc(n.label),d.Ab(2),d.Sc("\u0411\u0418\u041d: ",n.bin,"")}}function Lc(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div"),d.Wb(1,"button",52),d.ic("click",(function(e){d.Fc(n);var t=d.lc(2),r=d.Cc(17);return t.openDepartmentDictionary(r,e)})),d.Qc(2," \u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a "),d.Vb(),d.Wb(3,"p",53),d.Qc(4,"\u0427\u0430\u0441\u0442\u044b\u0435 \u0423\u0413\u0414"),d.Vb(),d.Vb()}}function Dc(e,t){1&e&&d.Oc(0,Lc,5,0,"div",42),2&e&&d.rc("ngIf",!t.searchTerm)}function Qc(e,t){1&e&&d.Rb(0,"div",6)}function Fc(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div"),d.Wb(1,"button",52),d.ic("click",(function(e){d.Fc(n);var t=d.lc(2),r=d.Cc(52);return t.openKBKDictionary(r,e)})),d.Qc(2," \u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a "),d.Vb(),d.Wb(3,"p",53),d.Qc(4,"\u0427\u0430\u0441\u0442\u044b\u0435 \u041a\u0411\u041a"),d.Vb(),d.Vb()}}function Bc(e,t){1&e&&d.Oc(0,Fc,5,0,"div",42),2&e&&d.rc("ngIf",!t.searchTerm)}function $c(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div"),d.Wb(1,"button",52),d.ic("click",(function(e){d.Fc(n);var t=d.lc(2),r=d.Cc(61);return t.openKnpDictionary(r,e)})),d.Qc(2," \u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a "),d.Vb(),d.Wb(3,"p",54),d.Qc(4,"\u0427\u0430\u0441\u0442\u044b\u0435 \u041a\u041d\u041f"),d.Vb(),d.Wb(5,"p",55),d.Qc(6,"\u0412\u044b\u0431\u043e\u0440 \u041a\u041d\u041f \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u0446\u0435\u043b\u0438 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Vb()}}function Uc(e,t){1&e&&d.Oc(0,$c,7,0,"div",42),2&e&&d.rc("ngIf",!t.searchTerm)}function Yc(e,t){if(1&e&&(d.Wb(0,"div",56),d.Wb(1,"div",57),d.Qc(2),d.Vb(),d.Vb()),2&e){var n=t.ngIf;d.Ab(2),d.Sc(" ",n," ")}}function Kc(e,t){1&e&&d.Rb(0,"div",6)}function Hc(e,t){if(1&e&&(d.Wb(0,"div",58),d.Rb(1,"span",59),d.Vb()),2&e){var n=t.ngIf;d.Ab(1),d.rc("innerHTML",n,d.Gc)}}function Gc(e,t){1&e&&(d.Ub(0),d.Qc(1),d.mc(2,"translate"),d.Tb()),2&e&&(d.Ab(1),d.Sc(" ",d.nc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function zc(e,t){if(1&e&&(d.Qc(0),d.mc(1,"translate"),d.mc(2,"amountFormat"),d.mc(3,"async")),2&e){var n=d.lc();d.Tc(" ",d.nc(1,2,"PAYMENTS.COMMISSION"),": ",d.nc(2,4,d.nc(3,6,n.commission$))," \u20b8 ")}}function qc(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"button",60),d.ic("click",(function(e){return d.Fc(n),d.lc().saveToDraft()})),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),d.Vb(),d.Wb(3,"button",61),d.Qc(4),d.mc(5,"translate"),d.Vb(),d.Tb()}if(2&e){var r=d.lc();d.Ab(4),d.Sc("",d.nc(5,1,r.submitLabel)," ")}}function Xc(e,t){1&e&&(d.Ub(0),d.Wb(1,"button",62),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"),d.Vb(),d.Tb())}function Zc(e,t){if(1&e&&(d.Wb(0,"div",63),d.Wb(1,"div",64),d.Rb(2,"j-period-input",65,66),d.mc(4,"translate"),d.Vb(),d.Vb()),2&e){var n=d.Cc(3),r=d.lc();d.Ab(2),d.rc("hasError",r.hasError(n,r.form.controls.period))("label",d.nc(4,3,"SHARED.TIME.PERIOD"))("formControl",r.form.controls.period)}}function Jc(e,t){if(1&e&&(d.Wb(0,"div",63),d.Wb(1,"div",67),d.Rb(2,"j-period-input",65,68),d.mc(4,"translate"),d.mc(5,"translate"),d.Vb(),d.Wb(6,"div",67),d.Rb(7,"j-period-input",65,69),d.mc(9,"translate"),d.mc(10,"translate"),d.Vb(),d.Vb()),2&e){var n=d.Cc(3),r=d.Cc(8),i=d.lc();d.Ab(2),d.uc("label","",d.nc(4,8,"SHARED.TIME.MONTH")," ",d.nc(5,10,"SHARED.PREPOSITION.FROM"),""),d.rc("hasError",i.hasError(n,i.form.controls.periodStart)||i.hasError(r,i.form.controls.periodEnd))("formControl",i.form.controls.periodStart),d.Ab(5),d.uc("label","",d.nc(9,12,"SHARED.TIME.MONTH")," ",d.nc(10,14,"SHARED.PREPOSITION.TO"),""),d.rc("hasError",i.hasError(r,i.form.controls.periodEnd)||i.hasError(n,i.form.controls.periodStart))("formControl",i.form.controls.periodEnd)}}function es(e,t){if(1&e&&(d.Wb(0,"j-form-field",70),d.Wb(1,"j-label"),d.Qc(2,"VIN \u043a\u043e\u0434"),d.Vb(),d.Rb(3,"input",71),d.Rb(4,"j-error",31),d.Vb(),d.Wb(5,"div",58),d.Rb(6,"span",59),d.Vb()),2&e){var n=d.lc();d.Ab(3),d.rc("formControl",n.form.controls.vin),d.Ab(1),d.rc("control",n.form.controls.vin)("errorMessages",n.errors.vin),d.Ab(2),d.rc("innerHTML",n.vinMessage,d.Gc)}}function ts(e,t){if(1&e&&(d.Wb(0,"j-form-field",70),d.Wb(1,"j-label"),d.Qc(2,"\u041d\u043e\u043c\u0435\u0440 \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430"),d.Vb(),d.Rb(3,"input",13),d.Vb()),2&e){var n=d.lc();d.Ab(3),d.rc("mask",n.masks.protocolNumber.mask)("formControl",n.form.controls.protocolNumber)}}function ns(e,t){1&e&&(d.Wb(0,"p",72),d.Qc(1," \u0422\u0443\u0442 \u0431\u0443\u0434\u0435\u0442 \u0442\u0435\u043a\u0441\u0442 \u043f\u043e \u043a\u043e\u043c\u0438\u0441\u0441\u0438\u0438 "),d.Rb(2,"br"),d.Qc(3," \u041f\u043e \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e \u043a\u0430\u043a\u043e\u0439 "),d.Rb(4,"br"),d.Qc(5," \u0416\u0434\u0443 \u0438\u043d\u0444\u0443 "),d.Vb())}var rs,is,os=((rs=function(e){function t(e,n,r,i,o,a,c,s,l,u,b,d,m,p){var f;return _classCallCheck(this,t),(f=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,p.createTaxForm(),d,e,n,i,r,a,u,m,b))).route=e,f.router=n,f.paymentsService=r,f.companyService=i,f.dateAdapter=o,f.maskService=a,f.translate=c,f.datePipe=s,f.accountsService=l,f.modalService=u,f.pipelines=b,f.api=d,f.dictionaries=m,f.paymentsFormsFactory=p,f.associatedFieldTpl=void 0,f.masks={number:"paymentNum",amount:"amount",vin:"vin",knp:"knp",kbk:"kbk",protocolNumber:"protocol"},f.commission$=new Hr.a(0),f.protocolMessage$=new Hr.a(""),f.vinLength=17,f.subs=new Qi.a,f.paymentType=ii.i.TAX,f}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"ngOnInit",this).call(this),this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(de.a)((function(t){return e.checkPersonalAccounts(t)}))),this.getMaskConfig(),this.createControlsStream(this.form),this.combineKBK(this.paymentType),this.knp$=this.combineKNP([function(t,n){if(n[0]){var r=e.knpStore.getItemsByIds(e.kbkStore.entities[n[0]].associatedKnpList),i=e.form.controls.knp;return i.enable(),setTimeout((function(){1===r.length?(i.patchValue(r[0].code),e.focusableContainer.focusNext()):r.some((function(e){return e.code===i.value}))||i.patchValue("")}),100),r}return[]}],[this.controlsStream.kbk]),this.listenWorkingDays(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenKnpUpdates(),this.subs.add(this.createPeriodMessage$().subscribe(this.periodMessage$)),this.subs.add(Object(Gr.a)([this.controlsStream.vin.pipe(Object(fe.a)((function(e){return e?"VIN".concat(e,"/V"):""}))),this.controlsStream.protocolNumber.pipe(Object(fe.a)((function(e){return e?"ADM".concat(e,"/A"):""})))]).subscribe((function(t){e.protocolMessage$.next(t.join(" "))})));var n=[this.protocolMessage$.pipe(Object(fe.a)((function(e){return["protocol",e]}))),Object(Gr.a)([this.translate.get("SHARED.NOT_SELECTED"),this.translate.get("SHARED.TIME.PERIOD"),this.periodMessage$]).pipe(Object(fe.a)((function(e){var t=_slicedToArray(e,3),n=t[0],r=t[1],i=t[2];return i&&i!==n?"".concat(r,": ").concat(i,"."):""})),Object(fe.a)((function(e){return["period",e]})))];this.listenPurposeMessageStream(n,["protocol","kbk","knp","period"]),this.subs.add(this.controlsStream.kbk.pipe().subscribe((function(t){var n=e.form.controls,r=n.protocolNumber,i=n.vin;e.rules.kbkCodeVinReq.some((function(e){return e===t}))?(i.enable(),r.disable(),r.value&&r.patchValue(""),e.associatedFieldTpl=e.vinTpl):/^204\d+$/.test(t)?(i.disable(),i.value&&i.patchValue(""),r.enable(),e.associatedFieldTpl=e.protocolNumberTpl):(e.associatedFieldTpl=null,i.disable(),r.disable(),r.value&&r.patchValue(""),i.value&&i.patchValue(""))}))),this.subs.add(this.controlsStream.intervalEnabled.pipe(Object(Ec.a)(300,void 0,{leading:!0,trailing:!0}),Object(Zr.a)()).subscribe((function(t){var n=e.form.controls,r=n.period,i=n.periodEnd,o=n.periodStart;t?([i,o].forEach((function(e){return e.enable()})),r.disable()):([i,o].forEach((function(e){return e.disable()})),r.enable())})))}},{key:"onKbkSelect",value:function(e){!this.form.controls.knp.value&&e.associatedKnpList&&this.form.controls.knp.setValue(e.associatedKnpList[0])}},{key:"openDepartmentDictionary",value:function(e,t){var n=this;t&&t.preventDefault(),e&&(e.blur(),e.close()),this.modalService.open(_i,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then((function(e){n.form.controls.ugd.setValue(e.code)})).catch((function(){}))}},{key:"openKBKDictionary",value:function(e,t){var n=this;t&&t.preventDefault(),e&&(e.blur(),e.close());var r=this.modalService.open(Pi,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});Object.assign(r.componentInstance,{store:this.kbkStore}),r.result.then((function(e){n.form.controls.kbk.setValue(e.code)})).catch((function(){}))}},{key:"onUgdSelect",value:function(e){}},{key:"createPeriodMessage$",value:function(){var e=this,t=this.controlsStream,n=t.intervalEnabled,r=t.periodEnd,i=t.periodStart,o=t.period;return Object(Gr.a)([n,this.translate.get("SHARED.NOT_SELECTED"),o,i,r]).pipe(Object(me.a)(0),Object(fe.a)((function(t){var n=_toArray(t),r=n[0],i=n[1],o=_slicedToArray(n.slice(2).map((function(t){return t?e.datePipe.transform(t,"MM.yyyy"):""})),3),a=o[0],c=o[1],s=o[2];return!r&&!a||r&&!c&&!s?i:r?"".concat(c||i," - ").concat(s||i):"".concat(a||i)})))}},{key:"sendPayment",value:function(){return _get(_getPrototypeOf(t.prototype),"sendPayment",this).call(this,this.constructTaxPaymentBody())}},{key:"saveToDraft",value:function(){return _get(_getPrototypeOf(t.prototype),"saveToDraft",this).call(this,this.constructTaxPaymentBody())}},{key:"openKnpDictionary",value:function(e,t){var n=this;e.close(),e.blur(),setTimeout((function(){var e=n.modals.open(ki,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});e.componentInstance.paymentType=n.paymentType,e.result.then((function(e){if(!n.filteredKnpList.includes(e)){var t=n.kbkStore.items.find((function(e){var t;return e.code==(null===(t=n.form.controls.kbk)||void 0===t?void 0:t.value)})),r=n.knpStore.getItemsByIds(t.associatedKnpList);n.filteredKnpList=[].concat(_toConsumableArray(r),[e])}n.form.controls.knp.patchValue(e.code)})).catch((function(){}))}),0)}},{key:"constructTaxPaymentBody",value:function(){var e,t=this.form.value,n=this.protocolMessage$.getValue();return e=n?this.purposeMessage$.getValue().replace(n,[n,t.purpose].filter((function(e){return!!e})).join(" ")):[t.purpose,this.purposeMessage$.getValue()].filter((function(e){return!!e})).join(". "),Object.assign(Object.assign({},t),{purpose:e})}},{key:"listenKnpUpdates",value:function(){var e=this;this.knp$.subscribe((function(t){e.filteredKnpList=t}))}},{key:"intervalSwitchLabel",get:function(){return this.form.controls.intervalEnabled.value?"\u041e\u043f\u043b\u0430\u0442\u0430 \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0430 \u0437\u0430 \u043f\u0435\u0440\u0438\u043e\u0434":"\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0437\u0430\u0434\u0430\u0442\u044c \u043f\u0435\u0440\u0438\u043e\u0434 \u0434\u043b\u044f \u043e\u043f\u043b\u0430\u0442\u044b"}},{key:"vinMessage",get:function(){var e,t;return this.form.controls.vin.value&&0!==this.form.controls.vin.value.length?(null===(e=this.form.controls.vin.value)||void 0===e?void 0:e.length)<this.vinLength?this.translate.instant("PAYMENTS.VIN_MESSAGE.LESS",{length:this.vinLength}):(null===(t=this.form.controls.vin.value)||void 0===t?void 0:t.length)>this.vinLength?this.translate.instant("PAYMENTS.VIN_MESSAGE.MORE",{length:this.vinLength}):"":this.translate.instant("PAYMENTS.VIN_MESSAGE.OPTIONAL")}}]),t}(Mo)).\u0275fac=function(e){return new(e||rs)(d.Qb(Fr.a),d.Qb(Fr.c),d.Qb(Yr.c),d.Qb(li.a),d.Qb(a.c),d.Qb(Lo.a),d.Qb(c.e),d.Qb(r.f),d.Qb(l.c),d.Qb(a.q),d.Qb(xc.a),d.Qb(wc.a),d.Qb(vi.a),d.Qb(Wc.a))},rs.\u0275cmp=d.Kb({type:rs,selectors:[["j-tax-payment"]],viewQuery:function(e,t){var n;1&e&&(d.Vc(i.v,!0),d.Vc(Ot.b,!0),d.Vc(Nc,!0,d.L),d.Vc(Pc,!0,d.L)),2&e&&(d.Bc(n=d.jc())&&(t.ngForm=n.first),d.Bc(n=d.jc())&&(t.focusableContainer=n.first),d.Bc(n=d.jc())&&(t.vinTpl=n.first),d.Bc(n=d.jc())&&(t.protocolNumberTpl=n.first))},features:[d.xb],decls:122,vars:84,consts:[["autocomplete","off","jInvalidControlScroll","","jFocusableContainer","",1,"p-relative",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"payments__header"],[1,"h2","mb-0"],["type","button",1,"btn","btn-link","p-0","p3",3,"click"],[1,"form-group"],["selectWrapper",""],["bindValue","code","bindLabel","label",3,"appendTo","jFocusOnReturn","formControl","clearable","searchFn","items"],["ugdSelect",""],["j-option-tmp",""],["j-header-tmp",""],[1,"h2"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","formControl"],["class","form-group",4,"ngTemplateOutlet"],[1,"list-group"],[1,"list-group-item","text-left","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[3,"hidden"],["kbkWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items","change"],["kbkSelect",""],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"appendTo","jFocusOnReturn","formControl","clearable","searchMask","shadow","items"],["knpSelect",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],["clearable","true",3,"floatLabel"],["type","text","suffix"," \u20b8","jFormInput","","jCursorBound","","placeholder","0,00","mask","separator.2","jReplaceDot","","thousandSeparator"," ","decimalMarker",",",1,"form-control",3,"dropSpecialCharacters","formControl"],["class","j-input-helper text-muted mt-1 p3",4,"ngIf"],[1,"j-input-helper","text-muted","mt-1","p3","position-relative"],[4,"ngIf","ngIfElse"],["commission",""],[1,"payment-section--submit","form-group","pt-4"],[4,"ngIf"],["periodTpl",""],["intervalTpl",""],["vinTpl",""],["protocolNumberTpl",""],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["amountInfo",""],[1,"j-option-label","text-wrap"],[1,"m-0"],[1,"p3","text-gray","m-0"],["type","button",1,"form-section--action","btn","btn-xs","btn-link","float-right",3,"click"],[1,"p2"],[1,"p2","m-0"],[1,"p3","text-gray"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"j-input-helper","text-muted","mt-1","p3"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"],[1,"row"],[1,"col"],[3,"hasError","label","formControl"],["period",""],[1,"col","col-md-6"],["periodStart",""],["periodEnd",""],["clearable","true"],["type","text","jFormInput","","jFocusOnReturn","","maxlength","64","jUppercase","",1,"form-control",3,"formControl"],[1,"p3"]],template:function(e,t){if(1&e){var n=d.Xb();d.Wb(0,"form",0,1),d.ic("submit",(function(e){return t.onSubmit(e)})),d.Wb(2,"div",2),d.Wb(3,"fieldset"),d.Wb(4,"div",3),d.Wb(5,"h2",4),d.Qc(6),d.mc(7,"translate"),d.Vb(),d.Wb(8,"button",5),d.ic("click",(function(e){d.Fc(n);var r=d.Cc(17);return t.openDepartmentDictionary(r,e)})),d.Qc(9),d.mc(10,"translate"),d.Vb(),d.Vb(),d.Wb(11,"div",6),d.Wb(12,"j-form-field",null,7),d.Wb(14,"j-label"),d.Qc(15,"\u041e\u0440\u0433\u0430\u043d \u0433\u043e\u0441. \u0434\u043e\u0445\u043e\u0434\u043e\u0432"),d.Vb(),d.Wb(16,"j-select",8,9),d.mc(18,"async"),d.Oc(19,Mc,5,2,"ng-template",10),d.Oc(20,Dc,1,1,"ng-template",11),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(21,"div",2),d.Wb(22,"fieldset"),d.Wb(23,"legend",12),d.Qc(24,"\u0414\u0435\u0442\u0430\u043b\u0438 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Wb(25,"div",6),d.Wb(26,"j-form-field"),d.Wb(27,"j-label"),d.Qc(28,"\u041d\u043e\u043c\u0435\u0440 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430"),d.Vb(),d.Rb(29,"input",13),d.Vb(),d.Vb(),d.Oc(30,Qc,1,0,"div",14),d.Wb(31,"div",6),d.Wb(32,"ul",15),d.Wb(33,"li",16),d.Rb(34,"j-switch",17),d.Wb(35,"span",18),d.Qc(36),d.mc(37,"translate"),d.Rb(38,"br"),d.Wb(39,"small",19),d.Qc(40),d.mc(41,"translate"),d.Wb(42,"span",20),d.Qc(43),d.mc(44,"async"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(45,"div",6),d.Wb(46,"div",6),d.Wb(47,"j-form-field",null,21),d.Wb(49,"j-label"),d.Qc(50,"\u041a\u0411\u041a/\u0422\u0438\u043f \u043d\u0430\u043b\u043e\u0433\u0430"),d.Vb(),d.Wb(51,"j-select",22,23),d.ic("change",(function(e){return t.onKbkSelect(e)})),d.mc(53,"async"),d.Oc(54,Bc,1,1,"ng-template",11),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(55,"div",6),d.Wb(56,"j-form-field",null,24),d.Wb(58,"j-label"),d.Qc(59,"\u041a\u041d\u041f \u2014 \u041a\u043e\u0434 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Wb(60,"j-select",25,26),d.Oc(62,Uc,1,1,"ng-template",11),d.Vb(),d.Vb(),d.Vb(),d.Wb(63,"div",27),d.Wb(64,"span",28),d.Qc(65),d.mc(66,"async"),d.Vb(),d.Wb(67,"j-form-field"),d.Wb(68,"j-label"),d.Qc(69,"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Rb(70,"textarea",29,30),d.Rb(72,"j-error",31),d.Oc(73,Yc,3,1,"div",32),d.mc(74,"async"),d.Vb(),d.Vb(),d.Oc(75,Kc,1,0,"div",14),d.Vb(),d.Vb(),d.Wb(76,"div",2),d.Wb(77,"fieldset"),d.Wb(78,"div",6),d.Wb(79,"j-account-dropdown",33,34),d.ic("selected",(function(e){return t.onSenderAccountSelect(e)})),d.mc(81,"async"),d.mc(82,"async"),d.Vb(),d.Vb(),d.Wb(83,"div",6),d.Wb(84,"div",6),d.Wb(85,"j-form-field",35),d.Wb(86,"j-label"),d.Qc(87,"\u0421\u0443\u043c\u043c\u0430 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Rb(88,"input",36),d.Vb(),d.Oc(89,Hc,2,1,"div",37),d.mc(90,"async"),d.Wb(91,"div",38),d.Oc(92,Gc,3,3,"ng-container",39),d.mc(93,"async"),d.Oc(94,zc,4,8,"ng-template",null,40,d.Pc),d.Vb(),d.Vb(),d.Vb(),d.Wb(96,"div",6),d.Wb(97,"ul",15),d.Wb(98,"li",16),d.Rb(99,"j-switch",17),d.Wb(100,"span",18),d.Qc(101,"\u0421\u0440\u043e\u0447\u043d\u044b\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 "),d.Rb(102,"br"),d.Wb(103,"small",19),d.Qc(104),d.mc(105,"translate"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(106,"div",41),d.Wb(107,"div",41),d.Oc(108,qc,6,3,"ng-container",42),d.Oc(109,Xc,3,0,"ng-container",42),d.Vb(),d.Vb(),d.Oc(110,Zc,5,5,"ng-template",null,43,d.Pc),d.Oc(112,Jc,11,16,"ng-template",null,44,d.Pc),d.Oc(114,es,7,4,"ng-template",null,45,d.Pc),d.Oc(116,ts,4,2,"ng-template",null,46,d.Pc),d.Rb(118,"ngx-spinner",47),d.Rb(119,"ngx-spinner",47),d.Vb(),d.Oc(120,ns,6,0,"ng-template",null,48,d.Pc)}if(2&e){var r=d.Cc(13),i=d.Cc(17),o=d.Cc(48),a=d.Cc(52),c=d.Cc(57),s=d.Cc(61),l=d.Cc(95),u=d.Cc(111),b=d.Cc(113);d.rc("formGroup",t.form),d.Ab(6),d.Sc(" ",d.nc(7,56,"PAYMENTS.RECIPIENT.TITLE")," "),d.Ab(3),d.Sc(" ",d.nc(10,58,"PAYMENTS.SELECT_FROM_DICTIONARY")," "),d.Ab(7),d.rc("appendTo",r.elementRef.nativeElement)("jFocusOnReturn",i)("formControl",t.form.controls.ugd)("clearable",!1)("searchFn",t.paymentsService.ugdSearchFn)("items",d.nc(18,60,t.ugdStore.items$)),d.Ab(13),d.rc("mask",t.masks.number.mask)("formControl",t.form.controls.number),d.Ab(1),d.rc("ngTemplateOutlet",t.form.controls.intervalEnabled.value?b:u),d.Ab(4),d.rc("formControl",t.form.controls.intervalEnabled),d.Ab(2),d.Sc(" ",d.nc(37,62,"PAYMENTS.FORPERIOD")," "),d.Ab(4),d.Sc(" ",d.nc(41,64,t.intervalSwitchLabel)," "),d.Ab(2),d.rc("hidden",!t.form.controls.intervalEnabled.value),d.Ab(1),d.Sc(": ",d.nc(44,66,t.periodMessage$)," "),d.Ab(8),d.rc("jFocusOnReturn",a)("appendTo",o.elementRef.nativeElement)("formControl",t.form.controls.kbk)("clearable",!1)("searchMask",t.masks.kbk.mask)("shadow",t.masks.kbk.shadow)("items",d.nc(53,68,t.kbkStore.items$)),d.Ab(9),d.rc("appendTo",c.elementRef.nativeElement)("jFocusOnReturn",s)("formControl",t.form.controls.knp)("clearable",!1)("searchMask",t.masks.knp.mask)("shadow",t.masks.knp.shadow)("items",t.filteredKnpList),d.Ab(5),d.Tc(" ",d.nc(66,70,t.purposeLength$),"/",t.rules.purposeLength,""),d.Ab(5),d.rc("formControl",t.form.controls.purpose),d.Ab(2),d.rc("control",t.form.controls.purpose)("errorMessages",t.errors.purpose),d.Ab(1),d.rc("ngIf",d.nc(74,72,t.purposeMessage$)),d.Ab(2),d.rc("ngTemplateOutlet",t.associatedFieldTpl),d.Ab(4),d.rc("isLoading",d.nc(81,74,t.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",t.form.controls.senderAccount.touched&&t.form.controls.senderAccount.errors)("accounts",d.nc(82,76,t.acceptableAccounts$)),d.Ab(6),d.rc("floatLabel","always"),d.Ab(3),d.rc("dropSpecialCharacters",!0)("formControl",t.form.controls.amount),d.Ab(1),d.rc("ngIf",d.nc(90,78,t.amountMessage$)),d.Ab(3),d.rc("ngIf",null===d.nc(93,80,t.commission$))("ngIfElse",l),d.Ab(7),d.rc("formControl",t.form.controls.urgent),d.Ab(5),d.Rc(d.nc(105,82,"PAYMENTS.URGENT_HELPER")),d.Ab(4),d.rc("ngIf",t.restoredData.status!==t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("ngIf",t.restoredData.status===t.PAYMENT_STATUS.CREATED),d.Ab(9),d.rc("name",t.SPINNER)("fullScreen",!1),d.Ab(1),d.rc("name",t.SPINNER)("fullScreen",!1)}},directives:[i.J,i.u,Pt.b,Ot.b,i.l,Zt.a,en.a,kt,Ot.a,i.t,i.i,ve,ke,an.a,i.c,o.a,r.B,Rn.a,on.a,r.u,Bo.a,It.a,Et.a,fr.a,rn.a,Zn.a,i.o,Wt.a],pipes:[c.d,r.b,Vr.a],styles:[".payments__header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:1.5rem}"]}),rs),as=function(e){return[e]},cs=((is=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this))).routes=Br.a,e}return _inherits(t,e),t}(Oc)).\u0275fac=function(e){return new(e||is)},is.\u0275cmp=d.Kb({type:is,selectors:[["j-budget-payments"]],features:[d.xb],decls:13,vars:12,consts:[[1,"payment-section"],[1,"form-group","mb-5"],["routerLinkActive","active",1,"btn","btn-sm","btn-outline-dark","btn-shadow",3,"routerLink"],["routerLinkActive","active",1,"btn","btn-sm","btn-outline-dark","btn-shadow","ml-2",3,"routerLink"],[1,"outlet-animation-wrapper"],[3,"activate"],["outlet","outlet"]],template:function(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div",0),d.Wb(1,"div",1),d.Wb(2,"a",2),d.Qc(3,"\u041d\u0430\u043b\u043e\u0433\u043e\u0432\u044b\u0439"),d.Vb(),d.Wb(4,"a",3),d.Qc(5,"\u041f\u0435\u043d\u0441\u0438\u043e\u043d\u043d\u044b\u0439"),d.Vb(),d.Wb(6,"a",3),d.Qc(7,"\u0421\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439"),d.Vb(),d.Wb(8,"a",3),d.Qc(9,"\u041e\u0421\u041c\u0421"),d.Vb(),d.Vb(),d.Wb(10,"div",4),d.Wb(11,"router-outlet",5,6),d.ic("activate",(function(e){d.Fc(n);var r=d.Cc(12);return t.onActivate(e,r)})),d.Vb(),d.Vb(),d.Vb()}2&e&&(d.Ab(2),d.rc("routerLink",d.wc(4,as,t.routes.tenge.state.tax)),d.Ab(2),d.rc("routerLink",d.wc(6,as,t.routes.tenge.state.pension)),d.Ab(2),d.rc("routerLink",d.wc(8,as,t.routes.tenge.state.social)),d.Ab(2),d.rc("routerLink",d.wc(10,as,t.routes.tenge.state.osms)))},directives:[Fr.f,Fr.e,Fr.h],styles:[""],data:{animation:[Rc.c]}}),is),ss=n("ZF+8"),ls=["emailOnSuccess"];function us(e,t){if(1&e){var n=d.Xb();d.Wb(0,"button",55),d.ic("click",(function(e){return d.Fc(n),d.lc().checkIin()})),d.Qc(1,"\u041f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c"),d.Vb()}}function bs(e,t){1&e&&(d.Wb(0,"span"),d.Wb(1,"span",56),d.Qc(2,"PAYMENTS.TRUSTED_COUNTERPARTY"),d.Vb(),d.Rb(3,"span",57),d.Vb()),2&e&&(d.Ab(3),d.rc("inlineSVG","./assets/icons/counterparty/status.svg"))}function ds(e,t){1&e&&(d.Wb(0,"span"),d.Wb(1,"span",56),d.Qc(2,"PAYMENTS.UNTRUSTED_COUNTERPARTY"),d.Vb(),d.Rb(3,"span",58),d.Vb()),2&e&&(d.Ab(3),d.rc("inlineSVG","./assets/icons/counterparty/status.svg"))}function ms(e,t){if(1&e&&(d.Wb(0,"li",59),d.Qc(1),d.Vb()),2&e){var n=t.$implicit;d.Ab(1),d.Sc(" \u2022 ",n.name," ")}}function ps(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div"),d.Wb(1,"button",60),d.ic("click",(function(e){d.Fc(n);var t=d.lc(2),r=d.Cc(70);return t.openKnpDictionary(r,e)})),d.Qc(2," \u0421\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a "),d.Vb(),d.Wb(3,"p",61),d.Qc(4,"\u0427\u0430\u0441\u0442\u044b\u0435 \u041a\u041d\u041f"),d.Vb(),d.Wb(5,"p",62),d.Qc(6,"\u0412\u044b\u0431\u043e\u0440 \u041a\u041d\u041f \u0437\u0430\u0432\u0438\u0441\u0438\u0442 \u043e\u0442 \u0446\u0435\u043b\u0438 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Vb()}}function fs(e,t){1&e&&d.Oc(0,ps,7,0,"div",11),2&e&&d.rc("ngIf",!t.searchTerm)}function hs(e,t){if(1&e&&(d.Wb(0,"div",63),d.Wb(1,"div",64),d.Qc(2),d.Vb(),d.Vb()),2&e){var n=t.ngIf;d.Ab(2),d.Sc(" ",n," ")}}function vs(e,t){if(1&e&&(d.Wb(0,"div",35),d.Rb(1,"span",65),d.Vb()),2&e){var n=t.ngIf;d.Ab(1),d.rc("innerHTML",n,d.Gc)}}function gs(e,t){1&e&&(d.Ub(0),d.Qc(1),d.mc(2,"translate"),d.Tb()),2&e&&(d.Ab(1),d.Sc(" ",d.nc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function ys(e,t){if(1&e&&(d.Qc(0),d.mc(1,"translate"),d.mc(2,"amountFormat"),d.mc(3,"async")),2&e){var n=d.lc();d.Tc(" ",d.nc(1,2,"PAYMENTS.COMMISSION"),": ",d.nc(2,4,d.nc(3,6,n.commission$))," \u20b8 ")}}function Cs(e,t){1&e&&(d.Wb(0,"div"),d.Wb(1,"small",48),d.Qc(2,"\u041d\u0430 \u043f\u043e\u0447\u0442\u0443 \u043f\u0440\u0438\u0434\u0435\u0442 \u043a\u0432\u0438\u0442\u0430\u043d\u0446\u0438\u044f \u043e\u0431 \u043e\u043f\u043b\u0430\u0442\u0435"),d.Vb(),d.Vb())}function ks(e,t){if(1&e){var n=d.Xb();d.Wb(0,"div",66),d.Wb(1,"j-form-field"),d.Wb(2,"j-label"),d.Qc(3,"Email \u0430\u0434\u0440\u0435\u0441"),d.Vb(),d.Wb(4,"input",67,68),d.ic("focus",(function(e){return d.Fc(n),d.lc().onEmailOnSuccessFocus(e)})),d.Vb(),d.Rb(6,"j-error",12),d.Vb(),d.Wb(7,"small",48),d.Qc(8,"\u0418\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d \u043d\u0430 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 email \u0430\u0434\u0440\u0435\u0441 "),d.Vb(),d.Vb()}if(2&e){var r=d.lc();d.Ab(4),d.rc("ngbTypeahead",r.search)("formControl",r.form.controls.emailOnSuccess),d.Ab(2),d.rc("control",r.form.controls.emailOnSuccess)("errorMessages",r.errors.email)}}function As(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"button",69),d.ic("click",(function(e){return d.Fc(n),d.lc().saveToDraft()})),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),d.Vb(),d.Wb(3,"button",70),d.Qc(4),d.mc(5,"translate"),d.Vb(),d.Tb()}if(2&e){var r=d.lc();d.Ab(4),d.Sc("",d.nc(5,1,r.submitLabel)," ")}}function Ts(e,t){1&e&&(d.Ub(0),d.Wb(1,"button",71),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"),d.Vb(),d.Tb())}function Rs(e,t){1&e&&(d.Wb(0,"p",72),d.Qc(1," \u0422\u0443\u0442 \u0431\u0443\u0434\u0435\u0442 \u0442\u0435\u043a\u0441\u0442 \u043f\u043e \u043a\u043e\u043c\u0438\u0441\u0441\u0438\u0438 "),d.Rb(2,"br"),d.Qc(3," \u041f\u043e \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e \u043a\u0430\u043a\u043e\u0439 "),d.Rb(4,"br"),d.Qc(5," \u0416\u0434\u0443 \u0438\u043d\u0444\u0443 "),d.Vb())}function _s(e,t){1&e&&d.Rb(0,"j-kbe-info")}var Ss,js=function(e){return e.SUCCESS="SUCCESS",e.ERROR="ERROR",e}({}),Os=((Ss=function(e){function t(e,n,r,i,o,a,c,s,l,u,b,d,m){var p;return _classCallCheck(this,t),(p=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,b.createPaymentInTengeForm(),a,i,o,e,n,r,l,c,u))).companyService=e,p.paymentsService=n,p.maskService=r,p.route=i,p.router=o,p.api=a,p.dictionaries=c,p.accountsService=s,p.modalService=l,p.pipelines=u,p.paymentsFormsFactory=b,p.recipientsService=d,p.userService=m,p.isCounterPartyLoading$=new Hr.a(null),p.masks={iinOrBin:"iin",bankAccount:"tengeAccount",kbeCode:"kbe",knp:"knp",number:"paymentNum",amount:"amount"},p.riskGroups=[],p.counterPartyStatus=js,p.counterParty$=new Hr.a(null),p.focusEmail$=new A.a,p.prevEmails$=new Hr.a([]),p.fetchingEmailsFor$=new Hr.a(null),p.iinIsSubmitted$=new Hr.a(null),p.iinIsFound$=new Hr.a(null),p.paymentType=ii.i.REGULAR_PAYMENT_ORDER,p.user=p.userService.user,p}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"ngOnInit",this).call(this),this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(de.a)((function(t){return e.checkPersonalAccounts(t)}))),this.knp$=this.combineKNP([function(t){return e.dictionaries.selectByPaymentType(t,{type:ii.i.REGULAR_PAYMENT_ORDER,sortFavourite:!0})}]),this.listenWorkingDays(),this.getMaskConfig(),this.createControlsStream(this.form),this.listenVAT(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.listenEmailSearch();var n=this.controlsStream,r=n.bankAccount,i=n.senderAccount;this.subs.add(Object(Gr.a)([r.pipe(Object(pe.a)((function(t){return e.form.controls.bankAccount.valid})),Object(be.a)("")),i.pipe(Object(pe.a)((function(t){return e.form.controls.senderAccount.valid})),Object(fe.a)((function(e){return e.iban})),Object(be.a)(""))]).pipe(Object(fe.a)((function(t){var n=_slicedToArray(t,2),r=n[0],i=n[1];return e.paymentsService.checkPaymentTypeFromIban(i,"KZ"+r)}))).subscribe((function(t){return e.paymentType=t}))),this.applyCounterAgentVerification()}},{key:"openSavedPayments",value:function(){var e=this;this.modalService.open(hi,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then((function(t){var n=t.recipient,r=t.account;e.form.patchValue({bankAccount:r.iban,iinOrBin:n.iinOrBin,name:n.name,kbeCode:n.kbe.code}),e.form.markAsDirty()})).catch((function(){}))}},{key:"onEmailOnSuccessFocus",value:function(e){this.focusEmail$.next(e.target.value)}},{key:"openKnpDictionary",value:function(e,t){var n=this;e.close(),e.blur(),setTimeout((function(){var e=n.modals.open(ki,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0});e.componentInstance.paymentType=ii.i.REGULAR_PAYMENT_ORDER,e.result.then((function(e){n.form.controls.knp.patchValue(e.code)})).catch((function(){}))}),0)}},{key:"applyCounterAgentVerification",value:function(){var e=this,t=this.form.controls.iinOrBin;this.subs.add(this.controlsStream.iinOrBin.pipe(Object(Zr.a)(),Object(me.a)(300),Object(ti.a)((function(n){return e.counterParty$.next(null),e.iinIsFound$.next(null),e.iinIsSubmitted$.next(null),t.valid&&(e.iinIsNotOwn=e.user.iin!==n,e.isCounterPartyLoading$.next(n)),e.isCounterPartyLoading$.next(null),Object(qr.a)(null)}))).subscribe((function(t){t&&e.checkCounterParty(t),e.isCounterPartyLoading$.next(null)})))}},{key:"checkCounterParty",value:function(e){var t,n,r;(null===(t=e.companyInfo)||void 0===t?void 0:t.name)&&this.form.controls.name.setValue(null===(n=e.companyInfo)||void 0===n?void 0:n.name),e.riskGroups&&(this.riskGroups=e.riskGroups),this.counterParty$.next(0===(null===(r=e.riskGroups)||void 0===r?void 0:r.length)?this.counterPartyStatus.SUCCESS:this.counterPartyStatus.ERROR)}},{key:"listenEmailSearch",value:function(){var e=this,t=this.form.controls.emailOnSuccess;this.subs.add(this.controlsStream.notify.pipe(Object(me.a)(100)).subscribe((function(e){return e?t.enable():t.disable()}))),this.subs.add(this.controlsStream.iinOrBin.pipe(Object(me.a)(200),Object(pe.a)((function(t){return e.form.controls.iinOrBin.valid})),Object(ti.a)((function(t){return e.fetchingEmailsFor$.next(t),e.prevEmails$.next([]),e.recipientsService.getPrevNotifications(t).catch((function(e){return[]}))}))).subscribe((function(t){e.prevEmails$.next(t),e.fetchingEmailsFor$.next(null)}))),this.search=function(t){return Object(Gr.a)([e.prevEmails$.pipe(Object(fe.a)((function(e){return e.map((function(e){return e.email}))}))),t.pipe(Object(me.a)(200),Object(Zr.a)(),Object(be.a)("")),e.focusEmail$]).pipe(Object(fe.a)((function(e){var t=_slicedToArray(e,3),n=t[0],r=t[1];return t[2],r?n.filter((function(e){return e.toLowerCase().indexOf(r.toLowerCase())>-1})).slice(0,3):n.slice(0,3)})))}}},{key:"checkIin",value:function(){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.riskGroups=[],this.iinIsSubmitted$.next(!0),t=this.form.controls.iinOrBin.value,this.isCounterPartyLoading$.next(t),this.recipientsService.checkCounterParty(t).then((function(e){return Object(Kr.a)(n,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e&&this.checkCounterParty(e),t.next=3,this.successfulCounterPartyResult();case 3:case"end":return t.stop()}}),t,this)})))})).catch((function(e){console.error(e),n.iinIsSubmitted$.next(null),n.iinIsFound$.next(null),n.isCounterPartyLoading$.next(null),n.showSignError()}));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"showSignError",value:function(){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.modalService.open(Io,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"successfulCounterPartyResult",value:function(){return Object(Kr.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.iinIsSubmitted$.next(null),this.iinIsFound$.next(!0),this.isCounterPartyLoading$.next(null);case 1:case"end":return e.stop()}}),e,this)})))}}]),t}(Mo)).\u0275fac=function(e){return new(e||Ss)(d.Qb(li.a),d.Qb(Yr.c),d.Qb(Lo.a),d.Qb(Fr.a),d.Qb(Fr.c),d.Qb(wc.a),d.Qb(vi.a),d.Qb(l.c),d.Qb(a.q),d.Qb(xc.a),d.Qb(Wc.a),d.Qb(ui.a),d.Qb(ss.h))},Ss.\u0275cmp=d.Kb({type:Ss,selectors:[["j-payment-order"]],viewQuery:function(e,t){var n;1&e&&d.Lc(ls,!0),2&e&&d.Bc(n=d.jc())&&(t.emailOnSuccess=n.first)},features:[d.xb],decls:142,vars:115,consts:[[1,"payment-section"],["jInvalidControlScroll","","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"payments__header"],[1,"h2","mb-0"],["type","button",1,"btn","btn-link","p-0","p3",3,"click"],[1,"form-group"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"dropSpecialCharacters","jShadow","mask","formControl"],["jSuffix","","type","button","class","btn btn-xs btn-link",3,"click",4,"ngIf"],["jSuffix","",1,"counterParty","p3",3,"jLoading","jLoadingInverted"],[4,"ngIf"],[3,"control","errorMessages"],[1,"navbar-nav","mt-2"],["class","p3 risk-li text-muted",4,"ngFor","ngForOf"],["clearable","true"],["type","text","jFocusOnReturn","","jFormInput","",1,"form-control",3,"formControl"],["jPrefix","","hideEmpty","true",3,"name"],["type","text","jFormInput","","jReplaceOnPaste","KZ","jDynamicPrefix","KZ","jFocusOnReturn","","jUppercase","",1,"form-control",3,"jShadow","dropSpecialCharacters","mask","formControl"],["accountInput","jFormInput"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","jShadow","dropSpecialCharacters","formControl"],["href","javascript:void(0)","jSuffix","","tooltipClass","tooltip-light tooltip-large","triggers","mouseenter:mouseleave",1,"mr-1","link-gray",3,"ngbTooltip","inlineSVG"],[1,"h2"],["type","text","jFormInput","","jFocusOnReturn","",1,"form-control",3,"mask","formControl"],["allowAuto","true","label","\u0414\u0430\u0442\u0430 \u0432\u0430\u043b\u044e\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f",3,"datesEnabled","formControl","formatValue","jFocusOnReturn","minDate","maxDate","helperText"],["datePicker",""],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","compareWith","items"],["select",""],["j-header-tmp",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[1,"j-input-helper","text-muted","mt-1","p3"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],["clearable","true",3,"floatLabel"],["type","text","jFocusOnReturn","","jFormInput","","jCursorBound","","jReplaceDot","","suffix"," \u20b8","placeholder","0,00","mask","separator.2","thousandSeparator"," ","decimalMarker",",",1,"form-control",3,"dropSpecialCharacters","formControl"],["class","j-input-helper text-muted mt-1 p3",4,"ngIf"],[1,"j-input-helper","text-muted","mt-1","p3","position-relative"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group"],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"ml-3","flex-grow-1"],["class","mt-1",4,"ngIf"],[1,"payment-section--submit","form-group","pt-4"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["amountInfo",""],["kbeInfo",""],["jSuffix","","type","button",1,"btn","btn-xs","btn-link",3,"click"],["translate","",1,"text-muted","mr-2"],[1,"text-success",3,"inlineSVG"],[1,"text-danger",3,"inlineSVG"],[1,"p3","risk-li","text-muted"],["type","button",1,"form-section--action","btn","btn-xs","btn-link","float-right",3,"click"],[1,"p2","m-0"],[1,"p3","text-gray"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[3,"innerHTML"],[1,"mt-1"],["type","email","jFormInput","","jFocusOnReturn","","autocomplete","off",1,"form-control",3,"ngbTypeahead","formControl","focus"],["emailOnSuccess","ngbTypeahead"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"],[1,"p3"]],template:function(e,t){if(1&e&&(d.Wb(0,"div",0),d.Wb(1,"form",1,2),d.ic("submit",(function(e){return t.onSubmit(e)})),d.Wb(3,"div",3),d.Wb(4,"fieldset"),d.Wb(5,"div",4),d.Wb(6,"h2",5),d.Qc(7),d.mc(8,"translate"),d.Vb(),d.Wb(9,"button",6),d.ic("click",(function(e){return t.openSavedPayments()})),d.Qc(10),d.mc(11,"translate"),d.Vb(),d.Vb(),d.Wb(12,"div",7),d.Wb(13,"j-form-field"),d.Wb(14,"j-label"),d.Qc(15,"\u0411\u0418\u041d/\u0418\u0418\u041d"),d.Vb(),d.Rb(16,"input",8),d.Oc(17,us,2,0,"button",9),d.mc(18,"async"),d.mc(19,"async"),d.Wb(20,"div",10),d.mc(21,"async"),d.Oc(22,bs,4,1,"span",11),d.mc(23,"async"),d.Oc(24,ds,4,1,"span",11),d.mc(25,"async"),d.Vb(),d.Rb(26,"j-error",12),d.Vb(),d.Wb(27,"ul",13),d.Oc(28,ms,2,1,"li",14),d.Vb(),d.Vb(),d.Wb(29,"div",7),d.Wb(30,"j-form-field",15),d.Wb(31,"j-label"),d.Qc(32,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f"),d.Vb(),d.Rb(33,"input",16),d.Vb(),d.Vb(),d.Wb(34,"div",7),d.Wb(35,"j-form-field",15),d.Rb(36,"j-entity-logo",17),d.mc(37,"bankFromAccount"),d.Wb(38,"j-label"),d.Qc(39,"\u0421\u0447\u0435\u0442 \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f"),d.Vb(),d.Rb(40,"input",18,19),d.Rb(42,"j-error",12),d.Vb(),d.Vb(),d.Wb(43,"div",7),d.Wb(44,"j-form-field",15),d.Wb(45,"j-label"),d.Qc(46,"\u041a\u0411\u0435"),d.Vb(),d.Rb(47,"input",20),d.Rb(48,"a",21),d.Rb(49,"j-error",12),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(50,"div",3),d.Wb(51,"fieldset"),d.Wb(52,"legend",22),d.Qc(53,"\u0414\u0435\u0442\u0430\u043b\u0438 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Wb(54,"div",7),d.Wb(55,"j-form-field"),d.Wb(56,"j-label"),d.Qc(57,"\u041d\u043e\u043c\u0435\u0440 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430"),d.Vb(),d.Rb(58,"input",23),d.Vb(),d.Vb(),d.Wb(59,"div",7),d.Rb(60,"j-date-picker",24,25),d.mc(62,"async"),d.mc(63,"async"),d.Vb(),d.Wb(64,"div",7),d.Wb(65,"j-form-field",null,26),d.Wb(67,"j-label"),d.Qc(68,"\u041a\u041d\u041f \u2014 \u041a\u043e\u0434 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Wb(69,"j-select",27,28),d.mc(71,"async"),d.Oc(72,fs,1,1,"ng-template",29),d.Vb(),d.Vb(),d.Vb(),d.Wb(73,"div",30),d.Wb(74,"span",31),d.Qc(75),d.mc(76,"async"),d.Vb(),d.Wb(77,"j-form-field"),d.Wb(78,"j-label"),d.Qc(79,"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Rb(80,"textarea",32,33),d.Rb(82,"j-error",12),d.Oc(83,hs,3,1,"div",34),d.mc(84,"async"),d.Vb(),d.Wb(85,"div",35),d.Qc(86," \u041f\u0440\u0438 \u043e\u043f\u043b\u0430\u0442\u0435 \u0437\u0430 \u0442\u043e\u0432\u0430\u0440\u044b/\u0443\u0441\u043b\u0443\u0433\u0438 \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u043e\u0432, \u0440\u0430\u0431\u043e\u0442, \u0443\u0441\u043b\u0443\u0433, \u043d\u043e\u043c\u0435\u0440\u0430 \u0438 \u0434\u0430\u0442\u044b \u0434\u043e\u0433\u043e\u0432\u043e\u0440\u043e\u0432/\u0441\u0447\u0435\u0442\u043e\u0432 "),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(87,"div",3),d.Wb(88,"fieldset"),d.Wb(89,"div",7),d.Wb(90,"j-account-dropdown",36,37),d.ic("selected",(function(e){return t.onSenderAccountSelect(e)})),d.mc(92,"async"),d.mc(93,"async"),d.Vb(),d.Vb(),d.Wb(94,"div",7),d.Wb(95,"div",7),d.Wb(96,"j-form-field",38),d.Wb(97,"j-label"),d.Qc(98,"\u0421\u0443\u043c\u043c\u0430 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Rb(99,"input",39),d.Vb(),d.Oc(100,vs,2,1,"div",40),d.mc(101,"async"),d.Wb(102,"div",41),d.Oc(103,gs,3,3,"ng-container",42),d.mc(104,"async"),d.Oc(105,ys,4,8,"ng-template",null,43,d.Pc),d.Vb(),d.Vb(),d.Vb(),d.Wb(107,"div",7),d.Wb(108,"ul",44),d.Wb(109,"li",45),d.Rb(110,"j-switch",46),d.Wb(111,"span",47),d.Qc(112,"\u041d\u0414\u0421 (12%) "),d.Rb(113,"br"),d.Wb(114,"small",48),d.Qc(115),d.mc(116,"amountFormat"),d.mc(117,"async"),d.Vb(),d.Vb(),d.Vb(),d.Wb(118,"li",45),d.Rb(119,"j-switch",46),d.Wb(120,"span",47),d.Qc(121,"\u0421\u0440\u043e\u0447\u043d\u044b\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 "),d.Rb(122,"br"),d.Wb(123,"small",48),d.Qc(124),d.mc(125,"translate"),d.Vb(),d.Vb(),d.Vb(),d.Wb(126,"li",45),d.Rb(127,"j-switch",46),d.Wb(128,"div",49),d.Qc(129,"\u0421\u043e\u043e\u0431\u0449\u0438\u0442\u044c \u043e\u0431 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0438 "),d.Rb(130,"br"),d.Oc(131,Cs,3,0,"div",11),d.Oc(132,ks,9,4,"div",50),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(133,"div",51),d.Wb(134,"div",51),d.Oc(135,As,6,3,"ng-container",11),d.Oc(136,Ts,3,0,"ng-container",11),d.Vb(),d.Vb(),d.Rb(137,"ngx-spinner",52),d.Vb(),d.Vb(),d.Oc(138,Rs,6,0,"ng-template",null,53,d.Pc),d.Oc(140,_s,1,0,"ng-template",null,54,d.Pc)),2&e){var n=d.Cc(61),r=d.Cc(66),i=d.Cc(70),o=d.Cc(106),a=d.Cc(141);d.Ab(1),d.rc("formGroup",t.form),d.Ab(6),d.Sc(" ",d.nc(8,75,"PAYMENTS.RECIPIENT.TITLE")," "),d.Ab(3),d.Sc(" ",d.nc(11,77,"PAYMENTS.SELECT_FROM_DICTIONARY")," "),d.Ab(6),d.rc("dropSpecialCharacters",!0)("jShadow",t.masks.iinOrBin.shadow)("mask",t.masks.iinOrBin.mask)("formControl",t.form.controls.iinOrBin),d.Ab(1),d.rc("ngIf",t.form.controls.iinOrBin.valid&&t.iinIsNotOwn&&!d.nc(18,79,t.iinIsSubmitted$)&&!d.nc(19,81,t.iinIsFound$)),d.Ab(3),d.rc("jLoading",d.nc(21,83,t.isCounterPartyLoading$))("jLoadingInverted",!0),d.Ab(2),d.rc("ngIf",d.nc(23,85,t.counterParty$)===t.counterPartyStatus.SUCCESS),d.Ab(2),d.rc("ngIf",d.nc(25,87,t.counterParty$)===t.counterPartyStatus.ERROR),d.Ab(2),d.rc("control",t.form.controls.iinOrBin)("errorMessages",t.errors.iinOrBin),d.Ab(2),d.rc("ngForOf",t.riskGroups),d.Ab(5),d.rc("formControl",t.form.controls.name),d.Ab(3),d.rc("name",d.nc(37,89,"KZ"+t.form.controls.bankAccount.value)),d.Ab(4),d.rc("jShadow",t.masks.bankAccount.shadow)("dropSpecialCharacters",!0)("mask",t.masks.bankAccount.mask)("formControl",t.form.controls.bankAccount),d.Ab(2),d.rc("control",t.form.controls.bankAccount)("errorMessages",t.errors.bankAccount),d.Ab(5),d.rc("mask",t.masks.kbeCode.mask)("jShadow",t.masks.kbeCode.shadow)("dropSpecialCharacters",!0)("formControl",t.form.controls.kbeCode),d.Ab(1),d.rc("ngbTooltip",a)("inlineSVG","./assets/icons/payments/question.svg"),d.Ab(1),d.rc("control",t.form.controls.kbeCode)("errorMessages",t.errors.kbeCode),d.Ab(9),d.rc("mask",t.masks.number.mask)("formControl",t.form.controls.number),d.Ab(2),d.rc("datesEnabled",d.nc(62,91,t.workingDays$))("formControl",t.form.controls.date)("formatValue",!0)("jFocusOnReturn",n)("minDate",t.dateLimit.minDate)("maxDate",t.dateLimit.maxDate)("helperText",d.nc(63,93,t.dateMessage$)),d.Ab(9),d.rc("jFocusOnReturn",i)("appendTo",r.elementRef.nativeElement)("formControl",t.form.controls.knp)("clearable",!1)("searchMask",t.masks.knp.mask)("shadow",t.masks.knp.shadow)("compareWith",t.knpComparator)("items",d.nc(71,95,t.knp$)),d.Ab(6),d.Tc(" ",d.nc(76,97,t.purposeLength$),"/",t.rules.purposeLength,""),d.Ab(5),d.rc("formControl",t.form.controls.purpose),d.Ab(2),d.rc("control",t.form.controls.purpose)("errorMessages",t.errors.purpose),d.Ab(1),d.rc("ngIf",d.nc(84,99,t.purposeMessage$)),d.Ab(7),d.rc("isLoading",d.nc(92,101,t.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",t.form.controls.senderAccount.touched&&t.form.controls.senderAccount.errors)("accounts",d.nc(93,103,t.acceptableAccounts$)),d.Ab(6),d.rc("floatLabel","always"),d.Ab(3),d.rc("dropSpecialCharacters",!0)("formControl",t.form.controls.amount),d.Ab(1),d.rc("ngIf",d.nc(101,105,t.amountMessage$)),d.Ab(3),d.rc("ngIf",null===d.nc(104,107,t.commission$))("ngIfElse",o),d.Ab(7),d.rc("formControl",t.form.controls.vat),d.Ab(5),d.Sc("\u0412 \u0441\u0443\u043c\u043c\u0443 \u0432\u0445\u043e\u0434\u0438\u0442 \u041d\u0414\u0421 = ",d.nc(116,109,d.nc(117,111,t.vat$))," \u20b8"),d.Ab(4),d.rc("formControl",t.form.controls.urgent),d.Ab(5),d.Rc(d.nc(125,113,"PAYMENTS.URGENT_HELPER")),d.Ab(3),d.rc("formControl",t.form.controls.notify),d.Ab(4),d.rc("ngIf",!t.form.controls.notify.value),d.Ab(1),d.rc("ngIf",t.form.controls.notify.value),d.Ab(3),d.rc("ngIf",t.restoredData.status!==t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("ngIf",t.restoredData.status===t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("name",t.SPINNER)("fullScreen",!1)}},directives:[i.J,i.u,Pt.b,Ot.b,i.l,Zt.a,en.a,an.a,i.c,Ot.a,Nt.a,o.a,i.t,i.i,r.u,nn.a,Gt.a,on.a,r.t,_n.a,tn.a,Vt.a,Mt.a,Wt.a,a.E,gr.a,qt.a,kt,ke,Bo.a,It.a,Et.a,Rn.a,fr.a,c.a,rn.a,a.G,Mn.a],pipes:[c.d,r.b,jr.a,Vr.a],styles:[".payments__header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:1.5rem}.counterParty[_ngcontent-%COMP%]{position:relative;min-width:40px;height:100%}li.risk-li[_ngcontent-%COMP%] + li.risk-li[_ngcontent-%COMP%]{margin-top:.5rem}"]}),Ss);function Is(e,t){if(1&e&&(d.Wb(0,"div",35),d.Wb(1,"div",36),d.Qc(2),d.Vb(),d.Vb()),2&e){var n=t.ngIf;d.Ab(2),d.Sc(" ",n," ")}}function Vs(e,t){if(1&e&&(d.Wb(0,"div",37),d.Rb(1,"span",38),d.Vb()),2&e){var n=t.ngIf;d.Ab(1),d.rc("innerHTML",n,d.Gc)}}function Es(e,t){1&e&&(d.Ub(0),d.Qc(1),d.mc(2,"translate"),d.Tb()),2&e&&(d.Ab(1),d.Sc(" ",d.nc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function xs(e,t){if(1&e&&(d.Qc(0),d.mc(1,"translate"),d.mc(2,"amountFormat"),d.mc(3,"async")),2&e){var n=d.lc();d.Tc(" ",d.nc(1,2,"PAYMENTS.COMMISSION"),": ",d.nc(2,4,d.nc(3,6,n.commission$))," \u20b8 ")}}function ws(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"button",39),d.ic("click",(function(e){return d.Fc(n),d.lc().saveToDraft()})),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),d.Vb(),d.Wb(3,"button",40),d.Qc(4),d.mc(5,"translate"),d.Vb(),d.Tb()}if(2&e){var r=d.lc();d.Ab(4),d.Sc("",d.nc(5,1,r.submitLabel)," ")}}function Ws(e,t){1&e&&(d.Ub(0),d.Wb(1,"button",41),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"),d.Vb(),d.Tb())}function Ns(e,t){1&e&&(d.Wb(0,"p",42),d.Qc(1," \u0422\u0443\u0442 \u0431\u0443\u0434\u0435\u0442 \u0442\u0435\u043a\u0441\u0442 \u043f\u043e \u043a\u043e\u043c\u0438\u0441\u0441\u0438\u0438 "),d.Rb(2,"br"),d.Qc(3," \u041f\u043e \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e \u043a\u0430\u043a\u043e\u0439 "),d.Rb(4,"br"),d.Qc(5," \u0416\u0434\u0443 \u0438\u043d\u0444\u0443 "),d.Vb())}var Ps,Ms=((Ps=function(e){function t(e,n,r,i,o,a,c,s,l,u,b,d){var m;return _classCallCheck(this,t),(m=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,d.createPensionForm(),u,e,n,i,r,a,s,l,b))).route=e,m.router=n,m.paymentsService=r,m.companyService=i,m.dateAdapter=o,m.maskService=a,m.accountsService=c,m.modalService=s,m.dictionaries=l,m.api=u,m.pipeline=b,m.paymentsFormsFactory=d,m.masks={number:"paymentNum",amount:"amount",knp:"knp"},m.employees$=new Hr.a([]),m.amount$=new Hr.a(0),m.subs=new Qi.a,m.paymentType=ii.i.PENSION,m}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"ngOnInit",this).call(this),this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(de.a)((function(t){return e.checkPersonalAccounts(t)}))),this.getMaskConfig(),this.createControlsStream(this.form),this.knp$=this.combineKNP(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream()}}]),t}(Mo)).\u0275fac=function(e){return new(e||Ps)(d.Qb(Fr.a),d.Qb(Fr.c),d.Qb(Vo.g),d.Qb(li.a),d.Qb(a.c),d.Qb(Lo.a),d.Qb(l.c),d.Qb(a.q),d.Qb(ss.a),d.Qb(Vo.c),d.Qb(Vo.f),d.Qb(Vo.e))},Ps.\u0275cmp=d.Kb({type:Ps,selectors:[["j-pension-payment"]],features:[d.xb],decls:75,vars:57,consts:[["jInvalidControlScroll","","autocomplete","off","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"h2"],[1,"form-group"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","periodRequired","birthDateRequired","additionalPeriodEnabled"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],[4,"ngIf"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["amountInfo",""],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"],[1,"p3"]],template:function(e,t){if(1&e&&(d.Wb(0,"form",0,1),d.ic("submit",(function(e){return t.onSubmit(e)})),d.Wb(2,"div",2),d.Wb(3,"fieldset"),d.Wb(4,"legend",3),d.Qc(5,"\u0414\u0435\u0442\u0430\u043b\u0438 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Wb(6,"div",4),d.Wb(7,"j-form-field"),d.Wb(8,"j-label"),d.Qc(9,"\u041d\u043e\u043c\u0435\u0440 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430"),d.Vb(),d.Rb(10,"input",5),d.Vb(),d.Vb(),d.Wb(11,"div",4),d.Wb(12,"j-form-field",null,6),d.Wb(14,"j-label"),d.Qc(15,"\u041a\u041d\u041f/\u0422\u0438\u043f \u043e\u0442\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),d.Vb(),d.Rb(16,"j-select",7,8),d.mc(18,"async"),d.Vb(),d.Vb(),d.Wb(19,"div",9),d.Wb(20,"span",10),d.Qc(21),d.mc(22,"async"),d.Vb(),d.Wb(23,"j-form-field"),d.Wb(24,"j-label"),d.Qc(25,"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Rb(26,"textarea",11,12),d.Rb(28,"j-error",13),d.Oc(29,Is,3,1,"div",14),d.mc(30,"async"),d.Vb(),d.Vb(),d.Wb(31,"div",4),d.Wb(32,"j-account-dropdown",15,16),d.ic("selected",(function(e){return t.onSenderAccountSelect(e)})),d.mc(34,"async"),d.mc(35,"async"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(36,"div",2),d.Wb(37,"fieldset"),d.Wb(38,"j-employee-group-control",17),d.Rb(39,"j-error",13),d.Vb(),d.Vb(),d.Vb(),d.Wb(40,"div",18),d.Wb(41,"div",4),d.Wb(42,"fieldset"),d.Wb(43,"ul",19),d.Wb(44,"li",20),d.Wb(45,"h5",21),d.Qc(46,"\u041e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430: "),d.Wb(47,"span",22),d.Wb(48,"strong"),d.Qc(49),d.mc(50,"amountFormat"),d.mc(51,"async"),d.Vb(),d.Qc(52," \u20b8"),d.Vb(),d.Vb(),d.Oc(53,Vs,2,1,"div",23),d.mc(54,"async"),d.Wb(55,"p",24),d.Oc(56,Es,3,3,"ng-container",25),d.mc(57,"async"),d.Oc(58,xs,4,8,"ng-template",null,26,d.Pc),d.Vb(),d.Vb(),d.Wb(60,"li",27),d.Rb(61,"j-switch",28),d.Wb(62,"span",29),d.Qc(63,"\u0421\u0440\u043e\u0447\u043d\u044b\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 "),d.Rb(64,"br"),d.Wb(65,"small",30),d.Qc(66),d.mc(67,"translate"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(68,"div",31),d.Wb(69,"div",31),d.Oc(70,ws,6,3,"ng-container",32),d.Oc(71,Ws,3,0,"ng-container",32),d.Vb(),d.Vb(),d.Rb(72,"ngx-spinner",33),d.Vb(),d.Oc(73,Ns,6,0,"ng-template",null,34,d.Pc)),2&e){var n=d.Cc(13),r=d.Cc(17),i=d.Cc(59);d.rc("formGroup",t.form),d.Ab(10),d.rc("mask",t.masks.number.mask)("formControl",t.form.controls.number),d.Ab(6),d.rc("jFocusOnReturn",r)("appendTo",n.elementRef.nativeElement)("formControl",t.form.controls.knp)("clearable",!1)("searchMask",t.masks.knp.mask)("shadow",t.masks.knp.shadow)("items",d.nc(18,37,t.knp$)),d.Ab(5),d.Tc(" ",d.nc(22,39,t.purposeLength$),"/",t.rules.purposeLength,""),d.Ab(5),d.rc("formControl",t.form.controls.purpose),d.Ab(2),d.rc("control",t.form.controls.purpose)("errorMessages",t.errors.purpose),d.Ab(1),d.rc("ngIf",d.nc(30,41,t.purposeMessage$)),d.Ab(3),d.rc("isLoading",d.nc(34,43,t.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",t.form.controls.senderAccount.touched&&t.form.controls.senderAccount.errors)("accounts",d.nc(35,45,t.acceptableAccounts$)),d.Ab(6),d.rc("formControl",t.form.controls.employees)("paymentType",t.paymentType)("periodRequired",!0)("birthDateRequired",!0)("additionalPeriodEnabled",!0),d.Ab(1),d.rc("control",t.form.controls.employees)("errorMessages",t.errors.employees),d.Ab(10),d.Rc(d.nc(50,47,d.nc(51,49,t.total$))),d.Ab(4),d.rc("ngIf",d.nc(54,51,t.amountMessage$)),d.Ab(3),d.rc("ngIf",null===d.nc(57,53,t.commission$))("ngIfElse",i),d.Ab(5),d.rc("formControl",t.form.controls.urgent),d.Ab(5),d.Rc(d.nc(67,55,"PAYMENTS.URGENT_HELPER")),d.Ab(4),d.rc("ngIf",t.restoredData.status!==t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("ngIf",t.restoredData.status===t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("name",t.SPINNER)("fullScreen",!1)}},directives:[i.J,i.u,Pt.b,Ot.b,i.l,Zt.a,en.a,an.a,i.c,Ot.a,o.a,i.t,i.i,kt,on.a,r.u,Bo.a,dn.a,Rn.a,fr.a,rn.a],pipes:[r.b,Vr.a,c.d],styles:[""],encapsulation:2}),Ps);function Ls(e,t){if(1&e&&(d.Wb(0,"div",35),d.Wb(1,"div",36),d.Qc(2),d.Vb(),d.Vb()),2&e){var n=t.ngIf;d.Ab(2),d.Sc(" ",n," ")}}function Ds(e,t){if(1&e&&(d.Wb(0,"div",37),d.Rb(1,"span",38),d.Vb()),2&e){var n=t.ngIf;d.Ab(1),d.rc("innerHTML",n,d.Gc)}}function Qs(e,t){1&e&&(d.Ub(0),d.Qc(1),d.mc(2,"translate"),d.Tb()),2&e&&(d.Ab(1),d.Sc(" ",d.nc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function Fs(e,t){if(1&e&&(d.Qc(0),d.mc(1,"translate"),d.mc(2,"amountFormat"),d.mc(3,"async")),2&e){var n=d.lc();d.Tc(" ",d.nc(1,2,"PAYMENTS.COMMISSION"),": ",d.nc(2,4,d.nc(3,6,n.commission$))," \u20b8 ")}}function Bs(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"button",39),d.ic("click",(function(e){return d.Fc(n),d.lc().saveToDraft()})),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),d.Vb(),d.Wb(3,"button",40),d.Qc(4),d.mc(5,"translate"),d.Vb(),d.Tb()}if(2&e){var r=d.lc();d.Ab(4),d.Sc("",d.nc(5,1,r.submitLabel)," ")}}function $s(e,t){1&e&&(d.Ub(0),d.Wb(1,"button",41),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"),d.Vb(),d.Tb())}function Us(e,t){1&e&&(d.Wb(0,"p",42),d.Qc(1," \u0422\u0443\u0442 \u0431\u0443\u0434\u0435\u0442 \u0442\u0435\u043a\u0441\u0442 \u043f\u043e \u043a\u043e\u043c\u0438\u0441\u0441\u0438\u0438 "),d.Rb(2,"br"),d.Qc(3," \u041f\u043e \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e \u043a\u0430\u043a\u043e\u0439 "),d.Rb(4,"br"),d.Qc(5," \u0416\u0434\u0443 \u0438\u043d\u0444\u0443 "),d.Vb())}var Ys,Ks=((Ys=function(e){function t(e,n,r,i,o,a,c,s,l,u,b,d){var m;return _classCallCheck(this,t),(m=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,d.createSocialForm(),l,i,o,n,e,a,s,u,b))).paymentsService=e,m.companyService=n,m.dateAdapter=r,m.route=i,m.router=o,m.maskService=a,m.accountsService=c,m.modalService=s,m.api=l,m.dictionaries=u,m.pipeline=b,m.paymentsFormsFactory=d,m.masks={number:"paymentNum",amount:"amount",knp:"knp"},m.paymentType=ii.i.SOCIAL,m}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"ngOnInit",this).call(this),this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(de.a)((function(t){return e.checkPersonalAccounts(t)}))),this.getMaskConfig(),this.createControlsStream(this.form),this.listenWorkingDays(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.knp$=this.combineKNP()}}]),t}(Mo)).\u0275fac=function(e){return new(e||Ys)(d.Qb(Yr.c),d.Qb(li.a),d.Qb(a.c),d.Qb(Fr.a),d.Qb(Fr.c),d.Qb(Lo.a),d.Qb(l.c),d.Qb(a.q),d.Qb(wc.a),d.Qb(vi.a),d.Qb(xc.a),d.Qb(Wc.a))},Ys.\u0275cmp=d.Kb({type:Ys,selectors:[["j-social-payment"]],features:[d.xb],decls:75,vars:57,consts:[["jInvalidControlScroll","","jFocusableContainer","","autocomplete","off",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"h2"],[1,"form-group"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","periodRequired","birthDateRequired","additionalPeriodEnabled"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],[4,"ngIf"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["amountInfo",""],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"],[1,"p3"]],template:function(e,t){if(1&e&&(d.Wb(0,"form",0,1),d.ic("submit",(function(e){return t.onSubmit(e)})),d.Wb(2,"div",2),d.Wb(3,"fieldset"),d.Wb(4,"legend",3),d.Qc(5,"\u0414\u0435\u0442\u0430\u043b\u0438 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Wb(6,"div",4),d.Wb(7,"j-form-field"),d.Wb(8,"j-label"),d.Qc(9,"\u041d\u043e\u043c\u0435\u0440 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430"),d.Vb(),d.Rb(10,"input",5),d.Vb(),d.Vb(),d.Wb(11,"div",4),d.Wb(12,"j-form-field",null,6),d.Wb(14,"j-label"),d.Qc(15,"\u041a\u041d\u041f/\u0422\u0438\u043f \u043e\u0442\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),d.Vb(),d.Rb(16,"j-select",7,8),d.mc(18,"async"),d.Vb(),d.Vb(),d.Wb(19,"div",9),d.Wb(20,"span",10),d.Qc(21),d.mc(22,"async"),d.Vb(),d.Wb(23,"j-form-field"),d.Wb(24,"j-label"),d.Qc(25,"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Rb(26,"textarea",11,12),d.Rb(28,"j-error",13),d.Oc(29,Ls,3,1,"div",14),d.mc(30,"async"),d.Vb(),d.Vb(),d.Wb(31,"div",4),d.Wb(32,"j-account-dropdown",15,16),d.ic("selected",(function(e){return t.onSenderAccountSelect(e)})),d.mc(34,"async"),d.mc(35,"async"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(36,"div",2),d.Wb(37,"fieldset"),d.Wb(38,"j-employee-group-control",17),d.Rb(39,"j-error",13),d.Vb(),d.Vb(),d.Vb(),d.Wb(40,"div",18),d.Wb(41,"div",4),d.Wb(42,"fieldset"),d.Wb(43,"ul",19),d.Wb(44,"li",20),d.Wb(45,"h5",21),d.Qc(46,"\u041e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430: "),d.Wb(47,"span",22),d.Wb(48,"strong"),d.Qc(49),d.mc(50,"amountFormat"),d.mc(51,"async"),d.Vb(),d.Qc(52," \u20b8"),d.Vb(),d.Vb(),d.Oc(53,Ds,2,1,"div",23),d.mc(54,"async"),d.Wb(55,"p",24),d.Oc(56,Qs,3,3,"ng-container",25),d.mc(57,"async"),d.Oc(58,Fs,4,8,"ng-template",null,26,d.Pc),d.Vb(),d.Vb(),d.Wb(60,"li",27),d.Rb(61,"j-switch",28),d.Wb(62,"span",29),d.Qc(63,"\u0421\u0440\u043e\u0447\u043d\u044b\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 "),d.Rb(64,"br"),d.Wb(65,"small",30),d.Qc(66),d.mc(67,"translate"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(68,"div",31),d.Wb(69,"div",31),d.Oc(70,Bs,6,3,"ng-container",32),d.Oc(71,$s,3,0,"ng-container",32),d.Vb(),d.Vb(),d.Rb(72,"ngx-spinner",33),d.Vb(),d.Oc(73,Us,6,0,"ng-template",null,34,d.Pc)),2&e){var n=d.Cc(13),r=d.Cc(17),i=d.Cc(59);d.rc("formGroup",t.form),d.Ab(10),d.rc("mask",t.masks.number.mask)("formControl",t.form.controls.number),d.Ab(6),d.rc("jFocusOnReturn",r)("appendTo",n.elementRef.nativeElement)("formControl",t.form.controls.knp)("clearable",!1)("searchMask",t.masks.knp.mask)("shadow",t.masks.knp.shadow)("items",d.nc(18,37,t.knp$)),d.Ab(5),d.Tc(" ",d.nc(22,39,t.purposeLength$),"/",t.rules.purposeLength,""),d.Ab(5),d.rc("formControl",t.form.controls.purpose),d.Ab(2),d.rc("control",t.form.controls.purpose)("errorMessages",t.errors.purpose),d.Ab(1),d.rc("ngIf",d.nc(30,41,t.purposeMessage$)),d.Ab(3),d.rc("isLoading",d.nc(34,43,t.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",t.form.controls.senderAccount.touched&&t.form.controls.senderAccount.errors)("accounts",d.nc(35,45,t.acceptableAccounts$)),d.Ab(6),d.rc("formControl",t.form.controls.employees)("paymentType",t.paymentType)("periodRequired",!0)("birthDateRequired",!0)("additionalPeriodEnabled",!0),d.Ab(1),d.rc("control",t.form.controls.employees)("errorMessages",t.errors.employees),d.Ab(10),d.Rc(d.nc(50,47,d.nc(51,49,t.total$))),d.Ab(4),d.rc("ngIf",d.nc(54,51,t.amountMessage$)),d.Ab(3),d.rc("ngIf",null===d.nc(57,53,t.commission$))("ngIfElse",i),d.Ab(5),d.rc("formControl",t.form.controls.urgent),d.Ab(5),d.Rc(d.nc(67,55,"PAYMENTS.URGENT_HELPER")),d.Ab(4),d.rc("ngIf",t.restoredData.status!==t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("ngIf",t.restoredData.status===t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("name",t.SPINNER)("fullScreen",!1)}},directives:[i.J,i.u,Pt.b,Ot.b,i.l,Zt.a,en.a,an.a,i.c,Ot.a,o.a,i.t,i.i,kt,on.a,r.u,Bo.a,dn.a,Rn.a,fr.a,rn.a],pipes:[r.b,Vr.a,c.d],styles:[""]}),Ys);function Hs(e,t){if(1&e&&(d.Wb(0,"div",35),d.Wb(1,"div",36),d.Qc(2),d.Vb(),d.Vb()),2&e){var n=t.ngIf;d.Ab(2),d.Sc(" ",n," ")}}function Gs(e,t){if(1&e&&(d.Wb(0,"div",37),d.Rb(1,"span",38),d.Vb()),2&e){var n=t.ngIf;d.Ab(1),d.rc("innerHTML",n,d.Gc)}}function zs(e,t){1&e&&(d.Ub(0),d.Qc(1),d.mc(2,"translate"),d.Tb()),2&e&&(d.Ab(1),d.Sc(" ",d.nc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function qs(e,t){if(1&e&&(d.Qc(0),d.mc(1,"translate"),d.mc(2,"amountFormat"),d.mc(3,"async")),2&e){var n=d.lc();d.Tc(" ",d.nc(1,2,"PAYMENTS.COMMISSION"),": ",d.nc(2,4,d.nc(3,6,n.commission$))," \u20b8 ")}}function Xs(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"button",39),d.ic("click",(function(e){return d.Fc(n),d.lc().saveToDraft()})),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),d.Vb(),d.Wb(3,"button",40),d.Qc(4),d.mc(5,"translate"),d.Vb(),d.Tb()}if(2&e){var r=d.lc();d.Ab(4),d.Sc("",d.nc(5,1,r.submitLabel)," ")}}function Zs(e,t){1&e&&(d.Ub(0),d.Wb(1,"button",41),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"),d.Vb(),d.Tb())}function Js(e,t){1&e&&(d.Wb(0,"p",42),d.Qc(1," \u0422\u0443\u0442 \u0431\u0443\u0434\u0435\u0442 \u0442\u0435\u043a\u0441\u0442 \u043f\u043e \u043a\u043e\u043c\u0438\u0441\u0441\u0438\u0438 "),d.Rb(2,"br"),d.Qc(3," \u041f\u043e \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e \u043a\u0430\u043a\u043e\u0439 "),d.Rb(4,"br"),d.Qc(5," \u0416\u0434\u0443 \u0438\u043d\u0444\u0443 "),d.Vb())}var el,tl=((el=function(e){function t(e,n,r,i,o,a,c,s,l,u,b,d){var m;return _classCallCheck(this,t),(m=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,d.createMedicalForm(),u,e,n,i,r,a,s,l,b))).route=e,m.router=n,m.paymentsService=r,m.companyService=i,m.dateAdapter=o,m.maskService=a,m.accountsService=c,m.modalService=s,m.dictionaries=l,m.api=u,m.pipeline=b,m.paymentsFormsFactory=d,m.masks={number:"paymentNum",amount:"amount",knp:"knp"},m.paymentType=ii.i.MEDICAL,m}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"ngOnInit",this).call(this),this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(de.a)((function(t){return e.checkPersonalAccounts(t)}))),this.getMaskConfig(),this.createControlsStream(this.form),this.knp$=this.combineKNP(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream()}}]),t}(Mo)).\u0275fac=function(e){return new(e||el)(d.Qb(Fr.a),d.Qb(Fr.c),d.Qb(Yr.c),d.Qb(li.a),d.Qb(a.c),d.Qb(Lo.a),d.Qb(l.c),d.Qb(a.q),d.Qb(vi.a),d.Qb(wc.a),d.Qb(xc.a),d.Qb(Wc.a))},el.\u0275cmp=d.Kb({type:el,selectors:[["j-medical-payment"]],features:[d.xb],decls:74,vars:57,consts:[["jInvalidControlScroll","","jFocusableContainer","","autocomplete","off",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"h2"],[1,"form-group"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["knpWrapper",""],["bindValue","code","bindLabel","label",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","periodRequired","birthDateRequired","additionalPeriodEnabled"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],[4,"ngIf"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["amountInfo",""],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"],[1,"p3"]],template:function(e,t){if(1&e&&(d.Wb(0,"form",0,1),d.ic("submit",(function(e){return t.onSubmit(e)})),d.Wb(2,"div",2),d.Wb(3,"fieldset"),d.Wb(4,"legend",3),d.Qc(5,"\u0414\u0435\u0442\u0430\u043b\u0438 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Wb(6,"div",4),d.Wb(7,"j-form-field"),d.Wb(8,"j-label"),d.Qc(9,"\u041d\u043e\u043c\u0435\u0440 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430"),d.Vb(),d.Rb(10,"input",5),d.Vb(),d.Vb(),d.Wb(11,"div",4),d.Wb(12,"j-form-field",null,6),d.Wb(14,"j-label"),d.Qc(15,"\u041a\u041d\u041f/\u0422\u0438\u043f \u043e\u0442\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),d.Vb(),d.Rb(16,"j-select",7,8),d.mc(18,"async"),d.Vb(),d.Vb(),d.Wb(19,"div",9),d.Wb(20,"span",10),d.Qc(21),d.mc(22,"async"),d.Vb(),d.Wb(23,"j-form-field"),d.Wb(24,"j-label"),d.Qc(25,"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Rb(26,"textarea",11,12),d.Rb(28,"j-error",13),d.Oc(29,Hs,3,1,"div",14),d.mc(30,"async"),d.Vb(),d.Vb(),d.Wb(31,"div",4),d.Wb(32,"j-account-dropdown",15,16),d.ic("selected",(function(e){return t.onSenderAccountSelect(e)})),d.mc(34,"async"),d.mc(35,"async"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(36,"div",2),d.Wb(37,"fieldset"),d.Wb(38,"j-employee-group-control",17),d.Rb(39,"j-error",13),d.Vb(),d.Vb(),d.Vb(),d.Wb(40,"div",18),d.Wb(41,"div",4),d.Wb(42,"fieldset"),d.Wb(43,"ul",19),d.Wb(44,"li",20),d.Wb(45,"h5",21),d.Qc(46,"\u041e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430: "),d.Wb(47,"span",22),d.Wb(48,"strong"),d.Qc(49),d.mc(50,"amountFormat"),d.mc(51,"async"),d.Vb(),d.Qc(52," \u20b8"),d.Vb(),d.Vb(),d.Oc(53,Gs,2,1,"div",23),d.mc(54,"async"),d.Wb(55,"p",24),d.Oc(56,zs,3,3,"ng-container",25),d.mc(57,"async"),d.Oc(58,qs,4,8,"ng-template",null,26,d.Pc),d.Vb(),d.Vb(),d.Wb(60,"li",27),d.Rb(61,"j-switch",28),d.Wb(62,"span",29),d.Qc(63,"\u0421\u0440\u043e\u0447\u043d\u044b\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 "),d.Rb(64,"br"),d.Wb(65,"small",30),d.Qc(66),d.mc(67,"translate"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(68,"div",31),d.Oc(69,Xs,6,3,"ng-container",32),d.Oc(70,Zs,3,0,"ng-container",32),d.Vb(),d.Rb(71,"ngx-spinner",33),d.Vb(),d.Oc(72,Js,6,0,"ng-template",null,34,d.Pc)),2&e){var n=d.Cc(13),r=d.Cc(17),i=d.Cc(59);d.rc("formGroup",t.form),d.Ab(10),d.rc("mask",t.masks.number.mask)("formControl",t.form.controls.number),d.Ab(6),d.rc("jFocusOnReturn",r)("appendTo",n.elementRef.nativeElement)("formControl",t.form.controls.knp)("clearable",!1)("searchMask",t.masks.knp.mask)("shadow",t.masks.knp.shadow)("items",d.nc(18,37,t.knp$)),d.Ab(5),d.Tc(" ",d.nc(22,39,t.purposeLength$),"/",t.rules.purposeLength,""),d.Ab(5),d.rc("formControl",t.form.controls.purpose),d.Ab(2),d.rc("control",t.form.controls.purpose)("errorMessages",t.errors.purpose),d.Ab(1),d.rc("ngIf",d.nc(30,41,t.purposeMessage$)),d.Ab(3),d.rc("isLoading",d.nc(34,43,t.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",t.form.controls.senderAccount.touched&&t.form.controls.senderAccount.errors)("accounts",d.nc(35,45,t.acceptableAccounts$)),d.Ab(6),d.rc("formControl",t.form.controls.employees)("paymentType",t.paymentType)("periodRequired",!0)("birthDateRequired",!0)("additionalPeriodEnabled",!0),d.Ab(1),d.rc("control",t.form.controls.employees)("errorMessages",t.errors.employees),d.Ab(10),d.Rc(d.nc(50,47,d.nc(51,49,t.total$))),d.Ab(4),d.rc("ngIf",d.nc(54,51,t.amountMessage$)),d.Ab(3),d.rc("ngIf",null===d.nc(57,53,t.commission$))("ngIfElse",i),d.Ab(5),d.rc("formControl",t.form.controls.urgent),d.Ab(5),d.Rc(d.nc(67,55,"PAYMENTS.URGENT_HELPER")),d.Ab(3),d.rc("ngIf",t.restoredData.status!==t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("ngIf",t.restoredData.status===t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("name",t.SPINNER)("fullScreen",!1)}},directives:[i.J,i.u,Pt.b,Ot.b,i.l,Zt.a,en.a,an.a,i.c,Ot.a,o.a,i.t,i.i,kt,on.a,r.u,Bo.a,dn.a,Rn.a,fr.a,rn.a],pipes:[r.b,Vr.a,c.d],styles:[""]}),el);function nl(e,t){1&e&&(d.Wb(0,"j-label"),d.Qc(1,"\u0411\u0430\u043d\u043a \u043f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044f"),d.Vb())}function rl(e,t){if(1&e&&(d.Wb(0,"div",55),d.Wb(1,"div",56),d.Rb(2,"j-entity-logo",57),d.Vb(),d.Wb(3,"div",58),d.Wb(4,"p",59),d.Qc(5),d.Vb(),d.Wb(6,"p",60),d.Qc(7),d.Vb(),d.Vb(),d.Vb()),2&e){var n=t.item;d.Ab(2),d.rc("name",n.bic),d.Ab(3),d.Sc(" ",n.salaryTransitIban?"\u0421\u0447\u0435\u0442: "+n.salaryTransitIban:n.name," "),d.Ab(2),d.Tc("",n.bic,": ",n.name,"")}}function il(e,t){if(1&e&&(d.Wb(0,"div",61),d.Wb(1,"div",56),d.Rb(2,"j-entity-logo",57),d.Vb(),d.Wb(3,"div",58),d.Wb(4,"p",59),d.Qc(5),d.Vb(),d.Wb(6,"p",60),d.Qc(7),d.Vb(),d.Vb(),d.Vb()),2&e){var n=t.item;d.Ab(2),d.rc("name",n.bic),d.Ab(3),d.Sc(" ",n.salaryTransitIban?"\u0421\u0447\u0435\u0442: "+n.salaryTransitIban:n.name," "),d.Ab(2),d.Tc("",n.bic,": ",n.name," ")}}function ol(e,t){if(1&e&&(d.Wb(0,"div",7),d.Wb(1,"j-form-field",62),d.Wb(2,"j-label"),d.Qc(3,"\u0421\u0447\u0435\u0442 \u0411\u0430\u043d\u043a\u0430"),d.Vb(),d.Rb(4,"input",63,64),d.Rb(6,"j-error",26),d.Vb(),d.Vb()),2&e){var n=d.lc();d.Ab(4),d.rc("jShadow",n.masks.bankAccount.shadow)("dropSpecialCharacters",!0)("mask",n.masks.bankAccount.mask)("formControl",n.form.controls.bankAccount),d.Ab(2),d.rc("control",n.form.controls.bankAccount)("errorMessages",n.errors.bankAccount)}}function al(e,t){if(1&e&&(d.Wb(0,"div",65),d.Qc(1),d.Vb()),2&e){var n=t.item;d.Ab(1),d.Rc(n.label)}}function cl(e,t){if(1&e&&(d.Wb(0,"div",66),d.Wb(1,"div",67),d.Qc(2),d.Vb(),d.Vb()),2&e){var n=t.ngIf;d.Ab(2),d.Sc(" ",n," ")}}function sl(e,t){if(1&e&&(d.Wb(0,"div",68),d.Rb(1,"span",69),d.Vb()),2&e){var n=t.ngIf;d.Ab(1),d.rc("innerHTML",n,d.Gc)}}function ll(e,t){1&e&&(d.Ub(0),d.Qc(1),d.mc(2,"translate"),d.Tb()),2&e&&(d.Ab(1),d.Sc(" ",d.nc(2,1,"PAYMENTS.COMMISSION_CALC_AUTO")," "))}function ul(e,t){if(1&e&&(d.Qc(0),d.mc(1,"translate"),d.mc(2,"amountFormat"),d.mc(3,"async")),2&e){var n=d.lc();d.Tc(" ",d.nc(1,2,"PAYMENTS.COMMISSION"),": ",d.nc(2,4,d.nc(3,6,n.commission$))," \u20b8 ")}}function bl(e,t){1&e&&(d.Wb(0,"p",70),d.Qc(1,"\u041f\u043e\u0434\u043f\u0438\u0441\u044b\u0432\u0430\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442, \u0432\u044b \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0430\u0435\u0442\u0435, \u0447\u0442\u043e \u0432\u0441\u0435 "),d.Rb(2,"br"),d.Qc(3," \u0441\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438 \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0440\u0435\u0437\u0438\u0434\u0435\u043d\u0442\u0430\u043c\u0438 \u0420\u041a"),d.Vb())}function dl(e,t){if(1&e){var n=d.Xb();d.Ub(0),d.Wb(1,"button",71),d.ic("click",(function(e){return d.Fc(n),d.lc().saveToDraft()})),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),d.Vb(),d.Wb(3,"button",72),d.Qc(4),d.mc(5,"translate"),d.Vb(),d.Tb()}if(2&e){var r=d.lc();d.Ab(4),d.Sc("",d.nc(5,1,r.submitLabel)," ")}}function ml(e,t){1&e&&(d.Ub(0),d.Wb(1,"button",73),d.Qc(2,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"),d.Vb(),d.Tb())}function pl(e,t){1&e&&(d.Wb(0,"p",74),d.Qc(1," \u0422\u0443\u0442 \u0431\u0443\u0434\u0435\u0442 \u0442\u0435\u043a\u0441\u0442 \u043f\u043e \u043a\u043e\u043c\u0438\u0441\u0441\u0438\u0438 "),d.Rb(2,"br"),d.Qc(3," \u041f\u043e \u043d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e \u043a\u0430\u043a\u043e\u0439 "),d.Rb(4,"br"),d.Qc(5," \u0416\u0434\u0443 \u0438\u043d\u0444\u0443 "),d.Vb())}var fl,hl,vl=((fl=function(e){function t(e,n,r,i,o,a,c,s,l,u,b,d){var m;return _classCallCheck(this,t),(m=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,d.createSalaryForm(),l,i,o,n,e,a,s,u,b))).paymentsService=e,m.companyService=n,m.dateAdapter=r,m.route=i,m.router=o,m.maskService=a,m.accountsService=c,m.modalService=s,m.api=l,m.dictionaries=u,m.pipeline=b,m.paymentsFormsFactory=d,m.masks={number:"paymentNum",amount:"amount",knp:"knp",bankAccount:"tengeAccount"},m.employeeMaxAmount=null,m.paymentType=ii.i.SALARY,m}return _inherits(t,e),_createClass(t,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"ngOnInit",this).call(this),this.banks=this.dictionaries.bankDictionary,this.dateLimit=this.paymentsService.stdDateRangeNgb,this.accountStore=this.accountsService.store,this.acceptableAccounts$=this.paymentsService.combineAcceptableAccounts(this.accountStore).pipe(Object(de.a)((function(t){return e.checkPersonalAccounts(t)}))),this.getMaskConfig(),this.createControlsStream(this.form),this.listenWorkingDays(),this.combineEmployeesAmount(),this.listenCommission(),this.listenTotal(),this.provideAmountMessage(),this.listenDateMessageStream(),this.listenPurposeMessageStream(),this.knp$=this.combineKNP(),this.subs.add(this.controlsStream.bankReceiver.pipe(Object(Jr.a)(this.banks.entities$),Object(fe.a)((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return n&&r[n]})),Object(Zr.a)()).subscribe((function(t){var n=e.form.controls.bankAccount;!t||t.salaryTransitIban&&n.enabled?(n.disable(),n.patchValue("")):t&&!t.salaryTransitIban&&n.disabled?n.enable():t&&n.updateValueAndValidity()})))}},{key:"openBanksDictionary",value:function(){var e=this;this.modals.open(Vi,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result.then((function(t){return t&&e.form.controls.bankReceiver.patchValue(t.id)})).catch((function(){}))}}]),t}(Mo)).\u0275fac=function(e){return new(e||fl)(d.Qb(Yr.c),d.Qb(li.a),d.Qb(a.c),d.Qb(Fr.a),d.Qb(Fr.c),d.Qb(Lo.a),d.Qb(l.c),d.Qb(a.q),d.Qb(wc.a),d.Qb(vi.a),d.Qb(xc.a),d.Qb(Wc.a))},fl.\u0275cmp=d.Kb({type:fl,selectors:[["j-salary-payment"]],features:[d.xb],decls:114,vars:89,consts:[[1,"payment-section"],["jInvalidControlScroll","","autocomplete","off","jFocusableContainer","",3,"formGroup","submit"],["formDirective","ngForm"],[1,"form-section"],[1,"payments__header"],[1,"h2","mb-0"],["type","button",1,"btn","btn-link","p-0","p3",3,"click"],[1,"form-group"],["receiverWrapper",""],[4,"ngIf"],["bindValue","id",3,"searchFn","jFocusOnReturn","appendTo","formControl","clearable","items"],["receiverSelect",""],["j-label-tmp",""],["j-option-tmp",""],["class","form-group",4,"ngIf"],[1,"h2"],["jFocusOnReturn","","type","text","jFormInput","",1,"form-control",3,"mask","formControl"],["allowAuto","true","label","\u0414\u0430\u0442\u0430 \u0432\u0430\u043b\u044e\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f",3,"jFocusOnReturn","datesEnabled","formControl","formatValue","minDate","maxDate","helperText"],["datepicker",""],["knpWrapper",""],["bindValue","code",3,"jFocusOnReturn","appendTo","formControl","clearable","searchMask","shadow","items"],["select",""],[1,"form-group","position-relative"],[1,"payment-section--purpose-length","p3","text-gray"],["jFocusOnReturn","","jFormInput","","rows","5",1,"form-control",3,"formControl"],["purpose",""],[3,"control","errorMessages"],["jBottomLine","","class","j-form-field-bottom",4,"ngIf"],[3,"isLoading","label","hasError","accounts","selected"],["senderAccountDropdown",""],[3,"formControl","paymentType","maxAmount","birthDateRequired","ibanRequired"],["ngProjectAs","[header]",5,["","header",""],1,"row"],[1,"form-group","col"],[1,"custom-control","custom-radio"],["type","radio","id","residents","name","isResidents","formControlName","isResidents",1,"custom-control-input",3,"value"],["for","residents",1,"custom-control-label","text-muted","p3"],["type","radio","id","nonResident","name","isResidents","formControlName","isResidents",1,"custom-control-input",3,"value"],["for","nonResident",1,"custom-control-label","text-muted","p3"],[1,"payment-section--summary","form-section"],[1,"list-group"],[1,"list-group-item"],[1,"light","m-0"],[1,"h3"],["class","payment-section--amount-warn mt-1 p2",4,"ngIf"],[1,"p3","text","text-gray","d-inline-block","m-0"],[4,"ngIf","ngIfElse"],["commission",""],[1,"list-group-item","d-flex","align-items-center"],[3,"formControl"],[1,"ml-3"],[1,"text-gray"],[1,"payment-section--submit","form-group","pt-4"],["class","p3 text-gray text-right",4,"ngIf"],["type","ball-scale-ripple-multiple","size","large","color","#d6dadf","zIndex","3","bdColor","rgba(246, 247, 248, 0.3)",3,"name","fullScreen"],["amountInfo",""],[1,"account-pill","pl-0","pr-0"],[1,"account-pill--logo"],[3,"name"],[1,"account-pill--content","small"],[1,"wrap-text"],[1,"wrap-text","text-gray"],[1,"account-pill","account-pill_gray","account-pill_fill"],["clearable","true"],["type","text","jFormInput","","jReplaceOnPaste","KZ","jDynamicPrefix","KZ","jFocusOnReturn","","jUppercase","",1,"form-control",3,"jShadow","dropSpecialCharacters","mask","formControl"],["accountInput","jFormInput"],[1,"text-truncate"],["jBottomLine","",1,"j-form-field-bottom"],[1,"text-truncate","small"],[1,"payment-section--amount-warn","mt-1","p2"],[3,"innerHTML"],[1,"p3","text-gray","text-right"],["type","button",1,"btn","btn-outline-primary","btn-static",3,"click"],["type","submit",1,"btn","btn-primary","btn-static","ml-3"],["type","submit",1,"btn","btn-outline-primary","btn-static"],[1,"p3"]],template:function(e,t){if(1&e&&(d.Wb(0,"div",0),d.Wb(1,"form",1,2),d.ic("submit",(function(e){return t.onSubmit(e)})),d.Wb(3,"div",3),d.Wb(4,"fieldset"),d.Wb(5,"div",4),d.Wb(6,"h2",5),d.Qc(7),d.mc(8,"translate"),d.Vb(),d.Wb(9,"button",6),d.ic("click",(function(e){return t.openBanksDictionary()})),d.Qc(10),d.mc(11,"translate"),d.Vb(),d.Vb(),d.Wb(12,"div",7),d.Wb(13,"j-form-field",null,8),d.Oc(15,nl,2,0,"j-label",9),d.Wb(16,"j-select",10,11),d.mc(18,"async"),d.Oc(19,rl,8,4,"ng-template",12),d.Oc(20,il,8,4,"ng-template",13),d.Vb(),d.Vb(),d.Vb(),d.Oc(21,ol,7,6,"div",14),d.Vb(),d.Vb(),d.Wb(22,"div",3),d.Wb(23,"fieldset"),d.Wb(24,"legend",15),d.Qc(25,"\u0414\u0435\u0442\u0430\u043b\u0438 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Wb(26,"div",7),d.Wb(27,"j-form-field"),d.Wb(28,"j-label"),d.Qc(29,"\u041d\u043e\u043c\u0435\u0440 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430"),d.Vb(),d.Rb(30,"input",16),d.Vb(),d.Vb(),d.Wb(31,"div",7),d.Rb(32,"j-date-picker",17,18),d.mc(34,"async"),d.mc(35,"async"),d.Vb(),d.Wb(36,"div",7),d.Wb(37,"j-form-field",null,19),d.Wb(39,"j-label"),d.Qc(40,"\u041a\u041d\u041f/\u0422\u0438\u043f \u043e\u0442\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),d.Vb(),d.Wb(41,"j-select",20,21),d.mc(43,"async"),d.Oc(44,al,2,1,"ng-template",12),d.Vb(),d.Vb(),d.Vb(),d.Wb(45,"div",22),d.Wb(46,"span",23),d.Qc(47),d.mc(48,"async"),d.Vb(),d.Wb(49,"j-form-field"),d.Wb(50,"j-label"),d.Qc(51,"\u041d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u043f\u043b\u0430\u0442\u0435\u0436\u0430"),d.Vb(),d.Rb(52,"textarea",24,25),d.Rb(54,"j-error",26),d.Oc(55,cl,3,1,"div",27),d.mc(56,"async"),d.Vb(),d.Vb(),d.Wb(57,"div",7),d.Wb(58,"j-account-dropdown",28,29),d.ic("selected",(function(e){return t.onSenderAccountSelect(e)})),d.mc(60,"async"),d.mc(61,"async"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(62,"div",3),d.Wb(63,"fieldset"),d.Wb(64,"j-employee-group-control",30),d.Wb(65,"div",31),d.Wb(66,"div",32),d.Wb(67,"div",33),d.Rb(68,"input",34),d.Wb(69,"label",35),d.Qc(70," \u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438 \u0440\u0435\u0437\u0438\u0434\u0435\u043d\u0442\u044b \u0420\u041a "),d.Vb(),d.Vb(),d.Vb(),d.Wb(71,"div",32),d.Wb(72,"div",33),d.Rb(73,"input",36),d.Wb(74,"label",37),d.Qc(75," \u0421\u043e\u0442\u0440\u0443\u0434\u043d\u0438\u043a\u0438 \u043d\u0435\u0440\u0435\u0437\u0438\u0434\u0435\u043d\u0442\u044b \u0420\u041a "),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Rb(76,"j-error",26),d.Vb(),d.Vb(),d.Vb(),d.Wb(77,"div",38),d.Wb(78,"div",7),d.Wb(79,"fieldset"),d.Wb(80,"ul",39),d.Wb(81,"li",40),d.Wb(82,"h5",41),d.Qc(83,"\u041e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430: "),d.Wb(84,"span",42),d.Wb(85,"strong"),d.Qc(86),d.mc(87,"amountFormat"),d.mc(88,"async"),d.Vb(),d.Qc(89," \u20b8"),d.Vb(),d.Vb(),d.Oc(90,sl,2,1,"div",43),d.mc(91,"async"),d.Wb(92,"p",44),d.Oc(93,ll,3,3,"ng-container",45),d.mc(94,"async"),d.Oc(95,ul,4,8,"ng-template",null,46,d.Pc),d.Vb(),d.Vb(),d.Wb(97,"li",47),d.Rb(98,"j-switch",48),d.Wb(99,"span",49),d.Qc(100,"\u0421\u0440\u043e\u0447\u043d\u044b\u0439 \u043f\u043b\u0430\u0442\u0435\u0436 "),d.Rb(101,"br"),d.Wb(102,"small",50),d.Qc(103),d.mc(104,"translate"),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Vb(),d.Wb(105,"div",51),d.Oc(106,bl,4,0,"p",52),d.mc(107,"async"),d.Wb(108,"div",51),d.Oc(109,dl,6,3,"ng-container",9),d.Oc(110,ml,3,0,"ng-container",9),d.Vb(),d.Vb(),d.Rb(111,"ngx-spinner",53),d.Vb(),d.Vb(),d.Oc(112,pl,6,0,"ng-template",null,54,d.Pc)),2&e){var n=d.Cc(14),r=d.Cc(17),i=d.Cc(33),o=d.Cc(38),a=d.Cc(42),c=d.Cc(96);d.Ab(1),d.rc("formGroup",t.form),d.Ab(6),d.Sc(" ",d.nc(8,57,"PAYMENTS.RECIPIENT.TITLE")," "),d.Ab(3),d.Sc(" ",d.nc(11,59,"PAYMENTS.SELECT_FROM_DICTIONARY")," "),d.Ab(5),d.rc("ngIf",!t.form.controls.bankReceiver.value),d.Ab(1),d.rc("searchFn",t.paymentsService.bankReceiverSearchFn)("jFocusOnReturn",r)("appendTo",n.elementRef.nativeElement)("formControl",t.form.controls.bankReceiver)("clearable",!1)("items",d.nc(18,61,t.banks.items$)),d.Ab(5),d.rc("ngIf",t.form.controls.bankAccount.enabled),d.Ab(9),d.rc("mask",t.masks.number.mask)("formControl",t.form.controls.number),d.Ab(2),d.rc("jFocusOnReturn",i)("datesEnabled",d.nc(34,63,t.workingDays$))("formControl",t.form.controls.date)("formatValue",!0)("minDate",t.dateLimit.minDate)("maxDate",t.dateLimit.maxDate)("helperText",d.nc(35,65,t.dateMessage$)),d.Ab(9),d.rc("jFocusOnReturn",a)("appendTo",o.elementRef.nativeElement)("formControl",t.form.controls.knp)("clearable",!1)("searchMask",t.masks.knp.mask)("shadow",t.masks.knp.shadow)("items",d.nc(43,67,t.knp$)),d.Ab(6),d.Tc(" ",d.nc(48,69,t.purposeLength$),"/",t.rules.purposeLength,""),d.Ab(5),d.rc("formControl",t.form.controls.purpose),d.Ab(2),d.rc("control",t.form.controls.purpose)("errorMessages",t.errors.purpose),d.Ab(1),d.rc("ngIf",d.nc(56,71,t.purposeMessage$)),d.Ab(3),d.rc("isLoading",d.nc(60,73,t.accountStore.fetching$))("label","PAYMENTS.SENDER_ACCOUNT.UNSELECTED")("hasError",t.form.controls.senderAccount.touched&&t.form.controls.senderAccount.errors)("accounts",d.nc(61,75,t.acceptableAccounts$)),d.Ab(6),d.rc("formControl",t.form.controls.employees)("paymentType",t.paymentType)("maxAmount",t.employeeMaxAmount)("birthDateRequired",!1)("ibanRequired",!0),d.Ab(4),d.rc("value",!0),d.Ab(5),d.rc("value",!1),d.Ab(3),d.rc("control",t.form.controls.employees)("errorMessages",t.errors.employees),d.Ab(10),d.Rc(d.nc(87,77,d.nc(88,79,t.total$))),d.Ab(4),d.rc("ngIf",d.nc(91,81,t.amountMessage$)),d.Ab(3),d.rc("ngIf",null===d.nc(94,83,t.commission$))("ngIfElse",c),d.Ab(5),d.rc("formControl",t.form.controls.urgent),d.Ab(5),d.Rc(d.nc(104,85,"PAYMENTS.URGENT_HELPER")),d.Ab(3),d.rc("ngIf",d.nc(107,87,t.controlsStream.isResidents)),d.Ab(3),d.rc("ngIf",t.restoredData.status!==t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("ngIf",t.restoredData.status===t.PAYMENT_STATUS.CREATED),d.Ab(1),d.rc("name",t.SPINNER)("fullScreen",!1)}},directives:[i.J,i.u,Pt.b,Ot.b,i.l,Zt.a,r.u,kt,Ot.a,i.t,i.i,ye,ve,en.a,an.a,i.c,o.a,qt.a,on.a,Bo.a,dn.a,i.B,i.j,Rn.a,fr.a,_n.a,Vt.a,Mt.a,Wt.a,Nt.a,rn.a],pipes:[c.d,r.b,Vr.a],styles:[".payments__header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between;margin-bottom:1.5rem}"]}),fl),gl=[{path:Br.c.root,component:Vc,children:[{path:"",canActivate:[Ur.a]},{path:Br.b.root,component:cs,data:{animation:"slideOrFade",index:2},children:[{path:Br.b.tax,matcher:Object(Oe.factoryUserPageMatcher)(Br.b.tax,"paymentId"),component:os,canDeactivate:[$r.a],data:{animation:"slideOrFade",index:21}},{path:Br.b.pension,matcher:Object(Oe.factoryUserPageMatcher)(Br.b.pension,"paymentId"),component:Ms,canDeactivate:[$r.a],data:{animation:"slideOrFade",index:22}},{path:Br.b.social,matcher:Object(Oe.factoryUserPageMatcher)(Br.b.social,"paymentId"),component:Ks,canDeactivate:[$r.a],data:{animation:"slideOrFade",index:23}},{path:Br.b.osms,matcher:Object(Oe.factoryUserPageMatcher)(Br.b.osms,"paymentId"),component:tl,canDeactivate:[$r.a],data:{animation:"slideOrFade",index:24}},{path:"**",redirectTo:Br.b.tax}]},{path:Br.c.order,matcher:Object(Oe.factoryUserPageMatcher)(Br.c.order,"paymentId"),component:Os,canDeactivate:[$r.a],data:{animation:"slideOrFade",index:1}},{path:Br.c.salary,matcher:Object(Oe.factoryUserPageMatcher)(Br.c.salary,"paymentId"),component:vl,canDeactivate:[$r.a],data:{animation:"slideOrFade",index:3}},{path:":paymentId",canActivate:[Ur.a]},{path:"**",redirectTo:Br.c.order}]},{path:Br.a.foreignCurrency,canDeactivate:[$r.a],matcher:Object(Oe.factoryUserPageMatcher)(Br.a.foreignCurrency,"paymentId"),component:Tc},{path:"**",redirectTo:Br.c.root}],yl=((hl=function e(){_classCallCheck(this,e)}).\u0275mod=d.Ob({type:hl}),hl.\u0275inj=d.Nb({factory:function(e){return new(e||hl)},imports:[[Fr.g.forChild(gl)],Fr.g]}),hl),Cl=n("3bMa"),kl=n("pZP7"),Al=n("UZjs"),Tl=n("i/as"),Rl=n("8Sq6"),_l=n("w657");n.d(t,"PaymentsModule",(function(){return jl}));var Sl,jl=((Sl=function e(){_classCallCheck(this,e)}).\u0275mod=d.Ob({type:Sl}),Sl.\u0275inj=d.Nb({factory:function(e){return new(e||Sl)},providers:[Qr.a],imports:[[r.c,i.n,i.D,o.c,a.g,a.D,a.H,a.y,s.b,c.c,l.b,b.a,Dr,yl,u.ContractsModule],a.r,a.D]}),Sl);d.Ic(Si.a,[Tc,kc,Vc,os,cs,Os,Ms,Ks,tl,vl,ki,_i,Si.a,Vi,Pi,Mi.a,Io,hi,Zi,Li,Di,so,vo,Oo,bo,go.b,ko,r.r,r.s,r.t,r.u,r.B,r.x,r.y,r.z,r.A,r.v,r.w,i.J,i.y,i.I,i.c,i.z,i.C,i.a,i.F,i.G,i.B,i.t,i.u,i.E,i.p,i.o,i.A,i.b,i.d,i.w,i.x,i.v,i.i,i.l,i.j,i.m,i.f,o.a,a.d,a.e,a.p,a.h,a.C,a.G,a.o,a.u,a.v,a.w,a.x,a.z,a.A,a.B,s.a,c.a,Cl.a,Bo.a,kl.a,Al.a,At.a,Tt.a,Rt.a,_t.a,St.a,jt.a,Ot.b,It.a,Vt.a,Et.a,xt.a,wt.a,Wt.a,Ot.a,Nt.a,Pt.b,Pt.a,Mt.a,Lt.a,Dt.a,Qt.a,Ft.a,Bt.a,$t.a,Ut.a,Yt.b,Kt.a,Ht.a,Gt.a,zt.a,qt.a,Xt.a,Zt.a,Jt.a,en.a,tn.a,nn.a,rn.a,on.a,an.a,cn.a,sn.a,ln.a,un.a,bn.a,dn.a,mn.a,pn.a,fn.a,hn.a,vn.a,gn.a,yn.a,Cn.a,kn.a,An.a,Tn.a,Rn.a,_n.a,Sn.a,jn.a,On.a,In.a,Vn.a,En.a,xn.a,wn.a,Wn.a,Nn.a,Pn.a,Mn.a,Ln.a,Dn.a,Qn.a,Fn.a,Bn.a,$n.a,Un.a,Yn.a,Kn.a,Hn.a,Gn.a,zn.a,qn.a,Xn.a,Zn.a,Jn.a,er.a,tr.a,nr.a,rr.a,ir.a,or.b,ar.a,cr.a,sr.a,lr.a,ur.a,br.a,dr.a,mr.a,pr.a,fr.a,hr.a,vr.a,gr.a,a.E,yr.a,yr.b,Cr.a,kr.a,Ar.a,Ar.c,Ar.b,Tr.a,Rr.a,kt,ue,ge,ve,ye,Ce,ke,Ae,Te,Re,_e,Se,je,Fr.h,Fr.d,Fr.f,Fr.e,Fr.i,Tl.a,Rl.a,_l.a],[r.b,r.I,r.q,r.l,r.F,r.g,r.D,r.G,r.d,r.f,r.j,r.k,r.m,o.b,c.d,_r.a,Sr.a,jr.a,Or.a,Ir.a,Vr.a,Er.a,xr.a,wr.a,Wr.a,Nr.a,Pr.a,Mr.a,Lr.a])}}]);
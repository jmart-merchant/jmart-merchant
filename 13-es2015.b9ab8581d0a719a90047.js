(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{kj2d:function(t,i,e){"use strict";e.r(i);var n=e("ofXK"),s=e("PCNd"),r=e("tyNb"),o=e("lJxs"),a=e("fXoL"),c=e("2A1n");let l=(()=>{class t{constructor(t,i){this.authoritiesService=t,this.router=i}canActivate(){return this.authoritiesService.getOtpDevices().pipe(Object(o.a)(t=>{var i;const e=(null===(i=t)||void 0===i?void 0:i.length)>0;return e||this.router.navigate(["/authorities/main"]),e}))}}return t.\u0275fac=function(i){return new(i||t)(a.ec(c.a),a.ec(r.c))},t.\u0275prov=a.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var b=e("mrSG"),d=e("quSY"),u=e("itXk"),p=e("pLZG"),m=e("VnnJ"),h=e("S1F0"),g=e("oKsb"),f=e("fvpk"),y=e("xJkR"),T=e("TwVa"),A=e("3Pt+"),v=e("+/Tu"),I=e("1kSV"),S=e("mR7B"),O=e("NpBu"),R=e("M6pS"),P=e("sYmb");let _=(()=>{class t{constructor(t,i,e){this.modal=t,this.authorityLimitsService=i,this.maskedService=e,this.isLoading=!1,this.form=new A.k({amount:new A.h("",A.H.required)})}ngOnInit(){this.title=this.mapTranslate(`CREATE.${this.paymentType}`)}dismissModal(t){this.modal.dismiss(t)}closeModal(t){this.modal.close(t)}createLimit(){return Object(b.a)(this,void 0,void 0,(function*(){this.isLoading=!0;const{amount:t}=this.form.getRawValue(),i={paymentType:this.paymentType,limit:{amount:this.maskedService.getNumberedAmount(t),currency:v.a.KZT}};try{const t=yield this.authorityLimitsService.createLimit(this.authorityId,i);this.closeModal(t)}catch(e){this.dismissModal(e)}finally{this.isLoading=!1}}))}mapTranslate(t){return`AUTHORITIES.MODALS.${t}`}}return t.\u0275fac=function(i){return new(i||t)(a.Qb(I.a),a.Qb(c.b),a.Qb(S.a))},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-create-limit-modal"]],inputs:{authorityId:"authorityId",paymentType:"paymentType"},decls:13,vars:14,consts:[[1,"pt-5","pb-4","px-4",3,"formGroup"],[1,"authorities-modal__article"],[1,"p3","text-muted"],[3,"label","formControl"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-primary",3,"jLoading","disabled","click"]],template:function(t,i){1&t&&(a.Wb(0,"form",0),a.Wb(1,"article",1),a.Wb(2,"h5"),a.Rc(3),a.mc(4,"translate"),a.Vb(),a.Wb(5,"p",2),a.Rc(6),a.mc(7,"translate"),a.Vb(),a.Vb(),a.Rb(8,"j-amount-input",3),a.Wb(9,"div",4),a.Wb(10,"button",5),a.ic("click",(function(t){return i.createLimit()})),a.Rc(11),a.mc(12,"translate"),a.Vb(),a.Vb(),a.Vb()),2&t&&(a.sc("formGroup",i.form),a.Ab(3),a.Tc(" ",a.nc(4,8,i.title)," "),a.Ab(3),a.Tc(" ",a.nc(7,10,i.mapTranslate("DESCRIPTION"))," "),a.Ab(2),a.sc("label",i.mapTranslate("LABEL"))("formControl",i.form.controls.amount),a.Ab(2),a.sc("jLoading",i.isLoading)("disabled",i.isLoading||i.form.invalid),a.Ab(1),a.Tc(" ",a.nc(12,12,i.mapTranslate("SUBMIT"))," "))},directives:[A.J,A.u,A.l,O.a,A.t,A.i,R.a],pipes:[P.d],styles:[".authorities-modal__article[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{line-height:30px;max-width:340px}"]}),t})(),E=(()=>{class t{constructor(t,i,e){this.modal=t,this.authorityLimitsService=i,this.maskedService=e,this.isLoading=!1}dismissModal(t){this.modal.dismiss(t)}closeModal(t,i=null){this.modal.close({message:t,limit:i})}ngOnInit(){this.title=this.mapTranslate(`CREATE.${this.paymentType}`),this.form=new A.k({amount:new A.h(this.maskedService.getMaskedAmount(this.limit.limit.amount),A.H.required)})}deleteLimit(){return Object(b.a)(this,void 0,void 0,(function*(){this.isLoading=!0;try{yield this.authorityLimitsService.deleteLimit(this.authorityId,this.limit),this.closeModal("delete")}catch(t){this.dismissModal("delete")}finally{this.isLoading=!1}}))}updateLimit(){return Object(b.a)(this,void 0,void 0,(function*(){const{amount:t}=this.form.getRawValue(),i=Object.assign(Object.assign({},this.limit),{limit:{amount:this.maskedService.getNumberedAmount(t),currency:v.a.KZT}});this.isLoading=!0;try{const t=yield this.authorityLimitsService.updateLimit(this.authorityId,i);this.closeModal("update",t)}catch(e){this.dismissModal("update")}finally{this.isLoading=!1}}))}mapTranslate(t){return`AUTHORITIES.MODALS.${t}`}}return t.\u0275fac=function(i){return new(i||t)(a.Qb(I.a),a.Qb(c.b),a.Qb(S.a))},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-edit-limit-modal"]],inputs:{authorityId:"authorityId",paymentType:"paymentType",limit:"limit"},decls:16,vars:19,consts:[[1,"pt-5","pb-4","px-4",3,"formGroup"],[1,"authorities-modal__article"],[1,"p3","text-muted"],[3,"label","formControl"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-outline-primary",3,"jLoading","disabled","click"],["type","submit",1,"ml-3","btn","btn-primary",3,"jLoading","disabled","click"]],template:function(t,i){1&t&&(a.Wb(0,"form",0),a.Wb(1,"article",1),a.Wb(2,"h5"),a.Rc(3),a.mc(4,"translate"),a.Vb(),a.Wb(5,"p",2),a.Rc(6),a.mc(7,"translate"),a.Vb(),a.Vb(),a.Rb(8,"j-amount-input",3),a.Wb(9,"div",4),a.Wb(10,"button",5),a.ic("click",(function(t){return i.deleteLimit()})),a.Rc(11),a.mc(12,"translate"),a.Vb(),a.Wb(13,"button",6),a.ic("click",(function(t){return i.updateLimit()})),a.Rc(14),a.mc(15,"translate"),a.Vb(),a.Vb(),a.Vb()),2&t&&(a.sc("formGroup",i.form),a.Ab(3),a.Tc(" ",a.nc(4,11,i.title)," "),a.Ab(3),a.Tc(" ",a.nc(7,13,i.mapTranslate("DESCRIPTION"))," "),a.Ab(2),a.sc("label",i.mapTranslate("LABEL"))("formControl",i.form.controls.amount),a.Ab(2),a.sc("jLoading",i.isLoading)("disabled",i.isLoading),a.Ab(1),a.Tc(" ",a.nc(12,15,i.mapTranslate("RESET"))," "),a.Ab(2),a.sc("jLoading",i.isLoading)("disabled",i.isLoading||i.form.invalid),a.Ab(1),a.Tc(" ",a.nc(15,17,i.mapTranslate("SUBMIT"))," "))},directives:[A.J,A.u,A.l,O.a,A.t,A.i,R.a],pipes:[P.d],styles:[""]}),t})();var L=e("VO+5"),M=e("DHTX"),C=e("wV3k");function V(t,i){if(1&t&&(a.Wb(0,"small",6),a.Rc(1),a.mc(2,"translate"),a.Vb()),2&t){const t=a.lc();a.Ab(1),a.Sc(a.nc(2,1,t.mapSwitchMessage("NO_LIMITS")))}}const W=function(t){return{amount:t}};function k(t,i){if(1&t&&(a.Wb(0,"small",6),a.Rc(1),a.mc(2,"translate"),a.mc(3,"money"),a.Vb()),2&t){const t=a.lc();a.Ab(1),a.Tc(" ",a.oc(2,1,t.mapSwitchMessage("HAS_LIMIT"),a.xc(6,W,a.nc(3,4,t.payment.limitAmount)))," ")}}function x(t,i){if(1&t){const t=a.Xb();a.Wb(0,"button",10),a.ic("click",(function(i){return a.Gc(t),a.lc(2).showCreateLimitModal()})),a.Rc(1),a.mc(2,"translate"),a.Vb()}if(2&t){const t=a.lc(2);a.sc("disabled",!t.payment.isEnabled),a.Ab(1),a.Tc(" ",a.nc(2,2,t.mapButtonLabel("SET_LIMIT"))," ")}}function j(t,i){if(1&t){const t=a.Xb();a.Wb(0,"button",11),a.ic("click",(function(i){return a.Gc(t),a.lc(2).showEditLimitModal()})),a.Rc(1),a.mc(2,"translate"),a.Vb()}if(2&t){const t=a.lc(2);a.sc("disabled",!t.payment.isEnabled),a.Ab(1),a.Tc(" ",a.nc(2,2,t.mapButtonLabel("CHANGE_LIMIT"))," ")}}function w(t,i){if(1&t&&(a.Ub(0),a.Wb(1,"div",7),a.Pc(2,x,3,4,"button",8),a.Pc(3,j,3,4,"button",9),a.Vb(),a.Tb()),2&t){const t=a.lc();a.Ab(2),a.sc("ngIf",!t.payment.limitAmount),a.Ab(1),a.sc("ngIf",t.payment.limitAmount)}}let D=(()=>{class t{constructor(t,i,e,n){this.authorityPermissionsService=t,this.notifierService=i,this.translateService=e,this.modalService=n}onChange(t){var i;return Object(b.a)(this,void 0,void 0,(function*(){try{let e;e=t?yield this.enablePayment():yield this.disablePayment(),!this.payment.permissionId&&(null===(i=e)||void 0===i?void 0:i.id)&&(this.payment.permissionId=e.id)}catch(e){this.payment.isEnabled=!this.payment.isEnabled}}))}enablePayment(){return Object(b.a)(this,void 0,void 0,(function*(){try{const t=yield this.authorityPermissionsService.grantPermission(this.person,this.payment);return this.notify("ACCESS_ENABLED"),t}catch(t){throw this.notify("ACCESS_ENABLE_FAILED","error"),t}}))}disablePayment(){return Object(b.a)(this,void 0,void 0,(function*(){try{const t=yield this.authorityPermissionsService.refusePermission(this.person,this.payment);return this.notify("ACCESS_DISABLED"),t}catch(t){throw this.notify("ACCESS_DISABLE_FAILED","error"),t}}))}showCreateLimitModal(){return Object(b.a)(this,void 0,void 0,(function*(){const t=this.createModalRef(_);try{const i=yield t.result;this.payment.limitId=i.id,this.payment.limitAmount=i.limit,this.notify("LIMIT_SET")}catch(i){i&&this.notify("LIMIT_SET_FAILED","error")}}))}showEditLimitModal(){return Object(b.a)(this,void 0,void 0,(function*(){const t=this.createModalRef(E);t.componentInstance.limit={id:this.payment.limitId,paymentType:this.payment.type,limit:this.payment.limitAmount};try{const{message:i,limit:e}=yield t.result;"update"===i?(this.payment.limitId=e.id,this.payment.limitAmount=e.limit,this.notify("LIMIT_UPDATED")):(this.payment.limitId=null,this.payment.limitAmount=null,this.notify("LIMIT_DELETED"))}catch(i){"update"===i?this.notify("LIMIT_UPDATE_FAILED","error"):"delete"==i&&this.notify("LIMIT_DELETE_FAILED","error")}}))}mapPaymentType(t){return this.mapTranslate(`TYPE.${t}`)}mapButtonLabel(t){return this.mapTranslate(`BUTTON.${t}`)}mapSwitchMessage(t){return this.mapTranslate(`SWITCH.${t}`)}createModalRef(t){const i=this.modalService.open(t,{backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",centered:!0});return i.componentInstance.authorityId=this.person.id,i.componentInstance.paymentType=this.payment.type,i}mapTranslate(t){return`AUTHORITIES.PAYMENTS.${t}`}notify(t,i="default"){this.notifierService.notify(i,this.translateService.instant(this.mapTranslate(`MESSAGES.${t}`),{paymentType:this.translateService.instant(this.mapPaymentType(this.payment.type))}))}}return t.\u0275fac=function(i){return new(i||t)(a.Qb(c.c),a.Qb(L.c),a.Qb(P.e),a.Qb(I.q))},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-payment"]],inputs:{payment:"payment",person:"person"},decls:9,vars:7,consts:[[1,"toggle"],[3,"value","valueChange"],[1,"toggle__label"],[1,"d-block"],["class","text-gray",4,"ngIf"],[4,"ngIf"],[1,"text-gray"],[1,"toggle__button"],["class","btn btn-link link-blue p-0",3,"disabled","click",4,"ngIf"],["class","btn btn-link p-0",3,"disabled","click",4,"ngIf"],[1,"btn","btn-link","link-blue","p-0",3,"disabled","click"],[1,"btn","btn-link","p-0",3,"disabled","click"]],template:function(t,i){1&t&&(a.Wb(0,"div",0),a.Wb(1,"j-toggle",1),a.ic("valueChange",(function(t){return i.payment.isEnabled=t}))("valueChange",(function(t){return i.onChange(t)})),a.Vb(),a.Wb(2,"span",2),a.Wb(3,"strong",3),a.Rc(4),a.mc(5,"translate"),a.Vb(),a.Pc(6,V,3,3,"small",4),a.Pc(7,k,4,8,"small",4),a.Vb(),a.Vb(),a.Pc(8,w,4,2,"ng-container",5)),2&t&&(a.Ab(1),a.sc("value",i.payment.isEnabled),a.Ab(3),a.Sc(a.nc(5,5,i.mapPaymentType(i.payment.type))),a.Ab(2),a.sc("ngIf",!i.payment.limitAmount),a.Ab(1),a.sc("ngIf",i.payment.limitAmount),a.Ab(1),a.sc("ngIf",!i.payment.isLimitDisabled))},directives:[M.a,n.u],pipes:[P.d,C.a],styles:["[_nghost-%COMP%]{display:block;padding:1rem 0}@media(min-width:670px){[_nghost-%COMP%]{-webkit-box-align:center;align-items:center;display:-webkit-box;display:flex}}.toggle__label[_ngcontent-%COMP%]{display:block;margin-left:1rem}.toggle[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;margin-bottom:1rem}@media(min-width:670px){.toggle[_ngcontent-%COMP%]{margin-bottom:0}}.toggle__button[_ngcontent-%COMP%]{text-align:center;-webkit-box-flex:1;flex-grow:1}@media(min-width:670px){.toggle__button[_ngcontent-%COMP%]{text-align:right}}"]}),t})();function U(t,i){if(1&t&&(a.Wb(0,"div",7),a.Rb(1,"j-authorities-payment",8),a.Vb()),2&t){const t=i.$implicit,e=a.lc(2);a.Ab(1),a.sc("payment",t)("person",e.person)}}function N(t,i){if(1&t&&(a.Wb(0,"div",5),a.Pc(1,U,2,2,"div",6),a.Vb()),2&t){const t=a.lc();a.Ab(1),a.sc("ngForOf",t.payments)}}const F=function(){return{height:"80px","background-color":"#ECEEF1"}};function H(t,i){1&t&&(a.Wb(0,"div",9),a.Rb(1,"ngx-skeleton-loader",10),a.Vb()),2&t&&(a.Ab(1),a.sc("theme",a.wc(1,F)))}const $=[T.i.PENSION,T.i.SOCIAL,T.i.MEDICAL,T.i.TAX,T.i.SALARY,T.i.CONVERSION,T.i.FOREIGN];let Q=(()=>{class t{constructor(t,i){this.authorityPermissionsService=t,this.authorityLimitsService=i,this.isLoading=!0}ngOnInit(){this.loadData()}loadData(){return Object(b.a)(this,void 0,void 0,(function*(){try{const t=yield this.loadPermissions(),i=yield this.loadLimits();this.payments=$.map(e=>{const n=t.find(t=>t.paymentType===e),s=i.find(t=>t.paymentType===e);return{type:e,permissionId:n?n.id:null,isEnabled:!n||n.permissions.length>0,limitId:s?s.id:null,limitAmount:s?s.limit:null,isLimitDisabled:[T.i.CONVERSION,T.i.FOREIGN].includes(e)}})}catch(t){}finally{this.isLoading=!1}}))}loadLimits(){return Object(b.a)(this,void 0,void 0,(function*(){try{return yield this.authorityLimitsService.getLimits(this.person.id)}catch(t){return[]}}))}loadPermissions(){return Object(b.a)(this,void 0,void 0,(function*(){try{return yield this.authorityPermissionsService.getPermissions(this.person.id)}catch(t){return[]}}))}mapTranslate(t){return`AUTHORITIES.PAYMENTS.${t}`}}return t.\u0275fac=function(i){return new(i||t)(a.Qb(c.c),a.Qb(c.b))},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-payments"]],inputs:{person:"person"},decls:9,vars:8,consts:[[1,"payments__header"],[1,"mb-1"],[1,"mb-0","p3","text-muted"],["class","payments__body",4,"ngIf"],["class","payments__body pt-4 pb-2",4,"ngIf"],[1,"payments__body"],["class","payments__item",4,"ngFor","ngForOf"],[1,"payments__item"],[3,"payment","person"],[1,"payments__body","pt-4","pb-2"],["count","8",3,"theme"]],template:function(t,i){1&t&&(a.Wb(0,"article",0),a.Wb(1,"h6",1),a.Rc(2),a.mc(3,"translate"),a.Vb(),a.Wb(4,"p",2),a.Rc(5),a.mc(6,"translate"),a.Vb(),a.Vb(),a.Pc(7,N,2,1,"div",3),a.Pc(8,H,2,2,"div",4)),2&t&&(a.Ab(2),a.Sc(a.nc(3,4,i.mapTranslate("TITLE"))),a.Ab(3),a.Sc(a.nc(6,6,i.mapTranslate("DESCRIPTION"))),a.Ab(2),a.sc("ngIf",!i.isLoading),a.Ab(1),a.sc("ngIf",i.isLoading))},directives:[n.u,n.t,D,y.a],pipes:[P.d],styles:["[_nghost-%COMP%]{background:#fff;border-radius:12px;display:block}.payments__body[_ngcontent-%COMP%], .payments__header[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.payments__header[_ngcontent-%COMP%]{padding-top:22px;padding-bottom:1rem;border-bottom:1px solid #dbdfe2}"]}),t})();function K(t,i){1&t&&(a.Ub(0),a.Rc(1," \u2022 "),a.Tb())}function B(t,i){if(1&t&&(a.Ub(0),a.Wb(1,"p",4),a.Rc(2),a.Pc(3,K,2,0,"ng-container",2),a.Rc(4),a.mc(5,"translate"),a.Vb(),a.Wb(6,"h1",5),a.Rc(7),a.Vb(),a.Tb()),2&t){const t=a.lc();a.Ab(2),a.Tc(" ",t.person.position," "),a.Ab(1),a.sc("ngIf",t.person.position&&t.person.authority),a.Ab(1),a.Tc(" ",a.nc(5,6,t.mapAuthority(t.person.authority))," "),a.Ab(3),a.Vc(" ",t.person.lastname," ",t.person.firstname?t.person.firstname[0]+".":"","",t.person.middlename?t.person.middlename[0]+".":""," ")}}const G=function(){return{width:"300px",height:"24px","margin-bottom":"6px","background-color":"#ECEEF1"}},Y=function(){return{height:"48px","margin-bottom":"0","background-color":"#ECEEF1"}};function J(t,i){1&t&&(a.Ub(0),a.Rb(1,"ngx-skeleton-loader",6),a.Rb(2,"ngx-skeleton-loader",6),a.Tb()),2&t&&(a.Ab(1),a.sc("theme",a.wc(2,G)),a.Ab(1),a.sc("theme",a.wc(3,Y)))}function X(t,i){if(1&t&&a.Rb(0,"j-authorities-payments",7),2&t){const t=a.lc();a.sc("person",t.person)}}let q=(()=>{class t{constructor(t,i,e){this.router=t,this.route=i,this.companyService=e,this.subscription=new d.a,this.isReady=!1,this.initAuthoritiesSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapAuthority(t){return this.mapTranslate(`AUTHORITY.${t}`)}mapTranslate(t){return`AUTHORITIES.USERS.${t}`}initAuthoritiesSubscription(){this.subscription.add(Object(u.a)([this.route.params,this.companyService.getAuthorizedPersons().pipe(Object(p.a)(t=>{var i;return(null===(i=t)||void 0===i?void 0:i.length)>0}))]).subscribe(([t,i])=>{this.initPerson(i.find(i=>i.id===t.id))}))}initPerson(t){return Object(b.a)(this,void 0,void 0,(function*(){t||this.onClose(),this.person=t,this.isReady=!0}))}onClose(){this.router.navigate(["/authorities/main"])}}return t.\u0275fac=function(i){return new(i||t)(a.Qb(r.c),a.Qb(r.a),a.Qb(m.a))},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-limits"]],decls:7,vars:3,consts:[["closePosition","outside","colsClassList","offset-lg-1 col-lg-8","bodyClassList","py-5",3,"closed"],[1,"limits__header",2,"position","relative"],[4,"ngIf"],[3,"person",4,"ngIf"],[1,"text-muted","limits__position"],[1,"limits__name"],[3,"theme"],[3,"person"]],template:function(t,i){1&t&&(a.Wb(0,"f-page",0),a.ic("closed",(function(t){return i.onClose()})),a.Wb(1,"f-page-header"),a.Wb(2,"div",1),a.Pc(3,B,8,8,"ng-container",2),a.Pc(4,J,3,4,"ng-container",2),a.Vb(),a.Vb(),a.Wb(5,"f-page-body"),a.Pc(6,X,1,1,"j-authorities-payments",3),a.Vb(),a.Vb()),2&t&&(a.Ab(3),a.sc("ngIf",i.person&&i.isReady),a.Ab(1),a.sc("ngIf",!i.person||!i.isReady),a.Ab(2),a.sc("ngIf",i.person&&i.isReady))},directives:[h.a,g.a,n.u,f.a,y.a,Q],pipes:[P.d],styles:[".limits__position[_ngcontent-%COMP%]{margin-bottom:6px}.limits__name[_ngcontent-%COMP%]{line-height:60px;margin-bottom:0}.limits__header[_ngcontent-%COMP%]{margin-bottom:60px}"]}),t})();function Z(t,i){if(1&t&&(a.Wb(0,"a",3),a.Rc(1),a.mc(2,"translate"),a.Vb()),2&t){const t=i.$implicit,e=a.lc();a.sc("routerLink",t),a.Ab(1),a.Tc(" ",a.nc(2,2,e.mapTranslate(t))," ")}}let z=(()=>{class t{constructor(t){this.authoritiesService=t,this.links=["users","otp"],this.subscription=new d.a,this.initSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapTranslate(t){return`AUTHORITIES.MAIN.NAV.${t.toUpperCase()}`}initSubscription(){this.subscription.add(this.authoritiesService.getOtpDevices().subscribe(t=>{var i;(null===(i=t)||void 0===i?void 0:i.length)>0?this.links.includes("otp")||this.links.push("otp"):this.links.includes("otp")&&this.links.splice(this.links.indexOf("otp"),1)}))}}return t.\u0275fac=function(i){return new(i||t)(a.Qb(c.a))},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-nav"]],decls:3,vars:1,consts:[[1,"f-page-tabs-wrap"],[1,"f-page-tabs"],["routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],["routerLinkActive","active",3,"routerLink"]],template:function(t,i){1&t&&(a.Wb(0,"div",0),a.Wb(1,"nav",1),a.Pc(2,Z,3,4,"a",2),a.Vb(),a.Vb()),2&t&&(a.Ab(2),a.sc("ngForOf",i.links))},directives:[n.t,r.f,r.e],pipes:[P.d],styles:[""]}),t})(),tt=(()=>{class t{constructor(t){this.router=t}onClose(){this.router.navigate(["/settings"])}}return t.\u0275fac=function(i){return new(i||t)(a.Qb(r.c))},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-main"]],decls:8,vars:3,consts:[["closePosition","outside","colsClassList","offset-lg-1 col-lg-11 offset-xl-2 col-xl-10","bodyClassList","py-5",3,"closed"],[1,"f-page-title"]],template:function(t,i){1&t&&(a.Wb(0,"f-page",0),a.ic("closed",(function(t){return i.onClose()})),a.Wb(1,"f-page-header"),a.Wb(2,"h1",1),a.Rc(3),a.mc(4,"translate"),a.Vb(),a.Rb(5,"j-authorities-nav"),a.Vb(),a.Wb(6,"f-page-body"),a.Rb(7,"router-outlet"),a.Vb(),a.Vb()),2&t&&(a.Ab(3),a.Sc(a.nc(4,1,"AUTHORITIES.MAIN.TITLE")))},directives:[h.a,g.a,z,f.a,r.h],pipes:[P.d],styles:[""]}),t})(),it=(()=>{class t{constructor(){}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-order"]],decls:2,vars:0,template:function(t,i){1&t&&(a.Wb(0,"p"),a.Rc(1," authorities-order works!\n"),a.Vb())},styles:[""]}),t})();function et(t,i){if(1&t&&(a.Wb(0,"th",3),a.Rc(1),a.mc(2,"translate"),a.Vb()),2&t){const t=i.$implicit,e=a.lc();a.Ab(1),a.Sc(a.nc(2,1,e.mapTableHeading(t)))}}function nt(t,i){if(1&t&&(a.Wb(0,"tr"),a.Wb(1,"td"),a.Wb(2,"div",4),a.Rc(3),a.Vb(),a.Vb(),a.Wb(4,"td"),a.Wb(5,"div",5),a.Rc(6),a.Vb(),a.Vb(),a.Vb()),2&t){const t=i.$implicit;a.Ab(3),a.Tc(" ",t.serial," "),a.Ab(3),a.Vc(" ",null==t.user?null:t.user.lastname," ",null!=t.user&&t.user.firstname?(null==t.user?null:t.user.firstname[0])+".":""," ",null!=t.user&&t.user.middlename?(null==t.user?null:t.user.middlename[0])+".":""," ")}}let st=(()=>{class t{constructor(t){this.authoritiesService=t,this.otpDevices=[],this.headings=["SERIAL","USER"],this.subscription=new d.a,this.initSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapTableHeading(t){return t?this.mapTranslate(`TABLE.${t}`):""}mapTranslate(t){return`AUTHORITIES.OTP.${t}`}initSubscription(){this.subscription.add(this.authoritiesService.getOtpDevices().subscribe(t=>{this.otpDevices=t}))}}return t.\u0275fac=function(i){return new(i||t)(a.Qb(c.a))},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-otp"]],decls:6,vars:2,consts:[[1,"j-authorities-table"],["class","p4 text-muted",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p4","text-muted"],[1,"p4","text-dark"],[1,"p2","text-dark"]],template:function(t,i){1&t&&(a.Wb(0,"table",0),a.Wb(1,"thead"),a.Wb(2,"tr"),a.Pc(3,et,3,3,"th",1),a.Vb(),a.Vb(),a.Wb(4,"tbody"),a.Pc(5,nt,7,4,"tr",2),a.Vb(),a.Vb()),2&t&&(a.Ab(3),a.sc("ngForOf",i.headings),a.Ab(2),a.sc("ngForOf",i.otpDevices))},directives:[n.t],pipes:[P.d],styles:[".j-authorities-table[_ngcontent-%COMP%]{background:#fff;width:100%;border-radius:12px}.j-authorities-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e9ebec}.j-authorities-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.j-authorities-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 16px;font-weight:400}.j-authorities-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 16px}"]}),t})();function rt(t,i){if(1&t&&(a.Wb(0,"th",6),a.Rc(1),a.mc(2,"translate"),a.Vb()),2&t){const t=i.$implicit,e=a.lc();a.Ab(1),a.Sc(a.nc(2,1,e.mapTableHeading(t)))}}function ot(t,i){if(1&t&&(a.Wb(0,"th",6),a.Rc(1),a.mc(2,"translate"),a.Vb()),2&t){const t=i.$implicit,e=a.lc(2);a.Ab(1),a.Sc(a.nc(2,1,e.mapTableHeading(t)))}}function at(t,i){if(1&t&&(a.Ub(0),a.Pc(1,ot,3,3,"th",3),a.Tb()),2&t){const t=a.lc();a.Ab(1),a.sc("ngForOf",t.primaryHeadings)}}function ct(t,i){1&t&&(a.Ub(0),a.Rc(1),a.mc(2,"translate"),a.Tb()),2&t&&(a.Ab(1),a.Tc(" ",a.nc(2,1,"SHARED.DATE_FROM")," "))}function lt(t,i){1&t&&(a.Ub(0),a.Rc(1," \u2014 "),a.Rb(2,"br"),a.Tb())}function bt(t,i){if(1&t&&(a.Wb(0,"span",11),a.Rc(1),a.mc(2,"translate"),a.Vb()),2&t){const t=a.lc(3);a.Ab(1),a.Sc(a.nc(2,1,t.mapTranslate("LIMITS_LINK")))}}function dt(t,i){if(1&t&&(a.Wb(0,"a",12),a.Rc(1),a.mc(2,"translate"),a.Vb()),2&t){const t=a.lc(2).$implicit,i=a.lc();a.sc("routerLink","/authorities/limits/"+t.id),a.Ab(1),a.Sc(a.nc(2,2,i.mapTranslate("LIMITS_LINK")))}}function ut(t,i){if(1&t&&(a.Ub(0),a.Wb(1,"td"),a.Pc(2,bt,3,3,"span",9),a.Pc(3,dt,3,4,"a",10),a.Vb(),a.Tb()),2&t){const t=a.lc().$implicit,i=a.lc();a.Ab(2),a.sc("ngIf",i.currentUserId===t.userId),a.Ab(1),a.sc("ngIf",i.currentUserId!==t.userId)}}function pt(t,i){if(1&t&&(a.Wb(0,"tr"),a.Wb(1,"td"),a.Wb(2,"div",7),a.Rc(3),a.Vb(),a.Wb(4,"div",6),a.Rc(5),a.Vb(),a.Vb(),a.Wb(6,"td"),a.Wb(7,"div",8),a.Rc(8),a.mc(9,"translate"),a.Vb(),a.Vb(),a.Wb(10,"td"),a.Wb(11,"div",8),a.Pc(12,ct,3,3,"ng-container",4),a.Rc(13),a.mc(14,"date"),a.Pc(15,lt,3,0,"ng-container",4),a.Rc(16),a.mc(17,"date"),a.Vb(),a.Vb(),a.Pc(18,ut,4,2,"ng-container",4),a.Vb()),2&t){const t=i.$implicit,e=a.lc();a.Ab(3),a.Vc(" ",t.lastname," ",t.firstname?t.firstname[0]+".":""," ",t.middlename?t.middlename[0]+".":""," "),a.Ab(2),a.Tc(" ",t.position," "),a.Ab(3),a.Tc(" ",a.nc(9,10,e.mapAuthority(t.authority))," "),a.Ab(4),a.sc("ngIf",!t.toDate),a.Ab(1),a.Tc(" ",a.oc(14,12,t.fromDate,"dd MMM yyyy")," "),a.Ab(2),a.sc("ngIf",t.toDate),a.Ab(1),a.Tc(" ",a.oc(17,15,t.toDate,"dd MMM yyyy")," "),a.Ab(2),a.sc("ngIf",e.isPrimaryAuthority)}}let mt=(()=>{class t{constructor(t,i){this.companyService=t,this.authoritiesService=i,this.persons=[],this.isPrimaryAuthority=!1,this.headings=["USER","TYPE","DURATION"],this.primaryHeadings=[""],this.subscription=new d.a,this.restrictions=[],this.initCompanySubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapAuthority(t){return this.mapTranslate(`AUTHORITY.${t}`)}mapRestrictions(t){return this.mapTranslate(`RESTRICTIONS.${t}`)}mapTableHeading(t){return t?this.mapTranslate(`TABLE.${t}`):""}mapTranslate(t){return`AUTHORITIES.USERS.${t}`}initCompanySubscription(){this.subscription.add(this.companyService.refresh$.pipe(Object(p.a)(([,,t])=>t)).subscribe(([t,i])=>{var e;this.currentUserId=null===(e=t)||void 0===e?void 0:e.id,this.isPrimaryAuthority=this.companyService.isPrimaryAuthority(i.authority),this.isPrimaryAuthority&&this.retrieveRestrictions()}))}retrieveRestrictions(){return Object(b.a)(this,void 0,void 0,(function*(){this.restrictions=yield this.authoritiesService.fetchRestrictions()}))}}return t.\u0275fac=function(i){return new(i||t)(a.Qb(m.a),a.Qb(c.a))},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-registered"]],inputs:{persons:"persons"},decls:14,vars:9,consts:[[1,"mb-1"],[1,"p3","text-muted"],[1,"j-authorities-table"],["class","p4 text-muted",4,"ngFor","ngForOf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"p4","text-muted"],[1,"p2","text-dark"],[1,"p4","text-dark"],["class","p3 text-disabled",4,"ngIf"],["class","p3 link-blue",3,"routerLink",4,"ngIf"],[1,"p3","text-disabled"],[1,"p3","link-blue",3,"routerLink"]],template:function(t,i){1&t&&(a.Wb(0,"article"),a.Wb(1,"h6",0),a.Rc(2),a.mc(3,"translate"),a.Vb(),a.Wb(4,"p",1),a.Rc(5),a.mc(6,"translate"),a.Vb(),a.Vb(),a.Wb(7,"table",2),a.Wb(8,"thead"),a.Wb(9,"tr"),a.Pc(10,rt,3,3,"th",3),a.Pc(11,at,2,1,"ng-container",4),a.Vb(),a.Vb(),a.Wb(12,"tbody"),a.Pc(13,pt,19,18,"tr",5),a.Vb(),a.Vb()),2&t&&(a.Ab(2),a.Sc(a.nc(3,5,"AUTHORITIES.USERS.REGISTERED.TITLE")),a.Ab(3),a.Sc(a.nc(6,7,"AUTHORITIES.USERS.REGISTERED.DESCRIPTION")),a.Ab(5),a.sc("ngForOf",i.headings),a.Ab(1),a.sc("ngIf",i.isPrimaryAuthority),a.Ab(2),a.sc("ngForOf",i.persons))},directives:[n.t,n.u,r.f],pipes:[P.d,n.f],styles:[".j-authorities-table[_ngcontent-%COMP%]{background:#fff;width:100%;border-radius:12px}.j-authorities-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e9ebec}.j-authorities-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.j-authorities-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 16px;font-weight:400}.j-authorities-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 16px}.restriction[_ngcontent-%COMP%]{background:#f2f2f7;border-radius:12px;padding:0 8px;display:inline-block}.restriction--danger[_ngcontent-%COMP%]{background:#ffefef}"]}),t})();var ht=e("tmjD");function gt(t,i){if(1&t&&(a.Wb(0,"th",5),a.Rc(1),a.mc(2,"translate"),a.Vb()),2&t){const t=i.$implicit,e=a.lc();a.Ab(1),a.Sc(a.nc(2,1,e.mapTableHeading(t)))}}function ft(t,i){if(1&t&&(a.Wb(0,"tr"),a.Wb(1,"td"),a.Wb(2,"div",6),a.Rc(3),a.Vb(),a.Wb(4,"div",5),a.Rc(5),a.Vb(),a.Vb(),a.Wb(6,"td"),a.Wb(7,"div",5),a.Rc(8),a.mc(9,"mask"),a.Vb(),a.Vb(),a.Wb(10,"td"),a.Wb(11,"div",5),a.Rc(12),a.Vb(),a.Vb(),a.Vb()),2&t){const t=i.$implicit;a.Ab(3),a.Vc(" ",t.lastname," ",t.firstname?t.firstname[0]+".":""," ",t.middlename?t.middlename[0]+".":""," "),a.Ab(2),a.Tc(" ",t.position," "),a.Ab(3),a.Tc(" ",t.phone?a.oc(9,6,t.phone,"+0 (000) 000 00 00"):"\u2014"," "),a.Ab(4),a.Tc(" ",t.iin||"\u2014"," ")}}let yt=(()=>{class t{constructor(){this.persons=[],this.headings=["USER","IIN","PHONE"]}mapTableHeading(t){return t?this.mapTranslate(`TABLE.${t}`):""}mapTranslate(t){return`AUTHORITIES.USERS.${t}`}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-unregistered"]],inputs:{persons:"persons"},decls:13,vars:8,consts:[[1,"mb-1"],[1,"p3","text-muted"],[1,"j-authorities-table","j-authorities-table--unregistered"],["class","p4 text-muted",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p4","text-muted"],[1,"p2","text-dark"]],template:function(t,i){1&t&&(a.Wb(0,"article"),a.Wb(1,"h6",0),a.Rc(2),a.mc(3,"translate"),a.Vb(),a.Wb(4,"p",1),a.Rc(5),a.mc(6,"translate"),a.Vb(),a.Vb(),a.Wb(7,"table",2),a.Wb(8,"thead"),a.Wb(9,"tr"),a.Pc(10,gt,3,3,"th",3),a.Vb(),a.Vb(),a.Wb(11,"tbody"),a.Pc(12,ft,13,9,"tr",4),a.Vb(),a.Vb()),2&t&&(a.Ab(2),a.Sc(a.nc(3,4,"AUTHORITIES.USERS.UNREGISTERED.TITLE")),a.Ab(3),a.Sc(a.nc(6,6,"AUTHORITIES.USERS.UNREGISTERED.DESCRIPTION")),a.Ab(5),a.sc("ngForOf",i.headings),a.Ab(2),a.sc("ngForOf",i.persons))},directives:[n.t],pipes:[P.d,ht.b],styles:[".j-authorities-table[_ngcontent-%COMP%]{background:#fff;width:100%;border-radius:12px}.j-authorities-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e9ebec}.j-authorities-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.j-authorities-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 16px;font-weight:400}.j-authorities-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 16px}[_nghost-%COMP%]{display:block;margin-top:2.5rem}.j-authorities-table--unregistered[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{opacity:.6}"]}),t})();function Tt(t,i){if(1&t&&a.Rb(0,"j-authorities-registered",1),2&t){const t=a.lc();a.sc("persons",t.registered)}}function At(t,i){if(1&t&&a.Rb(0,"j-authorities-unregistered",1),2&t){const t=a.lc();a.sc("persons",t.unregistered)}}let vt=(()=>{class t{constructor(t){this.companyService=t,this.registered=[],this.unregistered=[],this.subscription=new d.a,this.initAuthoritiesSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}initAuthoritiesSubscription(){this.subscription.add(this.companyService.getAuthorizedPersons().subscribe(t=>{var i;(null===(i=t)||void 0===i?void 0:i.length)>0&&(this.registered=t.filter(t=>!!t.userId),this.unregistered=t.filter(t=>!t.userId))}))}}return t.\u0275fac=function(i){return new(i||t)(a.Qb(m.a))},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities-users"]],decls:2,vars:2,consts:[[3,"persons",4,"ngIf"],[3,"persons"]],template:function(t,i){1&t&&(a.Pc(0,Tt,1,1,"j-authorities-registered",0),a.Pc(1,At,1,1,"j-authorities-unregistered",0)),2&t&&(a.sc("ngIf",(null==i.registered?null:i.registered.length)>0),a.Ab(1),a.sc("ngIf",(null==i.unregistered?null:i.unregistered.length)>0))},directives:[n.u,mt,yt],styles:[""]}),t})();const It=[{path:"",component:(()=>{class t{constructor(){}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=a.Kb({type:t,selectors:[["j-authorities"]],decls:1,vars:0,template:function(t,i){1&t&&a.Rb(0,"router-outlet")},directives:[r.h],styles:[""]}),t})(),data:{title:"SETTINGS.TITLE"},children:[{path:"main",component:tt,children:[{path:"users",component:vt},{path:"order",component:it},{path:"otp",canActivate:[l],component:st},{path:"**",redirectTo:"users"}]},{path:"limits/:id",component:q},{path:"**",redirectTo:"main"}]}];let St=(()=>{class t{}return t.\u0275mod=a.Ob({type:t}),t.\u0275inj=a.Nb({factory:function(i){return new(i||t)},imports:[[r.g.forChild(It)],r.g]}),t})();e.d(i,"AuthoritiesModule",(function(){return Ot}));let Ot=(()=>{class t{}return t.\u0275mod=a.Ob({type:t}),t.\u0275inj=a.Nb({factory:function(i){return new(i||t)},imports:[[n.c,A.n,A.D,s.a,St]]}),t})()}}]);
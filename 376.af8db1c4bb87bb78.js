"use strict";(self.webpackChunkjysan=self.webpackChunkjysan||[]).push([[376],{27376:(mt,J,c)=>{c.r(J),c.d(J,{LettersModule:()=>In});var a=c(69808),T=c(93075),E=c(23918),k=c(81538),U=c(13500),$=c(65832),H=c(91995),X=c(48149),m=c(59516),b=(()=>{return(n=b||(b={})).INBOX="inbox",n.OUTBOX="outbox",n.DRAFTS="drafts",b;var n})(),C=(()=>{return(n=C||(C={})).ON_SIGN="ON_SIGN",n.SENT="SENT",C;var n})(),Z=(()=>{return(n=Z||(Z={})).CERTIFICATE="CERTIFICATE",n.APPLICATION="APPLICATION",Z;var n})();const g=[{id:"919fbae5-ca24-4b3a-9323-a5b0c96a4512",displayName:"\u041f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0435 \u043f\u0438\u0441\u044c\u043c\u043e",description:"\u041f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0435 \u043f\u0438\u0441\u044c\u043c\u043e",type:"APPLICATION"},{id:"d61a02d0-50ea-4867-9c3b-ec318cb569ac",displayName:"\u041e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0435 \u043f\u043e \u0432\u0430\u043b\u044e\u0442\u043d\u044b\u043c \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430\u043c",description:"\u041e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0435 \u043f\u043e \u0432\u043e\u043f\u0440\u043e\u0441\u0443 \u0432\u0430\u043b\u044e\u0442\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430",type:"APPLICATION"},{id:"fba22715-756c-41d7-b100-e29f80ab0ea9",displayName:"\u041d\u0430 \u0432\u044b\u0434\u0430\u0447\u0443 \u043d\u0430\u043b\u0438\u0447\u043d\u044b\u0445 \u0434\u0435\u043d\u0435\u0433",description:"\u0417\u0430\u044f\u0432\u043a\u0430 \u043d\u0430 \u0432\u044b\u0434\u0430\u0447\u0443 \u043d\u0430\u043b\u0438\u0447\u043d\u044b\u0445 \u0434\u0435\u043d\u0435\u0433 \u0432 \u043e\u0442\u0434\u0435\u043b\u0435\u043d\u0438\u0438",type:"APPLICATION"},{id:"fa1be069-e728-4a2f-950f-ec4893dc42ac",displayName:"\u041d\u0430 \u0447\u0430\u0441\u0442\u0438\u0447\u043d\u043e\u0435 \u0438\u0437\u044a\u044f\u0442\u0438\u0435 \u0441 \u0434\u0435\u043f\u043e\u0437\u0438\u0442\u0430",description:"\u0417\u0430\u044f\u0432\u043a\u0430 \u043d\u0430 \u0447\u0430\u0441\u0442\u0438\u0447\u043d\u043e\u0435 \u0438\u0437\u044a\u044f\u0442\u0438\u0435 \u0441 \u0434\u0435\u043f\u043e\u0437\u0438\u0442\u0430",type:"APPLICATION"},{id:"d6d2fb09-6d94-4be1-b75c-f4f3dbfd0d75",displayName:"\u0421\u043c\u0435\u043d\u0430 \u0440\u0443\u043a\u043e\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f, \u0430\u0434\u0440\u0435\u0441\u0430, \u0443\u0447\u0440\u0435\u0434\u0438\u0442\u0435\u043b\u0435\u0439 \u0438 \u0442.\u0434",description:"\u0417\u0430\u044f\u0432\u043a\u0430 \u043d\u0430 \u0441\u043c\u0435\u043d\u0443 \u0440\u0443\u043a\u043e\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f, \u0430\u0434\u0440\u0435\u0441\u0430, \u0443\u0447\u0440\u0435\u0434\u0438\u0442\u0435\u043b\u0435\u0439 \u0438 \u0442.\u0434. \u0441 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c \u0443\u0447\u0440\u0435\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 (\u043f\u0440\u0438\u043a\u0430\u0437\u044b, \u0440\u0435\u0448\u0435\u043d\u0438\u044f, \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430)",type:"APPLICATION"},{id:"4a7c08ee-f640-4feb-a012-15f99084f8a1",displayName:"\u041d\u0430 \u0437\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435 \u0432\u0430\u043b\u044e\u0442\u044b \u043d\u0430 \u0441\u0447\u0435\u0442",description:"\u0417\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u0435 \u043e \u0437\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0438 \u0432\u0430\u043b\u044e\u0442\u044b \u043d\u0430 \u0441\u0447\u0435\u0442",type:"APPLICATION"},{id:"07e410d5-3283-4f8c-902c-6c86e2436677",displayName:"\u041e \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u0441\u0447\u0435\u0442\u0430",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u0441\u0447\u0435\u0442\u0430",type:"CERTIFICATE"},{id:"8295913a-b8ba-472f-af7c-8e12195b8ddf",displayName:"\u041e\u0431 \u043e\u0441\u0442\u0430\u0442\u043a\u0430\u0445 \u043d\u0430 \u0441\u0447\u0435\u0442\u0435",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e\u0431 \u043e\u0441\u0442\u0430\u0442\u043a\u0430\u0445 \u043d\u0430 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u043c \u0441\u0447\u0435\u0442\u0435",type:"CERTIFICATE"},{id:"a66d0329-8956-4bce-89ee-bdc9e3571349",displayName:"\u041e\u0431 \u043e\u0431\u043e\u0440\u043e\u0442\u0430\u0445 \u043d\u0430 \u0441\u0447\u0435\u0442\u0435",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e\u0431 \u043e\u0431\u043e\u0440\u043e\u0442\u0430\u0445 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u0441\u0447\u0435\u0442\u0430",type:"CERTIFICATE"},{id:"affb46a1-2012-47d2-9222-96b12603771c",displayName:"\u041e \u0440\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u0430\u0445 \u0441\u0447\u0435\u0442\u0430",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e \u0440\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u0430\u0445 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u0441\u0447\u0435\u0442\u0430",type:"CERTIFICATE"},{id:"48e07781-bc49-4e04-b24c-3136366b913f",displayName:"\u0414\u043b\u044f \u0430\u0443\u0434\u0438\u0442\u043e\u0440\u0441\u043a\u0438\u0445 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0439",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u043b\u044f \u0430\u0443\u0434\u0438\u0442\u043e\u0440\u0441\u043a\u0438\u0445 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0439",type:"CERTIFICATE"},{id:"903dabe2-5b6a-405a-93ab-5df77f8c1b7f",displayName:"\u0414\u043b\u044f \u0443\u0447\u0430\u0441\u0442\u0438\u044f \u0432 \u0442\u0435\u043d\u0434\u0435\u0440\u0435",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u043b\u044f \u0443\u0447\u0430\u0441\u0442\u0438\u044f \u0432 \u0442\u0435\u043d\u0434\u0435\u0440\u0435",type:"CERTIFICATE"},{id:"34ce1113-6f15-4f64-92af-fc97db0599be",displayName:"\u041e\u0431 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0438 \u043f\u0440\u043e\u0441\u0440\u043e\u0447\u0435\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u043e\u043b\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e\u0431 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0438 \u043f\u0440\u043e\u0441\u0440\u043e\u0447\u0435\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u043e\u043b\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438",type:"CERTIFICATE"},{id:"e4da4358-f6fe-42dc-8099-07026932f2cf",displayName:"\u041e \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0445 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u0439 3-\u0438\u0445 \u043b\u0438\u0446",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0445 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u0439 3-\u0438\u0445 \u043b\u0438\u0446 (\u0415\u041a\u041e)",type:"CERTIFICATE"}];var f=(()=>{return(n=f||(f={})).ACCOUNT_AVAILABILITY="ACCOUNT_AVAILABILITY",n.ACCOUNT_BALANCES="ACCOUNT_BALANCES",n.ACCOUNT_DETAILS="ACCOUNT_DETAILS",n.ACCOUNT_TURNOVER="ACCOUNT_TURNOVER",f;var n})(),o=c(41777),t=c(5e3),p=c(70655),d=c(40520),x=c(591),M=c(71764),v=c.n(M),q=c(12266),F=c(26164),Q=c(9661),et=c(82524),ft=c(82499),S=c(89854);let A=(()=>{class n{constructor(e,i,s,l,u){this.companyService=e,this.filesService=i,this.apiService=s,this.listService=l,this.translateService=u,this.files=[],this.lastLettersListPath$=new x.X("outbox"),this.retrieveTopics()}clearFiles(){this.files=[],this.filesService.uploading$.next([])}onFileDrop(e){const i=[];for(const s of e)i.push(s);i.length>0&&(this.files=[...i],this.filesService.uploading$.next(this.files))}mapLetterDate(e){const i=e.created,s=v()().isSame(i,"day"),l=v()().subtract(1,"date").isSame(i,"day"),u=v()(i).format("HH:mm");if(s)return{key:"LETTERS.DATE.TODAY",params:{time:u}};if(l)return{key:"LETTERS.DATE.YESTERDAY",params:{time:u}};{const _=v()().isSame(i,"year")?"d MMMM HH:mm":"d MMMM yyyy HH:mm";return(0,a.p6)(i,_,this.translateService.currentLang)}}getById(e){const i=this.mapUrl(`/${e}`);return this.apiService.get(i)}getLetterSignatures(e){const i=this.mapUrl(`/${e}/signatures`);return this.apiService.get(i)}sign(e){return this.listService.sign("letters",e)}getList(e={}){return(0,p.mG)(this,void 0,void 0,function*(){const i=this.mapUrl();let s=new d.LE;for(const _ in e)if(Object.prototype.hasOwnProperty.call(e,_)){let h=e[_];h&&(("dateFrom"==_||"dateTo"==_)&&(h=(0,q.Vd)(h)),s=s.append(_,h))}const u=yield this.apiService.get(i,null,s,{observe:"response"});return{items:u.body,totalCount:+u.headers.get("X-Total-Count")}})}retrieveTopics(){return(0,p.mG)(this,void 0,void 0,function*(){const e=this.mapUrl("/topics");let i;try{i=yield this.apiService.get(e)}catch(s){i=g}return this.cashedTopics=i,this.cashedTopics})}getTopics(e){return(0,p.mG)(this,void 0,void 0,function*(){return this.cashedTopics||(this.cashedTopics=yield this.retrieveTopics()),this.filterTopicsByType(e)})}getTopicValues(){return(0,p.mG)(this,void 0,void 0,function*(){return this.cashedTopics||(this.cashedTopics=yield this.retrieveTopics()),this.mapTopicValues()})}edit(e){const i=this.mapUrl(`/${e.id}`);return this.apiService.put(i,e)}create(e){const i=this.mapUrl();return this.apiService.post(i,e)}sendToSign(e){const i=Array.isArray(e),s=this.mapUrl(i?":on-sign":`/${e}:on-sign`);return this.apiService.patch(s,i?{itemIds:e}:null)}filterTopicsByType(e){return this.cashedTopics.filter(i=>i.type===e)}mapTopicValues(){return this.cashedTopics.map(e=>e.displayName)}mapUrl(e=""){return`companies/${this.companyService.currentId}/letters${e}`}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(F.J),t.LFG(Q.nS),t.LFG(et.sM),t.LFG(ft.X),t.LFG(S.sK))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),nt=(()=>{class n{constructor(e,i){this.apiService=e,this.companyService=i,this.cashedCertificateTypes$=new x.X([]),this.retrieveCertificateTypes()}getCertificate(e,i=null){return(0,p.mG)(this,void 0,void 0,function*(){try{const s=this.mapUrl(),l={certificateTypeCode:e,params:i};return yield this.apiService.post(s,l,null,null,{responseType:"blob"})}catch(s){const l=new FileReader,u=new Promise(_=>{l.onloadend=()=>{_(JSON.parse(l.result))}});throw l.readAsText(s.error),u}})}getCertificateTypes(){return this.cashedCertificateTypes$.asObservable()}retrieveCertificateTypes(){return(0,p.mG)(this,void 0,void 0,function*(){const e=this.mapUrl("/types");let i;try{i=yield this.apiService.get(e)}catch(s){i=[]}return this.cashedCertificateTypes$.next(i),i})}mapUrl(e=""){return`companies/${this.companyService.currentId}/certificates${e}`}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(et.sM),t.LFG(F.J))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var D=c(69544),Tt=c(54507),Ct=c(68221),St=c(37074),bt=c(25021),vt=c(89584);function xt(n,r){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.dateText," ")}}function Lt(n,r){if(1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,e.date.key,e.date.params)," ")}}function yt(n,r){if(1&n&&(t.TgZ(0,"div",10),t.YNc(1,xt,2,1,"ng-container",11),t.YNc(2,Lt,3,4,"ng-container",11),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.dateText),t.xp6(1),t.Q6J("ngIf",e.date)}}function Et(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",14),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(3).onFileClick(l)}),t._UZ(1,"span",15),t.TgZ(2,"div",16),t._uU(3),t.qZA()()}if(2&n){const e=r.$implicit;t.xp6(3),t.hij(" ",null==e?null:e.name," ")}}function Ot(n,r){if(1&n&&(t.ynx(0),t.YNc(1,Et,4,1,"button",13),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.letter.files)}}const Ft=function(){return{height:"32px","background-color":"#ECEEF1"}};function At(n,r){1&n&&t._UZ(0,"ngx-skeleton-loader",17),2&n&&t.Q6J("theme",t.DdM(1,Ft))}function Nt(n,r){if(1&n&&(t.YNc(0,Ot,2,1,"ng-container",11),t.YNc(1,At,1,2,"ngx-skeleton-loader",12)),2&n){const e=t.oxw();t.Q6J("ngIf",!e.isFilesLoading),t.xp6(1),t.Q6J("ngIf",e.isFilesLoading)}}function wt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",19)(1,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).onReply()}),t._uU(2),t.ALo(3,"translate"),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(2),t.hij(" ",t.lcZ(3,1,e.mapTranslate("REPLY"))," ")}}function Dt(n,r){if(1&n&&t.YNc(0,wt,4,3,"div",18),2&n){const e=t.oxw();t.Q6J("ngIf",e.letter.incoming)}}function It(n,r){if(1&n&&(t.TgZ(0,"div",27)(1,"div",28),t._uU(2),t.qZA(),t.TgZ(3,"div",29),t._uU(4),t.qZA()()),2&n){const e=r.$implicit;t.xp6(2),t.Oqu(e.name),t.xp6(1),t.Tol(e.classList),t.xp6(1),t.Oqu(e.label)}}function Zt(n,r){if(1&n&&(t.TgZ(0,"section",4)(1,"j-collapsible")(2,"j-collapsible-trigger")(3,"div",22)(4,"h5",23),t._uU(5),t.ALo(6,"translate"),t.qZA(),t._UZ(7,"j-icon",24),t.qZA()(),t.TgZ(8,"j-collapsible-body")(9,"div",25),t.YNc(10,It,5,4,"div",26),t.qZA()()()()),2&n){const e=t.oxw(2);t.xp6(5),t.hij(" ",t.lcZ(6,3,e.mapTranslate("SIGNERS"))," "),t.xp6(2),t.Q6J("isStroke",!0),t.xp6(3),t.Q6J("ngForOf",e.signers)}}function Mt(n,r){if(1&n&&t.YNc(0,Zt,11,5,"section",21),2&n){const e=t.oxw();t.Q6J("ngIf",(null==e.signers?null:e.signers.length)>0)}}let Pt=(()=>{class n{constructor(e,i,s,l){this.router=e,this.lettersService=i,this.filesService=s,this.companyService=l,this.closed=new t.vpe,this.isFilesLoading=!0}ngOnInit(){this.mapDateText(),this.loadAttachments()}onClose(){this.closed.emit()}onFileClick(e){this.filesService.downloadFileById(e.id,e.name)}onReply(){this.router.navigate(["/letters/create"],{state:{title:this.mapTranslate("TITLE")}})}mapTranslate(e){return`LETTERS.DETAILS.${e}`}loadAttachments(){return(0,p.mG)(this,void 0,void 0,function*(){this.isFilesLoading=!0;try{const e=yield this.lettersService.getById(this.letter.id);this.letter=Object.assign(Object.assign({},this.letter),e),this.loadSignatures()}catch(e){}finally{this.isFilesLoading=!1}})}loadSignatures(){return(0,p.mG)(this,void 0,void 0,function*(){this.letter.incoming||(this.signers=this.companyService.generateSignersList(this.letter.statusCode,this.letter.signatureScheme,this.letter.signatures))})}mapDateText(){const e=this.lettersService.mapLetterDate(this.letter);"string"==typeof e?this.dateText=e:this.date=e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.F0),t.Y36(A),t.Y36(Q.nS),t.Y36(F.J))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-details-content"]],inputs:{letter:"letter"},outputs:{closed:"closed"},decls:20,vars:8,consts:[[1,"letter-details"],[1,"letter-details__header"],[3,"ngTemplateOutlet"],["inlineSVG","/assets/icons/letters/close.svg",1,"letter-details__close",3,"click"],[1,"letter-details__body"],[1,"p2",3,"innerHtml"],["dateTemplate",""],["filesTemplate",""],["actionsTemplate",""],["signersTemplate",""],[1,"text-muted","p3"],[4,"ngIf"],["count","5",3,"theme",4,"ngIf"],["class","letter-details__file",3,"click",4,"ngFor","ngForOf"],[1,"letter-details__file",3,"click"],["inlineSVG","/assets/icons/contracts/file.svg",1,"mr-3"],[1,"text-truncate","p2"],["count","5",3,"theme"],["class","letter-details__actions",4,"ngIf"],[1,"letter-details__actions"],[1,"btn","btn-primary","btn-block",3,"click"],["class","letter-details__body",4,"ngIf"],[1,"letter-details__collapse"],[1,"m-0"],["name","arrowUp",1,"ml-auto","details__arrow",3,"isStroke"],[1,"letter-details__signers","p2"],["class","j-desc-row letter-details__signer",4,"ngFor","ngForOf"],[1,"j-desc-row","letter-details__signer"],[1,"text-dark","j-desc-child"],["translate","",1,"text-muted","j-desc-child"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.GkF(2,2),t.TgZ(3,"button",3),t.NdJ("click",function(){return i.onClose()}),t.qZA()(),t.TgZ(4,"article",4)(5,"h6"),t._uU(6),t.qZA(),t._UZ(7,"p",5),t.ALo(8,"linkifyPipe"),t.GkF(9,2)(10,2),t.qZA(),t.GkF(11,2),t.qZA(),t.YNc(12,yt,3,2,"ng-template",null,6,t.W1O),t.YNc(14,Nt,2,2,"ng-template",null,7,t.W1O),t.YNc(16,Dt,1,1,"ng-template",null,8,t.W1O),t.YNc(18,Mt,1,1,"ng-template",null,9,t.W1O)),2&e){const s=t.MAs(13),l=t.MAs(15),u=t.MAs(17),_=t.MAs(19);t.xp6(2),t.Q6J("ngTemplateOutlet",s),t.xp6(4),t.Oqu(i.letter.title),t.xp6(1),t.Q6J("innerHtml",t.lcZ(8,6,i.letter.body),t.oJD),t.xp6(2),t.Q6J("ngTemplateOutlet",l),t.xp6(1),t.Q6J("ngTemplateOutlet",u),t.xp6(1),t.Q6J("ngTemplateOutlet",_)}},directives:[a.tP,D.d$,a.O5,a.sg,E.xr,Tt.t,Ct.k,St.o,bt.p,S.Pi],pipes:[vt.K,S.X$],styles:[".letter-details__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.letter-details__close[_ngcontent-%COMP%]{display:inline-block;font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;color:#666c72;transition:all .2s ease-in-out}.letter-details__close[_ngcontent-%COMP%]:hover{color:#ef5630}.letter-details__body[_ngcontent-%COMP%]{margin-top:1.5rem;background:#fff;overflow:hidden;padding:1.5rem 1rem;border-radius:12px}.letter-details__body[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{word-break:break-word}.letter-details__body[_ngcontent-%COMP%]   .p2[_ngcontent-%COMP%]{white-space:pre-line;word-break:break-word}.letter-details__file[_ngcontent-%COMP%]{display:inline-block;font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;width:100%;padding:0;display:flex;align-items:center;transition:all .2s ease-in-out;color:#1586bb}.letter-details__file[_ngcontent-%COMP%]:hover{color:#ef5630}.letter-details__file[_ngcontent-%COMP%] + .letter-details__file[_ngcontent-%COMP%]{margin-top:1.5rem}.letter-details__actions[_ngcontent-%COMP%]{margin-top:2.5rem}.letter-details__trigger[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}.letter-details__signers[_ngcontent-%COMP%]{padding-top:1rem}.letter-details__collapse[_ngcontent-%COMP%]{align-items:center;cursor:pointer;display:flex;justify-content:space-between}.letter-details__signer[_ngcontent-%COMP%]{grid-template-columns:1fr 100px}"]}),n})();var N=c(42654),Y=c(36053),z=c(5157),W=c(40703),jt=c(70542);let Qt=(()=>{class n{constructor(e){this.modal=e}onClose(){this.modal.dismiss()}onSubmit(e){this.modal.close(e)}ngOnInit(){}mapTranslate(e){return`LETTERS.CERTIFICATES.MODAL.${e}`}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(W.Kz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-certificates-modal"]],decls:5,vars:5,consts:[[1,"modal-body","px-4","pt-4","pb-0"],[3,"hideBorders","submitLabel","closed","submitted"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h5"),t._uU(2),t.ALo(3,"translate"),t.qZA()(),t.TgZ(4,"j-range-input",1),t.NdJ("closed",function(){return i.onClose()})("submitted",function(l){return i.onSubmit(l)}),t.qZA()),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,3,i.mapTranslate("TITLE"))),t.xp6(2),t.Q6J("hideBorders",!0)("submitLabel",i.mapTranslate("SUBMIT")))},directives:[jt.u],pipes:[S.X$],styles:[""]}),n})();var Yt=c(76759),it=c(66013),Bt=c(70853);const Gt=["accountDropdown"];function kt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(2).onTypeSelect(l)}),t._UZ(1,"span",6),t.TgZ(2,"span"),t._uU(3),t.qZA()()}if(2&n){const e=r.$implicit;t.xp6(3),t.Oqu(e.description)}}function Ut(n,r){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,kt,4,1,"button",4),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.types)}}const $t=function(){return{height:"138.06px","background-color":"#ECEEF1"}};function Ht(n,r){1&n&&(t.ynx(0),t._UZ(1,"ngx-skeleton-loader",7),t.BQk()),2&n&&(t.xp6(1),t.Q6J("theme",t.DdM(1,$t)))}const Vt={backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",backdrop:"static",centered:!0};let qt=(()=>{class n{constructor(e,i,s,l,u,_,h){this.companyService=e,this.certificatesService=i,this.accountsService=s,this.filesService=l,this.notifierService=u,this.translateService=_,this.modalService=h,this.isLoading=!0,(0,Y.aj)([this.accountsService.getAccountsList(),this.certificatesService.getCertificateTypes()]).subscribe(y=>{const[w,O]=y;this.mapAccounts(w),this.types=O,this.isLoading=!1})}ngOnInit(){}mapTranslate(e){return`LETTERS.CERTIFICATES.${e}`}onTypeSelect(e){return(0,p.mG)(this,void 0,void 0,function*(){e.code===f.ACCOUNT_TURNOVER?this.showSertificatesModal(e):this.downloadCertificate(e,this.params)})}onAccountSelect(e){this.params=e.accountType===z.Q5.ALL?null:{iban:e.iban}}showSertificatesModal(e){return(0,p.mG)(this,void 0,void 0,function*(){const i=this.modalService.open(Qt,Vt);try{const s=yield i.result;this.downloadCertificate(e,Object.assign(Object.assign({},this.params),{dateFrom:(0,q.Vd)(s.from),dateTo:(0,q.Vd)(s.to)}))}catch(s){}})}downloadCertificate(e,i=null){return(0,p.mG)(this,void 0,void 0,function*(){try{const s=yield this.certificatesService.getCertificate(e.code,i);this.filesService.downloadFile(s,`${e.description} - ${this.companyService.currentCompany.name}.pdf`)}catch(s){this.mapError(s)}})}mapError(e){return(0,p.mG)(this,void 0,void 0,function*(){const i=yield e,s=i.description||i.code||this.translateService.instant(this.mapTranslate("ERROR"));this.notifierService.notify("error",s)})}mapAccounts(e){const i=e.filter(s=>s.accountType===z.Q5.ACCOUNT);this.accounts=i.length>1?[...i,{accountType:z.Q5.ALL}]:i,setTimeout(()=>{this.accountDropdown.selectAccount(this.accounts[this.accounts.length-1])},0)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(F.J),t.Y36(nt),t.Y36(Yt.i),t.Y36(Q.nS),t.Y36(it.lG),t.Y36(S.sK),t.Y36(W.FF))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-certificates"]],viewQuery:function(e,i){if(1&e&&t.Gf(Gt,5),2&e){let s;t.iGM(s=t.CRH())&&(i.accountDropdown=s.first)}},decls:8,vars:9,consts:[[1,"letters-create-group"],[3,"isLoading","accounts","isDisabledSelectable","label","selected"],["accountDropdown",""],[4,"ngIf"],["class","letters-certificate__button p2",3,"click",4,"ngFor","ngForOf"],[1,"letters-certificate__button","p2",3,"click"],["inlineSVG","/assets/icons/v2/file-24.svg",1,"d-inline-block","mr-3"],[3,"theme"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"h6"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"j-account-dropdown",1,2),t.NdJ("selected",function(l){return i.onAccountSelect(l)}),t.qZA(),t.YNc(6,Ut,2,1,"div",3),t.YNc(7,Ht,2,2,"ng-container",3),t.qZA()),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,7,i.mapTranslate("TITLE"))),t.xp6(2),t.Q6J("isLoading",i.isLoading)("accounts",i.accounts)("isDisabledSelectable",!0)("label",i.mapTranslate("ACCOUNTS_DROPDOWN")),t.xp6(2),t.Q6J("ngIf",!i.isLoading),t.xp6(1),t.Q6J("ngIf",i.isLoading))},directives:[Bt.S,a.O5,a.sg,D.d$,E.xr],pipes:[S.X$],styles:["[_nghost-%COMP%]{display:block}.letters-create-group[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;padding:1.25rem 1rem}.letters-create-group[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-bottom:1rem}.letters-certificate__button[_ngcontent-%COMP%]{display:inline-block;font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;padding:0;display:flex;color:#1586bb;align-items:center;transition:all .2s ease-in-out}.letters-certificate__button[_ngcontent-%COMP%]:hover{color:#ef5630}.letters-certificate__button[_ngcontent-%COMP%] + .letters-certificate__button[_ngcontent-%COMP%]{margin-top:1rem}"]}),n})();function zt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",3),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(2).onLinkSelect(l)}),t.TgZ(1,"span"),t._uU(2),t.qZA(),t._UZ(3,"span",4),t.qZA()}if(2&n){const e=r.$implicit;t.xp6(2),t.Oqu(e.displayName)}}function Wt(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"div",1)(2,"h6"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.YNc(5,zt,4,1,"button",2),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,2,e.mapTranslate(e.topicType))),t.xp6(2),t.Q6J("ngForOf",e.topics)}}const Kt=function(){return{height:"450px","background-color":"#ECEEF1"}};function te(n,r){1&n&&(t.ynx(0),t._UZ(1,"ngx-skeleton-loader",5),t.BQk()),2&n&&(t.xp6(1),t.Q6J("theme",t.DdM(1,Kt)))}let ne=(()=>{class n{constructor(e,i){this.lettersService=e,this.router=i,this.isLoading=!0}ngOnInit(){this.loadTopics()}mapTranslate(e){return`LETTERS.CREATE_CONTENT.${e}`}onLinkSelect(e){this.router.navigate(["/letters/create"],{state:{title:e.displayName}})}loadTopics(){return(0,p.mG)(this,void 0,void 0,function*(){try{this.topics=yield this.lettersService.getTopics(this.topicType)}catch(e){}finally{this.isLoading=!1}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A),t.Y36(m.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-create-group"]],inputs:{topicType:"topicType"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"letters-create-group"],["class","letters-create-group__button p2",3,"click",4,"ngFor","ngForOf"],[1,"letters-create-group__button","p2",3,"click"],["inlineSVG","/assets/icons/letters/next.svg",1,"d-inline-block","ml-3"],[3,"theme"]],template:function(e,i){1&e&&(t.YNc(0,Wt,6,4,"ng-container",0),t.YNc(1,te,2,2,"ng-container",0)),2&e&&(t.Q6J("ngIf",!i.isLoading),t.xp6(1),t.Q6J("ngIf",i.isLoading))},directives:[a.O5,a.sg,D.d$,E.xr],pipes:[S.X$],styles:["[_nghost-%COMP%]{display:block}.letters-create-group[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;padding:1.25rem 1rem}.letters-create-group[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-bottom:1rem}.letters-create-group__button[_ngcontent-%COMP%]{display:inline-block;font-weight:400;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;display:flex;padding:0;text-align:left;width:100%;align-items:baseline;justify-content:space-between;color:#1a1c1f;transition:all .2s ease-in-out}.letters-create-group__button[_ngcontent-%COMP%]:hover{color:#ef5630}.letters-create-group__button[_ngcontent-%COMP%] + .letters-create-group__button[_ngcontent-%COMP%]{margin-top:1rem}"]}),n})();function ie(n,r){1&n&&t._UZ(0,"j-letters-certificates")}let re=(()=>{class n{constructor(e){this.certificatesService=e,this.closed=new t.vpe,this.LETTER_TOPIC_TYPE=Z,this.subscription=new N.w,this.isCertificatesShown=!1;const i=this.certificatesService.getCertificateTypes().subscribe(s=>{this.isCertificatesShown=(null==s?void 0:s.length)>0});this.subscription.add(i)}ngOnDestroy(){this.subscription.unsubscribe()}mapTranslate(e){return`LETTERS.CREATE_CONTENT.${e}`}onClose(){this.closed.emit()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(nt))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-create-content"]],outputs:{closed:"closed"},decls:10,vars:6,consts:[[1,"letters-create-content"],[1,"letters-create-content__header"],[1,"m-0"],["inlineSVG","/assets/icons/letters/close.svg",1,"letters-create-content__close",3,"click"],[1,"letters-create-content__body"],[4,"ngIf"],[1,"mt-3",3,"topicType"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5",2),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",3),t.NdJ("click",function(){return i.onClose()}),t.qZA()(),t.TgZ(6,"div",4),t.YNc(7,ie,1,0,"j-letters-certificates",5),t._UZ(8,"j-letters-create-group",6)(9,"j-letters-create-group",6),t.qZA()()),2&e&&(t.xp6(3),t.Oqu(t.lcZ(4,4,i.mapTranslate("TITLE"))),t.xp6(4),t.Q6J("ngIf",i.isCertificatesShown),t.xp6(1),t.Q6J("topicType",i.LETTER_TOPIC_TYPE.CERTIFICATE),t.xp6(1),t.Q6J("topicType",i.LETTER_TOPIC_TYPE.APPLICATION))},directives:[D.d$,a.O5,qt,ne],pipes:[S.X$],styles:["[_nghost-%COMP%]{margin:-1rem;display:block}.letters-create-content__close[_ngcontent-%COMP%]{display:inline-block;font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;color:#666c72;transition:all .2s ease-in-out}.letters-create-content__close[_ngcontent-%COMP%]:hover{color:#ef5630}.letters-create-content__header[_ngcontent-%COMP%]{background-color:#fff;padding:1.5rem;display:flex;align-items:center;justify-content:space-between}.letters-create-content__body[_ngcontent-%COMP%]{padding:1.5rem}"]}),n})();function oe(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"j-letters-details-content",5),t.NdJ("closed",function(){return t.CHM(e),t.oxw().hideAside()}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("letter",e.letter)}}function ae(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"j-letters-create-content",6),t.NdJ("closed",function(){return t.CHM(e),t.oxw().hideAside()}),t.qZA()}}const K="overflow-hidden";let st=(()=>{class n{constructor(e){this.document=e,this.isContentShown=!1,this.isDetailsShowing=!1,this.isCreateShowing=!1,this.closed=new t.vpe}ngOnDestroy(){this.document.body.classList.remove(K)}showDetails(e){this.isDetailsShowing=!0,this.isCreateShowing=!1,this.letter=e,this.showContent()}showCreate(){this.isCreateShowing=!0,this.isDetailsShowing=!1,this.showContent()}hideAside(){this.letter=null,this.isCreateShowing=!1,this.isDetailsShowing=!1,this.document.body.classList.remove(K),this.isContentShown=!1,this.closed.emit()}showContent(){this.document.body.classList.add(K),this.isContentShown=!0}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(a.K0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-aside"]],outputs:{closed:"closed"},decls:5,vars:4,consts:[[1,"f-page-wrapper","is-shown"],[1,"f-page-backdrop",3,"click"],[1,"f-page-content","f-page-content--gray","f-page-content--quarter","is-shown","letters-aside"],[3,"letter","closed",4,"ngIf"],[3,"closed",4,"ngIf"],[3,"letter","closed"],[3,"closed"]],template:function(e,i){1&e&&(t.TgZ(0,"section",0)(1,"div",1),t.NdJ("click",function(){return i.hideAside()}),t.qZA(),t.TgZ(2,"section",2),t.YNc(3,oe,1,1,"j-letters-details-content",3),t.YNc(4,ae,1,0,"j-letters-create-content",4),t.qZA()()),2&e&&(t.Q6J("@wrapper",i.isContentShown?"shown":"hidden"),t.xp6(2),t.Q6J("@content",i.isContentShown?"shown":"hidden"),t.xp6(1),t.Q6J("ngIf",i.isDetailsShowing),t.xp6(1),t.Q6J("ngIf",i.isCreateShowing))},directives:[a.O5,Pt,re],styles:[".letters-aside[_ngcontent-%COMP%]{padding:1rem;top:62px}@media (min-width: 960px){.letters-aside[_ngcontent-%COMP%]{top:98px}}@media (min-width: 1280px){.letters-aside[_ngcontent-%COMP%]{top:0}}"],data:{animation:[(0,o.X$)("wrapper",[(0,o.SB)("shown",(0,o.oB)({transform:"scale(1)",visibility:"visible",opacity:"1"})),(0,o.SB)("hidden",(0,o.oB)({transform:"scale(0.9)",visibility:"hidden",opacity:"0"})),(0,o.eR)("shown<=>hidden",(0,o.jt)("250ms"))]),(0,o.X$)("content",[(0,o.SB)("shown",(0,o.oB)({right:"0%"})),(0,o.SB)("hidden",(0,o.oB)({right:"-25%"})),(0,o.eR)("shown<=>hidden",(0,o.jt)("500ms ease-in-out"))])]}}),n})();var le=c(31872),ce=c(79311),pe=c(94114),de=c(61459),rt=c(24850),I=c(41959),ge=c(81522),ue=c(50235),_e=c(48622),ot=c(85814);function he(n,r){if(1&n&&(t.ynx(0),t.TgZ(1,"form",5),t.GkF(2,6)(3,6)(4,6)(5,6),t.qZA(),t.BQk()),2&n){const e=t.oxw(),i=t.MAs(3),s=t.MAs(5),l=t.MAs(7),u=t.MAs(9);t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngTemplateOutlet",s),t.xp6(1),t.Q6J("ngTemplateOutlet",l),t.xp6(1),t.Q6J("ngTemplateOutlet",u)}}const at=function(){return{height:"56px","background-color":"#ECEEF1"}},me=function(){return{height:"335px","background-color":"#ECEEF1"}},fe=function(){return{"margin-bottom":"50px",width:"50%",height:"32px","background-color":"#ECEEF1"}};function Te(n,r){if(1&n&&(t.TgZ(0,"div"),t._UZ(1,"ngx-skeleton-loader",7)(2,"ngx-skeleton-loader",7)(3,"ngx-skeleton-loader",7),t.GkF(4,6),t.TgZ(5,"div",8),t._UZ(6,"ngx-skeleton-loader",7),t.qZA()()),2&n){t.oxw();const e=t.MAs(7);t.xp6(1),t.Q6J("theme",t.DdM(5,at)),t.xp6(1),t.Q6J("theme",t.DdM(6,me)),t.xp6(1),t.Q6J("theme",t.DdM(7,fe)),t.xp6(1),t.Q6J("ngTemplateOutlet",e),t.xp6(2),t.Q6J("theme",t.DdM(8,at))}}function Ce(n,r){if(1&n&&(t.TgZ(0,"span",14),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.hij(" ",e," ")}}function Se(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",9)(1,"j-dropdown-input",10,11),t.NdJ("selected",function(s){return t.CHM(e),t.oxw().onTitleSelect(s)}),t.YNc(3,Ce,2,1,"ng-template",null,12,t.W1O),t.qZA()(),t.TgZ(5,"div",9),t._UZ(6,"j-input",13),t.ALo(7,"async"),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("options",e.topics)("hasError",e.f.title.invalid&&e.isSubmitted)("selectedItem",e.f.title.value)("label",e.mapTranslate("TITLE")),t.xp6(5),t.Q6J("label",e.mapTranslate("BODY"))("inputExtra",t.lcZ(7,11,e.bodyLengthMessage$))("formControl",e.f.body)("hasError",e.f.body.invalid&&e.isSubmitted)("errorText",e.mapBodyErrors())("maxLength",e.bodyMaxLength)("isClearable",!1)}}function be(n,r){if(1&n&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,e.mapTranslate("MAX_FILES_REACHED"))," ")}}const ve=function(n){return{acceptedFormats:n}};function xe(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",15)(1,"div",16)(2,"input",17),t.NdJ("change",function(s){return t.CHM(e),t.oxw().onAddFile(s)}),t.qZA(),t.TgZ(3,"label",18),t._UZ(4,"span",19),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"span",20),t._uU(9),t.ALo(10,"translate"),t.qZA()(),t.TgZ(11,"j-uploading-files",21),t.NdJ("updated",function(s){return t.CHM(e),t.oxw().onUploadingFilesUpdate(s)}),t.qZA(),t.YNc(12,be,3,3,"div",22),t.qZA()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("formControl",e.f.uploadModel)("accept",e.acceptedFormats),t.xp6(4),t.hij(" ",t.lcZ(7,9,e.mapTranslate("ADD_FILE"))," "),t.xp6(3),t.hij(" ",t.xi3(10,11,e.mapTranslate("ADD_FILE_DESCRIPTION"),t.VKq(14,ve,e.acceptedFormats))," "),t.xp6(2),t.Q6J("isLoading",e.isLoading)("acceptedFormats",e.acceptedFormats)("uploadingFiles",e.uploadingFiles)("maxSize",e.maxSize),t.xp6(1),t.Q6J("ngIf",(null==e.uploadingFiles?null:e.uploadingFiles.length)>10)}}function Le(n,r){if(1&n&&(t.TgZ(0,"div",24),t._UZ(1,"span",25),t.TgZ(2,"span"),t._uU(3),t.ALo(4,"translate"),t.qZA()()),2&n){const e=t.oxw();t.xp6(3),t.hij(" ",t.lcZ(4,1,e.mapTranslate("INFO"))," ")}}function ye(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",27),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).edit()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("jLoadingInverted",!0)("disabled",e.isSubmitting||(null==e.uploadingFiles?null:e.uploadingFiles.length)>10)("jLoading",e.isSubmitting),t.xp6(1),t.hij(" ",t.lcZ(3,4,e.mapTranslate("SAVE_EDITING"))," ")}}function Ee(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",28),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).saveToDraft()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("disabled",e.isSubmitting||(null==e.uploadingFiles?null:e.uploadingFiles.length)>10)("jLoading",e.isSubmitting)("jLoadingInverted",!0),t.xp6(1),t.hij(" ",t.lcZ(3,4,e.mapTranslate("SAVE_TO_DRAFT"))," ")}}function Oe(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",29),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).createAndSign()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("disabled",e.isSubmitting||(null==e.uploadingFiles?null:e.uploadingFiles.length)>10)("jLoading",e.isSubmitting),t.xp6(1),t.hij(" ",t.lcZ(3,3,e.mapTranslate(e.createAndSignLabel))," ")}}function Fe(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",29),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).createAndSendForSign()}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.BQk()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("disabled",e.isSubmitting||(null==e.uploadingFiles?null:e.uploadingFiles.length)>10)("jLoading",e.isSubmitting),t.xp6(1),t.hij(" ",t.lcZ(3,3,e.mapTranslate("CREATE_AND_SEND_FOR_SIGN"))," ")}}function Ae(n,r){if(1&n&&(t.TgZ(0,"div",26),t.YNc(1,ye,4,6,"ng-container",0),t.YNc(2,Ee,4,6,"ng-container",0),t.YNc(3,Oe,4,5,"ng-container",0),t.YNc(4,Fe,4,5,"ng-container",0),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.isEditing),t.xp6(1),t.Q6J("ngIf",!e.isEditing),t.xp6(1),t.Q6J("ngIf",e.canSendAndSign),t.xp6(1),t.Q6J("ngIf",e.canSendOnly)}}var L=(()=>{return(n=L||(L={})).SAVED_TO_DRAFT="NOTIFICATIONS.SAVED_TO_DRAFT",n.SENT_FOR_SIGN="NOTIFICATIONS.SENT_FOR_SIGN",n.SAVED_EDITING="NOTIFICATIONS.SAVED_EDITING",n.SIGNED="NOTIFICATIONS.SIGNED",n.SAVED_TO_DRAFT_ERROR="NOTIFICATIONS.SAVED_TO_DRAFT_ERROR",n.SENT_FOR_SIGN_ERROR="NOTIFICATIONS.SENT_FOR_SIGN_ERROR",n.SAVED_EDITING_ERROR="NOTIFICATIONS.SAVED_EDITING_ERROR",n.SIGNED_ERROR="NOTIFICATIONS.SIGNED_ERROR",L;var n})();let De=(()=>{class n{constructor(e,i,s,l,u,_,h){this.route=e,this.router=i,this.lettersService=s,this.companyService=l,this.filesService=u,this.notifierService=_,this.translateService=h,this.acceptedFormats=".doc, .docx, .pdf, .jpg, .jpeg, .png, .xls, .xlsx",this.maxSize=5e6,this.isSubmitted=!1,this.isLoading=!1,this.isSubmitting=!1,this.isEditing=!1,this.uploadingFiles=[],this.bodyMaxLength=1e4,this.bodyLengthMessage$=new x.X(`0/${this.bodyMaxLength}`),this.subscription=new N.w;const y=(0,Y.aj)([this.route.paramMap.pipe((0,rt.U)(()=>window.history.state)),this.route.params]).subscribe(w=>{const[O,G]=w;O.letter?(this.isEditing=!0,this.loadEditLetterByBody(O.letter,O.topics,O.files)):G.id?(this.isEditing=!0,this.loadEditLetterById(G.id)):this.loadNewLetter(O.title)});this.subscription.add(y),this.createAndSignLabel=this.companyService.isSecondaryAuthority()?"SIGN":"CREATE_AND_SIGN"}ngOnDestroy(){this.lettersService.clearFiles(),this.subscription.unsubscribe()}get f(){return this.form.controls}get canSendAndSign(){return this.companyService.isSecondaryAuthority()||this.companyService.isPrimaryAuthority()&&this.companyService.isSingleSignScheme()}get canSendOnly(){return this.companyService.isNoSignAuthority()||this.companyService.isPrimaryAuthority()&&this.companyService.isMultipleSignScheme()}loadEditLetter(e){this.originalLetter=e,setTimeout(()=>{var i;const{id:s,title:l,body:u}=e;this.form.setValue({id:s,title:l,body:u,uploadModel:null}),(null===(i=e.files)||void 0===i?void 0:i.length)>0&&(this.uploadingFiles=e.files.map(_=>({isLoading:!1,file:_})))},0)}loadEditLetterByBody(e,i,s=[]){return(0,p.mG)(this,void 0,void 0,function*(){this.uploadingFiles=s,this.topics=i,this.loadEditLetter(e),this.initForm(e)})}loadEditLetterById(e){return(0,p.mG)(this,void 0,void 0,function*(){this.isLoading=!0;try{const i=yield this.lettersService.getById(e);yield this.loadTopics(),this.loadEditLetter(i),this.initForm(i)}catch(i){}finally{this.isLoading=!1}})}loadNewLetter(e=""){return(0,p.mG)(this,void 0,void 0,function*(){this.isLoading=!0;try{yield this.loadTopics(),this.initForm({title:e})}catch(i){}finally{this.isLoading=!1}})}loadTopics(){return(0,p.mG)(this,void 0,void 0,function*(){this.topics=yield this.lettersService.getTopicValues()})}initForm(e=null){const{id:i,title:s,body:l}={id:e.id||null,title:e.title||"",body:e.body||""};this.form=new T.cw({id:new T.NI(i),title:new T.NI(s,T.kI.required),body:new T.NI(l,[T.kI.required,T.kI.maxLength(this.bodyMaxLength)]),uploadModel:new T.NI("")});const u=this.form.valueChanges.subscribe(h=>{this.isSubmitted=!1}),_=this.f.body.valueChanges.subscribe(h=>{this.bodyLengthMessage$.next(`${h.length}/${this.bodyMaxLength}`)});this.subscription.add(_),this.subscription.add(u)}prepareCreate(){return this.isSubmitted=!0,!this.form.invalid&&(this.filesService.hasLoadingFiles(this.uploadingFiles)?(this.notifierService.notify("default",this.translateService.instant("FILES.PLEASE_WAIT")),!1):(this.filesService.hasErroredFiles(this.uploadingFiles)&&this.notifierService.notify("default",this.translateService.instant("FILES.HAS_ERRORED_FILES")),!0))}saveToDraft(){return(0,p.mG)(this,void 0,void 0,function*(){if(!this.isSubmitting){this.isSubmitting=!0;try{const e=yield this.createDraft();this.showNotification(L.SAVED_TO_DRAFT),this.router.navigate(["/letters/drafts"],{state:{highlighted:e.id}}),this.isSubmitting=!1}catch(e){this.showNotification(L.SAVED_TO_DRAFT_ERROR,"error"),this.isSubmitting=!1}}})}createAndSendForSign(){return(0,p.mG)(this,void 0,void 0,function*(){if(!this.isSubmitting&&this.prepareCreate()){this.isSubmitting=!0;try{const i=yield this.lettersService.create(Object.assign(Object.assign({},this.mapLetterBody()),{statusCode:I.Q.ON_SIGN}));this.showNotification(L.SENT_FOR_SIGN),this.router.navigate(["/letters/outbox/on-sign"],{state:{highlighted:i.id}})}catch(i){this.showNotification(L.SENT_FOR_SIGN_ERROR,"error"),this.isSubmitting=!1}}})}createDraftAndNavigate(){return(0,p.mG)(this,void 0,void 0,function*(){try{this.originalLetter=yield this.createDraft(),this.router.navigate(["edit",this.originalLetter.id],{relativeTo:this.route.parent,state:{letter:this.originalLetter,topics:this.topics,files:this.uploadingFiles}})}catch(e){}})}createAndSign(){return(0,p.mG)(this,void 0,void 0,function*(){if(!this.isSubmitting&&this.prepareCreate()){this.isSubmitting=!0;try{yield this.createDraftAndNavigate(),yield this.lettersService.sign(this.originalLetter.id),this.showNotification(L.SIGNED),this.companyService.isSecondaryAuthority()?this.router.navigate(["/letters/outbox/on-sign"],{state:{highlighted:this.originalLetter.id}}):this.router.navigate(["/letters/outbox/sent"],{state:{highlighted:this.originalLetter.id}})}catch(i){this.showNotification(L.SIGNED_ERROR,"error"),this.isSubmitting=!1}}})}edit(){return(0,p.mG)(this,void 0,void 0,function*(){this.isSubmitting=!0;try{yield this.lettersService.edit(Object.assign(Object.assign({},this.originalLetter),this.mapLetterBody())),this.showNotification(L.SAVED_EDITING),this.router.navigate(["/letters/drafts"],{state:{highlighted:this.originalLetter.id}})}catch(e){this.showNotification(L.SAVED_EDITING_ERROR,"error"),this.isSubmitting=!1}})}createDraft(){return this.lettersService.create(Object.assign(Object.assign({},this.mapLetterBody()),{statusCode:I.Q.DRAFT}))}mapTranslate(e){return`LETTERS.CREATE.${e}`}mapBodyErrors(){return this.f.body.errors?this.f.body.errors.maxlength?"ERRORS.MAX_LENGTH":void 0:null}onTitleSelect(e){this.f.title.setValue(e)}onAddFile(e){var i;!(null===(i=null==e?void 0:e.target)||void 0===i?void 0:i.files)||(this.lettersService.onFileDrop(e.target.files),this.f.uploadModel.setValue(null))}onUploadingFilesUpdate(e){this.uploadingFiles=e}showNotification(e,i="default"){const s=this.mapTranslate(e),l=this.translateService.instant(s);this.notifierService.notify(i,l)}mapLetterBody(){return Object.assign(Object.assign({},this.form.getRawValue()),{fileIds:this.uploadingFiles.filter(e=>{var i;return!e.error&&(null===(i=e.file)||void 0===i?void 0:i.id)}).map(e=>e.file.id)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.gz),t.Y36(m.F0),t.Y36(A),t.Y36(F.J),t.Y36(Q.nS),t.Y36(it.lG),t.Y36(S.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-create-form"]],decls:10,vars:2,consts:[[4,"ngIf"],["formTemplate",""],["filesTemplate",""],["infoTemplate",""],["submitTemplate",""],[1,"letters-create",3,"formGroup"],[3,"ngTemplateOutlet"],[3,"theme"],[1,"form-footer","form-footer--bordered"],[1,"form-group"],[3,"options","hasError","selectedItem","label","selected"],["titleDropdown",""],["optionTemplate",""],["type","textarea","inputClass","j-input--large-textarea",3,"label","inputExtra","formControl","hasError","errorText","maxLength","isClearable"],[1,"py-2"],[1,"letters-create__files"],[1,"j-input-file"],["id","fileUpload","type","file","multiple","true",3,"formControl","accept","change"],["for","fileUpload",1,"link-blue"],["inlineSVG","/assets/icons/letters/attachment.svg",1,"mr-2"],[1,"text-muted"],[3,"isLoading","acceptedFormats","uploadingFiles","maxSize","updated"],["class","alert alert-danger",4,"ngIf"],[1,"alert","alert-danger"],[1,"form-footer","letters-create__info","form-footer--bordered","text-muted"],["inlineSVG","/assets/icons/letters/info.svg",1,"mr-3"],[1,"form-footer","form-footer--bordered","letter-create__submit"],["type","button",1,"btn","btn-link",3,"jLoadingInverted","disabled","jLoading","click"],["type","button",1,"btn","btn-link",3,"disabled","jLoading","jLoadingInverted","click"],["type","submit",1,"btn","btn-primary",3,"disabled","jLoading","click"]],template:function(e,i){1&e&&(t.YNc(0,he,6,5,"ng-container",0),t.YNc(1,Te,7,9,"div",0),t.YNc(2,Se,8,13,"ng-template",null,1,t.W1O),t.YNc(4,xe,13,16,"ng-template",null,2,t.W1O),t.YNc(6,Le,5,3,"ng-template",null,3,t.W1O),t.YNc(8,Ae,5,4,"ng-template",null,4,t.W1O)),2&e&&(t.Q6J("ngIf",i.form&&!i.isLoading),t.xp6(1),t.Q6J("ngIf",i.isLoading))},directives:[a.O5,T._Y,T.JL,T.sg,a.tP,E.xr,ge.i,ue.N,T.JJ,T.oH,T.Fj,D.d$,_e.z,ot.T],pipes:[a.Ov,S.X$],styles:[".letter-create__submit[_ngcontent-%COMP%]{flex-direction:column-reverse}.letter-create__submit[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-top:1rem;margin-left:0}@media (min-width: 1280px){.letter-create__submit[_ngcontent-%COMP%]{flex-direction:row}.letter-create__submit[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-top:0;margin-left:1rem}}.letter-create__submit[_ngcontent-%COMP%]   ngx-skeleton-loader[_ngcontent-%COMP%]{width:50%}.letters-create__info[_ngcontent-%COMP%]{justify-content:flex-start;align-items:center;padding:1.5rem 0}"]}),n})(),tt=(()=>{class n{constructor(e,i,s){this.route=e,this.router=i,this.lettersService=s,this.subscription=new N.w,this.lettersService.lastLettersListPath$.subscribe(l=>{this.lastLetterListPath=l})}ngOnInit(){const e=this.route.params.subscribe(i=>{this.title=i.id?"LETTERS.CREATE.EDIT":"LETTERS.CREATE.TITLE"});this.subscription.add(e)}ngOnDestroy(){this.lettersService.clearFiles(),this.subscription.unsubscribe()}onFileDropped(e){this.lettersService.onFileDrop(e)}onClose(){this.lettersService.clearFiles(),this.router.navigate(["/letters",this.lastLetterListPath])}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.gz),t.Y36(m.F0),t.Y36(A))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-create"]],decls:9,vars:3,consts:[["jDnd","",1,"dnd-wrap",3,"fileDropped"],["closePosition","outside","colsClassList","offset-lg-1 col-lg-10 offset-xl-2 col-xl-8","headerClassList","bg-white",3,"closed"],[1,"account-header"],[1,"f-page-title"]],template:function(e,i){1&e&&(t.TgZ(0,"section",0),t.NdJ("fileDropped",function(l){return i.onFileDropped(l)}),t.TgZ(1,"f-page",1),t.NdJ("closed",function(){return i.onClose()}),t.TgZ(2,"f-page-header")(3,"section",2)(4,"h1",3),t._uU(5),t.ALo(6,"translate"),t.qZA()()(),t.TgZ(7,"f-page-body"),t._UZ(8,"j-letters-create-form"),t.qZA()()()),2&e&&(t.xp6(5),t.hij("",t.lcZ(6,1,i.title)," "))},directives:[le.V,ce.J,pe.M,de.G,De],pipes:[S.X$],styles:[".dnd-wrap[_ngcontent-%COMP%]{transition:all .2s ease-in-out}.dnd-wrap.fileover[_ngcontent-%COMP%]{opacity:.5}"]}),n})();var R=c(77501),Ie=c(99430),Ze=c(16831),Me=c(77337),Re=c(194);function Pe(n,r){if(1&n&&(t.TgZ(0,"span",10),t._uU(1),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.Tol(e.badgeClass),t.xp6(1),t.Oqu(e.badge)}}function je(n,r){1&n&&(t.TgZ(0,"span",11),t._UZ(1,"span",12),t.qZA()),2&n&&(t.xp6(1),t.Q6J("jLoading",!0))}function Je(n,r){if(1&n&&(t.ynx(0),t.YNc(1,Pe,2,3,"span",8),t.YNc(2,je,2,1,"span",9),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",0!=e.badge),t.xp6(1),t.Q6J("ngIf",null==e.badge)}}function Qe(n,r){if(1&n&&(t.TgZ(0,"a",6)(1,"span"),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,Je,3,2,"ng-container",7),t.qZA()),2&n){const e=r.$implicit,i=t.oxw();t.Q6J("routerLink",e.url),t.xp6(2),t.Oqu(t.lcZ(3,3,e.label)),t.xp6(2),t.Q6J("ngIf",i.isBadgesShown(e.id))}}let Ye=(()=>{class n{constructor(e,i){this.navService=e,this.route=i,this.letterTypes=[{id:"outbox",label:"LETTERS.TYPES.OUTBOX",url:"/letters/outbox",badge:null,badgeClass:"badge-primary"},{id:"inbox",label:"LETTERS.TYPES.INBOX",url:"/letters/inbox",badge:null,badgeClass:"badge-primary"},{id:"draft",label:"LETTERS.TYPES.DRAFT",url:"/letters/drafts",badge:null,badgeClass:"badge-light"}],this.createShown=new t.vpe,this.subscription=new N.w,this.route.data.subscribe(s=>{this.isOutboxRoute=s.isOutbox||!1}),this.subscription.add(this.navService.getLetterBadges().subscribe(s=>{this.setBadge("outbox",s.onSignForMe),this.setBadge("inbox",s.unread),this.setBadge("draft",s.draft)}))}isBadgesShown(e){switch(e){case"inbox":case"draft":return!0;case"outbox":return!this.isOutboxRoute}}ngOnDestroy(){this.subscription.unsubscribe()}setBadge(e,i){this.letterTypes.find(s=>s.id===e).badge=i}onCreateShown(){this.createShown.emit()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(R.t),t.Y36(m.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-nav"]],outputs:{createShown:"createShown"},decls:8,vars:4,consts:[[1,"j-tabs"],[1,"j-tabs__list"],["class","j-tabs__item","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],[1,"ml-auto","btn","btn-link","j-tabs__add",3,"click"],["inlineSVG","/assets/icons/contracts/add.svg",1,"j-tabs__add-icon"],[1,"d-none","d-md-block"],["routerLinkActive","active",1,"j-tabs__item",3,"routerLink"],[4,"ngIf"],["class","j-tabs__badge badge",3,"class",4,"ngIf"],["class","j-tabs__badge badge badge-light",4,"ngIf"],[1,"j-tabs__badge","badge"],[1,"j-tabs__badge","badge","badge-light"],[3,"jLoading"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"nav",1),t.YNc(2,Qe,5,5,"a",2),t.TgZ(3,"button",3),t.NdJ("click",function(){return i.onCreateShown()}),t._UZ(4,"span",4),t.TgZ(5,"span",5),t._uU(6),t.ALo(7,"translate"),t.qZA()()()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",i.letterTypes),t.xp6(4),t.Oqu(t.lcZ(7,2,"LETTERS.ADD_NEW")))},directives:[a.sg,m.yS,m.Od,a.O5,ot.T,D.d$],pipes:[S.X$],styles:[""]}),n})();var lt=c(21086),Be=c(27221),Ge=c(89801),ke=c(161),Ue=c(51884);function $e(n,r){if(1&n&&(t.TgZ(0,"div",9),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Oqu(t.lcZ(2,1,e.mapTranslate("FOR_SIGN")))}}const B=function(n){return{$implicit:n}};function He(n,r){if(1&n&&(t.TgZ(0,"div",5)(1,"div",6),t.GkF(2,7),t.YNc(3,$e,3,3,"div",8),t.qZA(),t.GkF(4,7),t.qZA()),2&n){const e=r.$implicit,i=t.oxw(),s=t.MAs(6),l=t.MAs(8);t.xp6(2),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(5,B,e)),t.xp6(1),t.Q6J("ngIf",i.isSignable),t.xp6(1),t.Q6J("ngTemplateOutlet",l)("ngTemplateOutletContext",t.VKq(7,B,e))}}function Xe(n,r){if(1&n&&(t.TgZ(0,"div",5),t.GkF(1,7)(2,7),t.qZA()),2&n){const e=r.$implicit;t.oxw();const i=t.MAs(6),s=t.MAs(8);t.xp6(1),t.Q6J("ngTemplateOutlet",i)("ngTemplateOutletContext",t.VKq(4,B,e)),t.xp6(1),t.Q6J("ngTemplateOutlet",s)("ngTemplateOutletContext",t.VKq(6,B,e))}}function Ve(n,r){if(1&n&&(t.TgZ(0,"div",10),t._uU(1),t.ALo(2,"async"),t.qZA()),2&n){const e=r.$implicit,i=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,1,i.mapDateText(e))," ")}}function qe(n,r){if(1&n&&(t.TgZ(0,"article",11),t._UZ(1,"strong",12)(2,"div",13),t.qZA()),2&n){const e=r.$implicit;t.xp6(1),t.Q6J("jClamp",1)("innerText",null==e?null:e.title),t.xp6(1),t.Q6J("jClamp",1)("innerText",null==e?null:e.body)}}let ct=(()=>{class n{constructor(e,i,s,l,u,_){this.lettersService=e,this.router=i,this.route=s,this.navService=l,this.companyService=u,this.translateService=_,this.isDeletable=!1,this.isSelectable=!1,this.isSignable=!1,this.detailsShown=new t.vpe,this.scrolled=new t.vpe,this.translatePrefix="LETTERS.LIST",this.urlPath="letters",this.modalPartialTitleFn=this.mapModalPartialTitle.bind(this),this.highlightedFn=this.shouldBeHighlighted.bind(this),this.highlightedTemporarilyFn=this.shouldBeHighlightedTemporarily.bind(this)}onClick(e){e.read=!0,e.statusCode===I.Q.DRAFT?this.router.navigate(["edit",e.id],{relativeTo:this.route.parent}):this.detailsShown.emit(e)}onScroll(){this.scrolled.emit()}shouldBeHighlighted(e){return!e.read}shouldBeHighlightedTemporarily(e){return this.highlighted===e.id}mapModalPartialTitle(e){return`\u2116 ${e.letterNumber}:`}onClear(){this.navService.retrieveLetterBadges()}onSign(){(this.companyService.isSingleSignScheme()||this.companyService.isMultipleSignScheme()&&this.companyService.isPrimaryAuthority())&&this.router.navigate(["sent"],{relativeTo:this.route.parent})}mapTranslate(e){return`${this.translatePrefix}.${e}`}mapDateText(e){const i=this.lettersService.mapLetterDate(e);return"string"==typeof i?(0,lt.of)(i):this.translateService.stream(i.key,i.params)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A),t.Y36(m.F0),t.Y36(m.gz),t.Y36(R.t),t.Y36(F.J),t.Y36(S.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-group"]],inputs:{title:"title",list:"list",highlighted:"highlighted",isDeletable:"isDeletable",isSelectable:"isSelectable",isSignable:"isSignable"},outputs:{detailsShown:"detailsShown",scrolled:"scrolled"},decls:9,vars:11,consts:[[3,"list","title","urlPath","translatePrefix","isDeletable","isSelectable","isSignable","isHoverable","partialTitleFn","highlightedFn","highlightedTemporarilyFn","scrolled","clicked","cleared","signed"],["selectableTemplate",""],["defaultTemplate",""],["dateTemplate",""],["contentTemplate",""],[1,"p3","letters-item"],[1,"letters-item__status"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","text-blue",4,"ngIf"],[1,"text-blue"],[1,"letters-item__date","text-muted"],[1,"letters-item__content","p3"],[1,"letters-item__title","text-dark",3,"jClamp","innerText"],[1,"text-muted","letters-item__body",3,"jClamp","innerText"]],template:function(e,i){1&e&&(t.TgZ(0,"j-list",0),t.NdJ("scrolled",function(){return i.onScroll()})("clicked",function(l){return i.onClick(l)})("cleared",function(){return i.onClear()})("signed",function(){return i.onSign()}),t.YNc(1,He,5,9,"ng-template",null,1,t.W1O),t.YNc(3,Xe,3,8,"ng-template",null,2,t.W1O),t.qZA(),t.YNc(5,Ve,3,3,"ng-template",null,3,t.W1O),t.YNc(7,qe,3,4,"ng-template",null,4,t.W1O)),2&e&&t.Q6J("list",i.list)("title",i.title)("urlPath",i.urlPath)("translatePrefix",i.translatePrefix)("isDeletable",i.isDeletable)("isSelectable",i.isSelectable)("isSignable",i.isSignable)("isHoverable",!0)("partialTitleFn",i.modalPartialTitleFn)("highlightedFn",i.highlightedFn)("highlightedTemporarilyFn",i.highlightedTemporarilyFn)},directives:[ke.n,a.tP,a.O5,Ue.c],pipes:[S.X$,a.Ov],styles:["[_nghost-%COMP%]{display:block;background:#fff}.letters-item[_ngcontent-%COMP%]{display:grid;grid-column-gap:16px;column-gap:16px;grid-template-columns:148px minmax(0,1fr)}"]}),n})();var pt=c(35803),dt=c(43169);const ze=function(){return{width:"25%",height:"33px","background-color":"#ECEEF1"}};function We(n,r){1&n&&t._UZ(0,"ngx-skeleton-loader",3),2&n&&t.Q6J("theme",t.DdM(1,ze))}const Ke=function(){return{width:"13%","margin-right":"2%",height:"42px","background-color":"#ECEEF1"}},tn=function(){return{width:"80%",height:"42px","background-color":"#ECEEF1"}};function en(n,r){1&n&&(t.TgZ(0,"div"),t._UZ(1,"ngx-skeleton-loader",3)(2,"ngx-skeleton-loader",3),t.qZA()),2&n&&(t.xp6(1),t.Q6J("theme",t.DdM(2,Ke)),t.xp6(1),t.Q6J("theme",t.DdM(3,tn)))}let gt=(()=>{class n{constructor(){this.hasTitle=!1}get loadingCount(){return Array(5)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-loading"]],inputs:{hasTitle:"hasTitle"},decls:3,vars:2,consts:[[1,"bg-white","p-3"],[3,"theme",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"theme"]],template:function(e,i){1&e&&(t.TgZ(0,"section",0),t.YNc(1,We,1,2,"ngx-skeleton-loader",1),t.YNc(2,en,3,4,"div",2),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",i.hasTitle),t.xp6(1),t.Q6J("ngForOf",i.loadingCount))},directives:[a.O5,E.xr,a.sg],styles:[""]}),n})();function nn(n,r){1&n&&t._UZ(0,"j-empty-placeholder",5)}function sn(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"j-error-placeholder",6),t.NdJ("retried",function(){return t.CHM(e),t.oxw(2).onRetry()}),t.qZA()}}function rn(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"j-letters-group",1),t.NdJ("detailsShown",function(s){return t.CHM(e),t.oxw().onDetailsShown(s)}),t.qZA(),t.TgZ(2,"j-letters-group",2),t.NdJ("detailsShown",function(s){return t.CHM(e),t.oxw().onDetailsShown(s)}),t.qZA(),t.YNc(3,nn,1,0,"j-empty-placeholder",3),t.YNc(4,sn,1,0,"j-error-placeholder",4),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("list",e.onSignForMeList)("highlighted",e.highlighted)("isSignable",!0)("isSelectable",!0)("isDeletable",!0),t.xp6(1),t.Q6J("list",e.onSignForOthersList)("highlighted",e.highlighted)("title",e.mapTranslate("OTHERS_FOR_SIGN"))("isDeletable",!0),t.xp6(1),t.Q6J("ngIf",0===e.onSignForMeList.length&&0===e.onSignForOthersList.length&&!e.errorText),t.xp6(1),t.Q6J("ngIf",e.errorText)}}function on(n,r){1&n&&(t.ynx(0),t._UZ(1,"j-letters-loading")(2,"j-letters-loading",7),t.BQk()),2&n&&(t.xp6(2),t.Q6J("hasTitle",!0))}let cn=(()=>{class n{constructor(e,i,s){this.lettersService=e,this.navService=i,this.companyService=s,this.retrieved=new t.vpe,this.detailsShown=new t.vpe,this.isLoading=!0,this.onSignForMeList=[],this.onSignForOthersList=[],this.lettersSearch={incoming:!1,statusCode:[I.Q.ON_SIGN],pageSize:1e5},this.errorText=null,this.subscription=new N.w,this.subscription.add(this.companyService.refresh$.subscribe(l=>{const[u,_,h]=l;h&&this.retrieveLetters()}))}ngOnDestroy(){this.subscription.unsubscribe()}mapTranslate(e){return`LETTERS.LIST.${e}`}onDetailsShown(e){this.detailsShown.emit(e)}onRetry(){this.retrieveLetters()}retrieveLetters(){return(0,p.mG)(this,void 0,void 0,function*(){this.errorText=null,this.navService.retrieveLetterBadges();try{yield Promise.all([this.retrieveOnSignForMe(),this.retrieveOnSignForOthers()]),this.retrieved.emit({onSignForMe:this.onSignForMeList.length,onSignForOthers:this.onSignForOthersList.length})}catch(e){this.errorText=e.description||e}finally{this.isLoading=!1}})}retrieveOnSignForMe(){return(0,p.mG)(this,void 0,void 0,function*(){const e=yield this.lettersService.getList(Object.assign(Object.assign({},this.lettersSearch),{onSignForMe:!0}));this.onSignForMeList=e.items})}retrieveOnSignForOthers(){return(0,p.mG)(this,void 0,void 0,function*(){const e=yield this.lettersService.getList(Object.assign(Object.assign({},this.lettersSearch),{onSignForOthers:!0}));this.onSignForOthersList=e.items})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A),t.Y36(R.t),t.Y36(F.J))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-on-sign"]],inputs:{highlighted:"highlighted"},outputs:{retrieved:"retrieved",detailsShown:"detailsShown"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"list","highlighted","isSignable","isSelectable","isDeletable","detailsShown"],[1,"d-block","pt-3",3,"list","highlighted","title","isDeletable","detailsShown"],["class","bg-white","label","LETTERS.EMPTY.FOR_SIGN",4,"ngIf"],["class","bg-white",3,"retried",4,"ngIf"],["label","LETTERS.EMPTY.FOR_SIGN",1,"bg-white"],[1,"bg-white",3,"retried"],[3,"hasTitle"]],template:function(e,i){1&e&&(t.YNc(0,rn,5,11,"ng-container",0),t.YNc(1,on,3,1,"ng-container",0)),2&e&&(t.Q6J("ngIf",!i.isLoading),t.xp6(1),t.Q6J("ngIf",i.isLoading))},directives:[a.O5,ct,pt.j,dt.g,gt],styles:[""]}),n})();var ut=c(41359),pn=c(67515),dn=c(65765);function gn(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).onClearPeriod()}),t.ALo(1,"translate"),t.qZA()}2&n&&t.Q6J("ngbTooltip",t.lcZ(1,1,"SHARED.CLEAR"))}function un(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"section",2)(1,"j-filter-period-dropdown",3),t.NdJ("submitted",function(s){return t.CHM(e),t.oxw().onFilter(s)}),t.qZA(),t.YNc(2,gn,2,3,"button",4),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("hasClearButton",!1),t.xp6(1),t.Q6J("ngIf",e.currentDates)}}function _n(n,r){if(1&n&&(t.TgZ(0,"div",10),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,e.mapTranslate("ALL_LOADED"))," ")}}function hn(n,r){if(1&n&&t._UZ(0,"j-empty-placeholder",11),2&n){const e=t.oxw(2);t.Q6J("label",e.currentDates?e.emptyNotFound:e.emptyLabel)}}function mn(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"j-error-placeholder",12),t.NdJ("retried",function(){return t.CHM(e),t.oxw(2).onRetry()}),t.qZA()}}function fn(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"j-letters-group",6),t.NdJ("scrolled",function(){return t.CHM(e),t.oxw().onScroll()})("detailsShown",function(s){return t.CHM(e),t.oxw().onDetailsShown(s)}),t.qZA(),t.YNc(2,_n,3,3,"div",7),t.YNc(3,hn,1,1,"j-empty-placeholder",8),t.YNc(4,mn,1,0,"j-error-placeholder",9),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("list",e.list)("isSignable",e.isSignable)("isSelectable",e.isSelectable)("highlighted",e.highlighted)("isDeletable",e.isDeletable),t.xp6(1),t.Q6J("ngIf",!e.hasMorePages&&e.list.length>0),t.xp6(1),t.Q6J("ngIf",0===e.list.length&&!e.errorText),t.xp6(1),t.Q6J("ngIf",e.errorText)}}function Tn(n,r){1&n&&(t.ynx(0),t._UZ(1,"j-letters-loading"),t.BQk())}let _t=(()=>{class n{constructor(e,i,s,l){this.lettersService=e,this.companyService=i,this.navService=s,this.filterService=l,this.isLoading=!0,this.hasMorePages=!0,this.list=[],this.emptyNotFound="LETTERS.EMPTY.NOT_FOUND",this.emptyLabel="LETTERS.EMPTY.DEFAULT",this.isSelectable=!1,this.isSignable=!1,this.isDeletable=!1,this.hasDateFilter=!1,this.retrieved=new t.vpe,this.detailsShown=new t.vpe,this.page=1,this.pageSize=10,this.currentDates=null,this.errorText=null,this.subscription=new N.w}ngOnInit(){this.filterService.updatePeriod(ut._A.NONE),this.subscription.add(this.companyService.refresh$.subscribe(e=>{const[i,s,l]=e;l&&this.onClearPeriod()}))}ngOnDestroy(){this.subscription.unsubscribe()}onRetry(){this.retrieveLetters({page:1})}onFilter(e){this.currentDates=e,this.retrieveLetters({page:1,dateFrom:e.from,dateTo:e.to})}onClearPeriod(){this.currentDates=null,this.filterService.updatePeriod(ut._A.NONE),this.retrieveLetters({page:1})}onScroll(){this.isLoading||!this.hasMorePages||this.retrieveLetters({page:++this.page})}onDetailsShown(e){this.detailsShown.emit(e)}mapTranslate(e){return`LETTERS.LIST.${e}`}retrieveLetters(e){return(0,p.mG)(this,void 0,void 0,function*(){this.isLoading=!0,this.errorText=null;try{let i=Object.assign(Object.assign(Object.assign({},this.listParams),e),{pageSize:this.pageSize});const s=yield this.lettersService.getList(i);this.hasMorePages=s.totalCount>e.page*this.pageSize,this.page=e.page,this.list=e.page>1?[...this.list,...s.items]:s.items,this.retrieved.emit(this.list.length),this.navService.retrieveLetterBadges()}catch(i){this.errorText=i.description||i}finally{this.isLoading=!1}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(A),t.Y36(F.J),t.Y36(R.t),t.Y36(pn.i))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-list-base"]],inputs:{emptyNotFound:"emptyNotFound",emptyLabel:"emptyLabel",highlighted:"highlighted",listParams:"listParams",isSelectable:"isSelectable",isSignable:"isSignable",isDeletable:"isDeletable",hasDateFilter:"hasDateFilter"},outputs:{retrieved:"retrieved",detailsShown:"detailsShown"},decls:3,vars:3,consts:[["class","j-list__filter letters__inbox-filter",4,"ngIf"],[4,"ngIf"],[1,"j-list__filter","letters__inbox-filter"],["placement","left-top",3,"hasClearButton","submitted"],["class","letters__clear","tooltipClass","tooltip-light","inlineSVG","/assets/icons/tags-remove.svg",3,"ngbTooltip","click",4,"ngIf"],["tooltipClass","tooltip-light","inlineSVG","/assets/icons/tags-remove.svg",1,"letters__clear",3,"ngbTooltip","click"],[3,"list","isSignable","isSelectable","highlighted","isDeletable","scrolled","detailsShown"],["class","bg-white text-center text-muted py-5 p3",4,"ngIf"],["class","bg-white",3,"label",4,"ngIf"],["class","bg-white",3,"retried",4,"ngIf"],[1,"bg-white","text-center","text-muted","py-5","p3"],[1,"bg-white",3,"label"],[1,"bg-white",3,"retried"]],template:function(e,i){1&e&&(t.YNc(0,un,3,2,"section",0),t.YNc(1,fn,5,8,"ng-container",1),t.YNc(2,Tn,2,0,"ng-container",1)),2&e&&(t.Q6J("ngIf",i.hasDateFilter),t.xp6(1),t.Q6J("ngIf",!i.isLoading||i.page>1),t.xp6(1),t.Q6J("ngIf",i.isLoading))},directives:[a.O5,dn.j,D.d$,W._L,ct,pt.j,dt.g,gt],pipes:[S.X$],styles:[".letters__inbox-filter[_ngcontent-%COMP%]{text-align:right;align-items:center;display:flex;justify-content:flex-end;height:83px}.letters__inbox-filter[_ngcontent-%COMP%]   j-filter-period-dropdown[_ngcontent-%COMP%]{display:inline-block}.letters__clear[_ngcontent-%COMP%]{display:inline-block;font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;width:24px;height:24px;padding:0;margin-left:8px;display:flex;align-items:center;justify-content:center}"]}),n})();function bn(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",2)(1,"j-statuses",3),t.NdJ("selected",function(s){return t.CHM(e),t.oxw().onStatusSelect(s)}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("statuses",e.statuses)}}function vn(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"j-letters-on-sign",4),t.NdJ("retrieved",function(s){return t.CHM(e),t.oxw().onSignableRetrieved(s)})("detailsShown",function(s){return t.CHM(e),t.oxw().onDetailsShown(s)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("highlighted",e.highlighted)}}function xn(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"j-letters-list-base",5),t.NdJ("retrieved",function(s){return t.CHM(e),t.oxw().onSentRetrieved(s)})("detailsShown",function(s){return t.CHM(e),t.oxw().onDetailsShown(s)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("listParams",e.sentParams)("highlighted",e.highlighted)}}let yn=(()=>{class n{constructor(e,i,s,l,u){this.router=e,this.route=i,this.lettersService=s,this.navService=l,this.companyService=u,this.detailsShown=new t.vpe,this.statuses=[{label:this.mapTranslate("ON_SIGN"),value:C.ON_SIGN,count:null,isSelected:!0,isDisabled:!1},{label:this.mapTranslate("SENT"),value:C.SENT,count:0,isSelected:!1,isDisabled:!1}],this.sentParams={incoming:!1,statusCode:[I.Q.SENT,I.Q.READY_TO_SEND]},this.outboxStatus=this.statuses[0].value,this.LETTER_OUTBOX_STATUS=C,this.isOnSignHidden=!1,this.subscription=new N.w,this.subscription.add((0,Y.aj)([this.route.data,this.companyService.getAuthorizedPersons().pipe((0,Be.K)((h,y)=>(0,lt.of)([])))]).subscribe(h=>{const[y,w]=h;this.isOnSignHidden=!!w&&this.companyService.hasOnlyPrimaryAuthorities(w)&&this.companyService.isSingleSignScheme(),this.isOnSignHidden&&y.status===C.ON_SIGN?this.router.navigate(["sent"],{relativeTo:this.route.parent}):(this.onInit(y.status),this.lettersService.lastLettersListPath$.next(y.lastPath))}));const _=this.navService.getLetterBadges().subscribe(h=>{const{onSignForMe:y,onSignForOthers:w}=h,O=y>0;Object.assign(this.statuses.find(G=>G.value===C.ON_SIGN),{count:O?y:w,classList:O?"badge-primary":"badge-light"})});this.subscription.add(_)}ngOnDestroy(){this.subscription.unsubscribe()}onSignableRetrieved(e){}onSentRetrieved(e){}onDetailsShown(e){this.detailsShown.emit(e)}onInit(e=C.ON_SIGN){this.outboxStatus=e,this.statuses=this.statuses.map(i=>Object.assign(Object.assign({},i),{isSelected:i.value===e}))}onStatusSelect(e){let i="";switch(e){case C.ON_SIGN:i="on-sign";break;case C.SENT:i="sent"}this.router.navigate([i],{relativeTo:this.route.parent})}mapTranslate(e){return`LETTERS.STATUSES.${e}`}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(A),t.Y36(R.t),t.Y36(F.J))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-outbox"]],inputs:{highlighted:"highlighted"},outputs:{detailsShown:"detailsShown"},decls:3,vars:3,consts:[["class","j-list__filter",4,"ngIf"],[4,"ngIf"],[1,"j-list__filter"],[3,"statuses","selected"],[3,"highlighted","retrieved","detailsShown"],["emptyLabel","LETTERS.EMPTY.OUTBOX",3,"listParams","highlighted","retrieved","detailsShown"]],template:function(e,i){1&e&&(t.YNc(0,bn,2,1,"div",0),t.YNc(1,vn,2,1,"ng-container",1),t.YNc(2,xn,2,2,"ng-container",1)),2&e&&(t.Q6J("ngIf",!i.isOnSignHidden),t.xp6(1),t.Q6J("ngIf",i.outboxStatus===i.LETTER_OUTBOX_STATUS.ON_SIGN&&!i.isOnSignHidden),t.xp6(1),t.Q6J("ngIf",i.outboxStatus===i.LETTER_OUTBOX_STATUS.SENT))},directives:[a.O5,Ge.t,cn,_t],styles:[""]}),n})();const En=["lettersAside"];function On(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"j-letters-outbox",12),t.NdJ("detailsShown",function(s){return t.CHM(e),t.oxw().onDetailsShown(s)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("highlighted",e.highlighted)}}function Fn(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"j-letters-list-base",13),t.NdJ("detailsShown",function(s){return t.CHM(e),t.oxw().onDetailsShown(s)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("listParams",e.inboxParams)("highlighted",e.highlighted)("hasDateFilter",!0)}}function An(n,r){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"j-letters-list-base",14),t.NdJ("detailsShown",function(s){return t.CHM(e),t.oxw().onDetailsShown(s)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("listParams",e.draftsParams)("isSelectable",!0)("highlighted",e.highlighted)("isDeletable",!0)}}let j=(()=>{class n{constructor(e,i,s){this.route=e,this.navService=i,this.lettersService=s,this.LETTERS_CATEGORY=b,this.subscription=new N.w,this.inboxParams={incoming:!0},this.draftsParams={statusCode:[I.Q.DRAFT]};const l=(0,Y.aj)([this.route.paramMap.pipe((0,rt.U)(()=>window.history.state)),this.route.data]).subscribe(u=>{const[_,h]=u;this.lettersCategory=h.category,this.lettersService.lastLettersListPath$.next(h.lastPath),_.highlighted&&(this.highlighted=_.highlighted)});this.subscription.add(l)}ngOnDestroy(){this.subscription.unsubscribe()}onDetailsShown(e){this.lettersAside.showDetails(e)}onCreateShown(){this.lettersAside.showCreate()}onAsideClose(){this.navService.retrieveLetterBadges()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.gz),t.Y36(R.t),t.Y36(A))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters-list"]],viewQuery:function(e,i){if(1&e&&t.Gf(En,5),2&e){let s;t.iGM(s=t.CRH())&&(i.lettersAside=s.first)}},decls:19,vars:4,consts:[[1,"row"],[1,"col-lg-10","offset-lg-1","col-xl-8","offset-xl-2"],[1,"j-page"],["translate","",1,"d-none","d-lg-block","j-page__title"],[1,"j-page__body"],[1,"j-list"],[1,"j-list__nav"],[3,"createShown"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"closed"],["lettersAside",""],[3,"highlighted","detailsShown"],["emptyLabel","LETTERS.EMPTY.INBOX",3,"listParams","highlighted","hasDateFilter","detailsShown"],["emptyLabel","LETTERS.EMPTY.DRAFTS",3,"listParams","isSelectable","highlighted","isDeletable","detailsShown"]],template:function(e,i){1&e&&(t.TgZ(0,"j-layout-home")(1,"j-aside"),t._UZ(2,"j-nav-main"),t.qZA(),t.TgZ(3,"j-main")(4,"section",0)(5,"section",1)(6,"section",2)(7,"h2",3),t._uU(8,"LETTERS.TITLE"),t.qZA(),t.TgZ(9,"section",4)(10,"section",5)(11,"div",6)(12,"j-letters-nav",7),t.NdJ("createShown",function(){return i.onCreateShown()}),t.qZA()(),t.ynx(13,8),t.YNc(14,On,2,1,"ng-container",9),t.YNc(15,Fn,2,3,"ng-container",9),t.YNc(16,An,2,4,"ng-container",9),t.BQk(),t.qZA()()()()(),t.TgZ(17,"j-letters-aside",10,11),t.NdJ("closed",function(){return i.onAsideClose()}),t.qZA()()()),2&e&&(t.xp6(13),t.Q6J("ngSwitch",i.lettersCategory),t.xp6(1),t.Q6J("ngSwitchCase",i.LETTERS_CATEGORY.OUTBOX),t.xp6(1),t.Q6J("ngSwitchCase",i.LETTERS_CATEGORY.INBOX),t.xp6(1),t.Q6J("ngSwitchCase",i.LETTERS_CATEGORY.DRAFTS))},directives:[Ie.Y,Ze.l,Me.F,Re.C,S.Pi,Ye,a.RF,a.n9,yn,_t,st],styles:[".letters__body[_ngcontent-%COMP%]{box-shadow:0 0 1px #0000000a,0 0 2px #0000000f,0 4px 8px #0000000a;border-radius:.5rem}.letters__page-title[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:40px}.letters__header[_ngcontent-%COMP%]{padding:20px 1rem;display:none}@media (min-width: 960px){.letters__header[_ngcontent-%COMP%]{display:grid}}"]}),n})();var ht=c(15057);const Nn=[{path:"",component:(()=>{class n{constructor(e){this.featureFlagsService=e,this.subscription=new N.w}ngOnInit(){this.subscription.add(this.featureFlagsService.featureFlags$.subscribe(e=>{this.featureFlagsService.checkFeatureRoute(ht.Y.LETTER)}))}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(ht.a))},n.\u0275cmp=t.Xpm({type:n,selectors:[["j-letters"]],decls:1,vars:0,template:function(e,i){1&e&&t._UZ(0,"router-outlet")},directives:[m.lC],styles:[".letters__body[_ngcontent-%COMP%]{box-shadow:0 0 1px #0000000a,0 0 2px #0000000f,0 4px 8px #0000000a;border-radius:.5rem}.letters__page-title[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:40px}.letters__header[_ngcontent-%COMP%]{padding:20px 1rem;display:none}@media (min-width: 960px){.letters__header[_ngcontent-%COMP%]{display:grid}}"]}),n})(),data:{title:"CONTRACTS.TITLE"},children:[{path:"outbox",children:[{path:"on-sign",component:j,data:{category:b.OUTBOX,status:C.ON_SIGN,lastPath:"outbox/on-sign",isOutbox:!0}},{path:"sent",component:j,data:{category:b.OUTBOX,status:C.SENT,lastPath:"outbox/sent",isOutbox:!0}},{path:"**",redirectTo:"on-sign"}]},{path:"inbox",component:j,data:{category:b.INBOX,lastPath:"inbox"}},{path:"drafts",component:j,data:{category:b.DRAFTS,lastPath:"drafts"}},{path:"create",component:tt},{path:"edit/:id",component:tt},{path:"**",redirectTo:"outbox"}]},{path:"**",redirectTo:""}],Dn=[a.ez,T.u5,T.UX,E.hx,U.Yi,k.X,$.i,H.m,X.j,(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[m.Bz.forChild(Nn)],m.Bz]}),n})()];let In=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[Dn]]}),n})()},13500:(mt,J,c)=>{c.d(J,{CB:()=>C,L9:()=>V,Yi:()=>Z});var a=c(5e3),T=c(98723),E=c(69808);const k=["fileSelector"];function U(g,f){if(1&g&&(a.TgZ(0,"div",8),a._uU(1),a.qZA()),2&g){const o=a.oxw(2);a.xp6(1),a.Oqu(o.dropZoneLabel)}}function $(g,f){if(1&g){const o=a.EpF();a.TgZ(0,"div")(1,"input",9),a.NdJ("click",function(p){return a.CHM(o),a.oxw(2).openFileSelector(p)}),a.qZA()()}if(2&g){const o=a.oxw(2);a.xp6(1),a.s9C("value",o.browseBtnLabel),a.Q6J("className",o.browseBtnClassName)}}function H(g,f){if(1&g&&(a.YNc(0,U,2,1,"div",6),a.YNc(1,$,2,2,"div",7)),2&g){const o=a.oxw();a.Q6J("ngIf",o.dropZoneLabel),a.xp6(1),a.Q6J("ngIf",o.showBrowseBtn)}}function X(g,f){}const m=function(g){return{openFileSelector:g}};class b{constructor(f,o){this.relativePath=f,this.fileEntry=o}}let V=(()=>{class g{constructor(o){this.template=o}}return g.\u0275fac=function(o){return new(o||g)(a.Y36(a.Rgc))},g.\u0275dir=a.lG2({type:g,selectors:[["","ngx-file-drop-content-tmp",""]]}),g})(),C=(()=>{class g{constructor(o,t){this.zone=o,this.renderer=t,this.accept="*",this.directory=!1,this.multiple=!0,this.dropZoneLabel="",this.dropZoneClassName="ngx-file-drop__drop-zone",this.useDragEnter=!1,this.contentClassName="ngx-file-drop__content",this.showBrowseBtn=!1,this.browseBtnClassName="btn btn-primary btn-xs ngx-file-drop__browse-btn",this.browseBtnLabel="Browse files",this.onFileDrop=new a.vpe,this.onFileOver=new a.vpe,this.onFileLeave=new a.vpe,this.isDraggingOverDropZone=!1,this.globalDraggingInProgress=!1,this.files=[],this.numOfActiveReadEntries=0,this.helperFormEl=null,this.fileInputPlaceholderEl=null,this.dropEventTimerSubscription=null,this._disabled=!1,this.openFileSelector=p=>{this.fileSelector&&this.fileSelector.nativeElement&&this.fileSelector.nativeElement.click()},this.globalDragStartListener=this.renderer.listen("document","dragstart",p=>{this.globalDraggingInProgress=!0}),this.globalDragEndListener=this.renderer.listen("document","dragend",p=>{this.globalDraggingInProgress=!1})}get disabled(){return this._disabled}set disabled(o){this._disabled=null!=o&&"false"!=`${o}`}ngOnDestroy(){this.dropEventTimerSubscription&&(this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=null),this.globalDragStartListener(),this.globalDragEndListener(),this.files=[],this.helperFormEl=null,this.fileInputPlaceholderEl=null}onDragOver(o){this.useDragEnter?(this.preventAndStop(o),o.dataTransfer&&(o.dataTransfer.dropEffect="copy")):!this.isDropzoneDisabled()&&!this.useDragEnter&&o.dataTransfer&&(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(o)),this.preventAndStop(o),o.dataTransfer.dropEffect="copy")}onDragEnter(o){!this.isDropzoneDisabled()&&this.useDragEnter&&(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(o)),this.preventAndStop(o))}onDragLeave(o){this.isDropzoneDisabled()||(this.isDraggingOverDropZone&&(this.isDraggingOverDropZone=!1,this.onFileLeave.emit(o)),this.preventAndStop(o))}dropFiles(o){if(!this.isDropzoneDisabled()&&(this.isDraggingOverDropZone=!1,o.dataTransfer)){let t;t=o.dataTransfer.items?o.dataTransfer.items:o.dataTransfer.files,this.preventAndStop(o),this.checkFiles(t)}}uploadFiles(o){!this.isDropzoneDisabled()&&o.target&&(this.checkFiles(o.target.files||[]),this.resetFileInput())}checkFiles(o){for(let t=0;t<o.length;t++){const p=o[t];let d=null;if(this.canGetAsEntry(p)&&(d=p.webkitGetAsEntry()),d)if(d.isFile){const x=new b(d.name,d);this.addToQueue(x)}else d.isDirectory&&this.traverseFileTree(d,d.name);else if(p){const x={name:p.name,isDirectory:!1,isFile:!0,file:v=>v(p)},M=new b(x.name,x);this.addToQueue(M)}}this.dropEventTimerSubscription&&this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=(0,T.H)(200,200).subscribe(()=>{if(this.files.length>0&&0===this.numOfActiveReadEntries){const t=this.files;this.files=[],this.onFileDrop.emit(t)}})}traverseFileTree(o,t){if(o.isFile){const p=new b(t,o);this.files.push(p)}else{t+="/";const p=o.createReader();let d=[];const x=()=>{this.numOfActiveReadEntries++,p.readEntries(M=>{if(M.length)d=d.concat(M),x();else if(0===d.length){const v=new b(t,o);this.zone.run(()=>{this.addToQueue(v)})}else for(let v=0;v<d.length;v++)this.zone.run(()=>{this.traverseFileTree(d[v],t+d[v].name)});this.numOfActiveReadEntries--})};x()}}resetFileInput(){if(this.fileSelector&&this.fileSelector.nativeElement){const o=this.fileSelector.nativeElement,t=o.parentElement,p=this.getHelperFormElement(),d=this.getFileInputPlaceholderElement();t!==p&&(this.renderer.insertBefore(t,d,o),this.renderer.appendChild(p,o),p.reset(),this.renderer.insertBefore(t,o,d),this.renderer.removeChild(t,d))}}getHelperFormElement(){return this.helperFormEl||(this.helperFormEl=this.renderer.createElement("form")),this.helperFormEl}getFileInputPlaceholderElement(){return this.fileInputPlaceholderEl||(this.fileInputPlaceholderEl=this.renderer.createElement("div")),this.fileInputPlaceholderEl}canGetAsEntry(o){return!!o.webkitGetAsEntry}isDropzoneDisabled(){return this.globalDraggingInProgress||this.disabled}addToQueue(o){this.files.push(o)}preventAndStop(o){o.stopPropagation(),o.preventDefault()}}return g.\u0275fac=function(o){return new(o||g)(a.Y36(a.R0b),a.Y36(a.Qsj))},g.\u0275cmp=a.Xpm({type:g,selectors:[["ngx-file-drop"]],contentQueries:function(o,t,p){if(1&o&&a.Suo(p,V,5,a.Rgc),2&o){let d;a.iGM(d=a.CRH())&&(t.contentTemplate=d.first)}},viewQuery:function(o,t){if(1&o&&a.Gf(k,7),2&o){let p;a.iGM(p=a.CRH())&&(t.fileSelector=p.first)}},inputs:{accept:"accept",directory:"directory",multiple:"multiple",dropZoneLabel:"dropZoneLabel",dropZoneClassName:"dropZoneClassName",useDragEnter:"useDragEnter",contentClassName:"contentClassName",showBrowseBtn:"showBrowseBtn",browseBtnClassName:"browseBtnClassName",browseBtnLabel:"browseBtnLabel",disabled:"disabled"},outputs:{onFileDrop:"onFileDrop",onFileOver:"onFileOver",onFileLeave:"onFileLeave"},decls:7,vars:15,consts:[[3,"className","drop","dragover","dragenter","dragleave"],[3,"className"],["type","file",1,"ngx-file-drop__file-input",3,"accept","multiple","change"],["fileSelector",""],["defaultContentTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","ngx-file-drop__drop-zone-label",4,"ngIf"],[4,"ngIf"],[1,"ngx-file-drop__drop-zone-label"],["type","button",3,"className","value","click"]],template:function(o,t){if(1&o&&(a.TgZ(0,"div",0),a.NdJ("drop",function(d){return t.dropFiles(d)})("dragover",function(d){return t.onDragOver(d)})("dragenter",function(d){return t.onDragEnter(d)})("dragleave",function(d){return t.onDragLeave(d)}),a.TgZ(1,"div",1)(2,"input",2,3),a.NdJ("change",function(d){return t.uploadFiles(d)}),a.qZA(),a.YNc(4,H,2,2,"ng-template",null,4,a.W1O),a.YNc(6,X,0,0,"ng-template",5),a.qZA()()),2&o){const p=a.MAs(5);a.ekj("ngx-file-drop__drop-zone--over",t.isDraggingOverDropZone),a.Q6J("className",t.dropZoneClassName),a.xp6(1),a.Q6J("className",t.contentClassName),a.xp6(1),a.Q6J("accept",t.accept)("multiple",t.multiple),a.uIk("directory",t.directory||void 0)("webkitdirectory",t.directory||void 0)("mozdirectory",t.directory||void 0)("msdirectory",t.directory||void 0)("odirectory",t.directory||void 0),a.xp6(4),a.Q6J("ngTemplateOutlet",t.contentTemplate||p)("ngTemplateOutletContext",a.VKq(13,m,t.openFileSelector))}},directives:[E.O5,E.tP],styles:[".ngx-file-drop__drop-zone[_ngcontent-%COMP%]{border:2px dotted #0782d0;border-radius:30px;height:100px;margin:auto}.ngx-file-drop__drop-zone--over[_ngcontent-%COMP%]{background-color:hsla(0,0%,57.6%,.5)}.ngx-file-drop__content[_ngcontent-%COMP%]{align-items:center;color:#0782d0;display:flex;height:100px;justify-content:center}.ngx-file-drop__drop-zone-label[_ngcontent-%COMP%]{text-align:center}.ngx-file-drop__file-input[_ngcontent-%COMP%]{display:none}"]}),g})(),Z=(()=>{class g{}return g.\u0275fac=function(o){return new(o||g)},g.\u0275mod=a.oAB({type:g,bootstrap:function(){return[C]}}),g.\u0275inj=a.cJS({providers:[],imports:[[E.ez]]}),g})()}}]);
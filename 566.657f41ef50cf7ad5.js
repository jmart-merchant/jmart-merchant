"use strict";(self.webpackChunkjysan=self.webpackChunkjysan||[]).push([[566],{1566:(Nt,T,r)=>{r.r(T),r.d(T,{AuthoritiesModule:()=>jt});var p=r(69808),D=r(91995),m=r(59516),w=r(24850),t=r(5e3),d=r(65212);let Q=(()=>{class i{constructor(e,n){this.authoritiesService=e,this.router=n}canActivate(){return this.authoritiesService.getOtpDevices().pipe((0,w.U)(e=>{const n=(null==e?void 0:e.length)>0;return n||this.router.navigate(["/authorities/main"]),n}))}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(d.lv),t.LFG(m.F0))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var u=r(70655),g=r(42654),q=r(36053),b=r(21086),v=r(92198),C=r(27221),_=r(26164),x=r(79311),I=r(94114),L=r(23918),O=r(61459),h=r(7102),a=r(93075),Z=r(80457),S=r(5269),y=r(40703),E=r(26484),M=r(65243),P=r(85814),c=r(89854);let U=(()=>{class i{constructor(e,n,s){this.modal=e,this.authorityLimitsService=n,this.maskedService=s,this.isLoading=!1,this.form=new a.cw({amount:new a.NI("",[a.kI.required,l=>l.value&&this.maskedService.getNumberedAmount(l.value)>S.N?{maxAmount:!0}:null])})}ngOnInit(){this.title=this.mapTranslate(`CREATE.${this.paymentType}`)}dismissModal(e){this.modal.dismiss(e)}closeModal(e){this.modal.close(e)}createLimit(){return(0,u.mG)(this,void 0,void 0,function*(){this.isLoading=!0;const{amount:e}=this.form.getRawValue(),n={paymentType:this.paymentType,limit:{amount:this.maskedService.getNumberedAmount(e),currency:Z.w.KZT}};try{const s=yield this.authorityLimitsService.createLimit(this.authorityId,n);this.closeModal(s)}catch(s){this.dismissModal(s)}finally{this.isLoading=!1}})}mapTranslate(e){return`AUTHORITIES.MODALS.${e}`}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(y.Kz),t.Y36(d.Df),t.Y36(E.O))},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-create-limit-modal"]],inputs:{authorityId:"authorityId",paymentType:"paymentType"},decls:13,vars:14,consts:[[1,"pt-5","pb-4","px-4",3,"formGroup"],[1,"authorities-modal__article"],[1,"p3","text-muted"],[3,"label","formControl"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-primary",3,"jLoading","disabled","click"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0)(1,"article",1)(2,"h5"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"p",2),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t._UZ(8,"j-amount-input",3),t.TgZ(9,"div",4)(10,"button",5),t.NdJ("click",function(){return n.createLimit()}),t._uU(11),t.ALo(12,"translate"),t.qZA()()()),2&e&&(t.Q6J("formGroup",n.form),t.xp6(3),t.hij(" ",t.lcZ(4,8,n.title)," "),t.xp6(3),t.hij(" ",t.lcZ(7,10,n.mapTranslate("DESCRIPTION"))," "),t.xp6(2),t.Q6J("label",n.mapTranslate("LABEL"))("formControl",n.form.controls.amount),t.xp6(2),t.Q6J("jLoading",n.isLoading)("disabled",n.isLoading||n.form.invalid),t.xp6(1),t.hij(" ",t.lcZ(12,12,n.mapTranslate("SUBMIT"))," "))},directives:[a._Y,a.JL,a.sg,M.l,a.JJ,a.oH,P.T],pipes:[c.X$],styles:[".authorities-modal__article[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{line-height:30px;max-width:340px}"]}),i})(),R=(()=>{class i{constructor(e,n,s){this.modal=e,this.authorityLimitsService=n,this.maskedService=s,this.isLoading=!1}dismissModal(e){this.modal.dismiss(e)}closeModal(e,n=null){this.modal.close({message:e,limit:n})}ngOnInit(){this.title=this.mapTranslate(`CREATE.${this.paymentType}`),this.form=new a.cw({amount:new a.NI(this.maskedService.getMaskedAmount(this.limit.limit.amount),[a.kI.required,e=>e.value&&this.maskedService.getNumberedAmount(e.value)>S.N?{maxAmount:!0}:null])})}deleteLimit(){return(0,u.mG)(this,void 0,void 0,function*(){this.isLoading=!0;try{yield this.authorityLimitsService.deleteLimit(this.authorityId,this.limit),this.closeModal("delete")}catch(e){this.dismissModal("delete")}finally{this.isLoading=!1}})}updateLimit(){return(0,u.mG)(this,void 0,void 0,function*(){const{amount:e}=this.form.getRawValue(),n=Object.assign(Object.assign({},this.limit),{limit:{amount:this.maskedService.getNumberedAmount(e),currency:Z.w.KZT}});this.isLoading=!0;try{const s=yield this.authorityLimitsService.updateLimit(this.authorityId,n);this.closeModal("update",s)}catch(s){this.dismissModal("update")}finally{this.isLoading=!1}})}mapTranslate(e){return`AUTHORITIES.MODALS.${e}`}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(y.Kz),t.Y36(d.Df),t.Y36(E.O))},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-edit-limit-modal"]],inputs:{authorityId:"authorityId",paymentType:"paymentType",limit:"limit"},decls:16,vars:19,consts:[[1,"pt-5","pb-4","px-4",3,"formGroup"],[1,"authorities-modal__article"],[1,"p3","text-muted"],[3,"label","formControl"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-outline-primary",3,"jLoading","disabled","click"],["type","submit",1,"ml-3","btn","btn-primary",3,"jLoading","disabled","click"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0)(1,"article",1)(2,"h5"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"p",2),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t._UZ(8,"j-amount-input",3),t.TgZ(9,"div",4)(10,"button",5),t.NdJ("click",function(){return n.deleteLimit()}),t._uU(11),t.ALo(12,"translate"),t.qZA(),t.TgZ(13,"button",6),t.NdJ("click",function(){return n.updateLimit()}),t._uU(14),t.ALo(15,"translate"),t.qZA()()()),2&e&&(t.Q6J("formGroup",n.form),t.xp6(3),t.hij(" ",t.lcZ(4,11,n.title)," "),t.xp6(3),t.hij(" ",t.lcZ(7,13,n.mapTranslate("DESCRIPTION"))," "),t.xp6(2),t.Q6J("label",n.mapTranslate("LABEL"))("formControl",n.form.controls.amount),t.xp6(2),t.Q6J("jLoading",n.isLoading)("disabled",n.isLoading),t.xp6(1),t.hij(" ",t.lcZ(12,15,n.mapTranslate("RESET"))," "),t.xp6(2),t.Q6J("jLoading",n.isLoading)("disabled",n.isLoading||n.form.invalid),t.xp6(1),t.hij(" ",t.lcZ(15,17,n.mapTranslate("SUBMIT"))," "))},directives:[a._Y,a.JL,a.sg,M.l,a.JJ,a.oH,P.T],pipes:[c.X$],styles:[""]}),i})();var $=r(66013),H=r(21580),G=r(67997);function B(i,o){if(1&i&&(t.TgZ(0,"small",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,e.mapSwitchMessage("NO_LIMITS")))}}const X=function(i){return{amount:i}};function V(i,o){if(1&i&&(t.TgZ(0,"small",6),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"money"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,e.mapSwitchMessage("HAS_LIMIT"),t.VKq(6,X,t.lcZ(3,4,e.payment.limitAmount)))," ")}}function K(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).showCreateLimitModal()}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("disabled",!e.payment.isEnabled),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.mapButtonLabel("SET_LIMIT"))," ")}}function z(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).showEditLimitModal()}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("disabled",!e.payment.isEnabled),t.xp6(1),t.hij(" ",t.lcZ(2,2,e.mapButtonLabel("CHANGE_LIMIT"))," ")}}function W(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"div",7),t.YNc(2,K,3,4,"button",8),t.YNc(3,z,3,4,"button",9),t.qZA(),t.BQk()),2&i){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",!e.payment.limitAmount),t.xp6(1),t.Q6J("ngIf",e.payment.limitAmount)}}let tt=(()=>{class i{constructor(e,n,s,l){this.authorityPermissionsService=e,this.notifierService=n,this.translateService=s,this.modalService=l}onChange(e){return(0,u.mG)(this,void 0,void 0,function*(){try{let n;n=e?yield this.enablePayment():yield this.disablePayment(),!this.payment.permissionId&&(null==n?void 0:n.id)&&(this.payment.permissionId=n.id)}catch(n){this.payment.isEnabled=!this.payment.isEnabled}})}enablePayment(){return(0,u.mG)(this,void 0,void 0,function*(){try{const e=yield this.authorityPermissionsService.grantPermission(this.person,this.payment);return this.notify("ACCESS_ENABLED"),e}catch(e){throw console.log(e),this.notify("ACCESS_ENABLE_FAILED","error"),e}})}disablePayment(){return(0,u.mG)(this,void 0,void 0,function*(){try{const e=yield this.authorityPermissionsService.refusePermission(this.person,this.payment);return this.notify("ACCESS_DISABLED"),e}catch(e){throw console.log(e),this.notify("ACCESS_DISABLE_FAILED","error"),e}})}showCreateLimitModal(){return(0,u.mG)(this,void 0,void 0,function*(){const e=this.createModalRef(U);try{const n=yield e.result;this.payment.limitId=n.id,this.payment.limitAmount=n.limit,this.notify("LIMIT_SET")}catch(n){n&&this.notify("LIMIT_SET_FAILED","error")}})}showEditLimitModal(){return(0,u.mG)(this,void 0,void 0,function*(){const e=this.createModalRef(R);e.componentInstance.limit={id:this.payment.limitId,paymentType:this.payment.type,limit:this.payment.limitAmount};try{const{message:n,limit:s}=yield e.result;"update"===n?(this.payment.limitId=s.id,this.payment.limitAmount=s.limit,this.notify("LIMIT_UPDATED")):(this.payment.limitId=null,this.payment.limitAmount=null,this.notify("LIMIT_DELETED"))}catch(n){"update"===n?this.notify("LIMIT_UPDATE_FAILED","error"):"delete"==n&&this.notify("LIMIT_DELETE_FAILED","error")}})}mapPaymentType(e){return this.mapTranslate(`TYPE.${e}`)}mapButtonLabel(e){return this.mapTranslate(`BUTTON.${e}`)}mapSwitchMessage(e){return this.mapTranslate(`SWITCH.${e}`)}createModalRef(e){const n=this.modalService.open(e,{backdropClass:"backdrop_light",windowClass:"modal_light modal_dictionary",centered:!0});return n.componentInstance.authorityId=this.person.id,n.componentInstance.paymentType=this.payment.type,n}mapTranslate(e){return`AUTHORITIES.PAYMENTS.${e}`}notify(e,n="default"){this.notifierService.notify(n,this.translateService.instant(this.mapTranslate(`MESSAGES.${e}`),{paymentType:this.translateService.instant(this.mapPaymentType(this.payment.type))}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.Eg),t.Y36($.lG),t.Y36(c.sK),t.Y36(y.FF))},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-payment"]],inputs:{payment:"payment",person:"person"},decls:9,vars:7,consts:[[1,"toggle"],[3,"value","valueChange"],[1,"toggle__label"],[1,"d-block"],["class","text-gray",4,"ngIf"],[4,"ngIf"],[1,"text-gray"],[1,"toggle__button"],["class","btn btn-link link-blue p-0",3,"disabled","click",4,"ngIf"],["class","btn btn-link p-0",3,"disabled","click",4,"ngIf"],[1,"btn","btn-link","link-blue","p-0",3,"disabled","click"],[1,"btn","btn-link","p-0",3,"disabled","click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"j-toggle",1),t.NdJ("valueChange",function(l){return n.payment.isEnabled=l})("valueChange",function(l){return n.onChange(l)}),t.qZA(),t.TgZ(2,"span",2)(3,"strong",3),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.YNc(6,B,3,3,"small",4),t.YNc(7,V,4,8,"small",4),t.qZA()(),t.YNc(8,W,4,2,"ng-container",5)),2&e&&(t.xp6(1),t.Q6J("value",n.payment.isEnabled),t.xp6(3),t.Oqu(t.lcZ(5,5,n.mapPaymentType(n.payment.type))),t.xp6(2),t.Q6J("ngIf",!n.payment.limitAmount),t.xp6(1),t.Q6J("ngIf",n.payment.limitAmount),t.xp6(1),t.Q6J("ngIf",!n.payment.isLimitDisabled))},directives:[H.n,p.O5],pipes:[c.X$,G.L],styles:["[_nghost-%COMP%]{display:block;padding:1rem 0}@media (min-width: 670px){[_nghost-%COMP%]{align-items:center;display:flex}}.toggle__label[_ngcontent-%COMP%]{display:block;margin-left:1rem}.toggle[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1rem}@media (min-width: 670px){.toggle[_ngcontent-%COMP%]{margin-bottom:0}}.toggle__button[_ngcontent-%COMP%]{text-align:center;flex-grow:1}@media (min-width: 670px){.toggle__button[_ngcontent-%COMP%]{text-align:right}}"]}),i})();function et(i,o){if(1&i&&(t.TgZ(0,"div",7),t._UZ(1,"j-authorities-payment",8),t.qZA()),2&i){const e=o.$implicit,n=t.oxw(2);t.xp6(1),t.Q6J("payment",e)("person",n.person)}}function it(i,o){if(1&i&&(t.TgZ(0,"div",5),t.YNc(1,et,2,2,"div",6),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.payments)}}const nt=function(){return{height:"80px","background-color":"#ECEEF1"}};function ot(i,o){1&i&&(t.TgZ(0,"div",9),t._UZ(1,"ngx-skeleton-loader",10),t.qZA()),2&i&&(t.xp6(1),t.Q6J("theme",t.DdM(1,nt)))}const st=[h.V_.PENSION,h.V_.SOCIAL,h.V_.MEDICAL,h.V_.TAX,h.V_.SALARY,h.V_.CONVERSION,h.V_.FOREIGN];let rt=(()=>{class i{constructor(e,n){this.authorityPermissionsService=e,this.authorityLimitsService=n,this.isLoading=!0}ngOnInit(){this.loadData()}loadData(){return(0,u.mG)(this,void 0,void 0,function*(){try{const e=yield this.authorityPermissionsService.getPermissions(this.person.id),n=yield this.loadLimits();this.payments=st.map(s=>{const l=e.find(A=>A.paymentType===s),f=n.find(A=>A.paymentType===s);return{type:s,permissionId:l?l.id:null,isEnabled:!l||l.permissions.length>0,limitId:f?f.id:null,limitAmount:f?f.limit:null,isLimitDisabled:[h.V_.CONVERSION,h.V_.FOREIGN].includes(s)}})}catch(e){}finally{this.isLoading=!1}})}loadLimits(){return(0,u.mG)(this,void 0,void 0,function*(){try{return yield this.authorityLimitsService.getLimits(this.person.id)}catch(e){return[]}})}mapTranslate(e){return`AUTHORITIES.PAYMENTS.${e}`}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.Eg),t.Y36(d.Df))},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-payments"]],inputs:{person:"person"},decls:9,vars:8,consts:[[1,"payments__header"],[1,"mb-1"],[1,"mb-0","p3","text-muted"],["class","payments__body",4,"ngIf"],["class","payments__body pt-4 pb-2",4,"ngIf"],[1,"payments__body"],["class","payments__item",4,"ngFor","ngForOf"],[1,"payments__item"],[3,"payment","person"],[1,"payments__body","pt-4","pb-2"],["count","8",3,"theme"]],template:function(e,n){1&e&&(t.TgZ(0,"article",0)(1,"h6",1),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p",2),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.YNc(7,it,2,1,"div",3),t.YNc(8,ot,2,2,"div",4)),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,4,n.mapTranslate("TITLE"))),t.xp6(3),t.Oqu(t.lcZ(6,6,n.mapTranslate("DESCRIPTION"))),t.xp6(2),t.Q6J("ngIf",!n.isLoading),t.xp6(1),t.Q6J("ngIf",n.isLoading))},directives:[p.O5,p.sg,tt,L.xr],pipes:[c.X$],styles:["[_nghost-%COMP%]{background:#fff;border-radius:12px;display:block}.payments__header[_ngcontent-%COMP%], .payments__body[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.payments__header[_ngcontent-%COMP%]{padding-top:22px;padding-bottom:1rem;border-bottom:1px solid #dbdfe2}"]}),i})();function at(i,o){1&i&&(t.ynx(0),t._uU(1," \u2022 "),t.BQk())}function lt(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"p",4),t._uU(2),t.YNc(3,at,2,0,"ng-container",2),t._uU(4),t.ALo(5,"translate"),t.qZA(),t.TgZ(6,"h1",5),t._uU(7),t.qZA(),t.BQk()),2&i){const e=t.oxw();t.xp6(2),t.hij(" ",e.person.position," "),t.xp6(1),t.Q6J("ngIf",e.person.position&&e.person.authority),t.xp6(1),t.hij(" ",t.lcZ(5,6,e.mapAuthority(e.person.authority))," "),t.xp6(3),t.lnq(" ",e.person.lastname," ",e.person.firstname?e.person.firstname[0]+".":"","",e.person.middlename?e.person.middlename[0]+".":""," ")}}const pt=function(){return{width:"300px",height:"24px","margin-bottom":"6px","background-color":"#ECEEF1"}},ut=function(){return{height:"48px","margin-bottom":"0","background-color":"#ECEEF1"}};function mt(i,o){1&i&&(t.ynx(0),t._UZ(1,"ngx-skeleton-loader",6)(2,"ngx-skeleton-loader",6),t.BQk()),2&i&&(t.xp6(1),t.Q6J("theme",t.DdM(2,pt)),t.xp6(1),t.Q6J("theme",t.DdM(3,ut)))}function ct(i,o){if(1&i&&t._UZ(0,"j-authorities-payments",7),2&i){const e=t.oxw();t.Q6J("person",e.person)}}let j=(()=>{class i{constructor(e,n,s){this.router=e,this.route=n,this.companyService=s,this.subscription=new g.w,this.isReady=!1,this.initAuthoritiesSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapAuthority(e){return this.mapTranslate(`AUTHORITY.${e}`)}mapTranslate(e){return`AUTHORITIES.USERS.${e}`}initAuthoritiesSubscription(){this.subscription.add((0,q.aj)([this.route.params,this.companyService.getAuthorizedPersons().pipe((0,v.h)(e=>(null==e?void 0:e.length)>0)).pipe((0,C.K)((e,n)=>(console.log(e),this.onClose(),(0,b.of)([]))))]).subscribe(([e,n])=>{this.initPerson(n.find(s=>s.id===e.id))}))}initPerson(e){return(0,u.mG)(this,void 0,void 0,function*(){e||this.onClose(),this.person=e,this.isReady=!0})}onClose(){this.router.navigate(["/authorities/main"])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(_.J))},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-limits"]],decls:7,vars:3,consts:[["closePosition","outside","colsClassList","offset-lg-1 col-lg-8","bodyClassList","py-5",3,"closed"],[1,"limits__header",2,"position","relative"],[4,"ngIf"],[3,"person",4,"ngIf"],[1,"text-muted","limits__position"],[1,"limits__name"],[3,"theme"],[3,"person"]],template:function(e,n){1&e&&(t.TgZ(0,"f-page",0),t.NdJ("closed",function(){return n.onClose()}),t.TgZ(1,"f-page-header")(2,"div",1),t.YNc(3,lt,8,8,"ng-container",2),t.YNc(4,mt,3,4,"ng-container",2),t.qZA()(),t.TgZ(5,"f-page-body"),t.YNc(6,ct,1,1,"j-authorities-payments",3),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngIf",n.person&&n.isReady),t.xp6(1),t.Q6J("ngIf",!n.person||!n.isReady),t.xp6(2),t.Q6J("ngIf",n.person&&n.isReady))},directives:[x.J,I.M,p.O5,L.xr,O.G,rt],pipes:[c.X$],styles:[".limits__position[_ngcontent-%COMP%]{margin-bottom:6px}.limits__name[_ngcontent-%COMP%]{line-height:60px;margin-bottom:0}.limits__header[_ngcontent-%COMP%]{margin-bottom:60px}"]}),i})();function dt(i,o){if(1&i&&(t.TgZ(0,"a",3),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=o.$implicit,n=t.oxw();t.Q6J("routerLink",e),t.xp6(1),t.hij(" ",t.lcZ(2,2,n.mapTranslate(e))," ")}}let ht=(()=>{class i{constructor(e){this.authoritiesService=e,this.links=["users","otp"],this.subscription=new g.w,this.initSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapTranslate(e){return`AUTHORITIES.MAIN.NAV.${e.toUpperCase()}`}initSubscription(){this.subscription.add(this.authoritiesService.getOtpDevices().subscribe(e=>{(null==e?void 0:e.length)>0?this.links.includes("otp")||this.links.push("otp"):this.links.includes("otp")&&this.links.splice(this.links.indexOf("otp"),1)}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.lv))},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-nav"]],decls:3,vars:1,consts:[[1,"f-page-tabs-wrap"],[1,"f-page-tabs"],["routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],["routerLinkActive","active",3,"routerLink"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"nav",1),t.YNc(2,dt,3,4,"a",2),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngForOf",n.links))},directives:[p.sg,m.yS,m.Od],pipes:[c.X$],styles:[""]}),i})(),N=(()=>{class i{constructor(e){this.router=e}onClose(){this.router.navigate(["/settings"])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(m.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-main"]],decls:8,vars:3,consts:[["closePosition","outside","colsClassList","offset-lg-1 col-lg-11 offset-xl-2 col-xl-10","bodyClassList","py-5",3,"closed"],[1,"f-page-title"]],template:function(e,n){1&e&&(t.TgZ(0,"f-page",0),t.NdJ("closed",function(){return n.onClose()}),t.TgZ(1,"f-page-header")(2,"h1",1),t._uU(3),t.ALo(4,"translate"),t.qZA(),t._UZ(5,"j-authorities-nav"),t.qZA(),t.TgZ(6,"f-page-body"),t._UZ(7,"router-outlet"),t.qZA()()),2&e&&(t.xp6(3),t.Oqu(t.lcZ(4,1,"AUTHORITIES.MAIN.TITLE")))},directives:[x.J,I.M,ht,O.G,m.lC],pipes:[c.X$],styles:[""]}),i})(),F=(()=>{class i{constructor(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-order"]],decls:2,vars:0,template:function(e,n){1&e&&(t.TgZ(0,"p"),t._uU(1," authorities-order works!\n"),t.qZA())},styles:[""]}),i})();function gt(i,o){if(1&i&&(t.TgZ(0,"th",3),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=o.$implicit,n=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,n.mapTableHeading(e)))}}function ft(i,o){if(1&i&&(t.TgZ(0,"tr")(1,"td")(2,"div",4),t._uU(3),t.qZA()(),t.TgZ(4,"td")(5,"div",5),t._uU(6),t.qZA()()()),2&i){const e=o.$implicit;t.xp6(3),t.hij(" ",e.serial," "),t.xp6(3),t.lnq(" ",null==e.user?null:e.user.lastname," ",null!=e.user&&e.user.firstname?(null==e.user?null:e.user.firstname[0])+".":""," ",null!=e.user&&e.user.middlename?(null==e.user?null:e.user.middlename[0])+".":""," ")}}let J=(()=>{class i{constructor(e){this.authoritiesService=e,this.otpDevices=[],this.headings=["SERIAL","USER"],this.subscription=new g.w,this.initSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapTableHeading(e){return e?this.mapTranslate(`TABLE.${e}`):""}mapTranslate(e){return`AUTHORITIES.OTP.${e}`}initSubscription(){this.subscription.add(this.authoritiesService.getOtpDevices().subscribe(e=>{this.otpDevices=e}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.lv))},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-otp"]],decls:6,vars:2,consts:[[1,"j-authorities-table"],["class","p4 text-muted",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p4","text-muted"],[1,"p4","text-dark"],[1,"p2","text-dark"]],template:function(e,n){1&e&&(t.TgZ(0,"table",0)(1,"thead")(2,"tr"),t.YNc(3,gt,3,3,"th",1),t.qZA()(),t.TgZ(4,"tbody"),t.YNc(5,ft,7,4,"tr",2),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngForOf",n.headings),t.xp6(2),t.Q6J("ngForOf",n.otpDevices))},directives:[p.sg],pipes:[c.X$],styles:[".j-authorities-table[_ngcontent-%COMP%]{background:#fff;width:100%;border-radius:12px}.j-authorities-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e9ebec}.j-authorities-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.j-authorities-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 16px;font-weight:400}.j-authorities-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 16px}"]}),i})();var Y=r(15057);function _t(i,o){if(1&i&&(t.TgZ(0,"th",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=o.$implicit,n=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,n.mapTableHeading(e)))}}function yt(i,o){if(1&i&&(t.TgZ(0,"th",6),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=o.$implicit,n=t.oxw(2);t.xp6(1),t.Oqu(t.lcZ(2,1,n.mapTableHeading(e)))}}function At(i,o){if(1&i&&(t.ynx(0),t.YNc(1,yt,3,3,"th",3),t.BQk()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.primaryHeadings)}}function Tt(i,o){1&i&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&i&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SHARED.DATE_FROM")," "))}function bt(i,o){1&i&&(t.ynx(0),t._uU(1," \u2014 "),t._UZ(2,"br"),t.BQk())}function vt(i,o){if(1&i&&(t.TgZ(0,"span",11),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.Oqu(t.lcZ(2,1,e.mapTranslate("LIMITS_LINK")))}}function Ct(i,o){if(1&i&&(t.TgZ(0,"a",12),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=t.oxw(2).$implicit,n=t.oxw();t.Q6J("routerLink","/authorities/limits/"+e.id),t.xp6(1),t.Oqu(t.lcZ(2,2,n.mapTranslate("LIMITS_LINK")))}}function xt(i,o){if(1&i&&(t.ynx(0),t.TgZ(1,"td"),t.YNc(2,vt,3,3,"span",9),t.YNc(3,Ct,3,4,"a",10),t.qZA(),t.BQk()),2&i){const e=t.oxw().$implicit,n=t.oxw();t.xp6(2),t.Q6J("ngIf",n.currentUserId===e.userId),t.xp6(1),t.Q6J("ngIf",n.currentUserId!==e.userId)}}function It(i,o){if(1&i&&(t.TgZ(0,"tr")(1,"td")(2,"div",7),t._uU(3),t.qZA(),t.TgZ(4,"div",6),t._uU(5),t.qZA()(),t.TgZ(6,"td")(7,"div",8),t._uU(8),t.ALo(9,"translate"),t.qZA()(),t.TgZ(10,"td")(11,"div",8),t.YNc(12,Tt,3,3,"ng-container",4),t._uU(13),t.ALo(14,"date"),t.YNc(15,bt,3,0,"ng-container",4),t._uU(16),t.ALo(17,"date"),t.qZA()(),t.YNc(18,xt,4,2,"ng-container",4),t.qZA()),2&i){const e=o.$implicit,n=t.oxw();t.xp6(3),t.lnq(" ",e.lastname," ",e.firstname?e.firstname[0]+".":""," ",e.middlename?e.middlename[0]+".":""," "),t.xp6(2),t.hij(" ",e.position," "),t.xp6(3),t.hij(" ",t.lcZ(9,10,n.mapAuthority(e.authority))," "),t.xp6(4),t.Q6J("ngIf",!e.toDate),t.xp6(1),t.hij(" ",t.xi3(14,12,e.fromDate,"dd MMM yyyy")," "),t.xp6(2),t.Q6J("ngIf",e.toDate),t.xp6(1),t.hij(" ",t.xi3(17,15,e.toDate,"dd MMM yyyy")," "),t.xp6(2),t.Q6J("ngIf",n.isPrimaryAuthority&&!n.isFeatureDisabled)}}let Lt=(()=>{class i{constructor(e,n,s){this.companyService=e,this.authoritiesService=n,this.featureFlagsService=s,this.persons=[],this.isPrimaryAuthority=!1,this.headings=["USER","TYPE","DURATION"],this.primaryHeadings=[""],this.isFeatureDisabled=!1,this.subscription=new g.w,this.restrictions=[],this.initCompanySubscription(),this.initFeatureFlagsSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}mapAuthority(e){return this.mapTranslate(`AUTHORITY.${e}`)}mapRestrictions(e){return this.mapTranslate(`RESTRICTIONS.${e}`)}mapTableHeading(e){return e?this.mapTranslate(`TABLE.${e}`):""}mapTranslate(e){return`AUTHORITIES.USERS.${e}`}initCompanySubscription(){this.subscription.add(this.companyService.refresh$.pipe((0,v.h)(([,,e])=>e)).subscribe(([e,n])=>{this.currentUserId=null==e?void 0:e.id,this.isPrimaryAuthority=this.companyService.isPrimaryAuthority(n.authority),this.isPrimaryAuthority&&this.retrieveRestrictions()}))}initFeatureFlagsSubscription(){this.subscription.add(this.featureFlagsService.featureFlags$.subscribe(()=>{this.isFeatureDisabled=this.featureFlagsService.isDisabled(Y.Y.PAYMENT_PERMISSIONS)}))}retrieveRestrictions(){return(0,u.mG)(this,void 0,void 0,function*(){this.restrictions=yield this.authoritiesService.fetchRestrictions()})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(_.J),t.Y36(d.lv),t.Y36(Y.a))},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-registered"]],inputs:{persons:"persons"},decls:14,vars:9,consts:[[1,"mb-1"],[1,"p3","text-muted"],[1,"j-authorities-table"],["class","p4 text-muted",4,"ngFor","ngForOf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"p4","text-muted"],[1,"p2","text-dark"],[1,"p4","text-dark"],["class","p3 text-disabled",4,"ngIf"],["class","p3 link-blue",3,"routerLink",4,"ngIf"],[1,"p3","text-disabled"],[1,"p3","link-blue",3,"routerLink"]],template:function(e,n){1&e&&(t.TgZ(0,"article")(1,"h6",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p",1),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"table",2)(8,"thead")(9,"tr"),t.YNc(10,_t,3,3,"th",3),t.YNc(11,At,2,1,"ng-container",4),t.qZA()(),t.TgZ(12,"tbody"),t.YNc(13,It,19,18,"tr",5),t.qZA()()),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,5,"AUTHORITIES.USERS.REGISTERED.TITLE")),t.xp6(3),t.Oqu(t.lcZ(6,7,"AUTHORITIES.USERS.REGISTERED.DESCRIPTION")),t.xp6(5),t.Q6J("ngForOf",n.headings),t.xp6(1),t.Q6J("ngIf",n.isPrimaryAuthority),t.xp6(2),t.Q6J("ngForOf",n.persons))},directives:[p.sg,p.O5,m.yS],pipes:[c.X$,p.uU],styles:[".j-authorities-table[_ngcontent-%COMP%]{background:#fff;width:100%;border-radius:12px}.j-authorities-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e9ebec}.j-authorities-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.j-authorities-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 16px;font-weight:400}.j-authorities-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 16px}.restriction[_ngcontent-%COMP%]{background:#f2f2f7;border-radius:12px;padding:0 8px;display:inline-block}.restriction--danger[_ngcontent-%COMP%]{background:#ffefef}"]}),i})();var Ot=r(46805);function Zt(i,o){if(1&i&&(t.TgZ(0,"th",5),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i){const e=o.$implicit,n=t.oxw();t.xp6(1),t.Oqu(t.lcZ(2,1,n.mapTableHeading(e)))}}function St(i,o){if(1&i&&(t.TgZ(0,"tr")(1,"td")(2,"div",6),t._uU(3),t.qZA(),t.TgZ(4,"div",5),t._uU(5),t.qZA()(),t.TgZ(6,"td")(7,"div",5),t._uU(8),t.ALo(9,"mask"),t.qZA()(),t.TgZ(10,"td")(11,"div",5),t._uU(12),t.qZA()()()),2&i){const e=o.$implicit;t.xp6(3),t.lnq(" ",e.lastname," ",e.firstname?e.firstname[0]+".":""," ",e.middlename?e.middlename[0]+".":""," "),t.xp6(2),t.hij(" ",e.position," "),t.xp6(3),t.hij(" ",e.phone?t.xi3(9,6,e.phone,"+0 (000) 000 00 00"):"\u2014"," "),t.xp6(4),t.hij(" ",e.iin||"\u2014"," ")}}let Et=(()=>{class i{constructor(){this.persons=[],this.headings=["USER","IIN","PHONE"]}mapTableHeading(e){return e?this.mapTranslate(`TABLE.${e}`):""}mapTranslate(e){return`AUTHORITIES.USERS.${e}`}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-unregistered"]],inputs:{persons:"persons"},decls:13,vars:8,consts:[[1,"mb-1"],[1,"p3","text-muted"],[1,"j-authorities-table","j-authorities-table--unregistered"],["class","p4 text-muted",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"p4","text-muted"],[1,"p2","text-dark"]],template:function(e,n){1&e&&(t.TgZ(0,"article")(1,"h6",0),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p",1),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"table",2)(8,"thead")(9,"tr"),t.YNc(10,Zt,3,3,"th",3),t.qZA()(),t.TgZ(11,"tbody"),t.YNc(12,St,13,9,"tr",4),t.qZA()()),2&e&&(t.xp6(2),t.Oqu(t.lcZ(3,4,"AUTHORITIES.USERS.UNREGISTERED.TITLE")),t.xp6(3),t.Oqu(t.lcZ(6,6,"AUTHORITIES.USERS.UNREGISTERED.DESCRIPTION")),t.xp6(5),t.Q6J("ngForOf",n.headings),t.xp6(2),t.Q6J("ngForOf",n.persons))},directives:[p.sg],pipes:[c.X$,Ot.Iq],styles:[".j-authorities-table[_ngcontent-%COMP%]{background:#fff;width:100%;border-radius:12px}.j-authorities-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e9ebec}.j-authorities-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.j-authorities-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:14px 16px;font-weight:400}.j-authorities-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 16px}[_nghost-%COMP%]{display:block;margin-top:2.5rem}.j-authorities-table--unregistered[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{opacity:.6}"]}),i})();function Mt(i,o){if(1&i&&t._UZ(0,"j-authorities-registered",1),2&i){const e=t.oxw();t.Q6J("persons",e.registered)}}function Pt(i,o){if(1&i&&t._UZ(0,"j-authorities-unregistered",1),2&i){const e=t.oxw();t.Q6J("persons",e.unregistered)}}let k=(()=>{class i{constructor(e){this.companyService=e,this.registered=[],this.unregistered=[],this.subscription=new g.w,this.initAuthoritiesSubscription()}ngOnDestroy(){this.subscription.unsubscribe()}initAuthoritiesSubscription(){this.subscription.add(this.companyService.getAuthorizedPersons().pipe((0,C.K)((e,n)=>(console.log(e),(0,b.of)([])))).subscribe(e=>{(null==e?void 0:e.length)>0&&(this.registered=e.filter(n=>!!n.userId),this.unregistered=e.filter(n=>!n.userId))}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(_.J))},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities-users"]],decls:2,vars:2,consts:[[3,"persons",4,"ngIf"],[3,"persons"]],template:function(e,n){1&e&&(t.YNc(0,Mt,1,1,"j-authorities-registered",0),t.YNc(1,Pt,1,1,"j-authorities-unregistered",0)),2&e&&(t.Q6J("ngIf",(null==n.registered?null:n.registered.length)>0),t.xp6(1),t.Q6J("ngIf",(null==n.unregistered?null:n.unregistered.length)>0))},directives:[p.O5,Lt,Et],styles:[""]}),i})();const Ut=[{path:"",component:(()=>{class i{constructor(){}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["j-authorities"]],decls:1,vars:0,template:function(e,n){1&e&&t._UZ(0,"router-outlet")},directives:[m.lC],styles:[""]}),i})(),data:{title:"SETTINGS.TITLE"},children:[{path:"main",component:N,children:[{path:"users",component:k},{path:"order",component:F},{path:"otp",canActivate:[Q],component:J},{path:"**",redirectTo:"users"}]},{path:"limits/:id",component:j},{path:"**",redirectTo:"main"}]}];let Rt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[m.Bz.forChild(Ut)],m.Bz]}),i})(),jt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[p.ez,a.u5,a.UX,D.m,Rt]]}),i})()}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{DVvf:function(t,e,i){"use strict";i.r(e);var n=i("ofXK"),o=i("3Pt+"),s=i("tk/3"),r=i("sYmb"),c=i("xJkR"),a=i("4Nuw"),l=i("PCNd"),u=i("tyNb"),d=i("fXoL"),m=i("bsP8"),h=i("S1F0"),b=i("oKsb"),f=i("fvpk"),p=i("mrSG"),v=i("quSY"),y=i("lJxs"),A=i("TwVa"),S=i("+/Tu"),g=i("zwEd"),R=i("Kd2e"),T=i("1kSV");function E(t,e){if(1&t&&d.Rb(0,"p",10),2&t){const t=d.lc();d.sc("innerHTML",t.errorText,d.Hc)}}let w=(()=>{class t{constructor(t,e){this.modal=t,this.router=e}dismissModal(){this.modal.dismiss()}closeModal(){this.router.navigate(["/transfers"]),this.modal.close()}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(T.a),d.Qb(u.c))},t.\u0275cmp=d.Kb({type:t,selectors:[["j-transfer-error"]],inputs:{description:"description",errorText:"errorText"},decls:15,vars:5,consts:[[1,"modal-header","j-modal-header"],[1,"modal-body","px-4","pt-0","pb-4","text-center"],["src","./assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted"],["translate",""],["class","mt-3 mb-0 text-danger",3,"innerHTML",4,"ngIf"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-primary","btn-block","mb-3",3,"click"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[1,"mt-3","mb-0","text-danger",3,"innerHTML"]],template:function(t,e){1&t&&(d.Rb(0,"div",0),d.Wb(1,"div",1),d.Rb(2,"img",2),d.mc(3,"translate"),d.Wb(4,"h3",3),d.Rc(5,"SHARED.ERROR"),d.Vb(),d.Wb(6,"p",4),d.Wb(7,"span",5),d.Rc(8),d.Vb(),d.Vb(),d.Pc(9,E,1,1,"p",6),d.Vb(),d.Wb(10,"div",7),d.Wb(11,"button",8),d.ic("click",(function(t){return e.closeModal()})),d.Rc(12," SHARED.TRY_AGAIN "),d.Vb(),d.Wb(13,"button",9),d.ic("click",(function(t){return e.dismissModal()})),d.Rc(14," SHARED.BACK_TO_HOME "),d.Vb(),d.Vb()),2&t&&(d.Ab(2),d.tc("alt",d.nc(3,3,"SHARED.ERROR")),d.Ab(6),d.Sc(e.description),d.Ab(1),d.sc("ngIf",e.errorText))},directives:[r.a,n.u],pipes:[r.d],styles:[""]}),t})();var C=i("Kx/q");let N=(()=>{class t{constructor(t){this.modal=t}dismissModal(){this.modal.dismiss()}closeModal(){this.modal.close()}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(T.a))},t.\u0275cmp=d.Kb({type:t,selectors:[["j-transfer-success"]],inputs:{description:"description",totalBalance:"totalBalance"},decls:14,vars:5,consts:[[1,"modal-header","j-modal-header"],[1,"modal-body","j-modal-body","text-center","pb-4"],["src","./assets/img/history/modals/success.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[3,"money"],["translate","",1,"m-0","text-muted"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-primary","btn-block","mb-3",3,"click"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"]],template:function(t,e){1&t&&(d.Rb(0,"div",0),d.Wb(1,"div",1),d.Rb(2,"img",2),d.mc(3,"translate"),d.Wb(4,"h3",3),d.Wb(5,"strong"),d.Rb(6,"j-money",4),d.Vb(),d.Vb(),d.Wb(7,"p",5),d.Rc(8),d.Vb(),d.Vb(),d.Wb(9,"div",6),d.Wb(10,"button",7),d.ic("click",(function(t){return e.closeModal()})),d.Rc(11," TRANSFERS.NAVIGATE_TO_HISTORY "),d.Vb(),d.Wb(12,"button",8),d.ic("click",(function(t){return e.dismissModal()})),d.Rc(13," SHARED.BACK_TO_HOME "),d.Vb(),d.Vb()),2&t&&(d.Ab(2),d.tc("alt",d.nc(3,3,e.description)),d.Ab(4),d.sc("money",e.totalBalance),d.Ab(2),d.Tc(" ",e.description," "))},directives:[r.a,C.a],pipes:[r.d],styles:[""]}),t})();var O=i("y5b2"),I=i("L+ju"),F=i("+BgI"),k=i("wtV8"),P=i("mR7B");let V=(()=>{class t{constructor(t,e,i){this.paymentsPipelineService=t,this.paymentsApiService=e,this.maskedService=i}getTransferById(t){return this.paymentsApiService.getPaymentById(t)}saveEditedTransfer(t,e){return this.paymentsApiService.updatePayment(Object.assign(Object.assign({},e),this.mapTransferOwnPaymentBody(t)),{paymentId:t.id})}createOwnTransfer(t){return Object(p.a)(this,void 0,void 0,(function*(){try{return this.paymentsApiService.createPayment(this.mapTransferOwnPaymentBody(t))}catch(e){throw e}}))}createAndSignOwnTransfer(t){return Object(p.a)(this,void 0,void 0,(function*(){const e=yield this.createOwnTransfer(t);return this.paymentsPipelineService.processPaymentVerify(e)}))}mapTransferOwnPaymentBody(t){let e=A.i.IN_BETWEEN,i=null;t.fromAccount.accountType===I.a.ACCOUNT&&t.toAccount.accountType===I.a.CARD&&(e=A.i.ACCOUNT_TO_CARD),t.fromAccount.accountType===I.a.CARD&&t.toAccount.accountType===I.a.ACCOUNT&&(e=A.i.CARD_TO_ACCOUNT,i=t.fromAccount.accountId),t.fromAccount.accountType===I.a.CARD&&t.toAccount.accountType===I.a.CARD&&(e=A.i.CARD_TO_CARD,i=t.fromAccount.accountId);let n={type:e,category:A.g.DOMESTIC,paymentRecipient:{recipientAccount:{iban:t.to}},details:{payerIban:t.from,paymentAmount:{amount:this.maskedService.getNumberedAmount(t.amount),currency:S.a.KZT},documentId:t.documentNumber,associatedField:{parameters:{payerCardNumber:t.fromAccount.accountType===I.a.CARD?t.fromAccount.cardNumber:null,recipientCardNumber:t.toAccount.accountType===I.a.CARD?t.toAccount.cardNumber:null}}}};return i&&(n.details=Object.assign(Object.assign({},n.details),{payerAccountId:i})),n}mapTransferOwnToPayment(t,e){return e.paymentRecipient.recipientAccount.iban=t.to,e.details.payerIban=t.from,e.details.paymentAmount.amount=this.maskedService.getNumberedAmount(t.amount),e.details.documentId=t.documentNumber,e}}return t.\u0275fac=function(e){return new(e||t)(d.ec(F.a),d.ec(k.a),d.ec(P.a))},t.\u0275prov=d.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var D=i("VnnJ"),j=i("CVrE"),L=i("7rOj"),_=i("+eKG"),M=i("VO+5"),x=i("2A1n"),W=i("kDIH"),B=i("hsBV"),H=i("9odQ"),Q=i("NpBu");const U=["fromDropdown"],G=["toDropdown"],K=function(){return{height:"56px","background-color":"#ECEEF1"}},q=function(){return{height:"56px",width:"200px","background-color":"#ECEEF1"}};function X(t,e){1&t&&(d.Ub(0),d.Rb(1,"ngx-skeleton-loader",3),d.Rb(2,"ngx-skeleton-loader",3),d.Rb(3,"ngx-skeleton-loader",3),d.Rb(4,"ngx-skeleton-loader",3),d.Wb(5,"div",4),d.Rb(6,"ngx-skeleton-loader",3),d.Vb(),d.Tb()),2&t&&(d.Ab(1),d.sc("theme",d.wc(5,K)),d.Ab(1),d.sc("theme",d.wc(6,K)),d.Ab(1),d.sc("theme",d.wc(7,K)),d.Ab(1),d.sc("theme",d.wc(8,K)),d.Ab(2),d.sc("theme",d.wc(9,q)))}function J(t,e){1&t&&d.Rb(0,"j-restricted-placeholder",5)}function Y(t,e){if(1&t&&(d.Rb(0,"p",17),d.mc(1,"translate")),2&t){const t=d.lc(2);d.sc("innerHTML",d.oc(1,1,"TRANSFERS.NOT_ENOUGH",t.translateParams),d.Hc)}}function Z(t,e){if(1&t){const t=d.Xb();d.Wb(0,"div",18),d.Wb(1,"button",19),d.ic("click",(function(e){return d.Gc(t),d.lc(2).edit()})),d.Rc(2,"TRANSFERS.SAVE"),d.Vb(),d.Vb()}}function z(t,e){if(1&t){const t=d.Xb();d.Wb(0,"button",19),d.ic("click",(function(e){return d.Gc(t),d.lc(3).createOnly()})),d.Rc(1,"TRANSFERS.FOR_SIGN"),d.Vb()}}function $(t,e){if(1&t){const t=d.Xb();d.Wb(0,"button",22),d.ic("click",(function(e){return d.Gc(t),d.lc(3).createAndSign()})),d.Rc(1,"TRANSFERS.SIGN"),d.Vb()}}function tt(t,e){if(1&t){const t=d.Xb();d.Wb(0,"button",22),d.ic("click",(function(e){return d.Gc(t),d.lc(3).createOnly()})),d.Rc(1,"TRANSFERS.SEND"),d.Vb()}}function et(t,e){if(1&t&&(d.Wb(0,"div",18),d.Pc(1,z,2,0,"button",20),d.Pc(2,$,2,0,"button",21),d.Pc(3,tt,2,0,"button",21),d.Vb()),2&t){const t=d.lc(2);d.Ab(1),d.sc("ngIf",t.canSendAndSign),d.Ab(1),d.sc("ngIf",t.canSendAndSign),d.Ab(1),d.sc("ngIf",t.canSendOnly)}}function it(t,e){if(1&t){const t=d.Xb();d.Ub(0),d.Wb(1,"form",6),d.Wb(2,"div",7),d.Wb(3,"j-account-dropdown",8,9),d.ic("selected",(function(e){return d.Gc(t),d.lc().onFromSelect(e)})),d.Vb(),d.Vb(),d.Wb(5,"div",10),d.Wb(6,"j-account-dropdown",11,12),d.ic("selected",(function(e){return d.Gc(t),d.lc().onToSelect(e)})),d.Vb(),d.Vb(),d.Wb(8,"div",10),d.Rb(9,"j-input",13),d.Vb(),d.Wb(10,"div",10),d.Rb(11,"j-amount-input",14),d.Pc(12,Y,2,4,"p",15),d.Vb(),d.Pc(13,Z,3,0,"div",16),d.Pc(14,et,4,3,"div",16),d.Vb(),d.Tb()}if(2&t){const t=d.lc();d.Ab(1),d.sc("formGroup",t.transferForm),d.Ab(2),d.sc("hasError",t.f.from.invalid&&t.isSubmitted)("accounts",t.fromAccounts)("isDisabledSelectable",!1)("isLoading",t.isAccountsLoading)("isFromArrowShown",!0),d.Ab(3),d.sc("hasError",t.f.to.invalid&&t.isSubmitted)("accounts",t.toAccounts)("isLoading",t.isAccountsLoading)("isDisabledSelectable",!0),d.Ab(3),d.sc("hasError",t.f.documentNumber.invalid&&t.isSubmitted)("isClearable",!1)("formControl",t.f.documentNumber),d.Ab(2),d.sc("hasError",t.f.amount.invalid&&t.isSubmitted)("helperText","TRANSFERS.COMMISSION")("helperTextParams",t.commissionParams)("formControl",t.f.amount),d.Ab(1),d.sc("ngIf",t.hasUnsufficientFunds),d.Ab(1),d.sc("ngIf",t.isEditing),d.Ab(1),d.sc("ngIf",!t.isEditing)}}let nt=(()=>{class t{constructor(t,e,i,n,s,r,c,a,l,u,d,m,h,b,f,p,y){this.route=t,this.transfersService=e,this.companyService=i,this.paymentsService=n,this.accountsService=s,this.amountFormatPipe=r,this.modalService=c,this.router=a,this.maskedService=l,this.paymentsApiService=u,this.cardsService=d,this.featureFlagsService=m,this.notifierService=h,this.translateService=b,this.moneyPipe=f,this.navService=p,this.authorityPermissionsService=y,this.isRestricted=!1,this.isSubmitted=!1,this.isLoading=!0,this.repeatPayment=null,this.commissionParams={amount:this.moneyPipe.transform({amount:0,currency:S.a.KZT})},this.subscription=new v.a,this.isAccountsLoading=!0,this.transferForm=new o.k({id:new o.h(""),from:new o.h("",[o.H.required]),fromAccount:new o.h(null),to:new o.h("",[o.H.required]),toAccount:new o.h(null),documentNumber:new o.h("",[o.H.required]),amount:new o.h("",[o.H.required,t=>{var e;return 0==(null===(e=t)||void 0===e?void 0:e.value)?{cantBeZero:!0}:null}])})}ngOnInit(){const t=this.route.params.subscribe(t=>{t.id&&(this.f.id.setValue(t.id),this.isEditing=!0)});this.subscription.add(t)}ngAfterViewInit(){this.getPermission().then(()=>{this.isRestricted?this.isLoading=!1:this.initPage()})}initPage(){const t=this.route.paramMap.pipe(Object(y.a)(()=>window.history.state)).subscribe(t=>{this.isEditing?this.loadEditTransfer(this.f.id.value):t.repeatPaymentId?this.loadRepeatTransfer(t.repeatPaymentId):this.loadNewTransfer()}),e=this.transferForm.valueChanges.subscribe(t=>{this.isSubmitted=!1});this.subscription.add(t),this.subscription.add(e)}ngOnDestroy(){this.subscription.unsubscribe()}get fromAccounts(){var t;return null===(t=this.accounts)||void 0===t?void 0:t.filter(t=>!(t.accountType===a.a.CARD&&t.category===g.a.PRIVATE))}get toAccounts(){return this.accounts}get canSendAndSign(){return this.companyService.isSecondaryAuthority()||this.companyService.isPrimaryAuthority()&&this.companyService.isSingleSignScheme()}get canSendOnly(){return this.companyService.isNoSignAuthority()||this.companyService.isPrimaryAuthority()&&this.companyService.isMultipleSignScheme()}get f(){return this.transferForm.controls}get translateParams(){return{amount:this.amountFormatPipe.transform(this.amountDelta)}}get hasUnsufficientFunds(){return this.amountDelta>0}onFromSelect(t){t&&(this.selectFromAccount(t),this.applyClearOnFromSelectedRule(t),this.applySelectFromCompanionRule(t))}onToSelect(t){t&&(this.selectToAccount(t),this.applyClearOnToSelectedRule(t),this.applySelectToCompanionRule(t))}loadRepeatTransfer(t){return Object(p.a)(this,void 0,void 0,(function*(){this.isLoading=!0;const e=yield Promise.all([this.transfersService.getTransferById(t),this.retrieveAccounts()]);this.applyOnlyAccountRule();const[i]=e,n=yield this.mapRepeatTransferFromPayment(i);this.initRepeatTransfer(n),this.setAutoNumeration(),this.isLoading=!1}))}loadEditTransfer(t){return Object(p.a)(this,void 0,void 0,(function*(){this.isLoading=!0,this.originalPayment=yield this.transfersService.getTransferById(t);const e=yield this.mapRepeatTransferFromPayment(this.originalPayment);yield this.retrieveAccounts(),this.applyOnlyAccountRule(),this.initRepeatTransfer(e),this.isLoading=!1}))}loadNewTransfer(){return Object(p.a)(this,void 0,void 0,(function*(){this.isLoading=!0,yield this.retrieveAccounts(),this.setAutoNumeration(),this.isLoading=!1}))}edit(){return Object(p.a)(this,void 0,void 0,(function*(){if(this.isSubmitted=!0,!this.transferForm.invalid)try{yield this.transfersService.saveEditedTransfer(this.transferForm.value,this.originalPayment),this.showEditSuccess()}catch(t){this.showEditError(t)}}))}createOnly(){return Object(p.a)(this,void 0,void 0,(function*(){if(this.isSubmitted=!0,this.transferForm.invalid)return;this.isLoading=!0;const t=this.transferForm.getRawValue();if(!(yield this.checkIfAllowedToCreate(t.amount)))return void(this.isLoading=!1);const e=this.paymentsService.paymentNumber;try{yield this.transfersService.createOwnTransfer(t),this.showCreateSuccess(),e.entity=null}catch(i){e.entity=this.f.documentNumber.value,this.showCreateError(i)}finally{this.isLoading=!1}}))}createAndSign(){return Object(p.a)(this,void 0,void 0,(function*(){if(this.isSubmitted=!0,this.transferForm.invalid)return;this.isLoading=!0;const t=this.transferForm.getRawValue();if(!(yield this.checkIfAllowedToCreate(t.amount)))return void(this.isLoading=!1);const e=this.paymentsService.paymentNumber;try{yield this.transfersService.createAndSignOwnTransfer(t),this.showCreateAndSignSuccess(),e.entity=null}catch(i){e.entity=this.f.documentNumber.value,this.showCreateAndSignError(i)}finally{this.isLoading=!1}}))}getPermission(){return Object(p.a)(this,void 0,void 0,(function*(){try{this.isRestricted=yield this.authorityPermissionsService.isRestricted(A.i.IN_BETWEEN)}catch(t){this.isRestricted=!1}}))}checkIfAllowedToCreate(t){return Object(p.a)(this,void 0,void 0,(function*(){const e=yield this.paymentsApiService.checkWorkingTime(),i=yield this.paymentsApiService.checkAmountLimit(t,A.i.IN_BETWEEN);return console.log(e,i),e&&i}))}mapRepeatTransferFromPayment(t){var e,i,n,o,s;return Object(p.a)(this,void 0,void 0,(function*(){yield this.retrieveAccounts();let r=null===(e=t.details)||void 0===e?void 0:e.payerIban;return t.type!==A.i.CARD_TO_CARD&&t.type!==A.i.CARD_TO_ACCOUNT||(r=this.fromAccounts.find(e=>{var i;return e.accountType===a.a.CARD&&e.accountId===(null===(i=t.details)||void 0===i?void 0:i.payerAccountId)}).iban),{to:null===(n=null===(i=t.paymentRecipient)||void 0===i?void 0:i.recipientAccount)||void 0===n?void 0:n.iban,toAccount:this.toAccounts.find(e=>{var i,n;return e.iban===(null===(n=null===(i=t.paymentRecipient)||void 0===i?void 0:i.recipientAccount)||void 0===n?void 0:n.iban)}),from:r,fromAccount:this.fromAccounts.find(t=>t.iban===r),documentNumber:null===(o=t.details)||void 0===o?void 0:o.documentId,amount:null===(s=t.details)||void 0===s?void 0:s.paymentAmount.amount}}))}initRepeatTransfer(t){t&&(this.selectToAccountByIban(t.to),this.selectFromAccountByIban(t.from),this.f.documentNumber.setValue(t.documentNumber),this.f.amount.setValue(this.maskedService.getMaskedAmount(t.amount)))}get amountDelta(){var t,e;const{amount:i}=this.transferForm.getRawValue();return this.maskedService.getNumberedAmount(i)-(null===(e=null===(t=this.from)||void 0===t?void 0:t.balance)||void 0===e?void 0:e.amount)}applySelectToCompanionRule(t){var e,i;if(2==(null===(e=this.accounts)||void 0===e?void 0:e.length)){const e=this.findUnselectedAccount(t);this.selectFromAccount(e),null===(i=this.fromDropdown)||void 0===i||i.selectAccount(e)}}applySelectFromCompanionRule(t){var e,i;if(2==(null===(e=this.accounts)||void 0===e?void 0:e.length)){const e=this.findUnselectedAccount(t);this.selectToAccount(e),null===(i=this.toDropdown)||void 0===i||i.selectAccount(e)}}findUnselectedAccount(t){var e;return null===(e=this.accounts)||void 0===e?void 0:e.find(e=>e!=t)}findAccountByIban(t){var e;return null===(e=this.accounts)||void 0===e?void 0:e.find(e=>e.iban==t)}applyClearOnFromSelectedRule(t){var e;const i=t==this.to,n=t.iban==(null===(e=this.to)||void 0===e?void 0:e.iban)&&!i;(i||n)&&this.clearToAccount(),n&&this.notifierService.notify("default",this.translateService.instant("TRANSFERS.SAME_IBANS_NOTIFICATION"))}applyClearOnToSelectedRule(t){var e;const i=t==this.from,n=t.iban==(null===(e=this.from)||void 0===e?void 0:e.iban)&&!i;(i||n)&&this.clearFromAccount(),n&&this.notifierService.notify("default",this.translateService.instant("TRANSFERS.SAME_IBANS_NOTIFICATION"))}applyOnlyAccountRule(){var t;if(1==(null===(t=this.accounts)||void 0===t?void 0:t.length)){const t=this.accounts[0];t.isLocked||t.hasLockedState?(this.selectToAccount(t),this.toDropdown.selectAccount(t)):(this.selectFromAccount(t),this.fromDropdown.selectAccount(t))}}selectToAccount(t){var e;this.to=t,this.f.to.setValue(null===(e=this.to)||void 0===e?void 0:e.iban),this.f.toAccount.setValue(this.to)}selectFromAccount(t){var e;this.from=t,this.f.from.setValue(null===(e=this.from)||void 0===e?void 0:e.iban),this.f.fromAccount.setValue(this.from)}selectToAccountByIban(t){const e=this.findAccountByIban(t);this.selectToAccount(e),this.toDropdown.selectAccount(e)}selectFromAccountByIban(t){const e=this.findAccountByIban(t);this.selectFromAccount(e),this.fromDropdown.selectAccount(e)}clearToAccount(){var t;this.to=null,this.f.to.setValue(null),null===(t=this.toDropdown)||void 0===t||t.clearSelected()}clearFromAccount(){var t;this.from=null,this.f.from.setValue(null),null===(t=this.fromDropdown)||void 0===t||t.clearSelected()}retrieveAccounts(){return Object(p.a)(this,void 0,void 0,(function*(){this.isAccountsLoading=!0;try{const t=yield Promise.all([this.accountsService.retrieveAccounts().catch(()=>[]),this.cardsService.getCorporateCards().catch(()=>[]),this.featureFlagsService.featureFlags$.toPromise()]),[e,i]=t,n=e.filter(t=>t.balance.currency===S.a.KZT&&t.accountType===a.a.ACCOUNT),o=i.filter(t=>t.balance.currency===S.a.KZT);this.accounts=this.featureFlagsService.isDisabled(R.a.CARD_TRANSFERS)?n||[]:[...n||[],...o||[]]}catch(t){}finally{this.isAccountsLoading=!1}}))}showEditSuccess(){const t=parseFloat(this.maskedService.getUnmaskedAmount(this.f.amount.value));this.showSuccessModal("TRANSFERS.EDIT.SUCCESS",t)}showEditError(t){return Object(p.a)(this,void 0,void 0,(function*(){try{yield this.showErrorModal("TRANSFERS.EDIT.ERROR",t),this.edit()}catch(t){this.navigateToHome()}}))}showCreateSuccess(){const t=this.maskedService.getNumberedAmount(this.f.amount.value);this.showSuccessModal("TRANSFERS.CREATE.SUCCESS",t)}showCreateError(t){return Object(p.a)(this,void 0,void 0,(function*(){try{yield this.showErrorModal("TRANSFERS.CREATE.ERROR",t),this.createOnly()}catch(t){this.navigateToHome()}}))}showCreateAndSignSuccess(){const t=this.maskedService.getNumberedAmount(this.f.amount.value);this.showSuccessModal("TRANSFERS.CREATE_AND_SIGN.SUCCESS",t,!0)}showCreateAndSignError(t){return Object(p.a)(this,void 0,void 0,(function*(){try{yield this.showErrorModal("TRANSFERS.CREATE_AND_SIGN.ERROR",t),this.createAndSign()}catch(t){this.navigateToHome()}}))}showSuccessModal(t,e,i=!1){return Object(p.a)(this,void 0,void 0,(function*(){const n=this.modalService.open(N,{backdropClass:"backdrop_light",windowClass:"modal_light modal_sm",backdrop:"static",centered:!0});n.componentInstance.description=t,n.componentInstance.totalBalance={amount:e,currency:S.a.KZT};try{yield n.result,this.navigateToHistory(i)}catch(o){this.navigateToHome()}}))}showErrorModal(t,e){var i;const n=this.modalService.open(w,{backdropClass:"backdrop_light",windowClass:"modal_light modal_sm",backdrop:"static",centered:!0});return n.componentInstance.description=t,n.componentInstance.errorText=this.mapErrors(null===(i=e)||void 0===i?void 0:i.data)||e,n.result}mapErrors(t){let e="";for(const[i,n]of Object.entries(t))e+=n+"<br>";return e||null}setAutoNumeration(){this.subscription.add(this.paymentsService.paymentNumber$.subscribe(t=>{this.f.documentNumber.setValue(t)}))}navigateToHome(){this.navService.retrieveContractBadges(),this.navService.retrieveLetterBadges(),this.router.navigate(["/"])}navigateToHistory(t=!1){let e=O.c.FOR_SIGN;this.navService.retrieveContractBadges(),this.navService.retrieveLetterBadges(),t&&this.companyService.isPrimaryAuthority()&&this.companyService.isSingleSignScheme()&&(e=O.c.IN_PROGRESS),this.router.navigate(["/history/tenge"],{queryParams:{paymentStatus:e}})}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(u.a),d.Qb(V),d.Qb(D.a),d.Qb(j.g),d.Qb(a.c),d.Qb(L.a),d.Qb(T.q),d.Qb(u.c),d.Qb(P.a),d.Qb(j.c),d.Qb(_.a),d.Qb(R.b),d.Qb(M.c),d.Qb(r.e),d.Qb(L.e),d.Qb(m.a),d.Qb(x.c))},t.\u0275cmp=d.Kb({type:t,selectors:[["j-transfers-own"]],viewQuery:function(t,e){var i;1&t&&(d.Wc(U,!0),d.Wc(G,!0)),2&t&&(d.Cc(i=d.jc())&&(e.fromDropdown=i.first),d.Cc(i=d.jc())&&(e.toDropdown=i.first))},decls:4,vars:4,consts:[[4,"ngIf"],[3,"hidden"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER",4,"ngIf"],[3,"theme"],[1,"d-flex","justify-content-end"],["label","PAYMENTS.RESTRICTED_PLACEHOLDER"],[3,"formGroup"],[1,"form-group","form-from"],["label","TRANSFERS.FROM",3,"hasError","accounts","isDisabledSelectable","isLoading","isFromArrowShown","selected"],["fromDropdown",""],[1,"form-group"],["label","TRANSFERS.TO",3,"hasError","accounts","isLoading","isDisabledSelectable","selected"],["toDropdown",""],["label","TRANSFERS.DOCUMENT_NUMBER",3,"hasError","isClearable","formControl"],["label","TRANSFERS.AMOUNT",3,"hasError","helperText","helperTextParams","formControl"],["class","text-muted p3",3,"innerHTML",4,"ngIf"],["class","form-footer",4,"ngIf"],[1,"text-muted","p3",3,"innerHTML"],[1,"form-footer"],["type","button","translate","",1,"btn","btn-outline-primary",3,"click"],["type","button","class","btn btn-outline-primary","translate","",3,"click",4,"ngIf"],["type","submit","class","btn btn-primary ml-3","translate","",3,"click",4,"ngIf"],["type","submit","translate","",1,"btn","btn-primary","ml-3",3,"click"]],template:function(t,e){1&t&&(d.Pc(0,X,7,10,"ng-container",0),d.Wb(1,"section",1),d.Pc(2,J,1,0,"j-restricted-placeholder",2),d.Pc(3,it,15,20,"ng-container",0),d.Vb()),2&t&&(d.sc("ngIf",e.isLoading),d.Ab(1),d.sc("hidden",e.isLoading),d.Ab(1),d.sc("ngIf",e.isRestricted),d.Ab(1),d.sc("ngIf",!e.isRestricted))},directives:[n.u,c.a,W.a,o.J,o.u,o.l,B.a,H.b,o.t,o.i,Q.a,r.a],pipes:[r.d],styles:[".form-footer[_ngcontent-%COMP%]{border-top:1px solid rgba(183,190,197,.5);display:-webkit-box;display:flex;-webkit-box-pack:end;justify-content:flex-end;margin-top:1.5rem;padding-top:1.5rem}.form-from[_ngcontent-%COMP%]{position:relative;z-index:5}"]}),t})(),ot=(()=>{class t{constructor(t,e){this.router=t,this.navService=e}ngOnInit(){}onClose(){this.navService.retrieveLetterBadges(),this.navService.retrieveContractBadges(),this.router.navigate(["/"])}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(u.c),d.Qb(m.a))},t.\u0275cmp=d.Kb({type:t,selectors:[["j-transfers"]],decls:7,vars:0,consts:[["closePosition","outside","colsClassList","offset-lg-2 col-lg-8 offset-xl-3 col-xl-6",3,"closed"],[1,"account-header"],["translate","",1,"f-page-title"]],template:function(t,e){1&t&&(d.Wb(0,"f-page",0),d.ic("closed",(function(t){return e.onClose()})),d.Wb(1,"f-page-header"),d.Wb(2,"section",1),d.Wb(3,"h1",2),d.Rc(4,"TRANSFERS.TITLE"),d.Vb(),d.Vb(),d.Vb(),d.Wb(5,"f-page-body"),d.Rb(6,"j-transfers-own"),d.Vb(),d.Vb())},directives:[h.a,b.a,r.a,f.a,nt],styles:[""]}),t})();const st=[{path:"",component:ot,data:{title:"TRANSFERS.TITLE"}},{path:":id",component:ot},{path:"**",redirectTo:""}];let rt=(()=>{class t{}return t.\u0275mod=d.Ob({type:t}),t.\u0275inj=d.Nb({factory:function(e){return new(e||t)},imports:[[u.g.forChild(st)],u.g]}),t})();i.d(e,"TransfersModule",(function(){return ct}));let ct=(()=>{class t{}return t.\u0275mod=d.Ob({type:t}),t.\u0275inj=d.Nb({factory:function(e){return new(e||t)},imports:[[n.c,o.n,o.D,s.d,c.b,rt,a.b,l.a,r.c]]}),t})()}}]);
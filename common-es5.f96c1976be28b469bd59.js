function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"/Fsc":function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("fXoL"),i=n("1kSV"),a=n("sYmb"),o=function(){var e=function(){function e(t){_classCallCheck(this,e),this.modal=t}return _createClass(e,[{key:"closeModal",value:function(){this.modal.close()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Qb(i.a))},e.\u0275cmp=r.Kb({type:e,selectors:[["j-function-message-success"]],decls:11,vars:3,consts:[[1,"modal-header","j-modal-header"],[1,"modal-body","j-modal-body","text-center","pb-4"],["src","./assets/img/history/modals/success.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],["translate","",1,"m-0","text-muted"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-primary","m-0",3,"click"]],template:function(e,t){1&e&&(r.Rb(0,"div",0),r.Wb(1,"div",1),r.Rb(2,"img",2),r.nc(3,"translate"),r.Wb(4,"h3",3),r.Sc(5," SETTINGS.FEATURE_REQUEST.SUCCESS_MODAL.TITLE "),r.Vb(),r.Wb(6,"p",4),r.Sc(7," SETTINGS.FEATURE_REQUEST.SUCCESS_MODAL.DESCRIPTION "),r.Vb(),r.Vb(),r.Wb(8,"div",5),r.Wb(9,"button",6),r.ic("click",(function(e){return t.closeModal()})),r.Sc(10," SHARED.CLOSE "),r.Vb(),r.Vb()),2&e&&(r.Ab(2),r.uc("alt",r.oc(3,1,"SHARED.DONE")))},directives:[a.a],pipes:[a.d],styles:[""]}),e}()},CVrE:function(e,t,n){"use strict";n("FSxY");var r=n("O/Ur");n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var i=n("wtV8");n.d(t,"c",(function(){return i.a})),n("gm23");var a=n("kFTB");n.d(t,"e",(function(){return a.a}));var o=n("+BgI");n.d(t,"f",(function(){return o.a}));var u=n("0mgW");n.d(t,"d",(function(){return u.b})),n.d(t,"g",(function(){return u.c}))},FSKB:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n("mrSG"),i=n("+/Tu"),a=n("TwVa"),o=n("fXoL"),u=n("p6Hd"),c=n("VnnJ"),s=n("mR7B"),d=n("+BgI"),l=n("wtV8"),m=n("q25w"),p=function(){var e=function(){function e(t,n,r,i,a,o){_classCallCheck(this,e),this.api=t,this.companyService=n,this.maskedService=r,this.paymentsPipelineService=i,this.paymentsApiService=a,this.paymentsSharedService=o}return _createClass(e,[{key:"getPurposeList",value:function(){return this.api.get("dictionaries/conversion-purposes")}},{key:"getRate",value:function(e){return this.paymentsSharedService.getExchangeRate(e)}},{key:"getConversionById",value:function(e){return this.paymentsApiService.getPaymentById(e)}},{key:"saveEditedConversion",value:function(e,t){return this.paymentsApiService.updatePayment(this.mapConversionToPayment(e,t),{paymentId:e.id})}},{key:"getCommission",value:function(e){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="companies/".concat(this.companyService.currentId,"/payments/commission"),r=this.mapFormToPayment(e),t.next=4,this.api.post(n,r);case 4:return a=t.sent,t.abrupt("return",{amount:a.commissionAmount||0,currency:a.currency||i.a.KZT});case 6:case"end":return t.stop()}}),t,this)})))}},{key:"createConversion",value:function(e){return this.paymentsApiService.createPayment(this.mapFormToPayment(e))}},{key:"updateConversion",value:function(e){return this.paymentsApiService.updatePayment(this.mapFormToPayment(e),{paymentId:e.id})}},{key:"createAndSignConversion",value:function(e){return Object(r.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.createConversion(e);case 2:return n=t.sent,t.abrupt("return",this.paymentsPipelineService.processPaymentVerify(n));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"mapFormToPayment",value:function(e){var t,n,r,i,o,u={status:{code:a.h.CREATED},paymentRecipient:{recipientAccount:{iban:null===(t=e.to)||void 0===t?void 0:t.iban}},type:a.i.CONVERSION,category:a.g.CONVERSION,details:{exchangeRate:e.rate,conversionPurpose:e.purpose,description:e.description,payerIban:null===(n=e.from)||void 0===n?void 0:n.iban,paymentAmount:{amount:this.maskedService.getNumberedAmount(e.fromAmount),currency:null===(i=null===(r=e.from)||void 0===r?void 0:r.balance)||void 0===i?void 0:i.currency},documentId:e.documentNumber}};return e.commissionAccount&&(u.details.exchangeRate=Object.assign(Object.assign({},u.details.exchangeRate),{commissionWithdrawalIban:null===(o=e.commissionAccount)||void 0===o?void 0:o.iban})),u}},{key:"mapConversionToPayment",value:function(e,t){return t.paymentRecipient.recipientAccount.iban=e.to.iban,t.details.exchangeRate=e.rate,t.details.conversionPurpose=e.purpose,t.details.description=e.description,t.details.payerIban=e.from.iban,t.details.paymentAmount={amount:this.maskedService.getNumberedAmount(e.fromAmount),currency:e.from.balance.currency},t.details.documentId=e.documentNumber,t}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.ec(u.a),o.ec(c.a),o.ec(s.a),o.ec(d.a),o.ec(l.a),o.ec(m.a))},e.\u0275prov=o.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},FSxY:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("Stn5"),i=n("fXoL"),a=n("1kSV"),o=n("qXBG"),u=n("tyNb"),c=function(){var e=function(){function e(t,n,r){_classCallCheck(this,e),this.modal=t,this.auth=n,this.router=r}return _createClass(e,[{key:"canDeactivate",value:function(e,t,n,i){var a,o;if(null===(o=null===(a=this.router.getCurrentNavigation().extras)||void 0===a?void 0:a.state)||void 0===o?void 0:o.silent)return Promise.resolve(!0);if(e&&e.formDirective&&this.auth.isAuthenticated){var u=e.formDirective,c=e.form;if(!u.submitted&&c.dirty||u.submitted&&c.dirty)return this.modal.open(r.a,{backdropClass:"backdrop_light",windowClass:"modal_light modal_max-height",centered:!0}).result}return Promise.resolve(!0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.ec(a.q),i.ec(o.a),i.ec(u.c))},e.\u0275prov=i.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},Stn5:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("fXoL"),i=n("1kSV"),a=n("sYmb"),o=function(){var e=function(){function e(t){_classCallCheck(this,e),this.modal=t}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"cancel",value:function(){this.modal.close(!1)}},{key:"continue",value:function(){this.modal.close(!0)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Qb(i.a))},e.\u0275cmp=r.Kb({type:e,selectors:[["j-payment-guard-modal"]],decls:18,vars:6,consts:[[1,"result-modal"],[1,"modal-header"],["type","button",1,"close",3,"click"],["src","./assets/icons/close.svg",3,"alt"],[1,"modal-body","p-3"],[1,"text-center"],[1,"modal-body","text-center"],[1,"form-group"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-link",3,"click"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"div",1),r.Wb(2,"button",2),r.ic("click",(function(e){return t.modal.dismiss()})),r.Rb(3,"img",3),r.nc(4,"translate"),r.Vb(),r.Vb(),r.Wb(5,"div",4),r.Wb(6,"div",5),r.Wb(7,"h5"),r.Sc(8,"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0432\u044b\u0439\u0442\u0438 \u0441 \u043f\u043b\u0430\u0442\u0435\u0436\u0430?"),r.Vb(),r.Wb(9,"p"),r.Sc(10,"\u041f\u0440\u0438 \u0432\u044b\u0445\u043e\u0434\u0435 \u0441 \u043f\u043b\u0430\u0442\u0435\u0436\u0430, \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f"),r.Vb(),r.Vb(),r.Vb(),r.Wb(11,"div",6),r.Wb(12,"div",7),r.Wb(13,"button",8),r.ic("click",(function(e){return t.continue()})),r.Sc(14,"\u0412\u044b\u0439\u0442\u0438"),r.Vb(),r.Wb(15,"button",9),r.ic("click",(function(e){return t.cancel()})),r.Sc(16),r.nc(17,"translate"),r.Vb(),r.Vb(),r.Vb(),r.Vb()),2&e&&(r.Ab(3),r.uc("alt",r.oc(4,2,"SHARED.CLOSE")),r.Ab(13),r.Tc(r.oc(17,4,"SHARED.CANCEL")))},pipes:[a.d],styles:[""]}),e}()},gm23:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n("gzBp"),i=n("fXoL"),a=n("tyNb"),o=n("wtV8"),u=n("0mgW"),c=n("VO+5"),s=function(){var e=function(){function e(t,n,r,i,a){_classCallCheck(this,e),this.router=t,this.route=n,this.api=r,this.payments=i,this.notification=a}return _createClass(e,[{key:"canActivate",value:function(e,t){var n,i,a,o,u=this,c=null===(i=null===(n=this.router.getCurrentNavigation().extras)||void 0===n?void 0:n.state)||void 0===i?void 0:i.repeatPayment,s=(null===(a=e.params)||void 0===a?void 0:a.paymentId)||(null===(o=c)||void 0===o?void 0:o.id),d=r.a.tenge.order;return c&&(d=this.payments.getPaymentRouteByType(c.type)),s?this.api.getPaymentById(s).then((function(e){var t=[u.payments.getPaymentRouteByType(e.type)];c||t.push(s),u.router.navigate(t,{state:{resolvedPayment:e}})})).catch((function(e){u.router.navigate([r.a.tenge.order]),u.notification.show({type:"error",message:e})})):this.router.navigate([d]),!1}}]),e}();return e.\u0275fac=function(t){return new(t||e)(i.ec(a.c),i.ec(a.a),i.ec(o.a),i.ec(u.c),i.ec(c.c))},e.\u0275prov=i.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},kFTB:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n("YMfE"),i=n("3Pt+"),a=n("SMdK"),o=n("TwVa"),u=n("+/Tu"),c=n("fXoL"),s=n("0mgW"),d=n("7rOj"),l=n("bHA9"),m=function(){var e=function(){function e(t,n,r,i){_classCallCheck(this,e),this.fb=t,this.paymentsService=n,this.bankFromAccount=r,this.dictionaries=i}return _createClass(e,[{key:"createPaymentInTengeForm",value:function(){var e=this,t=this.fb.group({type:void 0,iinOrBin:["",[i.H.required,i.H.minLength(12)]],name:["",[i.H.required,i.H.maxLength(250)]],bankAccount:[void 0,i.H.required],kbeCode:["",[i.H.required,a.a.kbe]],number:["",i.H.required],date:null,knp:[void 0,[i.H.required]],purpose:[""],senderAccount:[""],amount:["",[i.H.required,i.H.min(this.paymentsService.rules.minAmount),i.H.max(this.paymentsService.rules.maxAmount),function(e){var t;return 0==(null===(t=e)||void 0===t?void 0:t.value)?{cantBeZero:!0}:null}]],vat:[!1],urgent:[!1],notify:[!1],emailOnSuccess:[{value:"",disabled:!0},[i.H.required,i.H.email]]}),n=t.controls,c=n.bankAccount,s=n.senderAccount;return c.setValidators([i.H.required,function(e){var t=Object(r.ibanPrefix)(e.value,u.a.KZT),n=s.value;return!e.value||t.length<18||!n||t!==n.iban?null:{isEqual:!0}},function(t){return e.paymentsService.bankExist(Object(r.ibanPrefix)(t.value||"",u.a.KZT))},function(e){return"KZ".concat(e.value)!==o.o.TAX_ACCOUNT?null:{taxAccountError:!0}}]),s.setValidators([i.H.required,function(e){return e.value&&c.updateValueAndValidity(),null}]),t}},{key:"createTaxForm",value:function(){var e=this.fb.group({type:o.i.TAX,ugd:[void 0,i.H.required],kbk:["",[i.H.required]],number:["",i.H.required],date:void 0,knp:[{value:"",disabled:!0},[i.H.required]],senderAccount:["",i.H.required],purpose:[""],amount:["",[i.H.required,i.H.min(this.paymentsService.rules.minAmount),i.H.max(this.paymentsService.rules.maxAmount)]],urgent:[!1],vin:[{value:"",disabled:!0}],intervalEnabled:!1,period:[{value:"",disabled:!0},[i.H.required]],periodStart:[{value:"",disabled:!0}],periodEnd:[{value:"",disabled:!0}],protocolNumber:[{value:"",disabled:!0},[i.H.required]]}),t=e.controls,n=t.periodEnd,r=t.periodStart,u=a.a.isSmallerThan(n),c=a.a.isGreaterThan(r);return r.setValidators([i.H.required,u,a.a.revalidateLinkControlIf((function(){return!u(r)&&n.hasError("isGreaterThan")}),n)]),n.setValidators([i.H.required,c,a.a.revalidateLinkControlIf((function(){return!c(n)&&r.hasError("isSmallerThan")}),r)]),e}},{key:"createPensionForm",value:function(){return this.fb.group({type:o.i.PENSION,date:void 0,period:[{value:void 0,disabled:!0},[i.H.required]],number:["",i.H.required],knp:["010",[i.H.required]],purpose:"",employees:[void 0,[i.H.required,i.H.minLength(1),this.paymentsService.employeeGroupControlValidator(o.i.PENSION)]],senderAccount:["",i.H.required],amount:[0,[i.H.required,i.H.min(.01)]],urgent:[!1],commonPeriodEnabled:!1})}},{key:"createSocialForm",value:function(){return this.fb.group({type:o.i.SOCIAL,date:void 0,period:[{value:void 0,disabled:!0},[i.H.required]],number:["",i.H.required],knp:["012",[i.H.required]],employees:[void 0,[i.H.required,i.H.minLength(1),this.paymentsService.employeeGroupControlValidator(o.i.SOCIAL)]],senderAccount:["",i.H.required],amount:[0,[i.H.required,i.H.min(.01)]],urgent:[!1],purpose:"",commonPeriodEnabled:!1})}},{key:"createMedicalForm",value:function(){return this.fb.group({type:o.i.MEDICAL,date:void 0,period:[{value:void 0,disabled:!0},[i.H.required]],number:["",i.H.required],knp:["121",[i.H.required]],employees:[void 0,[i.H.required,i.H.minLength(1),this.paymentsService.employeeGroupControlValidator(o.i.MEDICAL)]],senderAccount:["",i.H.required],amount:[0,[i.H.required,i.H.min(.01)]],urgent:[!1],purpose:"",commonPeriodEnabled:!1})}},{key:"createSalaryForm",value:function(){var e=this,t=this.fb.group({type:o.i.SALARY,bankReceiver:[""],bankAccount:[{value:"",disabled:!0}],date:void 0,number:["",i.H.required],knp:[void 0,[i.H.required]],employees:[void 0,[i.H.required,i.H.minLength(1),this.paymentsService.employeeGroupControlValidator(o.i.SALARY)]],senderAccount:["",i.H.required],amount:[0,[i.H.required,i.H.min(.01)]],urgent:[!1],purpose:[""],isResidents:!0}),n=t.controls,a=n.bankReceiver,c=n.bankAccount;return a.setValidators([i.H.required,function(e){return e.value&&c.updateValueAndValidity(),null}]),c.setValidators([i.H.required,function(t){var n=Object(r.ibanPrefix)(t.value,u.a.KZT);if(n.length<7||!a.value)return null;var i=e.dictionaries.bankDictionary.getItemsByIds(a.value),o=e.paymentsService.bankFromAccount.transform(n);return i&&i.bic!==o?{difReceiverAndBankBiq:!0}:null}]),t}},{key:"createCurrencyForm",value:function(){return this.fb.group({type:o.i.FOREIGN,senderAccount:["",i.H.required],commissionAccount:["",i.H.required],comission:[null],comissionCurrency:[null],payComission:[!1],countryCode:[void 0,i.H.required],country:[null],cityName:[void 0],contract:[null],contractId:[null],fxContractRecipient:[null],fxContractRecipientId:[null],withinContract:[!1],name:["",[i.H.required,i.H.maxLength(103)]],bankAccount:[""],kbeCode:["",[i.H.required,a.a.kbe]],number:["",i.H.required],date:[null],knp:[void 0,[i.H.required]],knpObject:[null],purpose:[""],amount:["",[i.H.required,i.H.min(this.paymentsService.rules.minAmount),i.H.max(this.paymentsService.rules.maxAmount),function(e){var t;return 0==(null===(t=e)||void 0===t?void 0:t.value)?{cantBeZero:!0}:null}]],bankLabel:["",i.H.required],bank:[null,i.H.required],hasIntermediaryBank:[!1],intermediaryBankLabel:[""],intermediaryBank:[null],notify:[!1],emailOnSuccess:[{value:"",disabled:!0},[i.H.required,i.H.email]],kpp:[""],kvo:[void 0],codeWord:[void 0],kio:[void 0,i.H.required],isRussianBudget:[null],isRussianTaxPayer:[null],payerInn:[null],payerKpp:[""],kbk:[null],oktmo:[""],payerStatus:["S08"],hasRussianBudgetExtras:[null],paymentBasis:[""],budgetDocNumber:[""],budgetPeriod:[""],uip:[null],isRubNonRussia:[!1],rubNonRussiaCorrespondentBankLabel:[""],rubNonRussiaCorrespondentBank:[null],rubNonRussiaBankLabel:[""],rubNonRussiaBank:[null],rubNonRussiaCorrespondentIban:[""],audIndex:[""],audState:[""],audStreet:[""],audBuildingNumber:[""],audAddress:[""]})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(c.ec(r.FormBuilderTypeSafe),c.ec(s.c),c.ec(d.b),c.ec(l.a))},e.\u0275prov=c.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e}()},qcJj:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n("fXoL"),i=n("1kSV"),a=n("sYmb"),o=function(){var e=function(){function e(t){_classCallCheck(this,e),this.modal=t}return _createClass(e,[{key:"closeModal",value:function(){this.modal.close()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Qb(i.a))},e.\u0275cmp=r.Kb({type:e,selectors:[["j-change-password-success"]],decls:14,vars:6,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","./assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-4"],["src","./assets/img/history/modals/success.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],["translate","",1,"m-0","text-muted"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-primary","m-0",3,"click"]],template:function(e,t){1&e&&(r.Wb(0,"div",0),r.Wb(1,"button",1),r.ic("click",(function(e){return t.closeModal()})),r.Rb(2,"img",2),r.nc(3,"translate"),r.Vb(),r.Vb(),r.Wb(4,"div",3),r.Rb(5,"img",4),r.nc(6,"translate"),r.Wb(7,"h3",5),r.Sc(8," SHARED.DONE "),r.Vb(),r.Wb(9,"p",6),r.Sc(10," SETTINGS.PASSWORD.SUCCESS "),r.Vb(),r.Vb(),r.Wb(11,"div",7),r.Wb(12,"button",8),r.ic("click",(function(e){return t.closeModal()})),r.Sc(13," SHARED.CLOSE "),r.Vb(),r.Vb()),2&e&&(r.Ab(2),r.uc("alt",r.oc(3,2,"SHARED.CLOSE")),r.Ab(3),r.uc("alt",r.oc(6,4,"SHARED.DONE")))},directives:[a.a],pipes:[a.d],styles:[""]}),e}()},tWFC:function(e,t,n){"use strict";var r=n("qcJj"),i=n("/Fsc");n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return i.a}))}}]);
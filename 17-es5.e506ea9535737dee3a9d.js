function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,s=void 0;try{for(var a,c=t[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(o){i=!0,s=o}finally{try{r||null==c.return||c.return()}finally{if(i)throw s}}return n}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"9u+z":function(t,e,n){"use strict";n.r(e);var r,i,s,a,c=n("ofXK"),o=n("3Pt+"),u=n("dlKe"),l=n("PCNd"),d=n("crCf"),b=n("5cNS"),h=n("tyNb"),m=n("fXoL"),p=n("paXB"),f=n("7/bn"),g=n("oMXN"),v=n("EiG8"),S=n("aZ8m"),y=((r=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||r)},r.\u0275cmp=m.Kb({type:r,selectors:[["j-history"]],decls:8,vars:0,consts:[[1,"row"],[1,"col-lg-10","offset-lg-1","col-xl-8","offset-xl-2"]],template:function(t,e){1&t&&(m.Wb(0,"j-layout-home"),m.Wb(1,"j-aside"),m.Rb(2,"j-nav-main"),m.Vb(),m.Wb(3,"j-main"),m.Wb(4,"section",0),m.Wb(5,"section",1),m.Rb(6,"j-header"),m.Rb(7,"router-outlet"),m.Vb(),m.Vb(),m.Vb(),m.Vb())},directives:[p.a,f.a,g.a,v.a,S.a,h.h],styles:[""]}),r),T=n("mrSG"),R=n("quSY"),O=n("itXk"),I=n("lJxs"),E=n("IzEk"),k=n("9N4E"),A=n("y5b2"),C=n("TwVa"),_=n("+/Tu"),F=n("1kSV"),x=n("sYmb"),L=n("e8Ap"),w=((a=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"failedText",get:function(){switch(this.failedCount%20){case 1:return"HISTORY.DELETE.FAILED.ONE";case 2:case 3:case 4:return"HISTORY.DELETE.FAILED.FEW";default:return"HISTORY.DELETE.FAILED.OTHER"}}},{key:"failedParams",get:function(){return{transactionsCount:this.failedCount}}},{key:"successText",get:function(){switch(this.successCount%10){case 1:return"HISTORY.DELETE.SUCCESS.ONE";case 2:case 3:case 4:return"HISTORY.DELETE.SUCCESS.FEW";default:return"HISTORY.DELETE.SUCCESS.OTHER"}}},{key:"successParams",get:function(){return{transactionsCount:this.successCount}}}]),t}()).\u0275fac=function(t){return new(t||a)(m.Qb(F.a))},a.\u0275cmp=m.Kb({type:a,selectors:[["j-delete-partial"]],inputs:{failedCount:"failedCount",successCount:"successCount"},decls:17,vars:15,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/partial.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"mt-0","text-muted",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.DELETE.PARTIAL"),m.Vb(),m.Rb(9,"p",6),m.mc(10,"translate"),m.Rb(11,"p",7),m.mc(12,"translate"),m.Vb(),m.Wb(13,"div",8),m.Wb(14,"button",9),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(15," HISTORY.BACK_TO_HISTORY "),m.Rb(16,"span",10),m.Vb(),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,5,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,7,"HISTORY.DELETE.PARTIAL")),m.Ab(4),m.rc("innerHTML",m.oc(10,9,e.successText,e.successParams),m.Gc),m.Ab(2),m.rc("innerHTML",m.oc(12,12,e.failedText,e.failedParams),m.Gc),m.Ab(5),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"))},directives:[x.a,L.a],pipes:[x.d],styles:[""]}),a),V=((s=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).modal=t,n}return _inherits(e,t),e}(w)).\u0275fac=function(t){return new(t||s)(m.Qb(F.a))},s.\u0275cmp=m.Kb({type:s,selectors:[["j-delete-error"]],features:[m.xb],decls:17,vars:11,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","px-4","pt-0","pb-4","text-center"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-primary","btn-block","mb-3",3,"click"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.DELETE.FAILED.TITLE"),m.Vb(),m.Rb(9,"p",6),m.mc(10,"translate"),m.Vb(),m.Wb(11,"div",7),m.Wb(12,"button",8),m.ic("click",(function(t){return e.closeModal()})),m.Qc(13," SHARED.TRY_AGAIN "),m.Vb(),m.Wb(14,"button",9),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(15," HISTORY.BACK_TO_HISTORY "),m.Rb(16,"span",10),m.Vb(),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,4,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,6,"HISTORY.DELETE.FAILED.TITLE")),m.Ab(4),m.rc("innerHTML",m.oc(10,8,e.failedText,e.failedParams),m.Gc),m.Ab(7),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"))},directives:[x.a,L.a],pipes:[x.d],styles:[""]}),s),D=((i=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).modal=t,n}return _inherits(e,t),e}(w)).\u0275fac=function(t){return new(t||i)(m.Qb(F.a))},i.\u0275cmp=m.Kb({type:i,selectors:[["j-delete-success"]],features:[m.xb],decls:15,vars:11,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-4"],["src","/assets/img/history/modals/success.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.DELETE.SUCCESS.TITLE"),m.Vb(),m.Rb(9,"p",6),m.mc(10,"translate"),m.Vb(),m.Wb(11,"div",7),m.Wb(12,"button",8),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(13," HISTORY.BACK_TO_HISTORY "),m.Rb(14,"span",9),m.Vb(),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,4,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,6,"HISTORY.DELETE.SUCCESS.TITLE")),m.Ab(4),m.rc("innerHTML",m.oc(10,8,e.successText,e.successParams),m.Gc),m.Ab(5),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"))},directives:[x.a,L.a],pipes:[x.d],styles:[""]}),i);function N(t,e){1&t&&(m.Wb(0,"span"),m.Qc(1,", "),m.Vb())}function H(t,e){if(1&t&&(m.Wb(0,"span"),m.Qc(1),m.Oc(2,N,2,0,"span",12),m.Vb()),2&t){var n,r=e.$implicit,i=e.index,s=m.lc().$implicit,a=i<(null==(n=m.lc().retrieveErrors(s.errorData))?null:n.length)-1;m.Ab(1),m.Sc(" ",r,""),m.Ab(1),m.rc("ngIf",a)}}function P(t,e){if(1&t&&(m.Wb(0,"div"),m.Wb(1,"strong"),m.Qc(2),m.Vb(),m.Oc(3,H,3,2,"span",11),m.Vb()),2&t){var n=e.$implicit,r=m.lc();m.Ab(2),m.Sc("\u2116",n.documentNumber,": "),m.Ab(1),m.rc("ngForOf",r.retrieveErrors(n.errorData))}}var W,M=((W=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"retrieveErrors",value:function(t){return Object.entries(t).map((function(t){return t[1]}))}},{key:"failedText",get:function(){switch(this.signResult&&this.signResult.numberOfFailed%20){case 1:return"HISTORY.PARTIAL.FAILED.ONE";case 2:case 3:case 4:return"HISTORY.PARTIAL.FAILED.FEW";default:return"HISTORY.PARTIAL.FAILED.OTHER"}}},{key:"failedParams",get:function(){return{transactionsCount:this.signResult&&this.signResult.numberOfFailed}}},{key:"failedTransactions",get:function(){return this.signResult&&this.signResult.results}}]),t}()).\u0275fac=function(t){return new(t||W)(m.Qb(F.a))},W.\u0275cmp=m.Kb({type:W,selectors:[["j-multiple-sign-partial-error"]],inputs:{signResult:"signResult"},decls:17,vars:12,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"mt-0","text-muted",3,"innerHTML"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"modal-footer","bg-main","p-4","d-block","justify-content-start"],["translate","HISTORY.PARTIAL.SUBTITLE"],[4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.FAILED.TITLE"),m.Vb(),m.Rb(9,"p",6),m.mc(10,"translate"),m.Wb(11,"button",7),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(12," HISTORY.BACK_TO_HISTORY "),m.Rb(13,"span",8),m.Vb(),m.Vb(),m.Wb(14,"div",9),m.Rb(15,"h5",10),m.Oc(16,P,4,2,"div",11),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,5,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,7,"HISTORY.FAILED.TITLE")),m.Ab(4),m.rc("innerHTML",m.oc(10,9,e.failedText,e.failedParams),m.Gc),m.Ab(4),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"),m.Ab(3),m.rc("ngForOf",e.failedTransactions))},directives:[x.a,L.a,c.t,c.u],pipes:[x.d],styles:[""]}),W),j=n("Kx/q");function Y(t,e){if(1&t&&(m.Wb(0,"div",16),m.Qc(1),m.mc(2,"lowercase"),m.mc(3,"translate"),m.Wb(4,"strong"),m.Rb(5,"j-money",17),m.Vb(),m.Vb()),2&t){var n=e.$implicit,r=m.lc();m.Ab(1),m.Tc(" ",n.count," ",m.nc(2,3,m.nc(3,5,r.mapCountLabel(n.count)))," \u2013 "),m.Ab(4),m.rc("money",n.money)}}function G(t,e){1&t&&(m.Wb(0,"span"),m.Qc(1,", "),m.Vb())}function Q(t,e){if(1&t&&(m.Wb(0,"span"),m.Qc(1),m.Oc(2,G,2,0,"span",18),m.Vb()),2&t){var n,r=e.$implicit,i=e.index,s=m.lc().$implicit,a=i<(null==(n=m.lc().retrieveErrors(s.errorData))?null:n.length)-1;m.Ab(1),m.Sc(" ",r,""),m.Ab(1),m.rc("ngIf",a)}}function B(t,e){if(1&t&&(m.Wb(0,"div"),m.Wb(1,"strong"),m.Qc(2),m.Vb(),m.Oc(3,Q,3,2,"span",15),m.Vb()),2&t){var n=e.$implicit,r=m.lc();m.Ab(2),m.Sc("\u2116",n.documentNumber,": "),m.Ab(1),m.rc("ngForOf",r.retrieveErrors(n.errorData))}}var K,U=((K=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"ngOnInit",value:function(){this.generateGroups()}},{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"retrieveErrors",value:function(t){return Object.entries(t).map((function(t){return t[1]}))}},{key:"mapCountLabel",value:function(t){switch(t%20){case 1:return"HISTORY.OPERATION.ONE";case 2:case 3:case 4:return"HISTORY.OPERATION.FEW";default:return"HISTORY.OPERATION.OTHER"}}},{key:"generateGroups",value:function(){var t={};this.result.results.forEach((function(e){var n=e.result.amount;t[n.currency]?(t[n.currency].money.amount+=n.amount,t[n.currency].count++):t[n.currency]={money:{currency:n.currency,amount:n.amount},count:1}})),this.groups=Object.values(t)}},{key:"successText",get:function(){switch(this.result&&this.result.numberOfSuccess%10){case 1:return"HISTORY.PARTIAL.SUCCESS.ONE";case 2:case 3:case 4:return"HISTORY.PARTIAL.SUCCESS.FEW";default:return"HISTORY.PARTIAL.SUCCESS.OTHER"}}},{key:"totalBalance",get:function(){return this.result&&this.result.totalBalance}},{key:"successCount",get:function(){return this.result&&this.result.numberOfSuccess}},{key:"totalCount",get:function(){return this.result&&this.result.results.length}},{key:"successParams",get:function(){return{transactionsCount:this.successCount}}},{key:"failedText",get:function(){switch(this.result&&this.result.numberOfFailed%10){case 1:return"HISTORY.PARTIAL.FAILED.ONE";case 2:case 3:case 4:return"HISTORY.PARTIAL.FAILED.FEW";default:return"HISTORY.PARTIAL.FAILED.OTHER"}}},{key:"failedParams",get:function(){return{transactionsCount:this.result&&this.result.numberOfFailed}}},{key:"failedTransactions",get:function(){return this.result&&this.result.results&&this.result.results.filter((function(t){return t.status===C.b.FAILED}))}}]),t}()).\u0275fac=function(t){return new(t||K)(m.Qb(F.a))},K.\u0275cmp=m.Kb({type:K,selectors:[["j-multiple-sign-partial-success"]],inputs:{result:"result"},decls:26,vars:19,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/partial.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted"],["translate",""],["class","result-group",4,"ngFor","ngForOf"],[1,"m-0","text-muted",3,"innerHTML"],[1,"mt-0","text-muted",3,"innerHTML"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"modal-footer","bg-main","p-4","d-block","justify-content-start"],["translate","HISTORY.PARTIAL.SUBTITLE"],[4,"ngFor","ngForOf"],[1,"result-group"],[3,"money"],[4,"ngIf"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.PARTIAL.TITLE"),m.Vb(),m.Wb(9,"p",6),m.Wb(10,"span",7),m.Qc(11,"HISTORY.OPERATION.FEW"),m.Vb(),m.Qc(12,": "),m.Wb(13,"strong"),m.Qc(14),m.Vb(),m.Vb(),m.Oc(15,Y,6,7,"div",8),m.Rb(16,"p",9),m.mc(17,"translate"),m.Rb(18,"p",10),m.mc(19,"translate"),m.Wb(20,"button",11),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(21," HISTORY.BACK_TO_HISTORY "),m.Rb(22,"span",12),m.Vb(),m.Vb(),m.Wb(23,"div",13),m.Rb(24,"h4",14),m.Oc(25,B,4,2,"div",15),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,9,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,11,"HISTORY.PARTIAL.TITLE")),m.Ab(9),m.Tc("",e.successCount,"/",e.totalCount,""),m.Ab(1),m.rc("ngForOf",e.groups),m.Ab(1),m.rc("innerHTML",m.oc(17,13,e.successText,e.successParams),m.Gc),m.Ab(2),m.rc("innerHTML",m.oc(19,16,e.failedText,e.failedParams),m.Gc),m.Ab(4),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"),m.Ab(3),m.rc("ngForOf",e.failedTransactions))},directives:[x.a,c.t,L.a,j.a,c.u],pipes:[x.d,c.q],styles:[""]}),K);function $(t,e){if(1&t&&(m.Wb(0,"p",13),m.Qc(1),m.Vb()),2&t){var n=m.lc();m.Ab(1),m.Sc(" ",n.errorText," ")}}var z,X=((z=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}}]),t}()).\u0275fac=function(t){return new(t||z)(m.Qb(F.a))},z.\u0275cmp=m.Kb({type:z,selectors:[["j-multiple-sign-error"]],inputs:{errorText:"errorText"},decls:19,vars:8,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","px-4","pt-0","pb-4","text-center"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted"],["translate",""],["class","mt-3 mb-0 text-danger",4,"ngIf"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-primary","btn-block","mb-3",3,"click"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"mt-3","mb-0","text-danger"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.FAILED.TITLE"),m.Vb(),m.Wb(9,"p",6),m.Wb(10,"span",7),m.Qc(11,"HISTORY.FAILED.DESCRIPTION"),m.Vb(),m.Vb(),m.Oc(12,$,2,1,"p",8),m.Vb(),m.Wb(13,"div",9),m.Wb(14,"button",10),m.ic("click",(function(t){return e.closeModal()})),m.Qc(15," SHARED.TRY_AGAIN "),m.Vb(),m.Wb(16,"button",11),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(17," HISTORY.BACK_TO_HISTORY "),m.Rb(18,"span",12),m.Vb(),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,4,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,6,"HISTORY.FAILED.TITLE")),m.Ab(7),m.rc("ngIf",e.errorText),m.Ab(6),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"))},directives:[x.a,c.u,L.a],pipes:[x.d],styles:[""]}),z);function J(t,e){if(1&t&&(m.Wb(0,"div",10),m.Qc(1),m.mc(2,"lowercase"),m.mc(3,"translate"),m.Wb(4,"strong"),m.Rb(5,"j-money",11),m.Vb(),m.Vb()),2&t){var n=e.$implicit,r=m.lc();m.Ab(1),m.Tc(" ",n.count," ",m.nc(2,3,m.nc(3,5,r.mapCountLabel(n.count)))," \u2013 "),m.Ab(4),m.rc("money",n.money)}}var q,Z=((q=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"ngOnInit",value:function(){this.generateGroups()}},{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"mapCountLabel",value:function(t){switch(t%20){case 1:return"HISTORY.OPERATION.ONE";case 2:case 3:case 4:return"HISTORY.OPERATION.FEW";default:return"HISTORY.OPERATION.OTHER"}}},{key:"generateGroups",value:function(){var t={};this.result.results.forEach((function(e){var n=e.result.amount;t[n.currency]?(t[n.currency].money.amount+=n.amount,t[n.currency].count++):t[n.currency]={money:{currency:n.currency,amount:n.amount},count:1}})),this.groups=Object.values(t)}}]),t}()).\u0275fac=function(t){return new(t||q)(m.Qb(F.a))},q.\u0275cmp=m.Kb({type:q,selectors:[["j-multiple-sign-success"]],inputs:{result:"result"},decls:14,vars:8,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-4"],["src","/assets/img/history/modals/success.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],["class","result-group",4,"ngFor","ngForOf"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"result-group"],[3,"money"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.SIGNED"),m.Vb(),m.Oc(9,J,6,7,"div",6),m.Vb(),m.Wb(10,"div",7),m.Wb(11,"button",8),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(12," HISTORY.BACK_TO_HISTORY "),m.Rb(13,"span",9),m.Vb(),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,4,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,6,"HISTORY.SIGNED")),m.Ab(4),m.rc("ngForOf",e.groups),m.Ab(4),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"))},directives:[x.a,c.t,L.a,j.a],pipes:[x.d,c.q],styles:[""]}),q);function tt(t,e){1&t&&(m.Wb(0,"span"),m.Qc(1,", "),m.Vb())}function et(t,e){if(1&t&&(m.Wb(0,"span"),m.Qc(1),m.Oc(2,tt,2,0,"span",13),m.Vb()),2&t){var n,r=e.$implicit,i=e.index,s=m.lc().$implicit,a=i<(null==(n=m.lc().retrieveErrors(s.errorData))?null:n.length)-1;m.Ab(1),m.Sc(" ",r,""),m.Ab(1),m.rc("ngIf",a)}}function nt(t,e){if(1&t&&(m.Wb(0,"div"),m.Wb(1,"strong"),m.Qc(2),m.Vb(),m.Oc(3,et,3,2,"span",12),m.Vb()),2&t){var n=e.$implicit,r=m.lc();m.Ab(2),m.Sc("\u2116",n.documentNumber,": "),m.Ab(1),m.rc("ngForOf",r.retrieveErrors(n.errorData))}}var rt,it,st,at=((st=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"retrieveErrors",value:function(t){return Object.entries(t).map((function(t){return t[1]}))}},{key:"failedCount",get:function(){var t;return(null===(t=this.signResult)||void 0===t?void 0:t.numberOfFailed)||0}},{key:"successCount",get:function(){var t;return(null===(t=this.signResult)||void 0===t?void 0:t.numberOfSuccess)||0}},{key:"failedText",get:function(){switch(this.failedCount%20){case 1:return"HISTORY.SEND_TO_SIGNED.FAILED.ONE";case 2:case 3:case 4:return"HISTORY.SEND_TO_SIGNED.FAILED.FEW";default:return"HISTORY.SEND_TO_SIGNED.FAILED.OTHER"}}},{key:"failedParams",get:function(){return{transactionsCount:this.failedCount}}},{key:"failedTransactions",get:function(){return this.signResult&&this.signResult.results&&this.signResult.results.filter((function(t){return t.status===C.b.FAILED}))}},{key:"successText",get:function(){switch(this.successCount%10){case 1:return"HISTORY.SEND_TO_SIGNED.SUCCESS.ONE";case 2:case 3:case 4:return"HISTORY.SEND_TO_SIGNED.SUCCESS.FEW";default:return"HISTORY.SEND_TO_SIGNED.SUCCESS.OTHER"}}},{key:"successParams",get:function(){return{transactionsCount:this.successCount}}}]),t}()).\u0275fac=function(t){return new(t||st)(m.Qb(F.a))},st.\u0275cmp=m.Kb({type:st,selectors:[["j-send-to-signed-partial"]],inputs:{signResult:"signResult"},decls:19,vars:16,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/partial.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"mt-0","text-muted",3,"innerHTML"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"modal-footer","bg-main","p-4","d-block","justify-content-start"],["translate","HISTORY.PARTIAL.SUBTITLE"],[4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.SEND_TO_SIGNED.PARTIAL"),m.Vb(),m.Rb(9,"p",6),m.mc(10,"translate"),m.Rb(11,"p",7),m.mc(12,"translate"),m.Wb(13,"button",8),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(14," HISTORY.BACK_TO_HISTORY "),m.Rb(15,"span",9),m.Vb(),m.Vb(),m.Wb(16,"div",10),m.Rb(17,"h4",11),m.Oc(18,nt,4,2,"div",12),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,6,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,8,"HISTORY.SEND_TO_SIGNED.PARTIAL")),m.Ab(4),m.rc("innerHTML",m.oc(10,10,e.successText,e.successParams),m.Gc),m.Ab(2),m.rc("innerHTML",m.oc(12,13,e.failedText,e.failedParams),m.Gc),m.Ab(4),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"),m.Ab(3),m.rc("ngForOf",e.failedTransactions))},directives:[x.a,L.a,c.t,c.u],pipes:[x.d],styles:[""]}),st),ct=((it=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).modal=t,n}return _inherits(e,t),e}(at)).\u0275fac=function(t){return new(t||it)(m.Qb(F.a))},it.\u0275cmp=m.Kb({type:it,selectors:[["j-send-to-signed-success"]],features:[m.xb],decls:15,vars:11,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-4"],["src","/assets/img/history/modals/success.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.SEND_TO_SIGNED.SUCCESS.TITLE"),m.Vb(),m.Rb(9,"p",6),m.mc(10,"translate"),m.Vb(),m.Wb(11,"div",7),m.Wb(12,"button",8),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(13," HISTORY.BACK_TO_HISTORY "),m.Rb(14,"span",9),m.Vb(),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,4,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,6,"HISTORY.SEND_TO_SIGNED.SUCCESS.TITLE")),m.Ab(4),m.rc("innerHTML",m.oc(10,8,e.successText,e.successParams),m.Gc),m.Ab(5),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"))},directives:[x.a,L.a],pipes:[x.d],styles:[""]}),it),ot=((rt=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).modal=t,n}return _inherits(e,t),e}(at)).\u0275fac=function(t){return new(t||rt)(m.Qb(F.a))},rt.\u0275cmp=m.Kb({type:rt,selectors:[["j-send-to-signed-error"]],features:[m.xb],decls:17,vars:11,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","px-4","pt-0","pb-4","text-center"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"m-0","text-muted",3,"innerHTML"],[1,"modal-footer","py-4","px-3","justify-content-center"],["translate","","type","button",1,"btn","btn-primary","btn-block","mb-3",3,"click"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.SEND_TO_SIGNED.FAILED.TITLE"),m.Vb(),m.Rb(9,"p",6),m.mc(10,"translate"),m.Vb(),m.Wb(11,"div",7),m.Wb(12,"button",8),m.ic("click",(function(t){return e.closeModal()})),m.Qc(13," SHARED.TRY_AGAIN "),m.Vb(),m.Wb(14,"button",9),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(15," HISTORY.BACK_TO_HISTORY "),m.Rb(16,"span",10),m.Vb(),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,4,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,6,"HISTORY.SEND_TO_SIGNED.FAILED.TITLE")),m.Ab(4),m.rc("innerHTML",m.oc(10,8,e.failedText,e.failedParams),m.Gc),m.Ab(7),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"))},directives:[x.a,L.a],pipes:[x.d],styles:[""]}),rt);function ut(t,e){1&t&&(m.Wb(0,"span"),m.Qc(1,", "),m.Vb())}function lt(t,e){if(1&t&&(m.Wb(0,"span"),m.Qc(1),m.Oc(2,ut,2,0,"span",12),m.Vb()),2&t){var n,r=e.$implicit,i=e.index,s=m.lc().$implicit,a=i<(null==(n=m.lc().retrieveErrors(s.errorData))?null:n.length)-1;m.Ab(1),m.Sc(" ",r,""),m.Ab(1),m.rc("ngIf",a)}}function dt(t,e){if(1&t&&(m.Wb(0,"div"),m.Wb(1,"strong"),m.Qc(2),m.Vb(),m.Oc(3,lt,3,2,"span",11),m.Vb()),2&t){var n=e.$implicit,r=m.lc();m.Ab(2),m.Sc("\u2116",n.documentNumber,": "),m.Ab(1),m.rc("ngForOf",r.retrieveErrors(n.errorData))}}var bt,ht=((bt=function(t){function e(t){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).modal=t,n}return _inherits(e,t),e}(at)).\u0275fac=function(t){return new(t||bt)(m.Qb(F.a))},bt.\u0275cmp=m.Kb({type:bt,selectors:[["j-send-to-signed-partial-error"]],features:[m.xb],decls:17,vars:12,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/error.svg",3,"alt"],["translate","",1,"light","mb-3","mt-2"],[1,"mt-0","text-muted",3,"innerHTML"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"modal-footer","bg-main","p-4","d-block","justify-content-start"],["translate","HISTORY.PARTIAL.SUBTITLE"],[4,"ngFor","ngForOf"],[4,"ngIf"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Rb(5,"img",4),m.mc(6,"translate"),m.Wb(7,"h3",5),m.Qc(8,"HISTORY.FAILED.TITLE"),m.Vb(),m.Rb(9,"p",6),m.mc(10,"translate"),m.Wb(11,"button",7),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(12," HISTORY.BACK_TO_HISTORY "),m.Rb(13,"span",8),m.Vb(),m.Vb(),m.Wb(14,"div",9),m.Rb(15,"h5",10),m.Oc(16,dt,4,2,"div",11),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,5,"SHARED.CLOSE")),m.Ab(3),m.sc("alt",m.nc(6,7,"HISTORY.FAILED.TITLE")),m.Ab(4),m.rc("innerHTML",m.oc(10,9,e.failedText,e.failedParams),m.Gc),m.Ab(4),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"),m.Ab(3),m.rc("ngForOf",e.failedTransactions))},directives:[x.a,L.a,c.t,c.u],pipes:[x.d],styles:[""]}),bt);function mt(t,e){1&t&&(m.Rb(0,"img",14),m.mc(1,"translate")),2&t&&m.sc("alt",m.nc(1,1,"HISTORY.VALIDATION.ERROR"))}function pt(t,e){1&t&&(m.Rb(0,"img",15),m.mc(1,"translate")),2&t&&m.sc("alt",m.nc(1,1,"HISTORY.VALIDATION.ERROR"))}function ft(t,e){if(1&t&&(m.Wb(0,"p",16),m.Wb(1,"span",17),m.Qc(2,"HISTORY.OPERATION.FEW"),m.Vb(),m.Qc(3,": "),m.Wb(4,"strong"),m.Qc(5),m.Vb(),m.Vb()),2&t){var n=m.lc();m.Ab(5),m.Tc("",n.successCount,"/",n.totalCount,"")}}function gt(t,e){if(1&t&&(m.Wb(0,"div",18),m.Qc(1),m.mc(2,"lowercase"),m.mc(3,"translate"),m.Wb(4,"strong"),m.Rb(5,"j-money",19),m.Vb(),m.Vb()),2&t){var n=e.$implicit,r=m.lc();m.Ab(1),m.Tc(" ",n.count," ",m.nc(2,3,m.nc(3,5,r.mapCountLabel(n.count)))," \u2013 "),m.Ab(4),m.rc("money",n.money)}}function vt(t,e){1&t&&(m.Wb(0,"span"),m.Qc(1,", "),m.Vb())}function St(t,e){if(1&t&&(m.Wb(0,"span"),m.Qc(1),m.Oc(2,vt,2,0,"span",20),m.Vb()),2&t){var n,r=e.$implicit,i=e.index,s=m.lc().$implicit,a=i<(null==(n=m.lc().retrieveErrors(s.errorData))?null:n.length)-1;m.Ab(1),m.Sc(" ",r,""),m.Ab(1),m.rc("ngIf",a)}}function yt(t,e){if(1&t&&(m.Wb(0,"div"),m.Wb(1,"strong"),m.Qc(2),m.Vb(),m.Oc(3,St,3,2,"span",13),m.Vb()),2&t){var n=e.$implicit,r=m.lc();m.Ab(2),m.Sc("\u2116",n.documentNumber,": "),m.Ab(1),m.rc("ngForOf",r.retrieveErrors(n.errorData))}}var Tt,Rt,Ot=((Tt=function(){function t(e){_classCallCheck(this,t),this.modal=e}return _createClass(t,[{key:"ngOnInit",value:function(){this.generateGroups()}},{key:"dismissModal",value:function(){this.modal.dismiss()}},{key:"closeModal",value:function(){this.modal.close()}},{key:"retrieveErrors",value:function(t){return Object.entries(t).map((function(t){return t[1]}))}},{key:"mapCountLabel",value:function(t){switch(t%20){case 1:return"HISTORY.OPERATION.ONE";default:return"HISTORY.OPERATION.OTHER"}}},{key:"generateGroups",value:function(){var t={};this.result.results.forEach((function(e){var n,r=null===(n=e.result)||void 0===n?void 0:n.amount;r&&(t[r.currency]?(t[r.currency].money.amount+=r.amount,t[r.currency].count++):t[r.currency]={money:{currency:r.currency,amount:r.amount},count:1})})),this.groups=Object.values(t)}},{key:"totalBalance",get:function(){return this.result&&this.result.totalBalance}},{key:"successCount",get:function(){return this.result&&this.result.numberOfSuccess}},{key:"totalCount",get:function(){return this.result&&this.result.results.length}},{key:"successParams",get:function(){return{transactionsCount:this.successCount}}},{key:"failedText",get:function(){if(!this.result)return"HISTORY.VALIDATION.ERROR";switch(this.result&&this.result.numberOfFailed%10){case 1:return"HISTORY.VALIDATION.ONE";case 2:case 3:case 4:return"HISTORY.VALIDATION.FEW";default:return"HISTORY.VALIDATION.OTHER"}}},{key:"failedParams",get:function(){return{transactionsCount:this.result&&this.result.numberOfFailed}}},{key:"failedTransactions",get:function(){return this.result&&this.result.results&&this.result.results.filter((function(t){return t.status===C.b.FAILED}))}}]),t}()).\u0275fac=function(t){return new(t||Tt)(m.Qb(F.a))},Tt.\u0275cmp=m.Kb({type:Tt,selectors:[["j-validation-error"]],inputs:{result:"result"},decls:17,vars:13,consts:[[1,"modal-header","j-modal-header"],["type","button",1,"close",3,"click"],["src","/assets/icons/close.svg",3,"alt"],[1,"modal-body","j-modal-body","text-center","pb-3"],["src","/assets/img/history/modals/partial.svg",3,"alt",4,"ngIf"],["src","/assets/img/history/modals/error.svg",3,"alt",4,"ngIf"],["class","m-0 text-muted",4,"ngIf"],["class","result-group",4,"ngFor","ngForOf"],[1,"mt-0","text-muted",3,"innerHTML"],["translate","","type","button",1,"btn","btn-static","btn-link","m-0",3,"click"],[3,"inlineSVG"],[1,"modal-footer","bg-main","p-4","d-block","justify-content-start"],["translate","HISTORY.PARTIAL.SUBTITLE"],[4,"ngFor","ngForOf"],["src","/assets/img/history/modals/partial.svg",3,"alt"],["src","/assets/img/history/modals/error.svg",3,"alt"],[1,"m-0","text-muted"],["translate",""],[1,"result-group"],[3,"money"],[4,"ngIf"]],template:function(t,e){1&t&&(m.Wb(0,"div",0),m.Wb(1,"button",1),m.ic("click",(function(t){return e.dismissModal()})),m.Rb(2,"img",2),m.mc(3,"translate"),m.Vb(),m.Vb(),m.Wb(4,"div",3),m.Oc(5,mt,2,3,"img",4),m.Oc(6,pt,2,3,"img",5),m.Oc(7,ft,6,2,"p",6),m.Oc(8,gt,6,7,"div",7),m.Rb(9,"p",8),m.mc(10,"translate"),m.Wb(11,"button",9),m.ic("click",(function(t){return e.dismissModal()})),m.Qc(12," HISTORY.BACK_TO_HISTORY "),m.Rb(13,"span",10),m.Vb(),m.Vb(),m.Wb(14,"div",11),m.Rb(15,"h4",12),m.Oc(16,yt,4,2,"div",13),m.Vb()),2&t&&(m.Ab(2),m.sc("alt",m.nc(3,8,"SHARED.CLOSE")),m.Ab(3),m.rc("ngIf",e.successCount>0),m.Ab(1),m.rc("ngIf",0===e.successCount),m.Ab(1),m.rc("ngIf",e.totalCount&&e.successCount),m.Ab(1),m.rc("ngForOf",e.groups),m.Ab(1),m.rc("innerHTML",m.oc(10,10,e.failedText,e.failedParams),m.Gc),m.Ab(4),m.rc("inlineSVG","./assets/icons/shared/arrow-right.svg"),m.Ab(3),m.rc("ngForOf",e.failedTransactions))},directives:[c.u,c.t,x.a,L.a,j.a],pipes:[x.d,c.q],styles:[""]}),Tt),It=n("tk/3"),Et=n("p6Hd"),kt=n("KWy3"),At=n("YMfE"),Ct=n("Kd2e"),_t=n("rEgK"),Ft=n("VnnJ"),xt=n("jZlK"),Lt=n("mR7B"),wt=n("7rOj"),Vt=((Rt=function(){function t(e,n,r,i,s,a,c,o){_classCallCheck(this,t),this.statementService=e,this.companyService=n,this.api=r,this.translateService=i,this.filterService=s,this.maskedService=a,this.curSymbolPipe=c,this.featureFlagsService=o,this.loadFeatureFlags()}return _createClass(t,[{key:"loadFeatureFlags",value:function(){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.featureFlagsService.featureFlags$.toPromise();case 2:this.featureFlags=t.sent;case 3:case"end":return t.stop()}}),t,this)})))}},{key:"getTransactionGroup",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C.g.DOMESTIC,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var s,a,c,o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(this.cashedCategory!==t||!this.cashedTransactionGroup||this.cashedFilter!==e||this.cashedPageNumber!==n||this.cashedPageSize!==r){i.next=2;break}return i.abrupt("return",this.cashedTransactionGroup);case 2:if(s=this.cashedFilter===e&&n>this.cashedPageNumber,i.t0=this.featureFlags,i.t0){i.next=7;break}return i.next=7,this.loadFeatureFlags();case 7:return i.prev=7,i.next=10,this.getHistoryList(t,e,n,r);case 10:return a=i.sent,this.cashedCategory=t,this.cashedFilter=e,this.cashedPageNumber=n,this.cashedPageSize=r,c=this.mapHistoryPayments(a.body),o=s?this.cashedTransactionGroup.transactions.concat(c):c,i.abrupt("return",(e.paymentStatus===A.c.FOR_SIGN&&(o=(o=o.sort(this.compareBySignature)).sort(this.compareByDate)),e.paymentStatus===A.c.FAILED&&this.markFailedAsRead(),this.cashedTransactionGroup={title:this.generateGroupTitle(e.paymentStatus),creditSum:null,debitSum:this.getTotalAmount(o),hasLargeTransactions:this.statementService.checkListForLargeTransactions(o),transactionsCount:o.length,transactions:o},this.cashedTransactionGroup));case 17:throw i.prev=17,i.t1=i.catch(7),i.t1;case 20:case"end":return i.stop()}}),i,this,[[7,17]])})))}},{key:"getHistoryList",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var s,a,c;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s="companies/".concat(this.companyService.currentId,"/payments"),a=new It.g,c=new It.h,i.abrupt("return",(c=(c=(c=this.appendCategoryParams(t,c)).append("page","".concat(n))).append("pageSize","".concat(r)),c=this.appendFilterParams(e,c),this.api.get(s,a,c,{observe:"response"})));case 3:case"end":return i.stop()}}),i,this)})))}},{key:"sendMultipleTransactionsForSign",value:function(t){var e="companies/".concat(this.companyService.currentId,"/payments:to-created"),n=new It.h;return t.forEach((function(t){n=n.append("paymentId",t)})),this.api.patch(e,null,null,n)}},{key:"validateTransactionsByPaymentId",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r="companies/".concat(t,"/payments/signatures/validate"),i=new It.h,n.abrupt("return",(e.forEach((function(t){i=i.append("paymentId",t)})),this.api.post(r,i)));case 3:case"end":return n.stop()}}),n,this)})))}},{key:"signMultipleTransactions",value:function(t,e,n){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,s,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i="companies/".concat(t,"/payments/signatures"),s=(s=new It.g).set(e.type===C.p.OTP?Et.c.OTP:Et.c.PHONE,e.signature),a=new It.h,r.abrupt("return",(n.forEach((function(t){a=a.append("paymentId",t)})),this.api.post(i,null,s,a)));case 5:case"end":return r.stop()}}),r,this)})))}},{key:"deleteTransaction",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r="companies/".concat(t,"/payments"),i=new It.g,s=(new It.h).set("id",e.id),n.abrupt("return",this.api.delete(r,i,s));case 3:case"end":return n.stop()}}),n,this)})))}},{key:"revokePayment",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.api.patch("companies/".concat(t,"/payments/").concat(e.paymentId,":to-revoked")));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"deleteMultipleTransactions",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r="companies/".concat(t,"/payments"),i=new It.g,s=new It.h,n.abrupt("return",(e.forEach((function(t){s=s.append("id",t.id)})),this.api.delete(r,i,s)));case 3:case"end":return n.stop()}}),n,this)})))}},{key:"isRemovable",value:function(t){return t.status.code===C.h.CREATED||t.status.code===C.h.DRAFT}},{key:"isEditable",value:function(t){return!(t.type===C.i.CONVERSION&&t.status.code!==C.h.CREATED||t.status.code!==C.h.DRAFT&&t.status.code!==C.h.CREATED)}},{key:"isRevokable",value:function(t){return t.status.code===C.h.READY_TO_SEND}},{key:"getSignsCountText",value:function(t){return"".concat(t.signatures&&t.signatures.length||0,"/").concat(this.companyService.isMultipleSignScheme(t.signatureScheme)?2:1)}},{key:"appendCategoryParams",value:function(t,e){switch(t){case C.g.ALL:e=(e=(e=e.append("category",C.g.DOMESTIC)).append("category",C.g.FOREIGN)).append("category",C.g.CONVERSION);break;default:e=e.append("category",t)}return e}},{key:"appendFilterParams",value:function(t,e){switch(e=this.appendStatusToParams(t.paymentStatus,e),t.documentNumber&&(e=e.append("documentNumber",t.documentNumber)),t.periodFrom&&(e=e.append("dateFrom",Object(At.convertDateToApiFormat)(t.periodFrom))),t.periodTo&&(e=e.append("dateTo",Object(At.convertDateToApiFormat)(t.periodTo))),t.amountFrom&&(e=e.append("amountFrom","".concat(t.amountFrom))),t.amountTo&&(e=e.append("amountTo","".concat(t.amountTo))),t.recipientIban&&(e=e.append("correspondentAccount",t.recipientIban)),t.recipientBin&&(e=e.append("correspondentBin",t.recipientBin)),t.sortBy){case A.e.AMOUNT_ASC:e=e.append("sortBy","AMOUNT");break;case A.e.AMOUNT_DESC:e=e.append("sortBy","-AMOUNT")}return e}},{key:"appendStatusToParams",value:function(t,e){switch(t){case A.c.ALL:e=(e=(e=(e=(e=(e=(e=(e=e.append("status",C.h.DRAFT)).append("status",C.h.CREATED)).append("status",C.h.REJECTED)).append("status",C.h.BANK_COMPLETED)).append("status",C.h.BANK_PROCESSING)).append("status",C.h.BANK_SENT)).append("status",C.h.READY_TO_SEND)).append("status",C.h.IN_BANK);break;case A.c.DRAFT:e=e.append("status",C.h.DRAFT);break;case A.c.FOR_SIGN:e=e.append("status",C.h.CREATED);break;case A.c.FAILED:e=e.append("status",C.h.REJECTED);break;case A.c.SUCCESS:e=e.append("status",C.h.BANK_COMPLETED);break;case A.c.IN_PROGRESS:e=(e=(e=(e=e.append("status",C.h.BANK_PROCESSING)).append("status",C.h.BANK_SENT)).append("status",C.h.READY_TO_SEND)).append("status",C.h.IN_BANK)}return e}},{key:"compareByDate",value:function(t,e){return t.paymentStatus.timestamp<e.paymentStatus.timestamp?1:t.paymentStatus.timestamp>e.paymentStatus.timestamp?-1:0}},{key:"updateForSignCount",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function r(){var i,s,a,c=this;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this.filterService.updateForSignCount(null),e){r.next=5;break}return r.next=3,this.retrivePaymentsByStatus(A.c.FOR_SIGN,n);case 3:i=r.sent,e=i.payments;case 5:s=0,a=0,null===(t=e)||void 0===t||t.forEach((function(t){var e;c.companyService.isSignable(t.status.code,t.signatureScheme,c.companyService.currentAuthority.authority,null===(e=t.signatures)||void 0===e?void 0:e.length)?s++:a++})),0==s&&0==a?this.filterService.updateForSignCount(0):s>0?this.filterService.updateForSignCount(s,!0):this.filterService.updateForSignCount(a);case 7:case"end":return r.stop()}}),r,this)})))}},{key:"retrivePaymentsByStatus",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i,s,a,c,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=0,i=null,s="companies/".concat(this.companyService.currentId,"/payments"),a=new It.g,c=new It.h,c=this.appendStatusToParams(t,c),c=(c=this.appendCategoryParams(e,c)).append("pageSize","100000"),n.prev=4,n.next=7,this.api.get(s,a,c,{observe:"response"});case 7:o=n.sent,i=o.body,r=+o.headers.get("X-Total-Count"),n.next=13;break;case 11:n.prev=11,n.t0=n.catch(4);case 13:return n.prev=13,n.abrupt("return",{payments:i,count:r});case 16:case"end":return n.stop()}}),n,this,[[4,11,13,16]])})))}},{key:"updateStatusCounts",value:function(t){this.updateForSignCount(null,t),this.updateCountsByBadges(t)}},{key:"isSignable",value:function(t){var e,n=this.companyService.isSignable(t.status.code,t.signatureScheme,this.companyService.currentAuthority.authority,null===(e=t.signatures)||void 0===e?void 0:e.length);return t.status.code===C.h.DRAFT?n&&this.isCorrectlyFullfilled(t):n}},{key:"isSignableByOthers",value:function(t){var e;return this.companyService.isSignableByOthers(t.status.code,t.signatureScheme,this.companyService.currentAuthority.authority,null===(e=t.signatures)||void 0===e?void 0:e.length)}},{key:"isSendableForSign",value:function(t){var e=this.isSignableByOthers(t),n=this.companyService.isSendableForSign(t.status.code,t.signatureScheme,this.companyService.currentAuthority.authority);return!e&&n}},{key:"isCorrectlyFullfilled",value:function(t){return!0}},{key:"markFailedAsRead",value:function(){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="companies/".concat(this.companyService.currentId,"/payments/badges:mark-read-rejected"),t.prev=1,t.next=4,this.api.put(e);case 4:t.next=8;break;case 6:t.prev=6,t.t0=t.catch(1);case 8:return t.prev=8,this.filterService.updateFailedCount(0),t.finish(8);case 11:case"end":return t.stop()}}),t,this,[[1,6,8,11]])})))}},{key:"updateCountsByBadges",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.filterService.updateInProgressCount(null),this.filterService.updateFailedCount(null),n=0,r=0,i="companies/".concat(this.companyService.currentId,"/payments/badges"),s=new It.h,s=this.appendCategoryParams(t,s),e.prev=5,e.next=8,this.api.get(i,null,s);case 8:e.t0=function(t){switch(t.statusCode){case C.h.READY_TO_SEND:case C.h.IN_BANK:case C.h.BANK_PROCESSING:case C.h.BANK_SENT:n+=t.count;break;case C.h.REJECTED:r+=t.count}},e.sent.forEach(e.t0),e.next=14;break;case 12:e.prev=12,e.t1=e.catch(5);case 14:return e.prev=14,this.filterService.updateInProgressCount(n),this.filterService.updateFailedCount(r),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[5,12,14,17]])})))}},{key:"getTotalAmount",value:function(t){var e=0,n=null;return t.forEach((function(t){t.balance&&(t.balance.currency&&!n&&(n=t.balance.currency),e+=t.balance.amount)})),{currency:n,amount:e}}},{key:"mapDescription",value:function(t){var e,n,r,i,s,a,c;switch(t.type){case C.i.CONVERSION:var o,u=this.maskedService.getMaskedAmount(null===(e=t.details.exchangeRate)||void 0===e?void 0:e.calculatedSum),l=this.curSymbolPipe.transform(null===(n=t.details.exchangeRate)||void 0===n?void 0:n.currencyTo);return(o=u&&l?this.translateService.instant("CONVERSION.DESCRIPTION",{money:"".concat(u," ").concat(l),iban:t.paymentRecipient.recipientAccount.iban}):(null===(r=t.details)||void 0===r?void 0:r.description)||null)?"".concat(o," ").concat((null===(i=t.details.conversionPurpose)||void 0===i?void 0:i.description)||""):(null===(s=t.details.conversionPurpose)||void 0===s?void 0:s.description)?"".concat(null===(a=t.details.conversionPurpose)||void 0===a?void 0:a.description):null;default:return(null===(c=t.details)||void 0===c?void 0:c.description)||null}}},{key:"mapHistoryPayments",value:function(t){var e=this;return t.map((function(t,n){var r,i,s,a,c,o,u,l,d,b,h,m,p,f,g,v,S,y,T,R,O,I,E={id:t.id||null,iban:(null===(r=t.details)||void 0===r?void 0:r.payerIban)||null,reference:t.id||null,documentNumber:(null===(i=t.details)||void 0===i?void 0:i.documentId)||null,correspondentBankBic:(null===(a=null===(s=t.paymentRecipient)||void 0===s?void 0:s.recipientAccount)||void 0===a?void 0:a.bic)||null,correspondentAccount:(null===(o=null===(c=t.paymentRecipient)||void 0===c?void 0:c.recipientAccount)||void 0===o?void 0:o.iban)||null,correspondentName:(null===(u=t.paymentRecipient)||void 0===u?void 0:u.name)||null,kbe:(null===(l=t.paymentRecipient)||void 0===l?void 0:l.kbe)||null,correspondentBin:(null===(d=t.paymentRecipient)||void 0===d?void 0:d.iinOrBin)||null,debit:(null===(b=t.details)||void 0===b?void 0:b.paymentAmount)||null,credit:null,description:e.mapDescription(t),documentDate:(null===(h=t.details)||void 0===h?void 0:h.issueDate)||null,valueDate:(null===(m=t.details)||void 0===m?void 0:m.valueDate)||null,knp:(null===(p=t.details)||void 0===p?void 0:p.knp)||null,kbk:(null===(f=t.details)||void 0===f?void 0:f.kbk)||null,signHead:null,signBuch:null,isPayment:!0,paymentId:t.id,paymentStatus:t.status||null,paymentType:t.type||null,paymentEmployees:t.paymentEmployees,createDate:(null===(g=t.details)||void 0===g?void 0:g.createDate)||null,foreignPaymentDetails:t.details.foreignPaymentDetails||null,foreignRecipient:{country:null===(v=t.paymentRecipient)||void 0===v?void 0:v.country,countryCode:null===(S=t.paymentRecipient)||void 0===S?void 0:S.countryCode,cityName:null===(y=t.paymentRecipient)||void 0===y?void 0:y.cityName,bic:null===(R=null===(T=t.paymentRecipient)||void 0===T?void 0:T.recipientAccount)||void 0===R?void 0:R.bic,bankName:null===(I=null===(O=t.paymentRecipient)||void 0===O?void 0:O.recipientAccount)||void 0===I?void 0:I.bankName},emailOnSuccess:t.emailOnSuccess||null,signatureScheme:t.signatureScheme||null,signatures:t.signatures||[]},k=new kt.d(E,e.translateService.currentLang);return e.isFeatureDisabled(t.type)?(k.isExportable=!1,k.isRepeatable=!1,k.isEditable=!1,k.isRemovable=!1,k.isSignable=!1,k.isSendableForSign=!1,k.isRevokable=!1):(k.isExportable=e.isExportable(t),k.isRepeatable=e.isRepeatable(t),k.isEditable=e.isEditable(t),k.isRemovable=e.isRemovable(t),k.isSignable=e.isSignable(t),k.isSendableForSign=e.isSendableForSign(t),k.isRevokable=e.isRevokable(t)),k.hasTour=k.isRepeatable&&0==n&&1==e.cashedPageNumber,k.isSignableByOthers=e.isSignableByOthers(t),k.signsCountText=e.getSignsCountText(k),k}))}},{key:"isFeatureDisabled",value:function(t){var e=t==C.i.CONVERSION&&this.featureFlagsService.isDisabled(Ct.a.CONVERSION),n=t==C.i.FOREIGN&&this.featureFlagsService.isDisabled(Ct.a.FOREIGN_PAYMENT);return e||n||!1}},{key:"isRepeatable",value:function(t){return(t.status.state!=C.d.MIGRATED||t.category!==C.g.CONVERSION)&&t.status.code!=C.h.DRAFT}},{key:"isExportable",value:function(t){return(t.status.state!=C.d.MIGRATED||t.category!==C.g.CONVERSION)&&t.status.code!=C.h.CREATED&&t.status.code!=C.h.DRAFT}},{key:"generateGroupTitle",value:function(t){switch(t){case A.c.ALL:return"HISTORY.LISTS.ALL";case A.c.FOR_SIGN:return"HISTORY.LISTS.FOR_SIGN";case A.c.FOR_SIGN_OTHERS:return"HISTORY.LISTS.FOR_SIGN_OTHERS";case A.c.SUCCESS:return"HISTORY.LISTS.SUCCESS";case A.c.FAILED:return"HISTORY.LISTS.FAILED";case A.c.IN_PROGRESS:return"HISTORY.LISTS.IN_PROGRESS";case A.c.DRAFT:return"HISTORY.LISTS.DRAFT"}}},{key:"compareBySignature",value:function(t,e){return t.isSignable&&e.isSignable?0:t.isSignable&&e.isSignableByOthers?-1:1}}]),t}()).\u0275fac=function(t){return new(t||Rt)(m.ec(_t.a),m.ec(Ft.a),m.ec(Et.a),m.ec(x.e),m.ec(xt.a),m.ec(Lt.a),m.ec(wt.c),m.ec(Ct.b))},Rt.\u0275prov=m.Mb({token:Rt,factory:Rt.\u0275fac,providedIn:"root"}),Rt),Dt=n("1ua0"),Nt=n("yZrb"),Ht=n("ZF+8"),Pt=n("iCQh"),Wt=n("THGi"),Mt=n("/68H"),jt=n("QiVB");function Yt(t,e){if(1&t&&(m.Wb(0,"a",10),m.Qc(1),m.Vb()),2&t){var n=e.$implicit;m.rc("routerLink",n.url),m.Ab(1),m.Rc(n.label)}}function Gt(t,e){1&t&&(m.Wb(0,"div",11),m.Rb(1,"j-statement-loading"),m.Vb())}function Qt(t,e){if(1&t&&(m.Wb(0,"div",25),m.Wb(1,"div"),m.Wb(2,"span",26),m.Qc(3,"HISTORY.OPERATION.OTHER"),m.Vb(),m.Qc(4,": "),m.Wb(5,"strong"),m.Qc(6),m.Vb(),m.Vb(),m.Wb(7,"div"),m.Wb(8,"span",26),m.Qc(9,"HISTORY.FOR_AMOUNT"),m.Vb(),m.Qc(10,": "),m.Wb(11,"strong"),m.Rb(12,"j-money",27),m.Vb(),m.Vb(),m.Vb()),2&t){var n=m.lc(3);m.Ab(6),m.Sc(" ",n.totalCount," "),m.Ab(6),m.rc("money",n.totalBalance)}}function Bt(t,e){if(1&t&&(m.Wb(0,"div",25),m.Wb(1,"strong"),m.Rb(2,"j-money",27),m.Vb(),m.Qc(3),m.Vb()),2&t){var n=e.$implicit;m.Ab(2),m.rc("money",n.balance),m.Ab(1),m.Sc(" (",n.count,") ")}}function Kt(t,e){if(1&t&&m.Oc(0,Bt,4,2,"div",28),2&t){var n=m.lc(3);m.rc("ngForOf",n.currencies)}}function Ut(t,e){if(1&t&&(m.Wb(0,"div",25),m.Wb(1,"strong"),m.Rb(2,"j-money",27),m.Vb(),m.Qc(3),m.Vb()),2&t){var n=e.$implicit;m.Ab(2),m.rc("money",n.balance),m.Ab(1),m.Sc(" (",n.count,") ")}}function $t(t,e){if(1&t&&(m.Oc(0,Ut,4,2,"div",28),m.Wb(1,"div",29),m.Qc(2,"+ "),m.Vb()),2&t){m.lc();var n=m.Cc(10),r=m.lc(2);m.rc("ngForOf",r.currencies.splice(0,4)),m.Ab(1),m.rc("ngbTooltip",n)}}function zt(t,e){if(1&t&&(m.Wb(0,"div"),m.Wb(1,"strong"),m.Rb(2,"j-money",27),m.Vb(),m.Qc(3),m.Vb()),2&t){var n=e.$implicit;m.Ab(2),m.rc("money",n.balance),m.Ab(1),m.Sc(" (",n.count,") ")}}function Xt(t,e){if(1&t&&m.Oc(0,zt,4,2,"div",30),2&t){var n=m.lc(3);m.rc("ngForOf",n.currencies.splice(3,n.currencies.length))}}function Jt(t,e){if(1&t){var n=m.Xb();m.Ub(0),m.Wb(1,"a",31),m.ic("click",(function(t){return m.Fc(n),m.lc(3).signAll(t)})),m.Wb(2,"span",32),m.Qc(3,"HISTORY.SIGN_ALL"),m.Vb(),m.Rb(4,"span",33),m.Vb(),m.Tb()}2&t&&(m.Ab(4),m.rc("inlineSVG","./assets/icons/transaction/sign.svg"))}function qt(t,e){if(1&t){var n=m.Xb();m.Ub(0),m.Wb(1,"a",31),m.ic("click",(function(t){return m.Fc(n),m.lc(3).sendAllForSign(t)})),m.Wb(2,"span",32),m.Qc(3,"HISTORY.SEND_ALL_FOR_SIGN"),m.Vb(),m.Rb(4,"span",33),m.Vb(),m.Tb()}2&t&&(m.Ab(4),m.rc("inlineSVG","./assets/icons/transaction/for-sign.svg"))}function Zt(t,e){if(1&t){var n=m.Xb();m.Wb(0,"a",36),m.ic("click",(function(t){return m.Fc(n),m.lc(4).signSelected(t)})),m.mc(1,"translate"),m.Vb()}2&t&&m.rc("ngbTooltip",m.nc(1,2,"HISTORY.SIGN_SELECTED"))("inlineSVG","./assets/icons/transaction/sign.svg")}function te(t,e){if(1&t){var n=m.Xb();m.Wb(0,"a",36),m.ic("click",(function(t){return m.Fc(n),m.lc(4).sendForSignSelected(t)})),m.mc(1,"translate"),m.Vb()}2&t&&m.rc("ngbTooltip",m.nc(1,2,"HISTORY.SEND_FOR_SIGN_SELECTED"))("inlineSVG","./assets/icons/transaction/for-sign.svg")}function ee(t,e){if(1&t){var n=m.Xb();m.Ub(0),m.Wb(1,"a",34),m.ic("click",(function(t){return m.Fc(n),m.lc(3).deleteSelectedTransactions(t)})),m.mc(2,"translate"),m.Vb(),m.Oc(3,Zt,2,4,"a",35),m.Oc(4,te,2,4,"a",35),m.Tb()}if(2&t){var r=m.lc(3);m.Ab(1),m.rc("ngbTooltip",m.nc(2,4,"HISTORY.DELETE_SELECTED"))("inlineSVG","./assets/icons/transaction/delete.svg"),m.Ab(2),m.rc("ngIf",r.isSignable),m.Ab(1),m.rc("ngIf",r.isSendableForSign)}}function ne(t,e){if(1&t){var n=m.Xb();m.Wb(0,"div",16),m.Wb(1,"div",17),m.Wb(2,"input",18),m.ic("ngModelChange",(function(t){return m.Fc(n),m.lc(2).isAllSelected=t}))("change",(function(t){return m.Fc(n),m.lc(2).selectAll()})),m.Vb(),m.Wb(3,"label",19),m.Qc(4,"HISTORY.SELECT_ALL"),m.Vb(),m.Vb(),m.Wb(5,"div",20),m.Oc(6,Qt,13,2,"ng-template",21),m.Oc(7,Kt,1,1,"ng-template",21),m.Oc(8,$t,3,2,"ng-template",21),m.Oc(9,Xt,1,1,"ng-template",null,22,m.Pc),m.Wb(11,"div",23),m.Oc(12,Jt,5,1,"ng-container",24),m.Oc(13,qt,5,1,"ng-container",24),m.Oc(14,ee,5,6,"ng-container",24),m.Vb(),m.Vb(),m.Vb()}if(2&t){var r=m.lc(2);m.Ab(2),m.rc("ngModel",r.isAllSelected),m.Ab(4),m.rc("ngIf",!r.currencies||(null==r.currencies?null:r.currencies.length)<=1),m.Ab(1),m.rc("ngIf",(null==r.currencies?null:r.currencies.length)>1&&(null==r.currencies?null:r.currencies.length)<=3),m.Ab(1),m.rc("ngIf",(null==r.currencies?null:r.currencies.length)>3),m.Ab(4),m.rc("ngIf",0==r.selectedCount&&r.isAllSignable),m.Ab(1),m.rc("ngIf",0==r.selectedCount&&r.isAllSendableForSign),m.Ab(1),m.rc("ngIf",r.selectedCount>0)}}function re(t,e){if(1&t){var n=m.Xb();m.Wb(0,"div",17),m.Wb(1,"input",38),m.ic("ngModelChange",(function(t){return m.Fc(n),m.lc(3).isAllSelected=t}))("change",(function(t){return m.Fc(n),m.lc(3).selectAll()})),m.Vb(),m.Wb(2,"label",39),m.Qc(3,"HISTORY.SELECT_ALL"),m.Vb(),m.Vb()}if(2&t){var r=m.lc(3);m.Ab(1),m.rc("ngModel",r.isAllSelected)}}function ie(t,e){if(1&t){var n=m.Xb();m.Ub(0),m.Wb(1,"a",34),m.ic("click",(function(t){return m.Fc(n),m.lc(3).exportSelectedTransactions(t)})),m.mc(2,"translate"),m.Vb(),m.Tb()}2&t&&(m.Ab(1),m.rc("ngbTooltip",m.nc(2,2,"HISTORY.DOWNLOAD_SELECTED"))("inlineSVG","./assets/icons/transaction/pdf.svg"))}function se(t,e){if(1&t&&(m.Wb(0,"div",16),m.Oc(1,re,4,1,"div",37),m.Wb(2,"div",20),m.Wb(3,"div",25),m.Wb(4,"div"),m.Wb(5,"span",26),m.Qc(6,"HISTORY.OPERATION.OTHER"),m.Vb(),m.Qc(7,": "),m.Wb(8,"strong"),m.Qc(9),m.Vb(),m.Vb(),m.Vb(),m.Wb(10,"div",23),m.Oc(11,ie,3,4,"ng-container",24),m.Vb(),m.Vb(),m.Vb()),2&t){var n=m.lc(2);m.Ab(1),m.rc("ngIf",n.isAllSelectableForExport),m.Ab(8),m.Sc(" ",n.totalCount," "),m.Ab(2),m.rc("ngIf",n.selectedCount>0)}}function ae(t,e){1&t&&(m.Wb(0,"div",40),m.Qc(1," ACCOUNTS.STATEMENT.ALL_LOADED "),m.Vb())}function ce(t,e){if(1&t){var n=m.Xb();m.Wb(0,"div",12),m.Oc(1,ne,15,7,"div",13),m.Oc(2,se,12,3,"div",13),m.Wb(3,"j-statement",14),m.ic("signed",(function(t){return m.Fc(n),m.lc().onSign(t)}))("sentForSign",(function(t){return m.Fc(n),m.lc().onSentForSign(t)}))("deleted",(function(t){return m.Fc(n),m.lc().onDelete(t)}))("revoked",(function(t){return m.Fc(n),m.lc().onRevoke(t)}))("selected",(function(t){return m.Fc(n),m.lc().onSelect()})),m.Vb(),m.Oc(4,ae,2,0,"div",15),m.Vb()}if(2&t){var r=m.lc();m.Hb("list-statement--scrollable",r.hasMorePages),m.Ab(1),m.rc("ngIf",r.isSelectable),m.Ab(1),m.rc("ngIf",r.isSelectableForExport),m.Ab(1),m.rc("statement",r.statement)("isTotalsShown",!1)("hasExtraPadding",!0)("isSelectable",r.isSelectable||r.isSelectableForExport),m.Ab(1),m.rc("ngIf",!r.hasMorePages&&r.statement.totalTransactionsCount>0)}}var oe,ue,le=((oe=function(){function t(e,n,r,i,s,a,c,o,u,l,d){var b=this;_classCallCheck(this,t),this.company=e,this.filterService=n,this.historyService=r,this.route=i,this.router=s,this.datePipe=a,this.modalService=c,this.filesService=o,this.maskedService=u,this.statementService=l,this.tourService=d,this.filterScheme={periodTo:null,periodFrom:null},this.filterCurrency=_.a.KZT,this.filterMode=k.a.HISTORY,this.modalConfigSmall={backdropClass:"backdrop_light",windowClass:"modal_light modal_sm",backdrop:"static",centered:!0},this.modalConfigMedium={backdropClass:"backdrop_light",windowClass:"modal_light modal_md",backdrop:"static",centered:!0},this.historyTypes=[{label:"HISTORY.ALL",url:"/history/all"},{label:"HISTORY.TENGE_PAYMENTS",url:"/history/tenge"},{label:"HISTORY.CURRENCY_PAYMENTS",url:"/history/foreign"},{label:"HISTORY.CONVERSION",url:"/history/conversion"}],this.subscription=new R.a,this.pageNumber=1,this.pageSize=25,this.pageSizeForSign=1e5,this.hasMorePages=!0,this.isLoading=!0,this.isLoadingExtra=!0,this.isReady=!1,this.isTourShown=!1,this.tourStep=null,this.hasSignableSelected=!1,this.isAllSelected=!1,this.selectedTransactions=[],this.selectedCount=0,this.SESSION_ROUTE_KEY="historyRouteQuery",this.cashedRouteQuery=JSON.parse(sessionStorage.getItem(this.SESSION_ROUTE_KEY)),this.canBeNavigatedToForSign=!0;var h=this.route.paramMap.pipe(Object(I.a)((function(){return window.history.state}))).subscribe((function(t){b.tourStep=t.tourStep,b.tourService.onTourStart$.next(null)}));this.subscription.add(h);var m=Object(O.a)([this.route.queryParams,this.route.data]).pipe(Object(E.a)(1)).subscribe((function(t){var e=_slicedToArray(t,2),n=e[0],r=e[1];Object.keys(n).length>0&&(b.canBeNavigatedToForSign=!1),b.paymentCategory=r.category,b.cashedRouteQuery&&!n&&(n=b.cashedRouteQuery),b.updateCashedRouteQuery(n);var i=b.mapQueryParams(n);b.filterScheme=i,b.filterService.updateExtra(b.filterScheme)}));this.subscription.add(m);var p=this.company.refresh$.subscribe((function(t){b.init(b.filterScheme),b.historyService.updateStatusCounts(b.paymentCategory)})),f=this.filterService.getScheme().subscribe((function(t){b.init(t)})),g=this.filesService.onImport().subscribe((function(){b.init(b.filterScheme),b.historyService.updateStatusCounts(b.paymentCategory)})),v=this.filterService.getStatuses().subscribe((function(t){var e=t.find((function(t){return t.value==A.c.FOR_SIGN}));if(e.count>0&&e.classList.includes("badge-primary")&&b.canBeNavigatedToForSign){b.canBeNavigatedToForSign=!1;var n=Object.assign(b.filterScheme,{paymentStatus:A.c.FOR_SIGN});b.filterService.updateExtra(n)}}));this.subscription.add(p),this.subscription.add(f),this.subscription.add(g),this.subscription.add(v)}return _createClass(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.filterService.getDefaults(this.filterMode);return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.filterScheme=Object.assign({},t),this.pageNumber=1,this.hasMorePages=!0,this.isLoading=!0,this.updateQueryParams(),e.next=7,this.loadStatement();case 7:this.updateSelectable();case 8:case"end":return e.stop()}}),e,this)})))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onScroll",value:function(){this.hasMorePages&&(this.pageNumber++,this.loadStatement())}},{key:"validateTransactionsByPaymentId",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.historyService.validateTransactionsByPaymentId(this.company.currentId,t);case 3:return n=e.sent,e.abrupt("return",(n.status!==C.b.SUCCESS&&this.showValidationError(n),n.status));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",(this.showValidationError(e.t0),C.b.FAILED));case 10:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"onSign",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={transactionIds:[t.id],totalBalance:t.balance,transactionsCount:1},e.prev=1,e.t0=t.paymentStatus.code===C.h.DRAFT,!e.t0){e.next=9;break}return e.next=6,this.validateTransactionsByPaymentId(n.transactionIds);case 6:e.t1=e.sent,e.t2=C.b.FAILED,e.t0=e.t1===e.t2;case 9:if(!e.t0){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,this.showSignModal(n);case 13:this.historyService.updateForSignCount(null,this.paymentCategory),e.next=18;break;case 16:e.prev=16,e.t3=e.catch(1);case 18:case"end":return e.stop()}}),e,this,[[1,16]])})))}},{key:"onSentForSign",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.sendToSigned([t]);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"onSelect",value:function(){this.updateSelectable()}},{key:"selectAll",value:function(){var t=this;this.currentTransactions.forEach((function(e){e.isSelected=t.isAllSelected})),this.updateSelectable(),this.isAllSelected=!0}},{key:"selectSignable",value:function(){var t=this;this.currentTransactions.forEach((function(e){e.isSelected=!!e.isSignable&&t.hasSignableSelected})),this.updateSelectable(),this.hasSignableSelected=!0}},{key:"signAll",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={paymentStatus:this.filterScheme.paymentStatus},e.next=4,this.historyService.getHistoryList(this.paymentCategory,n,1,this.pageSizeForSign);case 4:if(e.t0=function(t){return s.historyService.isSignable(t)},r=e.sent.body.filter(e.t0),i={transactionIds:this.retrieveIdsFromList(r),totalBalance:this.countTotalBalanceFromPaymentsList(r),transactionsCount:r.length},e.t1=this.filterScheme.paymentStatus===A.c.DRAFT,!e.t1){e.next=14;break}return e.next=11,this.validateTransactionsByPaymentId(i.transactionIds);case 11:e.t2=e.sent,e.t3=C.b.FAILED,e.t1=e.t2===e.t3;case 14:if(e.t4=e.t1,e.t4){e.next=17;break}this.showSignModal(i);case 17:case"end":return e.stop()}}),e,this)})))}},{key:"sendAllForSign",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={paymentStatus:A.c.DRAFT},e.next=4,this.historyService.getHistoryList(this.paymentCategory,n,1,this.pageSizeForSign);case 4:e.t0=function(t){return i.historyService.isSendableForSign(t)},r=e.sent.body.filter(e.t0),this.sendToSigned(r);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"signSelected",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n={transactionIds:this.retrieveIdsFromList(this.selectedTransactions),totalBalance:this.countTotalBalanceFromTransactionsList(this.selectedTransactions),transactionsCount:this.selectedTransactions.length},e.t0=this.filterScheme.paymentStatus===A.c.DRAFT,!e.t0){e.next=9;break}return e.next=6,this.validateTransactionsByPaymentId(n.transactionIds);case 6:e.t1=e.sent,e.t2=C.b.SUCCESS,e.t0=e.t1!==e.t2;case 9:if(e.t3=e.t0,e.t3){e.next=12;break}this.showSignModal(n);case 12:case"end":return e.stop()}}),e,this)})))}},{key:"sendForSignSelected",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),this.sendToSigned(this.selectedTransactions);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"deleteSelectedTransactions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.preventDefault(),this.deleteTransactions(this.selectedTransactions);case 1:case"end":return e.stop()}}),e,this)})))}},{key:"exportSelectedTransactions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t&&t.preventDefault(),e.next=3,this.statementService.exportTransactions(this.selectedTransactions);case 3:n=e.sent,this.filesService.downloadFile(n,"".concat(this.selectedCount,"_operations.pdf"));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"onDelete",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deleteTransactions([t]);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"onRevoke",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isLoading=!0,e.prev=1,e.next=4,this.historyService.revokePayment(this.company.currentId,t);case 4:return e.next=6,this.init(this.filterScheme);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:return e.prev=10,this.historyService.updateForSignCount(null,this.paymentCategory),this.historyService.updateStatusCounts(this.paymentCategory),this.resetSelectable(),this.updateSelectable(),e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,8,10,13]])})))}},{key:"deleteTransactions",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.forEach((function(t){t.isLoading=!0})),e.prev=1,e.next=4,this.historyService.deleteMultipleTransactions(this.company.currentId,t);case 4:return n=e.sent,e.next=7,this.init(this.filterScheme);case 7:r=n.length,i=t.length-r,0===r?this.showDeleteError(t):0===i?this.showDeleteSuccess(r):this.showDeletePartial(r,i),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),this.showDeleteError(t);case 14:return e.prev=14,this.historyService.updateForSignCount(null,this.paymentCategory),this.resetSelectable(),this.updateSelectable(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])})))}},{key:"sendToSigned",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.historyService.sendMultipleTransactionsForSign(t.map((function(t){return t.id})));case 3:n=e.sent,e.t0=n.status,e.next=e.t0===C.b.SUCCESS?7:e.t0===C.b.PARTLY_SUCCESS?11:e.t0===C.b.FAILED?15:16;break;case 7:return this.showSendToSignedSuccess(n),e.next=10,this.init(this.filterScheme);case 10:return e.abrupt("break",16);case 11:return this.showSendToSignedPartial(n),e.next=14,this.init(this.filterScheme);case 14:return e.abrupt("break",16);case 15:this.showSendToSignedPartialError(n);case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(0),console.error(e.t1),this.showSendToSignedError(t);case 21:return e.prev=21,this.resetSelectable(),this.updateSelectable(),this.historyService.updateForSignCount(null,this.paymentCategory),e.finish(21);case 24:case"end":return e.stop()}}),e,this,[[0,18,21,24]])})))}},{key:"showSignModal",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(Dt.b,this.modalConfigMedium),Object.assign(n.componentInstance,{additionalParams:{actionIds:t.transactionIds}}),Object.assign(n.componentInstance,{headerParams:{smsHeader:Nt.c.SIGNING_PAYMENT}}),n.componentInstance.submitted.subscribe((function(e){r.signMultipleTransactions(e,t).then((function(){localStorage.setItem("preferredSignatureType",e.type===C.p.OTP?Dt.a.OTP:Dt.a.SMS)})).catch((function(e){r.showMultipleSignError(e.description||e.code,t)})).finally((function(){r.historyService.updateForSignCount(null,r.paymentCategory),n.close()}))})),n.componentInstance.sentForRevision.subscribe((function(){r.init(r.filterScheme),n.close()}));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"signMultipleTransactions",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,this.historyService.signMultipleTransactions(this.company.currentId,t,e.transactionIds);case 3:r=n.sent,n.t0=r.status,n.next=n.t0===C.b.SUCCESS?7:n.t0===C.b.PARTLY_SUCCESS?11:n.t0===C.b.FAILED?15:16;break;case 7:return this.showMultipleSignSuccess(r),n.next=10,this.init(this.filterScheme);case 10:return n.abrupt("break",16);case 11:return this.showMultipleSignPartialSuccess(r),n.next=14,this.init(this.filterScheme);case 14:return n.abrupt("break",16);case 15:this.showMultipleSignPartialError(r);case 16:n.next=21;break;case 18:n.prev=18,n.t1=n.catch(0),this.showMultipleSignError(n.t1,e);case 21:return n.prev=21,this.updateSelectable(),this.historyService.updateForSignCount(null,this.paymentCategory),n.finish(21);case 24:case"end":return n.stop()}}),n,this,[[0,18,21,24]])})))}},{key:"loadStatement",value:function(){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isLoadingExtra=!0,t.prev=1,t.next=4,this.historyService.getTransactionGroup(this.paymentCategory,this.filterScheme,this.pageNumber,this.filterScheme.paymentStatus===A.c.FOR_SIGN?this.pageSizeForSign:this.pageSize);case 4:e=t.sent,this.hasMorePages=this.pageSize*this.pageNumber<=e.transactionsCount,this.statement={totalTransactionsCount:e.transactionsCount,transactionGroups:this.filterScheme.paymentStatus===A.c.FOR_SIGN?this.destructureForSignGroups(e):[e]},this.startHistoryTour(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0),this.statement=null;case 11:return t.prev=11,this.isReady=!0,this.isLoading=!1,this.isLoadingExtra=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,this,[[1,8,11,14]])})))}},{key:"startHistoryTour",value:function(){var t,e,n,r=this;this.isTourShown||(this.isTourShown=!0,("HISTORY_LIST.REPEAT"==this.tourStep||"HISTORY_HOME.NAV"==this.tourStep)&&(null===(n=null===(e=null===(t=this.statement)||void 0===t?void 0:t.transactionGroups[0])||void 0===e?void 0:e.transactions[0])||void 0===n?void 0:n.hasTour)&&setTimeout((function(){r.tourService.startTour(Ht.e.HISTORY_LIST)}),500))}},{key:"destructureForSignGroups",value:function(t){var e=t.transactions.filter((function(t){return t.isSignable})),n=t.transactions.filter((function(t){return t.isSignableByOthers}));return[{title:this.historyService.generateGroupTitle(A.c.FOR_SIGN),creditSum:null,debitSum:this.historyService.getTotalAmount(e),hasLargeTransactions:this.statementService.checkListForLargeTransactions(e),transactionsCount:e.length,transactions:e},{hasTour:!0,title:this.historyService.generateGroupTitle(A.c.FOR_SIGN_OTHERS),creditSum:null,debitSum:this.historyService.getTotalAmount(n),hasLargeTransactions:this.statementService.checkListForLargeTransactions(n),transactionsCount:n.length,transactions:n}]}},{key:"showValidationError",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(Ot,this.modalConfigMedium),t.results=t.results.map((function(t){return t.documentNumber=r.getDocumentNumberById(t.itemId),t})),n.componentInstance.result=t;case 2:case"end":return e.stop()}}),e,this)})))}},{key:"showMultipleSignPartialSuccess",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(U,this.modalConfigMedium),t.results=t.results.map((function(t){return t.documentNumber=r.getDocumentNumberById(t.itemId),t})),n.componentInstance.result=t;case 2:case"end":return e.stop()}}),e,this)})))}},{key:"showMultipleSignPartialError",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(M,this.modalConfigMedium),t.results=t.results.map((function(t){return t.documentNumber=r.getDocumentNumberById(t.itemId),t})),n.componentInstance.signResult=t;case 2:case"end":return e.stop()}}),e,this)})))}},{key:"showMultipleSignSuccess",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.modalService.open(Z,this.modalConfigSmall).componentInstance.result=t;case 1:case"end":return e.stop()}}),e,this)})))}},{key:"showMultipleSignError",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0;return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=this.modalService.open(X,this.modalConfigSmall)).componentInstance.errorText=t,n.prev=2,n.next=5,r.result;case 5:this.showSignModal(e),n.next=10;break;case 8:n.prev=8,n.t0=n.catch(2);case 10:case"end":return n.stop()}}),n,this,[[2,8]])})))}},{key:"showDeleteSuccess",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.modalService.open(D,this.modalConfigSmall).componentInstance.successCount=t;case 1:case"end":return e.stop()}}),e,this)})))}},{key:"showDeletePartial",value:function(t,e){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(r=this.modalService.open(w,this.modalConfigMedium)).componentInstance.successCount=t,r.componentInstance.failedCount=e;case 2:case"end":return n.stop()}}),n,this)})))}},{key:"showDeleteError",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.modalService.open(V,this.modalConfigSmall)).componentInstance.failedCount=t.length,e.prev=2,e.next=5,n.result;case 5:this.deleteTransactions(t),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:case"end":return e.stop()}}),e,this,[[2,8]])})))}},{key:"showSendToSignedSuccess",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.modalService.open(ct,this.modalConfigSmall).componentInstance.signResult=t;case 1:case"end":return e.stop()}}),e,this)})))}},{key:"showSendToSignedPartial",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(at,this.modalConfigMedium),t.results=t.results.map((function(t){return t.documentNumber=r.getDocumentNumberById(t.itemId),t})),n.componentInstance.signResult=t;case 2:case"end":return e.stop()}}),e,this)})))}},{key:"showSendToSignedPartialError",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.modalService.open(ht,this.modalConfigMedium),t.results=t.results.map((function(t){return t.documentNumber=r.getDocumentNumberById(t.itemId),t})),n.componentInstance.signResult=t;case 2:case"end":return e.stop()}}),e,this)})))}},{key:"showSendToSignedError",value:function(t){return Object(T.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this.modalService.open(ot,this.modalConfigSmall)).componentInstance.signResult={numberOfFailed:t.length,numberOfSuccess:0,status:C.b.FAILED},e.prev=2,e.next=5,n.result;case 5:this.sendToSigned(t),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(2);case 10:case"end":return e.stop()}}),e,this,[[2,8]])})))}},{key:"resetSelectable",value:function(){this.selectedTransactions=[],this.selectedCount=0,this.selectedBalance={amount:0,currency:null},this.isAllSelected=!1,this.hasSignableSelected=!1}},{key:"updateSelectable",value:function(){this.resetSelectable(),this.updateSelectedValues()}},{key:"retrieveIdsFromList",value:function(t){return t.map((function(t){return t.id}))}},{key:"updateSelectedValues",value:function(){var t=this;this.currentTransactions.forEach((function(e){e.isSelected&&(t.selectedTransactions.push(e),t.selectedCount++)})),this.selectedBalance=this.countTotalBalanceFromTransactionsList(this.selectedTransactions)}},{key:"countTotalBalanceFromPaymentsList",value:function(t){var e={amount:0,currency:null};return t.forEach((function(t){var n,r;e.currency||(e.currency=null===(n=t.details.paymentAmount)||void 0===n?void 0:n.currency),e.amount+=null===(r=t.details.paymentAmount)||void 0===r?void 0:r.amount})),e}},{key:"countTotalBalanceFromTransactionsList",value:function(t){var e={amount:0,currency:null};return t.forEach((function(t){t.debit&&(!e.currency&&t.debit.currency&&(e.currency=t.debit.currency),e.amount+=t.debit.amount)})),e}},{key:"isAllSignableInList",value:function(t){var e=!0;return t.forEach((function(t){if(!1===e)return e;t.isSignable||(e=!1)})),e}},{key:"isAllSendableForSignInList",value:function(t){var e=!0;return t.forEach((function(t){if(!1===e)return e;t.isSendableForSign||(e=!1)})),e}},{key:"hasSignableInList",value:function(t){return!!t.find((function(t){return t.isSignable}))}},{key:"hasSendableForSignInList",value:function(t){return!!t.find((function(t){return t.isSendableForSign}))}},{key:"mapQueryParams",value:function(t){var e=Object.assign({},this.filterService.getDefaults(this.filterMode));for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=t[n];if(!r)continue;e[n]="periodFrom"==n||"periodTo"==n?new Date(r):r}return e}},{key:"updateQueryParams",value:function(){var t=Object.assign({},this.filterScheme),e={};for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=t[n];r&&null!=r&&"null"!=r&&(e[n]="periodFrom"==n||"periodTo"==n?this.datePipe.transform(r,"yyyy-MM-dd"):r,"amountFrom"!=n&&"amountTo"!=n||(e[n]=this.maskedService.getNumberedAmount(r)))}this.updateCashedRouteQuery(e),this.router.navigate([],{queryParams:e,relativeTo:this.route})}},{key:"updateCashedRouteQuery",value:function(t){sessionStorage.setItem(this.SESSION_ROUTE_KEY,JSON.stringify(t))}},{key:"getDocumentNumberById",value:function(t){var e=this.currentTransactions.find((function(e){return e.id==t}));return e&&e.documentNumber||null}},{key:"isAllSignable",get:function(){return this.currentTransactions.length>0&&(this.filterScheme.paymentStatus===A.c.FOR_SIGN||this.filterScheme.paymentStatus===A.c.DRAFT)&&this.hasSignableInList(this.currentTransactions)}},{key:"isAllSendableForSign",get:function(){return!this.isAllSignable&&this.currentTransactions.length>0&&this.filterScheme.paymentStatus===A.c.DRAFT&&this.hasSendableForSignInList(this.currentTransactions)}},{key:"isSignable",get:function(){return this.currentTransactions&&(this.filterScheme.paymentStatus===A.c.FOR_SIGN||this.filterScheme.paymentStatus===A.c.DRAFT)&&this.isAllSignableInList(this.selectedTransactions)}},{key:"isSendableForSign",get:function(){return!this.isSignable&&this.currentTransactions&&this.filterScheme.paymentStatus===A.c.DRAFT&&this.isAllSendableForSignInList(this.selectedTransactions)}},{key:"isSelectable",get:function(){return this.currentTransactions&&(this.filterScheme.paymentStatus===A.c.FOR_SIGN||this.filterScheme.paymentStatus===A.c.DRAFT)}},{key:"isSelectableForExport",get:function(){return this.filterScheme.paymentStatus===A.c.SUCCESS||this.filterScheme.paymentStatus===A.c.FAILED||this.filterScheme.paymentStatus===A.c.IN_PROGRESS}},{key:"isAllSelectableForExport",get:function(){return this.filterScheme.paymentStatus===A.c.IN_PROGRESS}},{key:"totalBalance",get:function(){return this.selectedCount>0?this.selectedBalance:this.countTotalBalanceFromTransactionsList(this.currentTransactions)}},{key:"totalCount",get:function(){return this.selectedCount>0?this.selectedCount:this.currentTransactionsCount}},{key:"currentTransactionsCount",get:function(){var t;return(null===(t=this.statement)||void 0===t?void 0:t.totalTransactionsCount)||0}},{key:"currentTransactions",get:function(){var t,e,n;return(null===(n=null===(e=null===(t=this.statement)||void 0===t?void 0:t.transactionGroups)||void 0===e?void 0:e.map((function(t){return t.transactions})))||void 0===n?void 0:n.flat())||[]}},{key:"hasAnySelected",get:function(){return this.selectedCount>0}},{key:"currencies",get:function(){var t={};return(this.selectedCount>0?this.selectedTransactions:this.currentTransactions).forEach((function(e){var n,r,i,s,a,c,o,u;(null===(n=e.balance)||void 0===n?void 0:n.currency)&&(t[null===(r=e.balance)||void 0===r?void 0:r.currency]?(t[null===(i=e.balance)||void 0===i?void 0:i.currency].count++,t[null===(s=e.balance)||void 0===s?void 0:s.currency].balance.amount+=null===(a=e.balance)||void 0===a?void 0:a.amount):t[null===(c=e.balance)||void 0===c?void 0:c.currency]={count:1,balance:{amount:null===(o=e.balance)||void 0===o?void 0:o.amount,currency:null===(u=e.balance)||void 0===u?void 0:u.currency}})})),Object.values(t)}}]),t}()).\u0275fac=function(t){return new(t||oe)(m.Qb(Ft.a),m.Qb(k.c),m.Qb(Vt),m.Qb(h.a),m.Qb(h.c),m.Qb(c.f),m.Qb(F.q),m.Qb(Pt.a),m.Qb(Lt.a),m.Qb(kt.b),m.Qb(Ht.g))},oe.\u0275cmp=m.Kb({type:oe,selectors:[["j-history-list"]],decls:10,vars:9,consts:[[1,"j-list"],[1,"j-list__header"],[1,"j-tabs"],[1,"j-tabs__list"],["class","j-tabs__item","routerLinkActive","active","translate","",3,"routerLink",4,"ngFor","ngForOf"],[1,"j-list__filter"],[3,"currency","mode"],["class","j-list__statement j-list__loading",4,"ngIf"],["infiniteScroll","",3,"scrollWindow","alwaysCallback","infiniteScrollDistance","infiniteScrollThrottle","scrolled"],["class","j-list__statement",3,"list-statement--scrollable",4,"ngIf"],["routerLinkActive","active","translate","",1,"j-tabs__item",3,"routerLink"],[1,"j-list__statement","j-list__loading"],[1,"j-list__statement"],["class","total",4,"ngIf"],[3,"statement","isTotalsShown","hasExtraPadding","isSelectable","signed","sentForSign","deleted","revoked","selected"],["class","text-center text-muted mt-5 mb-3 text-small","translate","",4,"ngIf"],[1,"total"],[1,"total__select","custom-control","custom-checkbox"],["type","checkbox","id","checkboxAll",1,"custom-control-input",3,"ngModel","ngModelChange","change"],["for","checkboxAll","translate","",1,"custom-control-label"],[1,"total__content"],[3,"ngIf"],["leftCurrencies",""],[1,"total__actions"],[4,"ngIf"],[1,"total__text"],["translate",""],[3,"money"],["class","total__text",4,"ngFor","ngForOf"],[1,"total__text",3,"ngbTooltip"],[4,"ngFor","ngForOf"],["href","#",1,"total__action","total__action--sign",3,"click"],["translate","",1,"mr-2"],[3,"inlineSVG"],["href","#","tooltipClass","tooltip-light",1,"total__action",3,"ngbTooltip","inlineSVG","click"],["href","#","class","total__action total__action--sign","tooltipClass","tooltip-light",3,"ngbTooltip","inlineSVG","click",4,"ngIf"],["href","#","tooltipClass","tooltip-light",1,"total__action","total__action--sign",3,"ngbTooltip","inlineSVG","click"],["class","total__select custom-control custom-checkbox",4,"ngIf"],["type","checkbox","id","checkboxSelectExport",1,"custom-control-input",3,"ngModel","ngModelChange","change"],["for","checkboxSelectExport","translate","",1,"custom-control-label"],["translate","",1,"text-center","text-muted","mt-5","mb-3","text-small"]],template:function(t,e){1&t&&(m.Wb(0,"section",0),m.Wb(1,"div",1),m.Wb(2,"div",2),m.Wb(3,"nav",3),m.Oc(4,Yt,2,2,"a",4),m.Vb(),m.Vb(),m.Wb(5,"div",5),m.Rb(6,"j-filter",6),m.Vb(),m.Vb(),m.Oc(7,Gt,2,0,"div",7),m.Wb(8,"div",8),m.ic("scrolled",(function(t){return e.onScroll()})),m.Oc(9,ce,5,9,"div",9),m.Vb(),m.Vb()),2&t&&(m.Ab(4),m.rc("ngForOf",e.historyTypes),m.Ab(2),m.rc("currency",e.filterCurrency)("mode",e.filterMode),m.Ab(1),m.rc("ngIf",e.isLoading),m.Ab(1),m.rc("scrollWindow",!0)("alwaysCallback",!0)("infiniteScrollDistance",2)("infiniteScrollThrottle",500),m.Ab(1),m.rc("ngIf",!e.isLoading))},directives:[c.t,Wt.b,c.u,u.a,h.f,h.e,x.a,Mt.a,jt.a,o.a,o.t,o.w,j.a,F.E,L.a],pipes:[x.d],styles:['[_nghost-%COMP%]{margin:1rem 0;display:block}.total[_ngcontent-%COMP%]{min-height:60px;position:relative;font-size:.875rem;color:#666c72;padding-bottom:1rem}@media(min-width:960px){.total[_ngcontent-%COMP%]{-webkit-box-align:center;align-items:center;display:-webkit-box;display:flex}}.total[_ngcontent-%COMP%]:after{content:"";display:block;background:#eceef1;height:1px;position:absolute;bottom:0;left:-1.5rem;right:-1.5rem}.total[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1a1c1f}.total__select[_ngcontent-%COMP%]{margin-bottom:1rem}@media(min-width:960px){.total__select[_ngcontent-%COMP%]{margin-right:1.5rem;margin-bottom:0}}.total__select[_ngcontent-%COMP%]   .custom-control-label[_ngcontent-%COMP%]{line-height:1.5rem}.total__actions[_ngcontent-%COMP%]{margin-left:auto;display:-webkit-box;display:flex}.total__text[_ngcontent-%COMP%]{margin-right:1rem}@media(min-width:960px){.total__text[_ngcontent-%COMP%]{text-align:right}}.total__action[_ngcontent-%COMP%]{display:block;margin-left:.5rem;color:#b7bec5}.total__action[_ngcontent-%COMP%]:hover{color:#ef5630}.total__action--sign[_ngcontent-%COMP%]{color:#1586bb}.total__content[_ngcontent-%COMP%]{margin-left:auto;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center}@media(min-width:960px){.total__content[_ngcontent-%COMP%]{-webkit-box-pack:end;justify-content:flex-end}}']}),oe),de=[{path:"",component:y,data:{title:"HISTORY.TITLE"},children:[{path:"all",component:le,data:{category:C.g.ALL}},{path:"tenge",component:le,data:{category:C.g.DOMESTIC}},{path:"foreign",component:le,data:{category:C.g.FOREIGN}},{path:"conversion",component:le,data:{category:C.g.CONVERSION}},{path:"**",redirectTo:"all"}]}],be=((ue=function t(){_classCallCheck(this,t)}).\u0275mod=m.Ob({type:ue}),ue.\u0275inj=m.Nb({factory:function(t){return new(t||ue)},imports:[[h.g.forChild(de)],h.g]}),ue),he=n("xJkR");n.d(e,"HistoryModule",(function(){return pe}));var me,pe=((me=function t(){_classCallCheck(this,t)}).\u0275mod=m.Ob({type:me}),me.\u0275inj=m.Nb({factory:function(t){return new(t||me)},imports:[[c.c,l.a,b.a,o.n,d.a,be,u.b,x.c,he.b]]}),me)}}]);
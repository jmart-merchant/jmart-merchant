function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],n=!0,r=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(n=(a=o.next()).done)&&(i.push(a.value),!t||i.length!==t);n=!0);}catch(c){r=!0,s=c}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}return i}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{gfTr:function(e,t,i){"use strict";i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return h})),i.d(t,"c",(function(){return p}));var n=i("fXoL"),r=i("PqYM"),s=i("ofXK"),a=["fileSelector"];function o(e,t){if(1&e&&(n.Wb(0,"div",7),n.Qc(1),n.Vb()),2&e){var i=n.lc(2);n.Ab(1),n.Rc(i.dropZoneLabel)}}function c(e,t){if(1&e){var i=n.Xb();n.Wb(0,"div"),n.Wb(1,"input",8),n.ic("click",(function(e){return n.Fc(i),n.lc(2).openFileSelector(e)})),n.Vb(),n.Vb()}if(2&e){var r=n.lc(2);n.Ab(1),n.Db(r.browseBtnClassName),n.sc("value",r.browseBtnLabel)}}function l(e,t){if(1&e&&(n.Oc(0,o,2,1,"div",5),n.Oc(1,c,2,3,"div",6)),2&e){var i=n.lc();n.rc("ngIf",i.dropZoneLabel),n.Ab(1),n.rc("ngIf",i.showBrowseBtn)}}function u(e,t){}var d=function(e){return{openFileSelector:e}},b=function e(t,i){_classCallCheck(this,e),this.relativePath=t,this.fileEntry=i},h=function(){var e=function e(t){_classCallCheck(this,e),this.template=t};return e.\u0275fac=function(t){return new(t||e)(n.Qb(n.L))},e.\u0275dir=n.Lb({type:e,selectors:[["","ngx-file-drop-content-tmp",""]]}),e}(),g=function(){var e=function(){function e(t,i){var r=this;_classCallCheck(this,e),this.zone=t,this.renderer=i,this.accept="*",this.directory=!1,this.multiple=!0,this.dropZoneLabel="",this.dropZoneClassName="ngx-file-drop__drop-zone",this.useDragEnter=!1,this.contentClassName="ngx-file-drop__content",this.showBrowseBtn=!1,this.browseBtnClassName="btn btn-primary btn-xs ngx-file-drop__browse-btn",this.browseBtnLabel="Browse files",this.onFileDrop=new n.n,this.onFileOver=new n.n,this.onFileLeave=new n.n,this.isDraggingOverDropZone=!1,this.globalDraggingInProgress=!1,this.files=[],this.numOfActiveReadEntries=0,this.helperFormEl=null,this.fileInputPlaceholderEl=null,this.dropEventTimerSubscription=null,this._disabled=!1,this.openFileSelector=function(e){r.fileSelector&&r.fileSelector.nativeElement&&r.fileSelector.nativeElement.click()},this.globalDragStartListener=this.renderer.listen("document","dragstart",(function(e){r.globalDraggingInProgress=!0})),this.globalDragEndListener=this.renderer.listen("document","dragend",(function(e){r.globalDraggingInProgress=!1}))}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.dropEventTimerSubscription&&(this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=null),this.globalDragStartListener(),this.globalDragEndListener(),this.files=[],this.helperFormEl=null,this.fileInputPlaceholderEl=null}},{key:"onDragOver",value:function(e){this.useDragEnter?(this.preventAndStop(e),e.dataTransfer&&(e.dataTransfer.dropEffect="copy")):this.isDropzoneDisabled()||this.useDragEnter||!e.dataTransfer||(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(e)),this.preventAndStop(e),e.dataTransfer.dropEffect="copy")}},{key:"onDragEnter",value:function(e){!this.isDropzoneDisabled()&&this.useDragEnter&&(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(e)),this.preventAndStop(e))}},{key:"onDragLeave",value:function(e){this.isDropzoneDisabled()||(this.isDraggingOverDropZone&&(this.isDraggingOverDropZone=!1,this.onFileLeave.emit(e)),this.preventAndStop(e))}},{key:"dropFiles",value:function(e){var t;!this.isDropzoneDisabled()&&(this.isDraggingOverDropZone=!1,e.dataTransfer)&&(t=e.dataTransfer.items?e.dataTransfer.items:e.dataTransfer.files,this.preventAndStop(e),this.checkFiles(t))}},{key:"uploadFiles",value:function(e){!this.isDropzoneDisabled()&&e.target&&(this.checkFiles(e.target.files||[]),this.resetFileInput())}},{key:"checkFiles",value:function(e){for(var t=this,i=function(i){var n=e[i],r=null;if(t.canGetAsEntry(n)&&(r=n.webkitGetAsEntry()),r)if(r.isFile){var s=new b(r.name,r);t.addToQueue(s)}else r.isDirectory&&t.traverseFileTree(r,r.name);else if(n){var a={name:n.name,isDirectory:!1,isFile:!0,file:function(e){return e(n)}},o=new b(a.name,a);t.addToQueue(o)}},n=0;n<e.length;n++)i(n);this.dropEventTimerSubscription&&this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=Object(r.a)(200,200).subscribe((function(){if(t.files.length>0&&0===t.numOfActiveReadEntries){var e=t.files;t.files=[],t.onFileDrop.emit(e)}}))}},{key:"traverseFileTree",value:function(e,t){var i=this;if(e.isFile){var n=new b(t,e);this.files.push(n)}else{t+="/";var r=e.createReader(),s=[];!function n(){i.numOfActiveReadEntries++,r.readEntries((function(r){if(r.length)s=s.concat(r),n();else if(0===s.length){var a=new b(t,e);i.zone.run((function(){i.addToQueue(a)}))}else for(var o=function(e){i.zone.run((function(){i.traverseFileTree(s[e],t+s[e].name)}))},c=0;c<s.length;c++)o(c);i.numOfActiveReadEntries--}))}()}}},{key:"resetFileInput",value:function(){if(this.fileSelector&&this.fileSelector.nativeElement){var e=this.fileSelector.nativeElement,t=e.parentElement,i=this.getHelperFormElement(),n=this.getFileInputPlaceholderElement();t!==i&&(this.renderer.insertBefore(t,n,e),this.renderer.appendChild(i,e),i.reset(),this.renderer.insertBefore(t,e,n),this.renderer.removeChild(t,n))}}},{key:"getHelperFormElement",value:function(){return this.helperFormEl||(this.helperFormEl=this.renderer.createElement("form")),this.helperFormEl}},{key:"getFileInputPlaceholderElement",value:function(){return this.fileInputPlaceholderEl||(this.fileInputPlaceholderEl=this.renderer.createElement("div")),this.fileInputPlaceholderEl}},{key:"canGetAsEntry",value:function(e){return!!e.webkitGetAsEntry}},{key:"isDropzoneDisabled",value:function(){return this.globalDraggingInProgress||this.disabled}},{key:"addToQueue",value:function(e){this.files.push(e)}},{key:"preventAndStop",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=null!=e&&"false"!=="".concat(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(n.Qb(n.z),n.Qb(n.D))},e.\u0275cmp=n.Kb({type:e,selectors:[["ngx-file-drop"]],contentQueries:function(e,t,i){var r;1&e&&n.Ib(i,h,!0,n.L),2&e&&n.Bc(r=n.jc())&&(t.contentTemplate=r.first)},viewQuery:function(e,t){var i;1&e&&n.Lc(a,!0),2&e&&n.Bc(i=n.jc())&&(t.fileSelector=i.first)},inputs:{accept:"accept",directory:"directory",multiple:"multiple",dropZoneLabel:"dropZoneLabel",dropZoneClassName:"dropZoneClassName",useDragEnter:"useDragEnter",contentClassName:"contentClassName",showBrowseBtn:"showBrowseBtn",browseBtnClassName:"browseBtnClassName",browseBtnLabel:"browseBtnLabel",disabled:"disabled"},outputs:{onFileDrop:"onFileDrop",onFileOver:"onFileOver",onFileLeave:"onFileLeave"},decls:7,vars:17,consts:[[3,"drop","dragover","dragenter","dragleave"],["type","file",1,"ngx-file-drop__file-input",3,"accept","multiple","change"],["fileSelector",""],["defaultContentTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","ngx-file-drop__drop-zone-label",4,"ngIf"],[4,"ngIf"],[1,"ngx-file-drop__drop-zone-label"],["type","button",3,"value","click"]],template:function(e,t){if(1&e&&(n.Wb(0,"div",0),n.ic("drop",(function(e){return t.dropFiles(e)}))("dragover",(function(e){return t.onDragOver(e)}))("dragenter",(function(e){return t.onDragEnter(e)}))("dragleave",(function(e){return t.onDragLeave(e)})),n.Wb(1,"div"),n.Wb(2,"input",1,2),n.ic("change",(function(e){return t.uploadFiles(e)})),n.Vb(),n.Oc(4,l,2,2,"ng-template",null,3,n.Pc),n.Oc(6,u,0,0,"ng-template",4),n.Vb(),n.Vb()),2&e){var i=n.Cc(5);n.Db(t.dropZoneClassName),n.Hb("ngx-file-drop__drop-zone--over",t.isDraggingOverDropZone),n.Ab(1),n.Db(t.contentClassName),n.Ab(1),n.rc("accept",t.accept)("multiple",t.multiple),n.Bb("directory",t.directory||void 0)("webkitdirectory",t.directory||void 0)("mozdirectory",t.directory||void 0)("msdirectory",t.directory||void 0)("odirectory",t.directory||void 0),n.Ab(4),n.rc("ngTemplateOutlet",t.contentTemplate||i)("ngTemplateOutletContext",n.wc(15,d,t.openFileSelector))}},directives:[s.B,s.u],styles:[".ngx-file-drop__drop-zone[_ngcontent-%COMP%]{border:2px dotted #0782d0;border-radius:30px;height:100px;margin:auto}.ngx-file-drop__drop-zone--over[_ngcontent-%COMP%]{background-color:hsla(0,0%,57.6%,.5)}.ngx-file-drop__content[_ngcontent-%COMP%]{align-items:center;color:#0782d0;display:flex;height:100px;justify-content:center}.ngx-file-drop__drop-zone-label[_ngcontent-%COMP%]{text-align:center}.ngx-file-drop__file-input[_ngcontent-%COMP%]{display:none}"]}),e}(),p=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275mod=n.Ob({type:e,bootstrap:function(){return[g]}}),e.\u0275inj=n.Nb({factory:function(t){return new(t||e)},providers:[],imports:[[s.c]]}),e}()},mCIM:function(e,t,i){"use strict";i.r(t);var n,r=i("ofXK"),s=i("3Pt+"),a=i("xJkR"),o=i("dlKe"),c=i("gfTr"),l=i("5cNS"),u=i("PCNd"),d=i("tyNb"),b=function(e){return e.INBOX="inbox",e.OUTBOX="outbox",e.DRAFTS="drafts",e}({}),h=function(e){return e.ON_SIGN="ON_SIGN",e.SENT="SENT",e}({}),g=function(e){return e.CERTIFICATE="CERTIFICATE",e.APPLICATION="APPLICATION",e}({}),p=[{id:"919fbae5-ca24-4b3a-9323-a5b0c96a4512",displayName:"\u041f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0435 \u043f\u0438\u0441\u044c\u043c\u043e",description:"\u041f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0435 \u043f\u0438\u0441\u044c\u043c\u043e",type:"APPLICATION"},{id:"d61a02d0-50ea-4867-9c3b-ec318cb569ac",displayName:"\u041e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0435 \u043f\u043e \u0432\u0430\u043b\u044e\u0442\u043d\u044b\u043c \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430\u043c",description:"\u041e\u0431\u0440\u0430\u0449\u0435\u043d\u0438\u0435 \u043f\u043e \u0432\u043e\u043f\u0440\u043e\u0441\u0443 \u0432\u0430\u043b\u044e\u0442\u043d\u043e\u0433\u043e \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430",type:"APPLICATION"},{id:"fba22715-756c-41d7-b100-e29f80ab0ea9",displayName:"\u041d\u0430 \u0432\u044b\u0434\u0430\u0447\u0443 \u043d\u0430\u043b\u0438\u0447\u043d\u044b\u0445 \u0434\u0435\u043d\u0435\u0433",description:"\u0417\u0430\u044f\u0432\u043a\u0430 \u043d\u0430 \u0432\u044b\u0434\u0430\u0447\u0443 \u043d\u0430\u043b\u0438\u0447\u043d\u044b\u0445 \u0434\u0435\u043d\u0435\u0433 \u0432 \u043e\u0442\u0434\u0435\u043b\u0435\u043d\u0438\u0438",type:"APPLICATION"},{id:"fa1be069-e728-4a2f-950f-ec4893dc42ac",displayName:"\u041d\u0430 \u0447\u0430\u0441\u0442\u0438\u0447\u043d\u043e\u0435 \u0438\u0437\u044a\u044f\u0442\u0438\u0435 \u0441 \u0434\u0435\u043f\u043e\u0437\u0438\u0442\u0430",description:"\u0417\u0430\u044f\u0432\u043a\u0430 \u043d\u0430 \u0447\u0430\u0441\u0442\u0438\u0447\u043d\u043e\u0435 \u0438\u0437\u044a\u044f\u0442\u0438\u0435 \u0441 \u0434\u0435\u043f\u043e\u0437\u0438\u0442\u0430",type:"APPLICATION"},{id:"d6d2fb09-6d94-4be1-b75c-f4f3dbfd0d75",displayName:"\u0421\u043c\u0435\u043d\u0430 \u0440\u0443\u043a\u043e\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f, \u0430\u0434\u0440\u0435\u0441\u0430, \u0443\u0447\u0440\u0435\u0434\u0438\u0442\u0435\u043b\u0435\u0439 \u0438 \u0442.\u0434",description:"\u0417\u0430\u044f\u0432\u043a\u0430 \u043d\u0430 \u0441\u043c\u0435\u043d\u0443 \u0440\u0443\u043a\u043e\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f, \u0430\u0434\u0440\u0435\u0441\u0430, \u0443\u0447\u0440\u0435\u0434\u0438\u0442\u0435\u043b\u0435\u0439 \u0438 \u0442.\u0434. \u0441 \u0432\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c \u0443\u0447\u0440\u0435\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 (\u043f\u0440\u0438\u043a\u0430\u0437\u044b, \u0440\u0435\u0448\u0435\u043d\u0438\u044f, \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b\u0430)",type:"APPLICATION"},{id:"4a7c08ee-f640-4feb-a012-15f99084f8a1",displayName:"\u041d\u0430 \u0437\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0435 \u0432\u0430\u043b\u044e\u0442\u044b \u043d\u0430 \u0441\u0447\u0435\u0442",description:"\u0417\u0430\u044f\u0432\u043b\u0435\u043d\u0438\u0435 \u043e \u0437\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u0438 \u0432\u0430\u043b\u044e\u0442\u044b \u043d\u0430 \u0441\u0447\u0435\u0442",type:"APPLICATION"},{id:"07e410d5-3283-4f8c-902c-6c86e2436677",displayName:"\u041e \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u0441\u0447\u0435\u0442\u0430",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u0441\u0447\u0435\u0442\u0430",type:"CERTIFICATE"},{id:"8295913a-b8ba-472f-af7c-8e12195b8ddf",displayName:"\u041e\u0431 \u043e\u0441\u0442\u0430\u0442\u043a\u0430\u0445 \u043d\u0430 \u0441\u0447\u0435\u0442\u0435",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e\u0431 \u043e\u0441\u0442\u0430\u0442\u043a\u0430\u0445 \u043d\u0430 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u043c \u0441\u0447\u0435\u0442\u0435",type:"CERTIFICATE"},{id:"a66d0329-8956-4bce-89ee-bdc9e3571349",displayName:"\u041e\u0431 \u043e\u0431\u043e\u0440\u043e\u0442\u0430\u0445 \u043d\u0430 \u0441\u0447\u0435\u0442\u0435",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e\u0431 \u043e\u0431\u043e\u0440\u043e\u0442\u0430\u0445 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u0441\u0447\u0435\u0442\u0430",type:"CERTIFICATE"},{id:"affb46a1-2012-47d2-9222-96b12603771c",displayName:"\u041e \u0440\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u0430\u0445 \u0441\u0447\u0435\u0442\u0430",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e \u0440\u0435\u043a\u0432\u0438\u0437\u0438\u0442\u0430\u0445 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u0441\u0447\u0435\u0442\u0430",type:"CERTIFICATE"},{id:"48e07781-bc49-4e04-b24c-3136366b913f",displayName:"\u0414\u043b\u044f \u0430\u0443\u0434\u0438\u0442\u043e\u0440\u0441\u043a\u0438\u0445 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0439",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u043b\u044f \u0430\u0443\u0434\u0438\u0442\u043e\u0440\u0441\u043a\u0438\u0445 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0439",type:"CERTIFICATE"},{id:"903dabe2-5b6a-405a-93ab-5df77f8c1b7f",displayName:"\u0414\u043b\u044f \u0443\u0447\u0430\u0441\u0442\u0438\u044f \u0432 \u0442\u0435\u043d\u0434\u0435\u0440\u0435",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u0434\u043b\u044f \u0443\u0447\u0430\u0441\u0442\u0438\u044f \u0432 \u0442\u0435\u043d\u0434\u0435\u0440\u0435",type:"CERTIFICATE"},{id:"34ce1113-6f15-4f64-92af-fc97db0599be",displayName:"\u041e\u0431 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0438 \u043f\u0440\u043e\u0441\u0440\u043e\u0447\u0435\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u043e\u043b\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e\u0431 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0438\u0438 \u043f\u0440\u043e\u0441\u0440\u043e\u0447\u0435\u043d\u043d\u043e\u0439 \u0437\u0430\u0434\u043e\u043b\u0436\u0435\u043d\u043d\u043e\u0441\u0442\u0438",type:"CERTIFICATE"},{id:"e4da4358-f6fe-42dc-8099-07026932f2cf",displayName:"\u041e \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0445 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u0439 3-\u0438\u0445 \u043b\u0438\u0446",description:"\u0421\u043f\u0440\u0430\u0432\u043a\u0430 \u043e \u043d\u0430\u043b\u0438\u0447\u0438\u0438 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0445 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u0439 3-\u0438\u0445 \u043b\u0438\u0446 (\u0415\u041a\u041e)",type:"CERTIFICATE"}],f=i("R0Ic"),v=i("fXoL"),m=i("mrSG"),S=i("tk/3"),y=i("2Vo4"),T=i("Wgwc"),_=i.n(T),O=i("kAiJ"),k=i("VnnJ"),w=i("ZF+8"),E=i("yZrb"),C=i("FhWM"),x=((n=function(){function e(t,i,n,r,s){_classCallCheck(this,e),this.companyService=t,this.filesService=i,this.apiService=n,this.listService=r,this.locale=s,this.files=[],this.lastLettersListPath$=new y.a("outbox"),this.retrieveTopics()}return _createClass(e,[{key:"clearFiles",value:function(){this.files=[],this.filesService.uploading$.next([])}},{key:"onFileDrop",value:function(e){var t=[],i=!0,n=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var o=s.value;t.push(o)}}catch(c){n=!0,r=c}finally{try{i||null==a.return||a.return()}finally{if(n)throw r}}t.length>0&&(this.files=[].concat(t),this.filesService.uploading$.next(this.files))}},{key:"mapLetterDate",value:function(e){var t=e.created,i=_()().isSame(t,"day"),n=_()().subtract(1,"date").isSame(t,"day"),s=_()(t).format("HH:mm");if(i)return{key:"LETTERS.DATE.TODAY",params:{time:s}};if(n)return{key:"LETTERS.DATE.YESTERDAY",params:{time:s}};var a=_()().isSame(t,"year")?"d MMMM HH:mm":"d MMMM yyyy HH:mm";return Object(r.K)(t,a,this.locale)}},{key:"getById",value:function(e){var t=this.mapUrl("/".concat(e));return this.apiService.get(t)}},{key:"getLetterSignatures",value:function(e){var t=this.mapUrl("/".concat(e,"/signatures"));return this.apiService.get(t)}},{key:"sign",value:function(e){return this.listService.sign("letters",e)}},{key:"getList",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n,r,s,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r in i=this.mapUrl(),n=new S.h,e)Object.prototype.hasOwnProperty.call(e,r)&&(s=e[r])&&("dateFrom"!=r&&"dateTo"!=r||(s=Object(O.b)(s)),n=n.append(r,s));return t.next=5,this.apiService.get(i,null,n,{observe:"response"});case 5:return a=t.sent,t.abrupt("return",{items:a.body,totalCount:+a.headers.get("X-Total-Count")});case 7:case"end":return t.stop()}}),t,this)})))}},{key:"retrieveTopics",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.mapUrl("/topics"),e.prev=1,e.next=4,this.apiService.get(t);case 4:i=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),i=p;case 10:return e.abrupt("return",(this.cashedTopics=i,this.cashedTopics));case 11:case"end":return e.stop()}}),e,this,[[1,7]])})))}},{key:"getTopics",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.cashedTopics){t.next=4;break}t.t0=this.filterTopicsByType(e),t.next=8;break;case 4:return t.next=6,this.retrieveTopics();case 6:this.cashedTopics=t.sent,t.t0=this.filterTopicsByType(e);case 8:return t.abrupt("return",t.t0);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"getTopicValues",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cashedTopics){e.next=4;break}e.t0=this.mapTopicValues(),e.next=8;break;case 4:return e.next=6,this.retrieveTopics();case 6:this.cashedTopics=e.sent,e.t0=this.mapTopicValues();case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"edit",value:function(e){var t=this.mapUrl("/".concat(e.id));return this.apiService.put(t,e)}},{key:"create",value:function(e){var t=this.mapUrl();return this.apiService.post(t,e)}},{key:"sendToSign",value:function(e){var t=Array.isArray(e),i=this.mapUrl(t?":on-sign":"/".concat(e,":on-sign"));return this.apiService.patch(i,t?{itemIds:e}:null)}},{key:"filterTopicsByType",value:function(e){return this.cashedTopics.filter((function(t){return t.type===e}))}},{key:"mapTopicValues",value:function(){return this.cashedTopics.map((function(e){return e.displayName}))}},{key:"mapUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"companies/".concat(this.companyService.currentId,"/letters").concat(e)}}]),e}()).\u0275fac=function(e){return new(e||n)(v.ec(k.a),v.ec(w.b),v.ec(E.a),v.ec(C.a),v.ec(v.u))},n.\u0275prov=v.Mb({token:n,factory:n.\u0275fac,providedIn:"root"}),n),A=i("e8Ap"),F=i("fK/r"),I=i("PGAL"),L=i("Kcpt"),R=i("Hjq/"),D=i("sYmb");function j(e,t){if(1&e&&(v.Ub(0),v.Qc(1),v.Tb()),2&e){var i=v.lc(2);v.Ab(1),v.Sc(" ",i.dateText," ")}}function P(e,t){if(1&e&&(v.Ub(0),v.Qc(1),v.mc(2,"translate"),v.Tb()),2&e){var i=v.lc(2);v.Ab(1),v.Sc(" ",v.oc(2,1,i.date.key,i.date.params)," ")}}function N(e,t){if(1&e&&(v.Wb(0,"div",10),v.Oc(1,j,2,1,"ng-container",11),v.Oc(2,P,3,4,"ng-container",11),v.Vb()),2&e){var i=v.lc();v.Ab(1),v.rc("ngIf",i.dateText),v.Ab(1),v.rc("ngIf",i.date)}}function V(e,t){if(1&e){var i=v.Xb();v.Wb(0,"button",14),v.ic("click",(function(e){v.Fc(i);var n=t.$implicit;return v.lc(3).onFileClick(n)})),v.Rb(1,"span",15),v.Wb(2,"div",16),v.Qc(3),v.Vb(),v.Vb()}if(2&e){var n=t.$implicit;v.Ab(3),v.Sc(" ",null==n?null:n.name," ")}}function W(e,t){if(1&e&&(v.Ub(0),v.Oc(1,V,4,1,"button",13),v.Tb()),2&e){var i=v.lc(2);v.Ab(1),v.rc("ngForOf",i.letter.files)}}var M=function(){return{height:"32px","background-color":"#ECEEF1"}};function Q(e,t){1&e&&v.Rb(0,"ngx-skeleton-loader",17),2&e&&v.rc("theme",v.vc(1,M))}function B(e,t){if(1&e&&(v.Oc(0,W,2,1,"ng-container",11),v.Oc(1,Q,1,2,"ngx-skeleton-loader",12)),2&e){var i=v.lc();v.rc("ngIf",!i.isFilesLoading),v.Ab(1),v.rc("ngIf",i.isFilesLoading)}}function G(e,t){if(1&e){var i=v.Xb();v.Wb(0,"div",19),v.Wb(1,"button",20),v.ic("click",(function(e){return v.Fc(i),v.lc(2).onReply()})),v.Qc(2),v.mc(3,"translate"),v.Vb(),v.Vb()}if(2&e){var n=v.lc(2);v.Ab(2),v.Sc(" ",v.nc(3,1,n.mapTranslate("REPLY"))," ")}}function U(e,t){if(1&e&&v.Oc(0,G,4,3,"div",18),2&e){var i=v.lc();v.rc("ngIf",i.letter.incoming)}}function X(e,t){if(1&e&&(v.Wb(0,"div",27),v.Wb(1,"div",28),v.Qc(2),v.Vb(),v.Wb(3,"div",29),v.Qc(4),v.Vb(),v.Vb()),2&e){var i=t.$implicit;v.Ab(2),v.Rc(i.name),v.Ab(1),v.Db(i.classList),v.Ab(1),v.Rc(i.label)}}function z(e,t){if(1&e&&(v.Wb(0,"section",4),v.Wb(1,"j-collapsible"),v.Wb(2,"j-collapsible-trigger"),v.Wb(3,"div",22),v.Wb(4,"h5",23),v.Qc(5),v.mc(6,"translate"),v.Vb(),v.Rb(7,"j-icon",24),v.Vb(),v.Vb(),v.Wb(8,"j-collapsible-body"),v.Wb(9,"div",25),v.Oc(10,X,5,4,"div",26),v.Vb(),v.Vb(),v.Vb(),v.Vb()),2&e){var i=v.lc(2);v.Ab(5),v.Sc(" ",v.nc(6,3,i.mapTranslate("SIGNERS"))," "),v.Ab(2),v.rc("isStroke",!0),v.Ab(3),v.rc("ngForOf",i.signers)}}function H(e,t){if(1&e&&v.Oc(0,z,11,5,"section",21),2&e){var i=v.lc();v.rc("ngIf",(null==i.signers?null:i.signers.length)>0)}}var $,Y=(($=function(){function e(t,i,n,r){_classCallCheck(this,e),this.router=t,this.lettersService=i,this.filesService=n,this.companyService=r,this.closed=new v.n,this.isFilesLoading=!0}return _createClass(e,[{key:"ngOnInit",value:function(){this.mapDateText(),this.loadAttachments()}},{key:"onClose",value:function(){this.closed.emit()}},{key:"onFileClick",value:function(e){this.filesService.downloadFileById(e.id,e.name)}},{key:"onReply",value:function(){this.router.navigate(["/letters/create"],{state:{title:"\u041f\u0440\u043e\u0438\u0437\u0432\u043e\u043b\u044c\u043d\u043e\u0435 \u043f\u0438\u0441\u044c\u043c\u043e"}})}},{key:"mapTranslate",value:function(e){return"LETTERS.DETAILS.".concat(e)}},{key:"loadAttachments",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isFilesLoading=!0,e.prev=1,e.next=4,this.lettersService.getById(this.letter.id);case 4:t=e.sent,this.letter=Object.assign(Object.assign({},this.letter),t),this.loadSignatures(),e.next=10;break;case 8:e.prev=8,e.t0=e.catch(1);case 10:return e.prev=10,this.isFilesLoading=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,this,[[1,8,10,13]])})))}},{key:"loadSignatures",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.letter.incoming||(this.signers=this.companyService.generateSignersList(this.letter.statusCode,this.letter.signatureScheme,this.letter.signatures));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"mapDateText",value:function(){var e=this.lettersService.mapLetterDate(this.letter);"string"==typeof e?this.dateText=e:this.date=e}}]),e}()).\u0275fac=function(e){return new(e||$)(v.Qb(d.c),v.Qb(x),v.Qb(w.b),v.Qb(k.a))},$.\u0275cmp=v.Kb({type:$,selectors:[["j-letters-details-content"]],inputs:{letter:"letter"},outputs:{closed:"closed"},decls:20,vars:6,consts:[[1,"letter-details"],[1,"letter-details__header"],[3,"ngTemplateOutlet"],["inlineSVG","/assets/icons/letters/close.svg",1,"letter-details__close",3,"click"],[1,"letter-details__body"],[1,"p2"],["dateTemplate",""],["filesTemplate",""],["actionsTemplate",""],["signersTemplate",""],[1,"text-muted","p3"],[4,"ngIf"],["count","5",3,"theme",4,"ngIf"],["class","letter-details__file",3,"click",4,"ngFor","ngForOf"],[1,"letter-details__file",3,"click"],["inlineSVG","/assets/icons/contracts/file.svg",1,"mr-3"],[1,"text-truncate","p2"],["count","5",3,"theme"],["class","letter-details__actions",4,"ngIf"],[1,"letter-details__actions"],[1,"btn","btn-primary","btn-block",3,"click"],["class","letter-details__body",4,"ngIf"],[1,"letter-details__collapse"],[1,"m-0"],["name","arrowUp",1,"ml-auto","details__arrow",3,"isStroke"],[1,"letter-details__signers","p2"],["class","j-desc-row letter-details__signer",4,"ngFor","ngForOf"],[1,"j-desc-row","letter-details__signer"],[1,"text-dark","j-desc-child"],["translate","",1,"text-muted","j-desc-child"]],template:function(e,t){if(1&e&&(v.Wb(0,"div",0),v.Wb(1,"div",1),v.Sb(2,2),v.Wb(3,"button",3),v.ic("click",(function(e){return t.onClose()})),v.Vb(),v.Vb(),v.Wb(4,"article",4),v.Wb(5,"h6"),v.Qc(6),v.Vb(),v.Wb(7,"p",5),v.Qc(8),v.Vb(),v.Sb(9,2),v.Sb(10,2),v.Vb(),v.Sb(11,2),v.Vb(),v.Oc(12,N,3,2,"ng-template",null,6,v.Pc),v.Oc(14,B,2,2,"ng-template",null,7,v.Pc),v.Oc(16,U,1,1,"ng-template",null,8,v.Pc),v.Oc(18,H,1,1,"ng-template",null,9,v.Pc)),2&e){var i=v.Cc(13),n=v.Cc(15),r=v.Cc(17),s=v.Cc(19);v.Ab(2),v.rc("ngTemplateOutlet",i),v.Ab(4),v.Rc(t.letter.title),v.Ab(2),v.Rc(t.letter.body),v.Ab(1),v.rc("ngTemplateOutlet",n),v.Ab(1),v.rc("ngTemplateOutlet",r),v.Ab(1),v.rc("ngTemplateOutlet",s)}},directives:[r.B,A.a,r.u,r.t,a.a,F.a,I.a,L.a,R.a,D.a],pipes:[D.d],styles:[".letter-details__header[_ngcontent-%COMP%]{display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between}.letter-details__close[_ngcontent-%COMP%]{display:inline-block;font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;color:#666c72;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.letter-details__close[_ngcontent-%COMP%]:hover{color:#ef5630}.letter-details__body[_ngcontent-%COMP%]{margin-top:1.5rem;background:#fff;overflow:hidden;padding:1.5rem 1rem;border-radius:12px}.letter-details__file[_ngcontent-%COMP%]{display:inline-block;font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;width:100%;padding:0;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out;color:#1586bb}.letter-details__file[_ngcontent-%COMP%]:hover{color:#ef5630}.letter-details__file[_ngcontent-%COMP%] + .letter-details__file[_ngcontent-%COMP%]{margin-top:1.5rem}.letter-details__actions[_ngcontent-%COMP%]{margin-top:2.5rem}.letter-details__trigger[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.letter-details__signers[_ngcontent-%COMP%]{padding-top:1rem}.letter-details__collapse[_ngcontent-%COMP%]{-webkit-box-align:center;align-items:center;cursor:pointer;display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between}.letter-details__signer[_ngcontent-%COMP%]{grid-template-columns:1fr 100px}"]}),$);function K(e,t){if(1&e){var i=v.Xb();v.Wb(0,"button",3),v.ic("click",(function(e){v.Fc(i);var n=t.$implicit;return v.lc(2).onLinkSelect(n)})),v.Wb(1,"span"),v.Qc(2),v.Vb(),v.Rb(3,"span",4),v.Vb()}if(2&e){var n=t.$implicit;v.Ab(2),v.Rc(n.displayName)}}function Z(e,t){if(1&e&&(v.Ub(0),v.Wb(1,"div",1),v.Wb(2,"h6"),v.Qc(3),v.mc(4,"translate"),v.Vb(),v.Oc(5,K,4,1,"button",2),v.Vb(),v.Tb()),2&e){var i=v.lc();v.Ab(3),v.Rc(v.nc(4,2,i.mapTranslate(i.topicType))),v.Ab(2),v.rc("ngForOf",i.topics)}}var J=function(){return{height:"450px","background-color":"#ECEEF1"}};function q(e,t){1&e&&(v.Ub(0),v.Rb(1,"ngx-skeleton-loader",5),v.Tb()),2&e&&(v.Ab(1),v.rc("theme",v.vc(1,J)))}var ee,te,ie=((te=function(){function e(t,i){_classCallCheck(this,e),this.lettersService=t,this.router=i,this.isLoading=!0}return _createClass(e,[{key:"ngOnInit",value:function(){this.loadTopics()}},{key:"mapTranslate",value:function(e){return"LETTERS.CREATE_CONTENT.".concat(e)}},{key:"onLinkSelect",value:function(e){this.router.navigate(["/letters/create"],{state:{title:e.displayName}})}},{key:"loadTopics",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.lettersService.getTopics(this.topicType);case 3:this.topics=e.sent,e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:return e.prev=8,this.isLoading=!1,e.finish(8);case 11:case"end":return e.stop()}}),e,this,[[0,6,8,11]])})))}}]),e}()).\u0275fac=function(e){return new(e||te)(v.Qb(x),v.Qb(d.c))},te.\u0275cmp=v.Kb({type:te,selectors:[["j-letters-create-group"]],inputs:{topicType:"topicType"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"letters-create-group"],["class","letters-create-group__button p2",3,"click",4,"ngFor","ngForOf"],[1,"letters-create-group__button","p2",3,"click"],["inlineSVG","/assets/icons/letters/next.svg",1,"d-inline-block","ml-3"],[3,"theme"]],template:function(e,t){1&e&&(v.Oc(0,Z,6,4,"ng-container",0),v.Oc(1,q,2,2,"ng-container",0)),2&e&&(v.rc("ngIf",!t.isLoading),v.Ab(1),v.rc("ngIf",t.isLoading))},directives:[r.u,r.t,A.a,a.a],pipes:[D.d],styles:["[_nghost-%COMP%]{display:block}.letters-create-group[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;padding:1.25rem 1rem}.letters-create-group[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-bottom:1rem}.letters-create-group__button[_ngcontent-%COMP%]{display:inline-block;font-weight:400;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;display:-webkit-box;display:flex;padding:0;text-align:left;width:100%;-webkit-box-align:baseline;align-items:baseline;-webkit-box-pack:justify;justify-content:space-between;color:#1a1c1f;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.letters-create-group__button[_ngcontent-%COMP%]:hover{color:#ef5630}.letters-create-group__button[_ngcontent-%COMP%] + .letters-create-group__button[_ngcontent-%COMP%]{margin-top:1rem}"]}),te),ne=((ee=function(){function e(){_classCallCheck(this,e),this.closed=new v.n,this.LETTER_TOPIC_TYPE=g}return _createClass(e,[{key:"mapTranslate",value:function(e){return"LETTERS.CREATE_CONTENT.".concat(e)}},{key:"onClose",value:function(){this.closed.emit()}}]),e}()).\u0275fac=function(e){return new(e||ee)},ee.\u0275cmp=v.Kb({type:ee,selectors:[["j-letters-create-content"]],outputs:{closed:"closed"},decls:9,vars:5,consts:[[1,"letters-create-content"],[1,"letters-create-content__header"],[1,"m-0"],["inlineSVG","/assets/icons/letters/close.svg",1,"letters-create-content__close",3,"click"],[1,"letters-create-content__body"],[3,"topicType"],[1,"mt-3",3,"topicType"]],template:function(e,t){1&e&&(v.Wb(0,"div",0),v.Wb(1,"div",1),v.Wb(2,"h5",2),v.Qc(3),v.mc(4,"translate"),v.Vb(),v.Wb(5,"button",3),v.ic("click",(function(e){return t.onClose()})),v.Vb(),v.Vb(),v.Wb(6,"div",4),v.Rb(7,"j-letters-create-group",5),v.Rb(8,"j-letters-create-group",6),v.Vb(),v.Vb()),2&e&&(v.Ab(3),v.Rc(v.nc(4,3,t.mapTranslate("TITLE"))),v.Ab(4),v.rc("topicType",t.LETTER_TOPIC_TYPE.CERTIFICATE),v.Ab(1),v.rc("topicType",t.LETTER_TOPIC_TYPE.APPLICATION))},directives:[A.a,ie],pipes:[D.d],styles:["[_nghost-%COMP%]{margin:-1rem;display:block}.letters-create-content__close[_ngcontent-%COMP%]{display:inline-block;font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;color:#666c72;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.letters-create-content__close[_ngcontent-%COMP%]:hover{color:#ef5630}.letters-create-content__header[_ngcontent-%COMP%]{background-color:#fff;padding:1.5rem;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:justify;justify-content:space-between}.letters-create-content__body[_ngcontent-%COMP%]{padding:1.5rem}"]}),ee);function re(e,t){if(1&e){var i=v.Xb();v.Wb(0,"j-letters-details-content",5),v.ic("closed",(function(e){return v.Fc(i),v.lc().hideAside()})),v.Vb()}if(2&e){var n=v.lc();v.rc("letter",n.letter)}}function se(e,t){if(1&e){var i=v.Xb();v.Wb(0,"j-letters-create-content",6),v.ic("closed",(function(e){return v.Fc(i),v.lc().hideAside()})),v.Vb()}}var ae,oe=((ae=function(){function e(t){_classCallCheck(this,e),this.document=t,this.isContentShown=!1,this.isDetailsShowing=!1,this.isCreateShowing=!1,this.closed=new v.n}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.document.body.classList.remove("overflow-hidden")}},{key:"showDetails",value:function(e){this.isDetailsShowing=!0,this.isCreateShowing=!1,this.letter=e,this.showContent()}},{key:"showCreate",value:function(){this.isCreateShowing=!0,this.isDetailsShowing=!1,this.showContent()}},{key:"hideAside",value:function(){this.letter=null,this.isCreateShowing=!1,this.isDetailsShowing=!1,this.document.body.classList.remove("overflow-hidden"),this.isContentShown=!1,this.closed.emit()}},{key:"showContent",value:function(){this.document.body.classList.add("overflow-hidden"),this.isContentShown=!0}}]),e}()).\u0275fac=function(e){return new(e||ae)(v.Qb(r.e))},ae.\u0275cmp=v.Kb({type:ae,selectors:[["j-letters-aside"]],outputs:{closed:"closed"},decls:5,vars:4,consts:[[1,"f-page-wrapper","is-shown"],[1,"f-page-backdrop",3,"click"],[1,"f-page-content","f-page-content--gray","f-page-content--quarter","is-shown","letters-aside"],[3,"letter","closed",4,"ngIf"],[3,"closed",4,"ngIf"],[3,"letter","closed"],[3,"closed"]],template:function(e,t){1&e&&(v.Wb(0,"section",0),v.Wb(1,"div",1),v.ic("click",(function(e){return t.hideAside()})),v.Vb(),v.Wb(2,"section",2),v.Oc(3,re,1,1,"j-letters-details-content",3),v.Oc(4,se,1,0,"j-letters-create-content",4),v.Vb(),v.Vb()),2&e&&(v.rc("@wrapper",t.isContentShown?"shown":"hidden"),v.Ab(2),v.rc("@content",t.isContentShown?"shown":"hidden"),v.Ab(1),v.rc("ngIf",t.isDetailsShowing),v.Ab(1),v.rc("ngIf",t.isCreateShowing))},directives:[r.u,Y,ne],styles:[".letters-aside[_ngcontent-%COMP%]{padding:1rem;top:62px}@media(min-width:960px){.letters-aside[_ngcontent-%COMP%]{top:98px}}@media(min-width:1280px){.letters-aside[_ngcontent-%COMP%]{top:0}}"],data:{animation:[Object(f.n)("wrapper",[Object(f.k)("shown",Object(f.l)({transform:"scale(1)",visibility:"visible",opacity:"1"})),Object(f.k)("hidden",Object(f.l)({transform:"scale(0.9)",visibility:"hidden",opacity:"0"})),Object(f.m)("shown<=>hidden",Object(f.e)("250ms"))]),Object(f.n)("content",[Object(f.k)("shown",Object(f.l)({right:"0%"})),Object(f.k)("hidden",Object(f.l)({right:"-25%"})),Object(f.m)("shown<=>hidden",Object(f.e)("500ms ease-in-out"))])]}}),ae),ce=i("quSY"),le=i("570E"),ue=i("S1F0"),de=i("oKsb"),be=i("fvpk"),he=i("itXk"),ge=i("lJxs"),pe=i("TwVa"),fe=i("VO+5"),ve=i("h7tf"),me=i("9odQ"),Se=i("LFY/"),ye=i("M6pS");function Te(e,t){if(1&e&&(v.Ub(0),v.Wb(1,"form",5),v.Sb(2,6),v.Sb(3,6),v.Sb(4,6),v.Sb(5,6),v.Vb(),v.Tb()),2&e){var i=v.lc(),n=v.Cc(3),r=v.Cc(5),s=v.Cc(7),a=v.Cc(9);v.Ab(1),v.rc("formGroup",i.form),v.Ab(1),v.rc("ngTemplateOutlet",n),v.Ab(1),v.rc("ngTemplateOutlet",r),v.Ab(1),v.rc("ngTemplateOutlet",s),v.Ab(1),v.rc("ngTemplateOutlet",a)}}var _e=function(){return{height:"56px","background-color":"#ECEEF1"}},Oe=function(){return{height:"335px","background-color":"#ECEEF1"}},ke=function(){return{"margin-bottom":"50px",width:"50%",height:"32px","background-color":"#ECEEF1"}};function we(e,t){if(1&e&&(v.Wb(0,"div"),v.Rb(1,"ngx-skeleton-loader",7),v.Rb(2,"ngx-skeleton-loader",7),v.Rb(3,"ngx-skeleton-loader",7),v.Sb(4,6),v.Wb(5,"div",8),v.Rb(6,"ngx-skeleton-loader",7),v.Vb(),v.Vb()),2&e){v.lc();var i=v.Cc(7);v.Ab(1),v.rc("theme",v.vc(5,_e)),v.Ab(1),v.rc("theme",v.vc(6,Oe)),v.Ab(1),v.rc("theme",v.vc(7,ke)),v.Ab(1),v.rc("ngTemplateOutlet",i),v.Ab(2),v.rc("theme",v.vc(8,_e))}}function Ee(e,t){if(1&e&&(v.Wb(0,"span",14),v.Qc(1),v.Vb()),2&e){var i=t.$implicit;v.Ab(1),v.Sc(" ",i," ")}}function Ce(e,t){if(1&e){var i=v.Xb();v.Wb(0,"div",9),v.Wb(1,"j-dropdown-input",10,11),v.ic("selected",(function(e){return v.Fc(i),v.lc().onTitleSelect(e)})),v.Oc(3,Ee,2,1,"ng-template",null,12,v.Pc),v.Vb(),v.Vb(),v.Wb(5,"div",9),v.Rb(6,"j-input",13),v.mc(7,"async"),v.Vb()}if(2&e){var n=v.lc();v.Ab(1),v.rc("options",n.topics)("hasError",n.f.title.invalid&&n.isSubmitted)("selectedItem",n.f.title.value)("label",n.mapTranslate("TITLE")),v.Ab(5),v.rc("label",n.mapTranslate("BODY"))("inputExtra",v.nc(7,11,n.bodyLengthMessage$))("formControl",n.f.body)("hasError",n.f.body.invalid&&n.isSubmitted)("errorText",n.mapBodyErrors())("maxLength",n.bodyMaxLength)("isClearable",!1)}}function xe(e,t){if(1&e&&(v.Wb(0,"div",23),v.Qc(1),v.mc(2,"translate"),v.Vb()),2&e){var i=v.lc(2);v.Ab(1),v.Sc(" ",v.nc(2,1,i.mapTranslate("MAX_FILES_REACHED"))," ")}}var Ae=function(e){return{acceptedFormats:e}};function Fe(e,t){if(1&e){var i=v.Xb();v.Wb(0,"div",15),v.Wb(1,"div",16),v.Wb(2,"input",17),v.ic("change",(function(e){return v.Fc(i),v.lc().onAddFile(e)})),v.Vb(),v.Wb(3,"label",18),v.Rb(4,"span",19),v.Wb(5,"span"),v.Qc(6),v.mc(7,"translate"),v.Vb(),v.Vb(),v.Wb(8,"span",20),v.Qc(9),v.mc(10,"translate"),v.Vb(),v.Vb(),v.Wb(11,"j-uploading-files",21),v.ic("updated",(function(e){return v.Fc(i),v.lc().onUploadingFilesUpdate(e)})),v.Vb(),v.Oc(12,xe,3,3,"div",22),v.Vb()}if(2&e){var n=v.lc();v.Ab(2),v.rc("formControl",n.f.uploadModel)("accept",n.acceptedFormats),v.Ab(4),v.Sc(" ",v.nc(7,9,n.mapTranslate("ADD_FILE"))," "),v.Ab(3),v.Sc(" ",v.oc(10,11,n.mapTranslate("ADD_FILE_DESCRIPTION"),v.wc(14,Ae,n.acceptedFormats))," "),v.Ab(2),v.rc("isLoading",n.isLoading)("acceptedFormats",n.acceptedFormats)("uploadingFiles",n.uploadingFiles)("maxSize",n.maxSize),v.Ab(1),v.rc("ngIf",(null==n.uploadingFiles?null:n.uploadingFiles.length)>10)}}function Ie(e,t){if(1&e&&(v.Wb(0,"div",24),v.Rb(1,"span",25),v.Wb(2,"span"),v.Qc(3),v.mc(4,"translate"),v.Vb(),v.Vb()),2&e){var i=v.lc();v.Ab(3),v.Sc(" ",v.nc(4,1,i.mapTranslate("INFO"))," ")}}function Le(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"button",27),v.ic("click",(function(e){return v.Fc(i),v.lc(2).edit()})),v.Qc(2),v.mc(3,"translate"),v.Vb(),v.Tb()}if(2&e){var n=v.lc(2);v.Ab(1),v.rc("jLoadingInverted",!0)("disabled",n.isSubmitting||(null==n.uploadingFiles?null:n.uploadingFiles.length)>10)("jLoading",n.isSubmitting),v.Ab(1),v.Sc(" ",v.nc(3,4,n.mapTranslate("SAVE_EDITING"))," ")}}function Re(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"button",28),v.ic("click",(function(e){return v.Fc(i),v.lc(2).saveToDraft()})),v.Qc(2),v.mc(3,"translate"),v.Vb(),v.Tb()}if(2&e){var n=v.lc(2);v.Ab(1),v.rc("disabled",n.isSubmitting||(null==n.uploadingFiles?null:n.uploadingFiles.length)>10)("jLoading",n.isSubmitting)("jLoadingInverted",!0),v.Ab(1),v.Sc(" ",v.nc(3,4,n.mapTranslate("SAVE_TO_DRAFT"))," ")}}function De(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"button",29),v.ic("click",(function(e){return v.Fc(i),v.lc(2).createAndSign()})),v.Qc(2),v.mc(3,"translate"),v.Vb(),v.Tb()}if(2&e){var n=v.lc(2);v.Ab(1),v.rc("disabled",n.isSubmitting||(null==n.uploadingFiles?null:n.uploadingFiles.length)>10)("jLoading",n.isSubmitting),v.Ab(1),v.Sc(" ",v.nc(3,3,n.mapTranslate(n.createAndSignLabel))," ")}}function je(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"button",29),v.ic("click",(function(e){return v.Fc(i),v.lc(2).createAndSendForSign()})),v.Qc(2),v.mc(3,"translate"),v.Vb(),v.Tb()}if(2&e){var n=v.lc(2);v.Ab(1),v.rc("disabled",n.isSubmitting||(null==n.uploadingFiles?null:n.uploadingFiles.length)>10)("jLoading",n.isSubmitting),v.Ab(1),v.Sc(" ",v.nc(3,3,n.mapTranslate("CREATE_AND_SEND_FOR_SIGN"))," ")}}function Pe(e,t){if(1&e&&(v.Wb(0,"div",26),v.Oc(1,Le,4,6,"ng-container",0),v.Oc(2,Re,4,6,"ng-container",0),v.Oc(3,De,4,5,"ng-container",0),v.Oc(4,je,4,5,"ng-container",0),v.Vb()),2&e){var i=v.lc();v.Ab(1),v.rc("ngIf",i.isEditing),v.Ab(1),v.rc("ngIf",!i.isEditing),v.Ab(1),v.rc("ngIf",i.canSendAndSign),v.Ab(1),v.rc("ngIf",i.canSendOnly)}}var Ne,Ve,We=function(e){return e.SAVED_TO_DRAFT="NOTIFICATIONS.SAVED_TO_DRAFT",e.SENT_FOR_SIGN="NOTIFICATIONS.SENT_FOR_SIGN",e.SAVED_EDITING="NOTIFICATIONS.SAVED_EDITING",e.SIGNED="NOTIFICATIONS.SIGNED",e.SAVED_TO_DRAFT_ERROR="NOTIFICATIONS.SAVED_TO_DRAFT_ERROR",e.SENT_FOR_SIGN_ERROR="NOTIFICATIONS.SENT_FOR_SIGN_ERROR",e.SAVED_EDITING_ERROR="NOTIFICATIONS.SAVED_EDITING_ERROR",e.SIGNED_ERROR="NOTIFICATIONS.SIGNED_ERROR",e}({}),Me=((Ve=function(){function e(t,i,n,r,s,a,o){var c=this;_classCallCheck(this,e),this.route=t,this.router=i,this.lettersService=n,this.companyService=r,this.filesService=s,this.notifierService=a,this.translateService=o,this.acceptedFormats=".doc, .docx, .pdf, .jpg, .jpeg, .png, .xls, .xlsx",this.maxSize=5e6,this.isSubmitted=!1,this.isLoading=!1,this.isSubmitting=!1,this.isEditing=!1,this.uploadingFiles=[],this.bodyMaxLength=1e3,this.bodyLengthMessage$=new y.a("0/".concat(this.bodyMaxLength)),this.subscription=new ce.a;var l=Object(he.a)([this.route.paramMap.pipe(Object(ge.a)((function(){return window.history.state}))),this.route.params]).subscribe((function(e){var t=_slicedToArray(e,2),i=t[0],n=t[1];i.letter?(c.isEditing=!0,c.loadEditLetterByBody(i.letter,i.topics,i.files)):n.id?(c.isEditing=!0,c.loadEditLetterById(n.id)):c.loadNewLetter(i.title)}));this.subscription.add(l),this.createAndSignLabel=this.companyService.isSecondaryAuthority()?"SIGN":"CREATE_AND_SIGN"}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.lettersService.clearFiles(),this.subscription.unsubscribe()}},{key:"loadEditLetter",value:function(e){var t=this;this.originalLetter=e,setTimeout((function(){var i,n=e.id,r=e.title,s=e.body;t.form.setValue({id:n,title:r,body:s,uploadModel:null}),(null===(i=e.files)||void 0===i?void 0:i.length)>0&&(t.uploadingFiles=e.files.map((function(e){return{isLoading:!1,file:e}})))}),0)}},{key:"loadEditLetterByBody",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.uploadingFiles=i,this.topics=t,this.loadEditLetter(e),this.initForm(e);case 1:case"end":return n.stop()}}),n,this)})))}},{key:"loadEditLetterById",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isLoading=!0,t.prev=1,t.next=4,this.lettersService.getById(e);case 4:return i=t.sent,t.next=7,this.loadTopics();case 7:this.loadEditLetter(i),this.initForm(i),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(1);case 13:return t.prev=13,this.isLoading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[1,11,13,16]])})))}},{key:"loadNewLetter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isLoading=!0,t.prev=1,t.next=4,this.loadTopics();case 4:this.initForm({title:e}),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(1);case 9:return t.prev=9,this.isLoading=!1,t.finish(9);case 12:case"end":return t.stop()}}),t,this,[[1,7,9,12]])})))}},{key:"loadTopics",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.lettersService.getTopicValues();case 2:this.topics=e.sent;case 3:case"end":return e.stop()}}),e,this)})))}},{key:"initForm",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i={id:t.id||null,title:t.title||"",body:t.body||""},n=i.id,r=i.title,a=i.body;this.form=new s.k({id:new s.h(n),title:new s.h(r,s.H.required),body:new s.h(a,[s.H.required,s.H.maxLength(this.bodyMaxLength)]),uploadModel:new s.h("")});var o=this.form.valueChanges.subscribe((function(t){e.isSubmitted=!1})),c=this.f.body.valueChanges.subscribe((function(t){e.bodyLengthMessage$.next("".concat(t.length,"/").concat(e.bodyMaxLength))}));this.subscription.add(c),this.subscription.add(o)}},{key:"prepareCreate",value:function(){return this.isSubmitted=!0,!this.form.invalid&&(this.filesService.hasLoadingFiles(this.uploadingFiles)?(this.notifierService.notify("default",this.translateService.instant("FILES.PLEASE_WAIT")),!1):(this.filesService.hasErroredFiles(this.uploadingFiles)&&this.notifierService.notify("default",this.translateService.instant("FILES.HAS_ERRORED_FILES")),!0))}},{key:"saveToDraft",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isSubmitting){e.next=12;break}return this.isSubmitting=!0,e.prev=2,e.next=5,this.createDraft();case 5:t=e.sent,this.showNotification(We.SAVED_TO_DRAFT),this.router.navigate(["/letters/drafts"],{state:{highlighted:t.id}}),this.isSubmitting=!1,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),this.showNotification(We.SAVED_TO_DRAFT_ERROR,"error"),this.isSubmitting=!1;case 12:case"end":return e.stop()}}),e,this,[[2,9]])})))}},{key:"createAndSendForSign",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isSubmitting||!this.prepareCreate()){e.next=12;break}return this.isSubmitting=!0,e.prev=2,e.next=5,this.lettersService.create(Object.assign(Object.assign({},this.mapLetterBody()),{statusCode:pe.f.ON_SIGN}));case 5:t=e.sent,this.showNotification(We.SENT_FOR_SIGN),this.router.navigate(["/letters/outbox/on-sign"],{state:{highlighted:t.id}}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),this.showNotification(We.SENT_FOR_SIGN_ERROR,"error"),this.isSubmitting=!1;case 12:case"end":return e.stop()}}),e,this,[[2,9]])})))}},{key:"createDraftAndNavigate",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.createDraft();case 3:this.originalLetter=e.sent,this.router.navigate(["edit",this.originalLetter.id],{relativeTo:this.route.parent,state:{letter:this.originalLetter,topics:this.topics,files:this.uploadingFiles}}),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"createAndSign",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isSubmitting||!this.prepareCreate()){e.next=14;break}return this.isSubmitting=!0,e.prev=2,e.next=5,this.createDraftAndNavigate();case 5:return e.next=7,this.lettersService.sign(this.originalLetter.id);case 7:this.showNotification(We.SIGNED),this.companyService.isSecondaryAuthority()?this.router.navigate(["/letters/outbox/on-sign"],{state:{highlighted:this.originalLetter.id}}):this.router.navigate(["/letters/outbox/sent"],{state:{highlighted:this.originalLetter.id}}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),this.showNotification(We.SIGNED_ERROR,"error"),this.isSubmitting=!1;case 14:case"end":return e.stop()}}),e,this,[[2,11]])})))}},{key:"edit",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isSubmitting=!0,e.prev=1,e.next=4,this.lettersService.edit(Object.assign(Object.assign({},this.originalLetter),this.mapLetterBody()));case 4:this.showNotification(We.SAVED_EDITING),this.router.navigate(["/letters/drafts"],{state:{highlighted:this.originalLetter.id}}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.showNotification(We.SAVED_EDITING_ERROR,"error"),this.isSubmitting=!1;case 11:case"end":return e.stop()}}),e,this,[[1,8]])})))}},{key:"createDraft",value:function(){return this.lettersService.create(Object.assign(Object.assign({},this.mapLetterBody()),{statusCode:pe.f.DRAFT}))}},{key:"mapTranslate",value:function(e){return"LETTERS.CREATE.".concat(e)}},{key:"mapBodyErrors",value:function(){return this.f.body.errors?this.f.body.errors.maxlength?"ERRORS.MAX_LENGTH":void 0:null}},{key:"onTitleSelect",value:function(e){this.f.title.setValue(e)}},{key:"onAddFile",value:function(e){var t,i;(null===(i=null===(t=e)||void 0===t?void 0:t.target)||void 0===i?void 0:i.files)&&(this.lettersService.onFileDrop(e.target.files),this.f.uploadModel.setValue(null))}},{key:"onUploadingFilesUpdate",value:function(e){this.uploadingFiles=e}},{key:"showNotification",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",i=this.mapTranslate(e),n=this.translateService.instant(i);this.notifierService.notify(t,n)}},{key:"mapLetterBody",value:function(){return Object.assign(Object.assign({},this.form.getRawValue()),{fileIds:this.uploadingFiles.filter((function(e){var t;return!e.error&&(null===(t=e.file)||void 0===t?void 0:t.id)})).map((function(e){return e.file.id}))})}},{key:"f",get:function(){return this.form.controls}},{key:"canSendAndSign",get:function(){return this.companyService.isSecondaryAuthority()||this.companyService.isPrimaryAuthority()&&this.companyService.isSingleSignScheme()}},{key:"canSendOnly",get:function(){return this.companyService.isNoSignAuthority()||this.companyService.isPrimaryAuthority()&&this.companyService.isMultipleSignScheme()}}]),e}()).\u0275fac=function(e){return new(e||Ve)(v.Qb(d.a),v.Qb(d.c),v.Qb(x),v.Qb(k.a),v.Qb(w.b),v.Qb(fe.c),v.Qb(D.e))},Ve.\u0275cmp=v.Kb({type:Ve,selectors:[["j-letters-create-form"]],decls:10,vars:2,consts:[[4,"ngIf"],["formTemplate",""],["filesTemplate",""],["infoTemplate",""],["submitTemplate",""],[1,"letters-create",3,"formGroup"],[3,"ngTemplateOutlet"],[3,"theme"],[1,"form-footer","form-footer--bordered"],[1,"form-group"],[3,"options","hasError","selectedItem","label","selected"],["titleDropdown",""],["optionTemplate",""],["type","textarea","inputClass","j-input--large-textarea",3,"label","inputExtra","formControl","hasError","errorText","maxLength","isClearable"],[1,"py-2"],[1,"letters-create__files"],[1,"j-input-file"],["id","fileUpload","type","file","multiple","true",3,"formControl","accept","change"],["for","fileUpload",1,"link-blue"],["inlineSVG","/assets/icons/letters/attachment.svg",1,"mr-2"],[1,"text-muted"],[3,"isLoading","acceptedFormats","uploadingFiles","maxSize","updated"],["class","alert alert-danger",4,"ngIf"],[1,"alert","alert-danger"],[1,"form-footer","letters-create__info","form-footer--bordered","text-muted"],["inlineSVG","/assets/icons/letters/info.svg",1,"mr-3"],[1,"form-footer","form-footer--bordered","letter-create__submit"],["type","button",1,"btn","btn-link",3,"jLoadingInverted","disabled","jLoading","click"],["type","button",1,"btn","btn-link",3,"disabled","jLoading","jLoadingInverted","click"],["type","submit",1,"btn","btn-primary",3,"disabled","jLoading","click"]],template:function(e,t){1&e&&(v.Oc(0,Te,6,5,"ng-container",0),v.Oc(1,we,7,9,"div",0),v.Oc(2,Ce,8,13,"ng-template",null,1,v.Pc),v.Oc(4,Fe,13,16,"ng-template",null,2,v.Pc),v.Oc(6,Ie,5,3,"ng-template",null,3,v.Pc),v.Oc(8,Pe,5,4,"ng-template",null,4,v.Pc)),2&e&&(v.rc("ngIf",t.form&&!t.isLoading),v.Ab(1),v.rc("ngIf",t.isLoading))},directives:[r.u,s.J,s.u,s.l,r.B,a.a,ve.a,me.b,s.t,s.i,s.c,A.a,Se.a,ye.a],pipes:[r.b,D.d],styles:[".letter-create__submit[_ngcontent-%COMP%]{-webkit-box-orient:vertical;-webkit-box-direction:reverse;flex-direction:column-reverse}.letter-create__submit[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-top:1rem;margin-left:0}@media(min-width:1280px){.letter-create__submit[_ngcontent-%COMP%]{-webkit-box-orient:horizontal;-webkit-box-direction:normal;flex-direction:row}.letter-create__submit[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%] + .btn[_ngcontent-%COMP%]{margin-top:0;margin-left:1rem}}.letter-create__submit[_ngcontent-%COMP%]   ngx-skeleton-loader[_ngcontent-%COMP%]{width:50%}.letters-create__info[_ngcontent-%COMP%]{-webkit-box-pack:start;justify-content:flex-start;-webkit-box-align:center;align-items:center;padding:1.5rem 0}"]}),Ve),Qe=((Ne=function(){function e(t,i,n){var r=this;_classCallCheck(this,e),this.route=t,this.router=i,this.lettersService=n,this.subscription=new ce.a,this.lettersService.lastLettersListPath$.subscribe((function(e){r.lastLetterListPath=e}))}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this,t=this.route.params.subscribe((function(t){e.title=t.id?"LETTERS.CREATE.EDIT":"LETTERS.CREATE.TITLE"}));this.subscription.add(t)}},{key:"ngOnDestroy",value:function(){this.lettersService.clearFiles(),this.subscription.unsubscribe()}},{key:"onFileDropped",value:function(e){this.lettersService.onFileDrop(e)}},{key:"onClose",value:function(){this.lettersService.clearFiles(),this.router.navigate(["/letters",this.lastLetterListPath])}}]),e}()).\u0275fac=function(e){return new(e||Ne)(v.Qb(d.a),v.Qb(d.c),v.Qb(x))},Ne.\u0275cmp=v.Kb({type:Ne,selectors:[["j-letters-create"]],decls:9,vars:3,consts:[["jDnd","",1,"dnd-wrap",3,"fileDropped"],["closePosition","outside","colsClassList","offset-lg-1 col-lg-10 offset-xl-2 col-xl-8","headerClassList","bg-white",3,"closed"],[1,"account-header"],[1,"f-page-title"]],template:function(e,t){1&e&&(v.Wb(0,"section",0),v.ic("fileDropped",(function(e){return t.onFileDropped(e)})),v.Wb(1,"f-page",1),v.ic("closed",(function(e){return t.onClose()})),v.Wb(2,"f-page-header"),v.Wb(3,"section",2),v.Wb(4,"h1",3),v.Qc(5),v.mc(6,"translate"),v.Vb(),v.Vb(),v.Vb(),v.Wb(7,"f-page-body"),v.Rb(8,"j-letters-create-form"),v.Vb(),v.Vb(),v.Vb()),2&e&&(v.Ab(5),v.Sc("",v.nc(6,1,t.title)," "))},directives:[le.a,ue.a,de.a,be.a,Me],pipes:[D.d],styles:[".dnd-wrap[_ngcontent-%COMP%]{-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.dnd-wrap.fileover[_ngcontent-%COMP%]{opacity:.5}"]}),Ne),Be=i("bsP8"),Ge=i("paXB"),Ue=i("7/bn"),Xe=i("oMXN"),ze=i("EiG8"),He=i("zdqJ");function $e(e,t){if(1&e&&(v.Wb(0,"span",10),v.Qc(1),v.Vb()),2&e){var i=v.lc(2).$implicit;v.Db(i.badgeClass),v.Ab(1),v.Rc(i.badge)}}function Ye(e,t){1&e&&(v.Wb(0,"span",11),v.Rb(1,"span",12),v.Vb()),2&e&&(v.Ab(1),v.rc("jLoading",!0))}function Ke(e,t){if(1&e&&(v.Ub(0),v.Oc(1,$e,2,3,"span",8),v.Oc(2,Ye,2,1,"span",9),v.Tb()),2&e){var i=v.lc().$implicit;v.Ab(1),v.rc("ngIf",0!=i.badge),v.Ab(1),v.rc("ngIf",null==i.badge)}}function Ze(e,t){if(1&e&&(v.Wb(0,"a",6),v.Wb(1,"span"),v.Qc(2),v.mc(3,"translate"),v.Vb(),v.Oc(4,Ke,3,2,"ng-container",7),v.Vb()),2&e){var i=t.$implicit,n=v.lc();v.rc("routerLink",i.url),v.Ab(2),v.Rc(v.nc(3,3,i.label)),v.Ab(2),v.rc("ngIf",n.isBadgesShown(i.id))}}var Je,qe=((Je=function(){function e(t,i){var n=this;_classCallCheck(this,e),this.navService=t,this.route=i,this.letterTypes=[{id:"outbox",label:"LETTERS.TYPES.OUTBOX",url:"/letters/outbox",badge:null,badgeClass:"badge-primary"},{id:"inbox",label:"LETTERS.TYPES.INBOX",url:"/letters/inbox",badge:null,badgeClass:"badge-primary"},{id:"draft",label:"LETTERS.TYPES.DRAFT",url:"/letters/drafts",badge:null,badgeClass:"badge-light"}],this.createShown=new v.n,this.subscription=new ce.a,this.route.data.subscribe((function(e){n.isOutboxRoute=e.isOutbox||!1})),this.subscription.add(this.navService.getLetterBadges().subscribe((function(e){n.setBadge("outbox",e.onSignForMe),n.setBadge("inbox",e.unread),n.setBadge("draft",e.draft)})))}return _createClass(e,[{key:"isBadgesShown",value:function(e){switch(e){case"inbox":case"draft":return!0;case"outbox":return!this.isOutboxRoute}}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"setBadge",value:function(e,t){this.letterTypes.find((function(t){return t.id===e})).badge=t}},{key:"onCreateShown",value:function(){this.createShown.emit()}}]),e}()).\u0275fac=function(e){return new(e||Je)(v.Qb(Be.a),v.Qb(d.a))},Je.\u0275cmp=v.Kb({type:Je,selectors:[["j-letters-nav"]],outputs:{createShown:"createShown"},decls:8,vars:4,consts:[[1,"j-tabs"],[1,"j-tabs__list"],["class","j-tabs__item","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],["jTour","LETTERS.NEW","jTourPosition","bottom",1,"ml-auto","btn","btn-link","j-tabs__add",3,"click"],["inlineSVG","/assets/icons/contracts/add.svg",1,"j-tabs__add-icon"],[1,"d-none","d-md-block"],["routerLinkActive","active",1,"j-tabs__item",3,"routerLink"],[4,"ngIf"],["class","j-tabs__badge badge",3,"class",4,"ngIf"],["class","j-tabs__badge badge badge-light",4,"ngIf"],[1,"j-tabs__badge","badge"],[1,"j-tabs__badge","badge","badge-light"],[3,"jLoading"]],template:function(e,t){1&e&&(v.Wb(0,"div",0),v.Wb(1,"nav",1),v.Oc(2,Ze,5,5,"a",2),v.Wb(3,"button",3),v.ic("click",(function(e){return t.onCreateShown()})),v.Rb(4,"span",4),v.Wb(5,"span",5),v.Qc(6),v.mc(7,"translate"),v.Vb(),v.Vb(),v.Vb(),v.Vb()),2&e&&(v.Ab(2),v.rc("ngForOf",t.letterTypes),v.Ab(4),v.Rc(v.nc(7,2,"LETTERS.ADD_NEW")))},directives:[r.t,He.a,A.a,d.f,d.e,r.u,ye.a],pipes:[D.d],styles:[""]}),Je),et=i("I+WJ"),tt=i("LRne"),it=i("hJI6"),nt=i("vZvt");function rt(e,t){if(1&e&&(v.Wb(0,"div",9),v.Qc(1),v.mc(2,"translate"),v.Vb()),2&e){var i=v.lc(2);v.Ab(1),v.Rc(v.nc(2,1,i.mapTranslate("FOR_SIGN")))}}var st=function(e){return{$implicit:e}};function at(e,t){if(1&e&&(v.Wb(0,"div",5),v.Wb(1,"div",6),v.Sb(2,7),v.Oc(3,rt,3,3,"div",8),v.Vb(),v.Sb(4,7),v.Vb()),2&e){var i=t.$implicit,n=v.lc(),r=v.Cc(6),s=v.Cc(8);v.Ab(2),v.rc("ngTemplateOutlet",r)("ngTemplateOutletContext",v.wc(5,st,i)),v.Ab(1),v.rc("ngIf",n.isSignable),v.Ab(1),v.rc("ngTemplateOutlet",s)("ngTemplateOutletContext",v.wc(7,st,i))}}function ot(e,t){if(1&e&&(v.Wb(0,"div",5),v.Sb(1,7),v.Sb(2,7),v.Vb()),2&e){var i=t.$implicit;v.lc();var n=v.Cc(6),r=v.Cc(8);v.Ab(1),v.rc("ngTemplateOutlet",n)("ngTemplateOutletContext",v.wc(4,st,i)),v.Ab(1),v.rc("ngTemplateOutlet",r)("ngTemplateOutletContext",v.wc(6,st,i))}}function ct(e,t){if(1&e&&(v.Wb(0,"div",10),v.Qc(1),v.mc(2,"async"),v.Vb()),2&e){var i=t.$implicit,n=v.lc();v.Ab(1),v.Sc(" ",v.nc(2,1,n.mapDateText(i))," ")}}function lt(e,t){if(1&e&&v.Rb(0,"div",15),2&e){var i=v.lc().$implicit;v.rc("jClamp",1)("innerText",null==i?null:i.body)}}function ut(e,t){if(1&e&&v.Rb(0,"div",16),2&e){var i=v.lc().$implicit;v.rc("jClamp",1)("innerText",null==i?null:i.body)}}function dt(e,t){if(1&e&&(v.Wb(0,"article",11),v.Rb(1,"strong",12),v.Oc(2,lt,1,2,"div",13),v.Oc(3,ut,1,2,"div",14),v.Vb()),2&e){var i=t.$implicit;v.Ab(1),v.rc("jClamp",1)("innerText",null==i?null:i.title),v.Ab(1),v.rc("ngIf",!i.hasTour),v.Ab(1),v.rc("ngIf",i.hasTour)}}var bt,ht=((bt=function(){function e(t,i,n,r,s,a){_classCallCheck(this,e),this.lettersService=t,this.router=i,this.route=n,this.navService=r,this.companyService=s,this.translateService=a,this.isDeletable=!1,this.isSelectable=!1,this.isSignable=!1,this.detailsShown=new v.n,this.scrolled=new v.n,this.translatePrefix="LETTERS.LIST",this.urlPath="letters",this.modalPartialTitleFn=this.mapModalPartialTitle.bind(this),this.highlightedFn=this.shouldBeHighlighted.bind(this),this.highlightedTemporarilyFn=this.shouldBeHighlightedTemporarily.bind(this)}return _createClass(e,[{key:"onClick",value:function(e){e.read=!0,e.statusCode===pe.f.DRAFT?this.router.navigate(["edit",e.id],{relativeTo:this.route.parent}):this.detailsShown.emit(e)}},{key:"onScroll",value:function(){this.scrolled.emit()}},{key:"shouldBeHighlighted",value:function(e){return!e.read}},{key:"shouldBeHighlightedTemporarily",value:function(e){return this.highlighted===e.id}},{key:"mapModalPartialTitle",value:function(e){return"\u2116 ".concat(e.letterNumber,":")}},{key:"onClear",value:function(){this.navService.retrieveLetterBadges()}},{key:"onSign",value:function(){(this.companyService.isSingleSignScheme()||this.companyService.isMultipleSignScheme()&&this.companyService.isPrimaryAuthority())&&this.router.navigate(["sent"],{relativeTo:this.route.parent})}},{key:"mapTranslate",value:function(e){return"".concat(this.translatePrefix,".").concat(e)}},{key:"mapDateText",value:function(e){var t=this.lettersService.mapLetterDate(e);return"string"==typeof t?Object(tt.a)(t):this.translateService.stream(t.key,t.params)}}]),e}()).\u0275fac=function(e){return new(e||bt)(v.Qb(x),v.Qb(d.c),v.Qb(d.a),v.Qb(Be.a),v.Qb(k.a),v.Qb(D.e))},bt.\u0275cmp=v.Kb({type:bt,selectors:[["j-letters-group"]],inputs:{title:"title",list:"list",highlighted:"highlighted",isDeletable:"isDeletable",isSelectable:"isSelectable",isSignable:"isSignable"},outputs:{detailsShown:"detailsShown",scrolled:"scrolled"},decls:9,vars:11,consts:[[3,"list","title","urlPath","translatePrefix","isDeletable","isSelectable","isSignable","isHoverable","partialTitleFn","highlightedFn","highlightedTemporarilyFn","scrolled","clicked","cleared","signed"],["selectableTemplate",""],["defaultTemplate",""],["dateTemplate",""],["contentTemplate",""],[1,"p3","letters-item"],[1,"letters-item__status"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","text-blue",4,"ngIf"],[1,"text-blue"],[1,"letters-item__date","text-muted"],[1,"letters-item__content","p3"],[1,"letters-item__title","text-dark",3,"jClamp","innerText"],["class","text-muted letters-item__body",3,"jClamp","innerText",4,"ngIf"],["class","text-muted letters-item__body","jTour","LETTERS.DETAILS","jTourPosition","bottom",3,"jClamp","innerText",4,"ngIf"],[1,"text-muted","letters-item__body",3,"jClamp","innerText"],["jTour","LETTERS.DETAILS","jTourPosition","bottom",1,"text-muted","letters-item__body",3,"jClamp","innerText"]],template:function(e,t){1&e&&(v.Wb(0,"j-list",0),v.ic("scrolled",(function(e){return t.onScroll()}))("clicked",(function(e){return t.onClick(e)}))("cleared",(function(e){return t.onClear()}))("signed",(function(e){return t.onSign()})),v.Oc(1,at,5,9,"ng-template",null,1,v.Pc),v.Oc(3,ot,3,8,"ng-template",null,2,v.Pc),v.Vb(),v.Oc(5,ct,3,3,"ng-template",null,3,v.Pc),v.Oc(7,dt,4,4,"ng-template",null,4,v.Pc)),2&e&&v.rc("list",t.list)("title",t.title)("urlPath",t.urlPath)("translatePrefix",t.translatePrefix)("isDeletable",t.isDeletable)("isSelectable",t.isSelectable)("isSignable",t.isSignable)("isHoverable",!0)("partialTitleFn",t.modalPartialTitleFn)("highlightedFn",t.highlightedFn)("highlightedTemporarilyFn",t.highlightedTemporarilyFn)},directives:[it.a,r.B,r.u,nt.a,He.a],pipes:[D.d,r.b],styles:["[_nghost-%COMP%]{display:block;background:#fff}.letters-item[_ngcontent-%COMP%]{display:grid;-webkit-column-gap:16px;-moz-column-gap:16px;column-gap:16px;grid-template-columns:148px minmax(0,1fr)}"]}),bt),gt=i("4cI0"),pt=i("lABO"),ft=function(){return{width:"25%",height:"33px","background-color":"#ECEEF1"}};function vt(e,t){1&e&&v.Rb(0,"ngx-skeleton-loader",3),2&e&&v.rc("theme",v.vc(1,ft))}var mt=function(){return{width:"13%","margin-right":"2%",height:"42px","background-color":"#ECEEF1"}},St=function(){return{width:"80%",height:"42px","background-color":"#ECEEF1"}};function yt(e,t){1&e&&(v.Wb(0,"div"),v.Rb(1,"ngx-skeleton-loader",3),v.Rb(2,"ngx-skeleton-loader",3),v.Vb()),2&e&&(v.Ab(1),v.rc("theme",v.vc(2,mt)),v.Ab(1),v.rc("theme",v.vc(3,St)))}var Tt,_t=((Tt=function(){function e(){_classCallCheck(this,e),this.hasTitle=!1}return _createClass(e,[{key:"loadingCount",get:function(){return Array(5)}}]),e}()).\u0275fac=function(e){return new(e||Tt)},Tt.\u0275cmp=v.Kb({type:Tt,selectors:[["j-letters-loading"]],inputs:{hasTitle:"hasTitle"},decls:3,vars:2,consts:[[1,"bg-white","p-3"],[3,"theme",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"theme"]],template:function(e,t){1&e&&(v.Wb(0,"section",0),v.Oc(1,vt,1,2,"ngx-skeleton-loader",1),v.Oc(2,yt,3,4,"div",2),v.Vb()),2&e&&(v.Ab(1),v.rc("ngIf",t.hasTitle),v.Ab(1),v.rc("ngForOf",t.loadingCount))},directives:[r.u,r.t,a.a],styles:[""]}),Tt);function Ot(e,t){1&e&&v.Rb(0,"j-empty-placeholder",5)}function kt(e,t){if(1&e){var i=v.Xb();v.Wb(0,"j-error-placeholder",6),v.ic("retried",(function(e){return v.Fc(i),v.lc(2).onRetry()})),v.Vb()}}function wt(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"j-letters-group",1),v.ic("detailsShown",(function(e){return v.Fc(i),v.lc().onDetailsShown(e)})),v.Vb(),v.Wb(2,"j-letters-group",2),v.ic("detailsShown",(function(e){return v.Fc(i),v.lc().onDetailsShown(e)})),v.Vb(),v.Oc(3,Ot,1,0,"j-empty-placeholder",3),v.Oc(4,kt,1,0,"j-error-placeholder",4),v.Tb()}if(2&e){var n=v.lc();v.Ab(1),v.rc("list",n.onSignForMeList)("highlighted",n.highlighted)("isSignable",!0)("isSelectable",!0)("isDeletable",!0),v.Ab(1),v.rc("list",n.onSignForOthersList)("highlighted",n.highlighted)("title",n.mapTranslate("OTHERS_FOR_SIGN"))("isDeletable",!0),v.Ab(1),v.rc("ngIf",0===n.onSignForMeList.length&&0===n.onSignForOthersList.length&&!n.errorText),v.Ab(1),v.rc("ngIf",n.errorText)}}function Et(e,t){1&e&&(v.Ub(0),v.Rb(1,"j-letters-loading"),v.Rb(2,"j-letters-loading",7),v.Tb()),2&e&&(v.Ab(2),v.rc("hasTitle",!0))}var Ct,xt=((Ct=function(){function e(t,i,n){var r=this;_classCallCheck(this,e),this.lettersService=t,this.navService=i,this.companyService=n,this.retrieved=new v.n,this.detailsShown=new v.n,this.isLoading=!0,this.onSignForMeList=[],this.onSignForOthersList=[],this.lettersSearch={incoming:!1,statusCode:[pe.f.ON_SIGN],pageSize:1e5},this.errorText=null,this.subscription=new ce.a,this.subscription.add(this.companyService.refresh$.subscribe((function(e){var t=_slicedToArray(e,3);t[0],t[1],t[2]&&r.retrieveLetters()})))}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"mapTranslate",value:function(e){return"LETTERS.LIST.".concat(e)}},{key:"onDetailsShown",value:function(e){this.detailsShown.emit(e)}},{key:"onRetry",value:function(){this.retrieveLetters()}},{key:"retrieveLetters",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.errorText=null,this.navService.retrieveLetterBadges(),e.prev=1,e.next=4,Promise.all([this.retrieveOnSignForMe(),this.retrieveOnSignForOthers()]);case 4:this.onSignForMeList.length>0?this.onSignForMeList[0].hasTour=!0:this.onSignForOthersList.length>0&&(this.onSignForOthersList[0].hasTour=!0),this.retrieved.emit({onSignForMe:this.onSignForMeList.length,onSignForOthers:this.onSignForOthersList.length}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.errorText=e.t0.description||e.t0;case 11:return e.prev=11,this.isLoading=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,this,[[1,8,11,14]])})))}},{key:"retrieveOnSignForMe",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.lettersService.getList(Object.assign(Object.assign({},this.lettersSearch),{onSignForMe:!0}));case 2:t=e.sent,this.onSignForMeList=t.items;case 4:case"end":return e.stop()}}),e,this)})))}},{key:"retrieveOnSignForOthers",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.lettersService.getList(Object.assign(Object.assign({},this.lettersSearch),{onSignForOthers:!0}));case 2:t=e.sent,this.onSignForOthersList=t.items;case 4:case"end":return e.stop()}}),e,this)})))}}]),e}()).\u0275fac=function(e){return new(e||Ct)(v.Qb(x),v.Qb(Be.a),v.Qb(k.a))},Ct.\u0275cmp=v.Kb({type:Ct,selectors:[["j-letters-on-sign"]],inputs:{highlighted:"highlighted"},outputs:{retrieved:"retrieved",detailsShown:"detailsShown"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"list","highlighted","isSignable","isSelectable","isDeletable","detailsShown"],[1,"d-block","pt-3",3,"list","highlighted","title","isDeletable","detailsShown"],["class","bg-white","label","LETTERS.EMPTY.FOR_SIGN",4,"ngIf"],["class","bg-white",3,"retried",4,"ngIf"],["label","LETTERS.EMPTY.FOR_SIGN",1,"bg-white"],[1,"bg-white",3,"retried"],[3,"hasTitle"]],template:function(e,t){1&e&&(v.Oc(0,wt,5,11,"ng-container",0),v.Oc(1,Et,3,1,"ng-container",0)),2&e&&(v.rc("ngIf",!t.isLoading),v.Ab(1),v.rc("ngIf",t.isLoading))},directives:[r.u,ht,gt.a,pt.a,_t],styles:[""]}),Ct),At=i("y5b2"),Ft=i("jZlK"),It=i("u+5l"),Lt=i("1kSV");function Rt(e,t){if(1&e){var i=v.Xb();v.Wb(0,"button",5),v.ic("click",(function(e){return v.Fc(i),v.lc(2).onClearPeriod()})),v.mc(1,"translate"),v.Vb()}2&e&&v.rc("ngbTooltip",v.nc(1,1,"SHARED.CLEAR"))}function Dt(e,t){if(1&e){var i=v.Xb();v.Wb(0,"section",2),v.Wb(1,"j-filter-period-dropdown",3),v.ic("submitted",(function(e){return v.Fc(i),v.lc().onFilter(e)})),v.Vb(),v.Oc(2,Rt,2,3,"button",4),v.Vb()}if(2&e){var n=v.lc();v.Ab(2),v.rc("ngIf",n.currentDates)}}function jt(e,t){if(1&e&&(v.Wb(0,"div",10),v.Qc(1),v.mc(2,"translate"),v.Vb()),2&e){var i=v.lc(2);v.Ab(1),v.Sc(" ",v.nc(2,1,i.mapTranslate("ALL_LOADED"))," ")}}function Pt(e,t){if(1&e&&v.Rb(0,"j-empty-placeholder",11),2&e){var i=v.lc(2);v.rc("label",i.currentDates?i.emptyNotFound:i.emptyLabel)}}function Nt(e,t){if(1&e){var i=v.Xb();v.Wb(0,"j-error-placeholder",12),v.ic("retried",(function(e){return v.Fc(i),v.lc(2).onRetry()})),v.Vb()}}function Vt(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"j-letters-group",6),v.ic("scrolled",(function(e){return v.Fc(i),v.lc().onScroll()}))("detailsShown",(function(e){return v.Fc(i),v.lc().onDetailsShown(e)})),v.Vb(),v.Oc(2,jt,3,3,"div",7),v.Oc(3,Pt,1,1,"j-empty-placeholder",8),v.Oc(4,Nt,1,0,"j-error-placeholder",9),v.Tb()}if(2&e){var n=v.lc();v.Ab(1),v.rc("list",n.list)("isSignable",n.isSignable)("isSelectable",n.isSelectable)("highlighted",n.highlighted)("isDeletable",n.isDeletable),v.Ab(1),v.rc("ngIf",!n.hasMorePages&&n.list.length>0),v.Ab(1),v.rc("ngIf",0===n.list.length&&!n.errorText),v.Ab(1),v.rc("ngIf",n.errorText)}}function Wt(e,t){1&e&&(v.Ub(0),v.Rb(1,"j-letters-loading"),v.Tb())}var Mt,Qt=((Mt=function(){function e(t,i,n,r){_classCallCheck(this,e),this.lettersService=t,this.companyService=i,this.navService=n,this.filterService=r,this.isLoading=!0,this.hasMorePages=!0,this.list=[],this.emptyNotFound="LETTERS.EMPTY.NOT_FOUND",this.emptyLabel="LETTERS.EMPTY.DEFAULT",this.isSelectable=!1,this.isSignable=!1,this.isDeletable=!1,this.hasDateFilter=!1,this.retrieved=new v.n,this.detailsShown=new v.n,this.page=1,this.pageSize=10,this.currentDates=null,this.errorText=null,this.subscription=new ce.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.filterService.updatePeriod(At.d.NONE),this.subscription.add(this.companyService.refresh$.subscribe((function(t){var i=_slicedToArray(t,3);i[0],i[1],i[2]&&e.onClearPeriod()})))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onRetry",value:function(){this.retrieveLetters({page:1})}},{key:"onFilter",value:function(e){this.currentDates=e,this.retrieveLetters({page:1,dateFrom:e.from,dateTo:e.to})}},{key:"onClearPeriod",value:function(){this.currentDates=null,this.filterService.updatePeriod(At.d.NONE),this.retrieveLetters({page:1})}},{key:"onScroll",value:function(){!this.isLoading&&this.hasMorePages&&this.retrieveLetters({page:++this.page})}},{key:"onDetailsShown",value:function(e){this.detailsShown.emit(e)}},{key:"mapTranslate",value:function(e){return"LETTERS.LIST.".concat(e)}},{key:"retrieveLetters",value:function(e){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isLoading=!0,this.errorText=null,t.prev=1,i=Object.assign(Object.assign(Object.assign({},this.listParams),e),{pageSize:this.pageSize}),t.next=5,this.lettersService.getList(i);case 5:n=t.sent,this.hasMorePages=n.totalCount>e.page*this.pageSize,this.page=e.page,this.list=e.page>1?[].concat(_toConsumableArray(this.list),_toConsumableArray(n.items)):n.items,this.list.length>0&&(this.list[0].hasTour=!0),this.retrieved.emit(this.list.length),this.navService.retrieveLetterBadges(),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),this.errorText=t.t0.description||t.t0;case 12:return t.prev=12,this.isLoading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,this,[[1,9,12,15]])})))}}]),e}()).\u0275fac=function(e){return new(e||Mt)(v.Qb(x),v.Qb(k.a),v.Qb(Be.a),v.Qb(Ft.a))},Mt.\u0275cmp=v.Kb({type:Mt,selectors:[["j-letters-list-base"]],inputs:{emptyNotFound:"emptyNotFound",emptyLabel:"emptyLabel",highlighted:"highlighted",listParams:"listParams",isSelectable:"isSelectable",isSignable:"isSignable",isDeletable:"isDeletable",hasDateFilter:"hasDateFilter"},outputs:{retrieved:"retrieved",detailsShown:"detailsShown"},decls:3,vars:3,consts:[["class","j-list__filter letters__inbox-filter",4,"ngIf"],[4,"ngIf"],[1,"j-list__filter","letters__inbox-filter"],["placement","left-top",3,"submitted"],["class","letters__clear","tooltipClass","tooltip-light","inlineSVG","./assets/icons/tags-remove.svg",3,"ngbTooltip","click",4,"ngIf"],["tooltipClass","tooltip-light","inlineSVG","./assets/icons/tags-remove.svg",1,"letters__clear",3,"ngbTooltip","click"],[3,"list","isSignable","isSelectable","highlighted","isDeletable","scrolled","detailsShown"],["class","bg-white text-center text-muted py-5 p3",4,"ngIf"],["class","bg-white",3,"label",4,"ngIf"],["class","bg-white",3,"retried",4,"ngIf"],[1,"bg-white","text-center","text-muted","py-5","p3"],[1,"bg-white",3,"label"],[1,"bg-white",3,"retried"]],template:function(e,t){1&e&&(v.Oc(0,Dt,3,1,"section",0),v.Oc(1,Vt,5,8,"ng-container",1),v.Oc(2,Wt,2,0,"ng-container",1)),2&e&&(v.rc("ngIf",t.hasDateFilter),v.Ab(1),v.rc("ngIf",!t.isLoading||t.page>1),v.Ab(1),v.rc("ngIf",t.isLoading))},directives:[r.u,It.a,A.a,Lt.E,ht,gt.a,pt.a,_t],pipes:[D.d],styles:[".letters__inbox-filter[_ngcontent-%COMP%]{text-align:right;-webkit-box-align:center;align-items:center;display:-webkit-box;display:flex;-webkit-box-pack:end;justify-content:flex-end;height:83px}.letters__inbox-filter[_ngcontent-%COMP%]   j-filter-period-dropdown[_ngcontent-%COMP%]{display:inline-block}.letters__clear[_ngcontent-%COMP%]{display:inline-block;font-weight:400;color:#1a1c1f;text-align:center;vertical-align:middle;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;background-color:transparent;border:1px solid transparent;width:24px;height:24px;padding:0;margin-left:8px;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;-webkit-box-pack:center;justify-content:center}"]}),Mt);function Bt(e,t){if(1&e){var i=v.Xb();v.Wb(0,"div",2),v.Wb(1,"j-statuses",3),v.ic("selected",(function(e){return v.Fc(i),v.lc().onStatusSelect(e)})),v.Vb(),v.Vb()}if(2&e){var n=v.lc();v.Ab(1),v.rc("statuses",n.statuses)}}function Gt(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"j-letters-on-sign",4),v.ic("retrieved",(function(e){return v.Fc(i),v.lc().onSignableRetrieved(e)}))("detailsShown",(function(e){return v.Fc(i),v.lc().onDetailsShown(e)})),v.Vb(),v.Tb()}if(2&e){var n=v.lc();v.Ab(1),v.rc("highlighted",n.highlighted)}}function Ut(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"j-letters-list-base",5),v.ic("retrieved",(function(e){return v.Fc(i),v.lc().onSentRetrieved(e)}))("detailsShown",(function(e){return v.Fc(i),v.lc().onDetailsShown(e)})),v.Vb(),v.Tb()}if(2&e){var n=v.lc();v.Ab(1),v.rc("listParams",n.sentParams)("highlighted",n.highlighted)}}var Xt,zt=((Xt=function(){function e(t,i,n,r,s,a){var o=this;_classCallCheck(this,e),this.router=t,this.route=i,this.lettersService=n,this.navService=r,this.companyService=s,this.tourService=a,this.detailsShown=new v.n,this.statuses=[{label:this.mapTranslate("ON_SIGN"),value:h.ON_SIGN,count:null,isSelected:!0,isDisabled:!1},{label:this.mapTranslate("SENT"),value:h.SENT,count:0,isSelected:!1,isDisabled:!1}],this.sentParams={incoming:!1,statusCode:[pe.f.SENT,pe.f.READY_TO_SEND]},this.outboxStatus=this.statuses[0].value,this.LETTER_OUTBOX_STATUS=h,this.isOnSignHidden=!1,this.subscription=new ce.a,this.subscription.add(Object(he.a)([this.route.data,this.companyService.getAuthorizedPersons()]).subscribe((function(e){var t=_slicedToArray(e,2),i=t[0],n=t[1];o.isOnSignHidden=!!n&&o.companyService.hasOnlyPrimaryAuthorities(n)&&o.companyService.isSingleSignScheme(),o.isOnSignHidden&&i.status===h.ON_SIGN?o.router.navigate(["sent"],{relativeTo:o.route.parent}):(o.onInit(i.status),o.lettersService.lastLettersListPath$.next(i.lastPath))})));var c=this.navService.getLetterBadges().subscribe((function(e){var t=e.onSignForMe,i=e.onSignForOthers,n=t>0;Object.assign(o.statuses.find((function(e){return e.value===h.ON_SIGN})),{count:n?t:i,classList:n?"badge-primary":"badge-light"})}));this.subscription.add(c)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onSignableRetrieved",value:function(e){}},{key:"onSentRetrieved",value:function(e){}},{key:"onDetailsShown",value:function(e){this.detailsShown.emit(e)}},{key:"onInit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.ON_SIGN;this.outboxStatus=e,this.statuses=this.statuses.map((function(t){return Object.assign(Object.assign({},t),{isSelected:t.value===e})}))}},{key:"onStatusSelect",value:function(e){var t="";switch(e){case h.ON_SIGN:t="on-sign";break;case h.SENT:t="sent"}this.router.navigate([t],{relativeTo:this.route.parent})}},{key:"mapTranslate",value:function(e){return"LETTERS.STATUSES.".concat(e)}}]),e}()).\u0275fac=function(e){return new(e||Xt)(v.Qb(d.c),v.Qb(d.a),v.Qb(x),v.Qb(Be.a),v.Qb(k.a),v.Qb(w.g))},Xt.\u0275cmp=v.Kb({type:Xt,selectors:[["j-letters-outbox"]],inputs:{highlighted:"highlighted"},outputs:{detailsShown:"detailsShown"},decls:3,vars:3,consts:[["class","j-list__filter",4,"ngIf"],[4,"ngIf"],[1,"j-list__filter"],["jTour","LETTERS.STATUSES","jTourPosition","bottom",3,"statuses","selected"],[3,"highlighted","retrieved","detailsShown"],["emptyLabel","LETTERS.EMPTY.OUTBOX",3,"listParams","highlighted","retrieved","detailsShown"]],template:function(e,t){1&e&&(v.Oc(0,Bt,2,1,"div",0),v.Oc(1,Gt,2,1,"ng-container",1),v.Oc(2,Ut,2,2,"ng-container",1)),2&e&&(v.rc("ngIf",!t.isOnSignHidden),v.Ab(1),v.rc("ngIf",t.outboxStatus===t.LETTER_OUTBOX_STATUS.ON_SIGN&&!t.isOnSignHidden),v.Ab(1),v.rc("ngIf",t.outboxStatus===t.LETTER_OUTBOX_STATUS.SENT))},directives:[r.u,et.a,He.a,xt,Qt],styles:[""]}),Xt),Ht=["lettersAside"];function $t(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"j-letters-outbox",12),v.ic("detailsShown",(function(e){return v.Fc(i),v.lc().onDetailsShown(e)})),v.Vb(),v.Tb()}if(2&e){var n=v.lc();v.Ab(1),v.rc("highlighted",n.highlighted)}}function Yt(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"j-letters-list-base",13),v.ic("detailsShown",(function(e){return v.Fc(i),v.lc().onDetailsShown(e)})),v.Vb(),v.Tb()}if(2&e){var n=v.lc();v.Ab(1),v.rc("listParams",n.inboxParams)("highlighted",n.highlighted)("hasDateFilter",!0)}}function Kt(e,t){if(1&e){var i=v.Xb();v.Ub(0),v.Wb(1,"j-letters-list-base",14),v.ic("detailsShown",(function(e){return v.Fc(i),v.lc().onDetailsShown(e)})),v.Vb(),v.Tb()}if(2&e){var n=v.lc();v.Ab(1),v.rc("listParams",n.draftsParams)("isSelectable",!0)("highlighted",n.highlighted)("isDeletable",!0)}}var Zt,Jt,qt,ei=((Zt=function(){function e(t,i,n){var r=this;_classCallCheck(this,e),this.route=t,this.navService=i,this.lettersService=n,this.LETTERS_CATEGORY=b,this.subscription=new ce.a,this.inboxParams={incoming:!0},this.draftsParams={statusCode:[pe.f.DRAFT]};var s=Object(he.a)([this.route.paramMap.pipe(Object(ge.a)((function(){return window.history.state}))),this.route.data]).subscribe((function(e){var t=_slicedToArray(e,2),i=t[0],n=t[1];r.lettersCategory=n.category,r.lettersService.lastLettersListPath$.next(n.lastPath),i.highlighted&&(r.highlighted=i.highlighted)}));this.subscription.add(s)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onDetailsShown",value:function(e){this.lettersAside.showDetails(e)}},{key:"onCreateShown",value:function(){this.lettersAside.showCreate()}},{key:"onAsideClose",value:function(){this.navService.retrieveLetterBadges()}}]),e}()).\u0275fac=function(e){return new(e||Zt)(v.Qb(d.a),v.Qb(Be.a),v.Qb(x))},Zt.\u0275cmp=v.Kb({type:Zt,selectors:[["j-letters-list"]],viewQuery:function(e,t){var i;1&e&&v.Vc(Ht,!0),2&e&&v.Bc(i=v.jc())&&(t.lettersAside=i.first)},decls:19,vars:4,consts:[[1,"row"],[1,"col-lg-10","offset-lg-1","col-xl-8","offset-xl-2"],[1,"j-page"],["translate","",1,"d-none","d-lg-block","j-page__title"],[1,"j-page__body"],[1,"j-list"],[1,"j-list__nav"],[3,"createShown"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"closed"],["lettersAside",""],[3,"highlighted","detailsShown"],["emptyLabel","LETTERS.EMPTY.INBOX",3,"listParams","highlighted","hasDateFilter","detailsShown"],["emptyLabel","LETTERS.EMPTY.DRAFTS",3,"listParams","isSelectable","highlighted","isDeletable","detailsShown"]],template:function(e,t){1&e&&(v.Wb(0,"j-layout-home"),v.Wb(1,"j-aside"),v.Rb(2,"j-nav-main"),v.Vb(),v.Wb(3,"j-main"),v.Wb(4,"section",0),v.Wb(5,"section",1),v.Wb(6,"section",2),v.Wb(7,"h2",3),v.Qc(8,"LETTERS.TITLE"),v.Vb(),v.Wb(9,"section",4),v.Wb(10,"section",5),v.Wb(11,"div",6),v.Wb(12,"j-letters-nav",7),v.ic("createShown",(function(e){return t.onCreateShown()})),v.Vb(),v.Vb(),v.Ub(13,8),v.Oc(14,$t,2,1,"ng-container",9),v.Oc(15,Yt,2,3,"ng-container",9),v.Oc(16,Kt,2,4,"ng-container",9),v.Tb(),v.Vb(),v.Vb(),v.Vb(),v.Vb(),v.Vb(),v.Wb(17,"j-letters-aside",10,11),v.ic("closed",(function(e){return t.onAsideClose()})),v.Vb(),v.Vb(),v.Vb()),2&e&&(v.Ab(13),v.rc("ngSwitch",t.lettersCategory),v.Ab(1),v.rc("ngSwitchCase",t.LETTERS_CATEGORY.OUTBOX),v.Ab(1),v.rc("ngSwitchCase",t.LETTERS_CATEGORY.INBOX),v.Ab(1),v.rc("ngSwitchCase",t.LETTERS_CATEGORY.DRAFTS))},directives:[Ge.a,Ue.a,Xe.a,ze.a,D.a,qe,r.y,r.z,oe,zt,Qt],styles:[".letters__body[_ngcontent-%COMP%]{box-shadow:0 0 1px rgba(0,0,0,.04),0 0 2px rgba(0,0,0,.06),0 4px 8px rgba(0,0,0,.04);border-radius:.5rem}.letters__page-title[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:40px}.letters__header[_ngcontent-%COMP%]{padding:20px 1rem;display:none}@media(min-width:960px){.letters__header[_ngcontent-%COMP%]{display:grid}}"]}),Zt),ti=i("Kd2e"),ii=[{path:"",component:(Jt=function(){function e(t){_classCallCheck(this,e),this.featureFlagsService=t,this.subscription=new ce.a}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.subscription.add(this.featureFlagsService.featureFlags$.subscribe((function(t){e.featureFlagsService.checkFeatureRoute(ti.a.LETTER)})))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}}]),e}(),Jt.\u0275fac=function(e){return new(e||Jt)(v.Qb(ti.b))},Jt.\u0275cmp=v.Kb({type:Jt,selectors:[["j-letters"]],decls:1,vars:0,template:function(e,t){1&e&&v.Rb(0,"router-outlet")},directives:[d.h],styles:[".letters__body[_ngcontent-%COMP%]{box-shadow:0 0 1px rgba(0,0,0,.04),0 0 2px rgba(0,0,0,.06),0 4px 8px rgba(0,0,0,.04);border-radius:.5rem}.letters__page-title[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:40px}.letters__header[_ngcontent-%COMP%]{padding:20px 1rem;display:none}@media(min-width:960px){.letters__header[_ngcontent-%COMP%]{display:grid}}"]}),Jt),data:{title:"CONTRACTS.TITLE"},children:[{path:"outbox",children:[{path:"on-sign",component:ei,data:{category:b.OUTBOX,status:h.ON_SIGN,lastPath:"outbox/on-sign",isOutbox:!0}},{path:"sent",component:ei,data:{category:b.OUTBOX,status:h.SENT,lastPath:"outbox/sent",isOutbox:!0}},{path:"**",redirectTo:"on-sign"}]},{path:"inbox",component:ei,data:{category:b.INBOX,lastPath:"inbox"}},{path:"drafts",component:ei,data:{category:b.DRAFTS,lastPath:"drafts"}},{path:"create",component:Qe},{path:"edit/:id",component:Qe},{path:"**",redirectTo:"outbox"}]},{path:"**",redirectTo:""}],ni=((qt=function e(){_classCallCheck(this,e)}).\u0275mod=v.Ob({type:qt}),qt.\u0275inj=v.Nb({factory:function(e){return new(e||qt)},imports:[[d.g.forChild(ii)],d.g]}),qt);i("LJJp"),i.d(t,"LettersModule",(function(){return ai}));var ri,si=[r.c,s.n,s.D,a.b,c.c,o.b,l.a,u.a,ni],ai=((ri=function e(){_classCallCheck(this,e)}).\u0275mod=v.Ob({type:ri}),ri.\u0275inj=v.Nb({factory:function(e){return new(e||ri)},imports:[[si]]}),ri)}}]);